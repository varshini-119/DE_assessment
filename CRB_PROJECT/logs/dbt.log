[0m10:19:02.090849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1C68A85F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1C68AA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1C68A9AC0>]}


============================== 10:19:02.090849 | a8a7231f-3cca-483b-99c4-66bafdf36a6c ==============================
[0m10:19:02.090849 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:19:02.090849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:19:02.126032 [info ] [MainThread]: dbt version: 1.9.3
[0m10:19:02.126032 [info ] [MainThread]: python version: 3.12.9
[0m10:19:02.126032 [info ] [MainThread]: python path: C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\python.exe
[0m10:19:02.126032 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:19:02.515726 [info ] [MainThread]: Using profiles dir at C:\Users\PaluriVarshini\.dbt
[0m10:19:02.515726 [info ] [MainThread]: Using profiles.yml file at C:\Users\PaluriVarshini\.dbt\profiles.yml
[0m10:19:02.515726 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\PaluriVarshini\CRB_PROJECT\dbt_project.yml
[0m10:19:02.515726 [info ] [MainThread]: adapter type: snowflake
[0m10:19:02.515726 [info ] [MainThread]: adapter version: 1.9.2
[0m10:19:02.624712 [info ] [MainThread]: Configuration:
[0m10:19:02.624712 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:19:02.624712 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:19:02.624712 [info ] [MainThread]: Required dependencies:
[0m10:19:02.624712 [debug] [MainThread]: Executing "git --help"
[0m10:19:02.803912 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:19:02.819662 [debug] [MainThread]: STDERR: "b''"
[0m10:19:02.819662 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:19:02.819662 [info ] [MainThread]: Connection:
[0m10:19:02.819662 [info ] [MainThread]:   account: https://FPULZUC-MA01570.snowflakecomputing.com
[0m10:19:02.819662 [info ] [MainThread]:   user: VARSHINIPALURI
[0m10:19:02.819662 [info ] [MainThread]:   database: PROJECT_DB
[0m10:19:02.819662 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:19:02.819662 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:19:02.819662 [info ] [MainThread]:   schema: PROJECT_SCHEMA
[0m10:19:02.819662 [info ] [MainThread]:   authenticator: None
[0m10:19:02.826368 [info ] [MainThread]:   oauth_client_id: None
[0m10:19:02.826368 [info ] [MainThread]:   query_tag: None
[0m10:19:02.827689 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:19:02.828691 [info ] [MainThread]:   host: None
[0m10:19:02.829278 [info ] [MainThread]:   port: None
[0m10:19:02.829278 [info ] [MainThread]:   proxy_host: None
[0m10:19:02.830327 [info ] [MainThread]:   proxy_port: None
[0m10:19:02.831639 [info ] [MainThread]:   protocol: None
[0m10:19:02.831954 [info ] [MainThread]:   connect_retries: 1
[0m10:19:02.831954 [info ] [MainThread]:   connect_timeout: None
[0m10:19:02.831954 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:19:02.831954 [info ] [MainThread]:   retry_all: False
[0m10:19:02.831954 [info ] [MainThread]:   insecure_mode: False
[0m10:19:02.831954 [info ] [MainThread]:   reuse_connections: True
[0m10:19:02.831954 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:19:03.508005 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:19:07.177981 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:19:07.186960 [debug] [MainThread]: On debug: select 1 as id
[0m10:19:07.186960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:18.205725 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m10:19:18.205725 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m10:19:18.206774 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:19:18.207784 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:19:18.207784 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:19:18.207784 [debug] [MainThread]: Command `dbt debug` failed at 10:19:18.207784 after 16.28 seconds
[0m10:19:18.207784 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:19:18.207784 [debug] [MainThread]: On debug: No close available on handle
[0m10:19:18.207784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1C4B4E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1C6D9FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1C6E5E360>]}
[0m10:19:18.207784 [debug] [MainThread]: Flushing usage events
[0m10:19:19.108491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:20:22.914790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149817B99A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149845344D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014984534A40>]}


============================== 10:20:22.919791 | 72ada8c2-f2c1-44f6-bd14-6e0cfc80bcf6 ==============================
[0m10:20:22.919791 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:20:22.920791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'c:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:20:23.048178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72ada8c2-f2c1-44f6-bd14-6e0cfc80bcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014984562330>]}
[0m10:20:23.093317 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:20:23.095287 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:20:23.096285 [debug] [MainThread]: Command `cli deps` succeeded at 10:20:23.096285 after 0.36 seconds
[0m10:20:23.096285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014984562330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149841F62D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149846DEA50>]}
[0m10:20:23.097286 [debug] [MainThread]: Flushing usage events
[0m10:20:24.457514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:10.292051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EDDA957C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE055A5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE02F9340>]}


============================== 10:22:10.292051 | 6156e344-2d57-4bf2-9fbb-20bb39210e6a ==============================
[0m10:22:10.292051 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:22:10.292051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:22:10.332851 [info ] [MainThread]: dbt version: 1.9.3
[0m10:22:10.332851 [info ] [MainThread]: python version: 3.12.9
[0m10:22:10.332851 [info ] [MainThread]: python path: C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\python.exe
[0m10:22:10.332851 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:22:10.804244 [info ] [MainThread]: Using profiles dir at C:\Users\PaluriVarshini\.dbt
[0m10:22:10.804244 [info ] [MainThread]: Using profiles.yml file at C:\Users\PaluriVarshini\.dbt\profiles.yml
[0m10:22:10.804244 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\PaluriVarshini\CRB_PROJECT\dbt_project.yml
[0m10:22:10.804244 [info ] [MainThread]: adapter type: snowflake
[0m10:22:10.804244 [info ] [MainThread]: adapter version: 1.9.2
[0m10:22:10.928317 [info ] [MainThread]: Configuration:
[0m10:22:10.929318 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:22:10.929318 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:22:10.929318 [info ] [MainThread]: Required dependencies:
[0m10:22:10.929318 [debug] [MainThread]: Executing "git --help"
[0m10:22:10.989048 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:22:10.989048 [debug] [MainThread]: STDERR: "b''"
[0m10:22:10.991054 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:22:10.991054 [info ] [MainThread]: Connection:
[0m10:22:10.991054 [info ] [MainThread]:   account: FPULZUC-MA01570
[0m10:22:10.991054 [info ] [MainThread]:   user: VARSHINIPALURI
[0m10:22:10.993060 [info ] [MainThread]:   database: PROJECT_DB
[0m10:22:10.993060 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:22:10.993060 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:22:10.993060 [info ] [MainThread]:   schema: PROJECT_SCHEMA
[0m10:22:10.993060 [info ] [MainThread]:   authenticator: None
[0m10:22:10.995065 [info ] [MainThread]:   oauth_client_id: None
[0m10:22:10.995450 [info ] [MainThread]:   query_tag: None
[0m10:22:10.995450 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:22:10.995450 [info ] [MainThread]:   host: None
[0m10:22:10.996508 [info ] [MainThread]:   port: None
[0m10:22:10.997457 [info ] [MainThread]:   proxy_host: None
[0m10:22:10.998459 [info ] [MainThread]:   proxy_port: None
[0m10:22:10.998459 [info ] [MainThread]:   protocol: None
[0m10:22:10.999458 [info ] [MainThread]:   connect_retries: 1
[0m10:22:11.000462 [info ] [MainThread]:   connect_timeout: None
[0m10:22:11.001463 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:22:11.001463 [info ] [MainThread]:   retry_all: False
[0m10:22:11.002458 [info ] [MainThread]:   insecure_mode: False
[0m10:22:11.003459 [info ] [MainThread]:   reuse_connections: True
[0m10:22:11.006905 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:22:11.531757 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:22:11.677395 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:22:11.677395 [debug] [MainThread]: On debug: select 1 as id
[0m10:22:11.677395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:22:18.940681 [debug] [MainThread]: SQL status: SUCCESS 1 in 7.272 seconds
[0m10:22:18.940681 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:22:18.952123 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:22:18.952123 [debug] [MainThread]: Command `dbt debug` succeeded at 10:22:18.952123 after 8.92 seconds
[0m10:22:18.952123 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:22:18.952123 [debug] [MainThread]: On debug: Close
[0m10:22:19.275068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE0492660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE267F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EE267F530>]}
[0m10:22:19.277076 [debug] [MainThread]: Flushing usage events
[0m10:22:20.172109 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:32:32.211390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EEBADDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EEBAC680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EEBAE660>]}


============================== 10:32:32.218741 | 0ce07a1f-3762-4a28-9c0a-21ce6f72c26f ==============================
[0m10:32:32.218741 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:32:32.218741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -m stg_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:32:32.633011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ce07a1f-3762-4a28-9c0a-21ce6f72c26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EF53B6E0>]}
[0m10:32:32.697647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ce07a1f-3762-4a28-9c0a-21ce6f72c26f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EE0EA390>]}
[0m10:32:32.697647 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:32:33.229298 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:32:33.388085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:32:33.388085 [debug] [MainThread]: Partial parsing: added file: CRB_PROJECT://models\stage\stg_customers.sql
[0m10:32:33.388085 [debug] [MainThread]: Partial parsing: added file: CRB_PROJECT://models\source.yml
[0m10:32:33.669461 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.CRB_PROJECT.stg_customers' (models\stage\stg_customers.sql) depends on a source named 'crb_data.CUSTOMERS_DATA' which was not found
[0m10:32:33.669461 [debug] [MainThread]: Command `dbt compile` failed at 10:32:33.669461 after 1.65 seconds
[0m10:32:33.685159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5EE3C1EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F0E47740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5F0E28230>]}
[0m10:32:33.685159 [debug] [MainThread]: Flushing usage events
[0m10:32:34.597324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:39.526142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FEA13950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FEA110A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FEA10770>]}


============================== 10:35:39.526142 | 03ec5f15-e014-43e0-b2b8-9977aeca9b0a ==============================
[0m10:35:39.526142 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:35:39.526142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile -m stg_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:35:39.948265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03ec5f15-e014-43e0-b2b8-9977aeca9b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FF77F890>]}
[0m10:35:40.011915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03ec5f15-e014-43e0-b2b8-9977aeca9b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FF47F710>]}
[0m10:35:40.011915 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:35:40.513039 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:35:40.685954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:35:40.685954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:35:40.733072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03ec5f15-e014-43e0-b2b8-9977aeca9b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FEA2E300>]}
[0m10:35:40.812749 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:35:40.860546 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:35:40.894289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03ec5f15-e014-43e0-b2b8-9977aeca9b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FFC54A40>]}
[0m10:35:40.894289 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 474 macros
[0m10:35:40.894289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ec5f15-e014-43e0-b2b8-9977aeca9b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FFC272F0>]}
[0m10:35:40.902323 [info ] [MainThread]: 
[0m10:35:40.904332 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:35:40.905278 [info ] [MainThread]: 
[0m10:35:40.906220 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:35:40.912609 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:35:44.356217 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:35:44.356217 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:35:44.356217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:46.154531 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafed1-3201-7db6-000c-493e00019d42
[0m10:35:46.154531 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:35:46.154531 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:35:46.154531 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:35:46.156535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ec5f15-e014-43e0-b2b8-9977aeca9b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021781040530>]}
[0m10:35:46.168300 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m10:35:46.168300 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m10:35:46.168300 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m10:35:46.168300 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m10:35:46.168300 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m10:35:46.168300 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m10:35:46.168300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:46.168300 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:35:46.184031 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:35:46.511443 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was properly closed.
[0m10:35:46.511443 [debug] [MainThread]: Command end result
[0m10:35:46.527303 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:35:46.527303 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:35:46.527303 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:35:46.542979 [info ] [MainThread]: Compiled node 'stg_customers' is:
select 
* 
from PROJECT_DB.STAGE.CUSTOMERS_DATA
[0m10:35:46.542979 [debug] [MainThread]: Command `dbt compile` succeeded at 10:35:46.542979 after 7.17 seconds
[0m10:35:46.542979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FBBA31A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FE54E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FE54F440>]}
[0m10:35:46.542979 [debug] [MainThread]: Flushing usage events
[0m10:35:47.438096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:59.510729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174C0147A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174C014380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174C014A10>]}


============================== 10:35:59.518719 | 845b7ff1-be57-4e40-8889-d1f18139b010 ==============================
[0m10:35:59.518719 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:35:59.520172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m10:35:59.938296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '845b7ff1-be57-4e40-8889-d1f18139b010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174C2EC170>]}
[0m10:36:00.016444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '845b7ff1-be57-4e40-8889-d1f18139b010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021749D4A6C0>]}
[0m10:36:00.018451 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:36:00.516657 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:36:00.689119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:36:00.689119 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:36:00.739067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '845b7ff1-be57-4e40-8889-d1f18139b010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174C059C40>]}
[0m10:36:00.827291 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:36:00.827291 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:36:00.855840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '845b7ff1-be57-4e40-8889-d1f18139b010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174E291A90>]}
[0m10:36:00.859478 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 474 macros
[0m10:36:00.859478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845b7ff1-be57-4e40-8889-d1f18139b010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174DEA3D10>]}
[0m10:36:00.859478 [info ] [MainThread]: 
[0m10:36:00.859478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:36:00.859478 [info ] [MainThread]: 
[0m10:36:00.859478 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:36:00.859478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:36:00.970021 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:36:00.970021 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:36:00.970021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:02.506876 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.537 seconds
[0m10:36:02.514006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB, now create_PROJECT_DB_PROJECT_SCHEMA)
[0m10:36:02.517012 [debug] [ThreadPool]: Creating schema "database: "PROJECT_DB"
schema: "PROJECT_SCHEMA"
"
[0m10:36:02.526145 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_DB_PROJECT_SCHEMA"
[0m10:36:02.527132 [debug] [ThreadPool]: On create_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "create_PROJECT_DB_PROJECT_SCHEMA"} */
create schema if not exists PROJECT_DB.PROJECT_SCHEMA
[0m10:36:02.749072 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.222 seconds
[0m10:36:02.756070 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:36:02.765229 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:36:02.766397 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:36:02.766397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:03.702357 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.949 seconds
[0m10:36:03.702357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845b7ff1-be57-4e40-8889-d1f18139b010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174E264860>]}
[0m10:36:03.718278 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m10:36:03.718278 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.stg_customers ....................... [RUN]
[0m10:36:03.718278 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m10:36:03.718278 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m10:36:03.729431 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m10:36:03.731436 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m10:36:03.757849 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m10:36:03.757849 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m10:36:03.757849 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.stg_customers
  
   as (
    select 
* 
from PROJECT_DB.STAGE.CUSTOMERS_DATA
  );
[0m10:36:03.764566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:36:05.045421 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.281 seconds
[0m10:36:05.062612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '845b7ff1-be57-4e40-8889-d1f18139b010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217493F1A90>]}
[0m10:36:05.062612 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PROJECT_SCHEMA.stg_customers .................. [[32mSUCCESS 1[0m in 1.34s]
[0m10:36:05.062612 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m10:36:05.062612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:05.062612 [debug] [MainThread]: Connection 'create_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:36:05.062612 [debug] [MainThread]: On create_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:36:05.387384 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:36:05.387384 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:36:05.711001 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m10:36:05.711001 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m10:36:06.048428 [info ] [MainThread]: 
[0m10:36:06.061690 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.19 seconds (5.19s).
[0m10:36:06.061690 [debug] [MainThread]: Command end result
[0m10:36:06.084488 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:36:06.087493 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:36:06.094627 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:36:06.094627 [info ] [MainThread]: 
[0m10:36:06.095664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:36:06.095664 [info ] [MainThread]: 
[0m10:36:06.096663 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:36:06.097663 [debug] [MainThread]: Command `dbt run` succeeded at 10:36:06.097663 after 6.75 seconds
[0m10:36:06.098662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174BEE0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174DF2A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002174C014650>]}
[0m10:36:06.098662 [debug] [MainThread]: Flushing usage events
[0m10:36:06.968174 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:30.445049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BB294860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BB2949B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BB294770>]}


============================== 10:37:30.445049 | 48357251-1a70-4a62-b64c-a21271bdb36c ==============================
[0m10:37:30.445049 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:37:30.445049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile -m stg_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:37:30.866484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48357251-1a70-4a62-b64c-a21271bdb36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BBF8CB00>]}
[0m10:37:30.913537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48357251-1a70-4a62-b64c-a21271bdb36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BA7F5EE0>]}
[0m10:37:30.929291 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:37:31.397857 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:37:31.562391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:31.562391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:31.612293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48357251-1a70-4a62-b64c-a21271bdb36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BD0CE2D0>]}
[0m10:37:31.695737 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:37:31.695737 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:37:31.727997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48357251-1a70-4a62-b64c-a21271bdb36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BD480770>]}
[0m10:37:31.728681 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 474 macros
[0m10:37:31.729077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48357251-1a70-4a62-b64c-a21271bdb36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BD478C20>]}
[0m10:37:31.731084 [info ] [MainThread]: 
[0m10:37:31.731084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:37:31.731084 [info ] [MainThread]: 
[0m10:37:31.731084 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:37:31.731084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:37:31.841790 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:37:31.842794 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:37:31.842794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:33.362179 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.532 seconds
[0m10:37:33.362179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48357251-1a70-4a62-b64c-a21271bdb36c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BD2CC440>]}
[0m10:37:33.377879 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m10:37:33.377879 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m10:37:33.377879 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m10:37:33.377879 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m10:37:33.377879 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m10:37:33.377879 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m10:37:33.377879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:33.377879 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:37:33.377879 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:37:33.718211 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was properly closed.
[0m10:37:33.718211 [debug] [MainThread]: Command end result
[0m10:37:33.749814 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:37:33.753432 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:37:33.753432 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:37:33.753432 [info ] [MainThread]: Compiled node 'stg_customers' is:
select 
* 
from PROJECT_DB.STAGE.CUSTOMERS_DATA
[0m10:37:33.753432 [debug] [MainThread]: Command `dbt compile` succeeded at 10:37:33.753432 after 3.48 seconds
[0m10:37:33.753432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BBE0FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BD80D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272BA7658E0>]}
[0m10:37:33.753432 [debug] [MainThread]: Flushing usage events
[0m10:37:34.665887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:40.037874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C2D54980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C2D54AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C2D548F0>]}


============================== 10:37:40.045963 | 49c9fb8e-a3b4-4b42-812d-f04bc49ae905 ==============================
[0m10:37:40.045963 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:37:40.045963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:37:40.473549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49c9fb8e-a3b4-4b42-812d-f04bc49ae905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C394C230>]}
[0m10:37:40.537028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49c9fb8e-a3b4-4b42-812d-f04bc49ae905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C22B6570>]}
[0m10:37:40.537028 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:37:41.006027 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:37:41.188512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:41.188512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:41.221947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49c9fb8e-a3b4-4b42-812d-f04bc49ae905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C4B9CFE0>]}
[0m10:37:41.305399 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:37:41.305399 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:37:41.338591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49c9fb8e-a3b4-4b42-812d-f04bc49ae905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C4F1DE20>]}
[0m10:37:41.338591 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 474 macros
[0m10:37:41.338591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49c9fb8e-a3b4-4b42-812d-f04bc49ae905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C4B09F70>]}
[0m10:37:41.338591 [info ] [MainThread]: 
[0m10:37:41.345812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:37:41.345812 [info ] [MainThread]: 
[0m10:37:41.345812 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:37:41.345812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:37:41.450652 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:37:41.451652 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:37:41.451652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:42.642118 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.196 seconds
[0m10:37:42.658483 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:37:42.677989 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:37:42.677989 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:37:42.677989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:43.649278 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.978 seconds
[0m10:37:43.665300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49c9fb8e-a3b4-4b42-812d-f04bc49ae905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C4B9D550>]}
[0m10:37:43.665300 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m10:37:43.665300 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m10:37:43.665300 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m10:37:43.665300 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m10:37:43.680992 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m10:37:43.683000 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m10:37:43.711202 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m10:37:43.711202 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m10:37:43.711202 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (select 
* 
from PROJECT_DB.STAGE.CUSTOMERS_DATA
        );
[0m10:37:43.711202 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:37:45.784895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.069 seconds
[0m10:37:45.807555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49c9fb8e-a3b4-4b42-812d-f04bc49ae905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C01219D0>]}
[0m10:37:45.807555 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_customers ................. [[32mSUCCESS 1[0m in 2.14s]
[0m10:37:45.807555 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m10:37:45.807555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:45.807555 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:37:45.807555 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:37:46.161581 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:37:46.161581 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:37:46.578178 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m10:37:46.578178 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m10:37:46.962113 [info ] [MainThread]: 
[0m10:37:46.962113 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m10:37:46.962113 [debug] [MainThread]: Command end result
[0m10:37:46.983831 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:37:46.983831 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:37:46.999879 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:37:47.000312 [info ] [MainThread]: 
[0m10:37:47.001984 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:37:47.002961 [info ] [MainThread]: 
[0m10:37:47.004223 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:37:47.005229 [debug] [MainThread]: Command `dbt run` succeeded at 10:37:47.005229 after 7.12 seconds
[0m10:37:47.005229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C2C4B5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C2C4A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C0B1E660>]}
[0m10:37:47.006263 [debug] [MainThread]: Flushing usage events
[0m10:37:47.978574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:16.011097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6F991100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6F467EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6F9932C0>]}


============================== 10:40:16.011097 | d3063915-4445-4d1f-93bc-cbb6d59c8a23 ==============================
[0m10:40:16.011097 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:40:16.019813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile -m stg_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:40:16.430938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3063915-4445-4d1f-93bc-cbb6d59c8a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A70639790>]}
[0m10:40:16.502559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3063915-4445-4d1f-93bc-cbb6d59c8a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6FCECCB0>]}
[0m10:40:16.502559 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:40:16.977161 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:40:17.161962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:40:17.161962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:40:17.200444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3063915-4445-4d1f-93bc-cbb6d59c8a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A717C2C60>]}
[0m10:40:17.289397 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:40:17.289397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:40:17.313193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3063915-4445-4d1f-93bc-cbb6d59c8a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A71B70F80>]}
[0m10:40:17.313193 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 474 macros
[0m10:40:17.313193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3063915-4445-4d1f-93bc-cbb6d59c8a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A71B68A40>]}
[0m10:40:17.313193 [info ] [MainThread]: 
[0m10:40:17.318337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:40:17.318337 [info ] [MainThread]: 
[0m10:40:17.320343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:40:17.324355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:40:17.427491 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:40:17.427491 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:40:17.427491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:18.739284 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.310 seconds
[0m10:40:18.739284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3063915-4445-4d1f-93bc-cbb6d59c8a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A719BC440>]}
[0m10:40:18.739284 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m10:40:18.739284 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m10:40:18.739284 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m10:40:18.755100 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m10:40:18.755100 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m10:40:18.755100 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m10:40:18.755100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:18.755100 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:40:18.755100 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:40:19.096728 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was properly closed.
[0m10:40:19.096728 [debug] [MainThread]: Command end result
[0m10:40:19.128905 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:40:19.131650 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:40:19.131650 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:40:19.131650 [info ] [MainThread]: Compiled node 'stg_customers' is:
select 
* 
from PROJECT_DB.STAGE.CUSTOMERS_DATA
where customer_id is not null
[0m10:40:19.131650 [debug] [MainThread]: Command `dbt compile` succeeded at 10:40:19.131650 after 3.30 seconds
[0m10:40:19.131650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6F313FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6F4CE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013A6F4CFDA0>]}
[0m10:40:19.131650 [debug] [MainThread]: Flushing usage events
[0m10:40:20.084977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:25.749000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A41C1D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A415D2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A41C1C620>]}


============================== 10:40:25.749000 | 459d9209-77d0-4c3d-b6af-dea116d0926f ==============================
[0m10:40:25.749000 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:40:25.749000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:40:26.186267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '459d9209-77d0-4c3d-b6af-dea116d0926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A428DFB90>]}
[0m10:40:26.235982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '459d9209-77d0-4c3d-b6af-dea116d0926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A429412B0>]}
[0m10:40:26.235982 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:40:26.718188 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:40:26.895697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:40:26.895697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:40:26.939323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '459d9209-77d0-4c3d-b6af-dea116d0926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A43A1FC80>]}
[0m10:40:27.018012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:40:27.023806 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:40:27.037517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '459d9209-77d0-4c3d-b6af-dea116d0926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A43D7DC70>]}
[0m10:40:27.037517 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 474 macros
[0m10:40:27.037517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '459d9209-77d0-4c3d-b6af-dea116d0926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A43C6C320>]}
[0m10:40:27.053194 [info ] [MainThread]: 
[0m10:40:27.053194 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:40:27.053194 [info ] [MainThread]: 
[0m10:40:27.053194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:40:27.056332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:40:27.154061 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:40:27.154061 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:40:27.154061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:28.522394 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.356 seconds
[0m10:40:28.522394 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:40:28.528480 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:40:28.528480 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:40:28.528480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:29.533074 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.009 seconds
[0m10:40:29.548811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '459d9209-77d0-4c3d-b6af-dea116d0926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A428DEB70>]}
[0m10:40:29.548811 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m10:40:29.548811 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m10:40:29.548811 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m10:40:29.548811 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m10:40:29.548811 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m10:40:29.548811 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m10:40:29.595065 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m10:40:29.597034 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m10:40:29.597034 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (select 
* 
from PROJECT_DB.STAGE.CUSTOMERS_DATA
where customer_id is not null
        );
[0m10:40:29.598032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:40:31.007470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.410 seconds
[0m10:40:31.022965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '459d9209-77d0-4c3d-b6af-dea116d0926f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A42910AD0>]}
[0m10:40:31.022965 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_customers ................. [[32mSUCCESS 1[0m in 1.47s]
[0m10:40:31.022965 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m10:40:31.022965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:31.038735 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:40:31.038735 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:40:31.348759 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:40:31.364608 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:40:31.682670 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m10:40:31.682670 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m10:40:32.483279 [info ] [MainThread]: 
[0m10:40:32.483279 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m10:40:32.483279 [debug] [MainThread]: Command end result
[0m10:40:32.507629 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:40:32.509739 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:40:32.517618 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:40:32.517618 [info ] [MainThread]: 
[0m10:40:32.518621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:40:32.518621 [info ] [MainThread]: 
[0m10:40:32.518621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:40:32.518621 [debug] [MainThread]: Command `dbt run` succeeded at 10:40:32.518621 after 6.93 seconds
[0m10:40:32.518621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3F1997C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3F9DE7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3F9DE8A0>]}
[0m10:40:32.518621 [debug] [MainThread]: Flushing usage events
[0m10:40:33.412537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:43.614810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEB2E4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEB2E4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEB2E4B60>]}


============================== 10:41:43.628742 | 89e71ca4-51dc-4496-b9b5-34ddb8ae2d3b ==============================
[0m10:41:43.628742 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:41:43.628742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile -m stg_products', 'send_anonymous_usage_stats': 'True'}
[0m10:41:44.681261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89e71ca4-51dc-4496-b9b5-34ddb8ae2d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE86B29C0>]}
[0m10:41:44.744923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89e71ca4-51dc-4496-b9b5-34ddb8ae2d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEA84A390>]}
[0m10:41:44.744923 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:41:45.359354 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:41:45.529195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:41:45.529195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:41:45.577216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89e71ca4-51dc-4496-b9b5-34ddb8ae2d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFED0FE300>]}
[0m10:41:45.656345 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:41:45.674399 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:41:45.703819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89e71ca4-51dc-4496-b9b5-34ddb8ae2d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFED4B8CE0>]}
[0m10:41:45.703819 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:41:45.703819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89e71ca4-51dc-4496-b9b5-34ddb8ae2d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFED12CE60>]}
[0m10:41:45.703819 [info ] [MainThread]: 
[0m10:41:45.703819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:41:45.703819 [info ] [MainThread]: 
[0m10:41:45.703819 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:41:45.703819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:41:48.844071 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:41:48.857614 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:41:48.857614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:50.252716 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.395 seconds
[0m10:41:50.254722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89e71ca4-51dc-4496-b9b5-34ddb8ae2d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE8743920>]}
[0m10:41:50.254722 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:41:50.254722 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:41:50.254722 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:41:50.267508 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:41:50.267508 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:41:50.267508 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:41:50.267508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:50.267508 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:41:50.267508 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:41:50.586668 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was properly closed.
[0m10:41:50.595432 [debug] [MainThread]: Command end result
[0m10:41:50.614480 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:41:50.616487 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:41:50.624260 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:41:50.624260 [info ] [MainThread]: Compiled node 'stg_products' is:
select 
* 
from PROJECT_DB.STAGE.PRODUCTS_DATA
[0m10:41:50.624260 [debug] [MainThread]: Command `dbt compile` succeeded at 10:41:50.624260 after 7.18 seconds
[0m10:41:50.624260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEADBF710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEB2C7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEBCABCB0>]}
[0m10:41:50.624260 [debug] [MainThread]: Flushing usage events
[0m10:41:51.495297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:42:02.749811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015785764620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001578540A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015785764470>]}


============================== 10:42:02.749811 | 572c2b88-7aa7-4f6b-b2e2-e4da07152914 ==============================
[0m10:42:02.749811 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:42:02.749811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_products', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:42:03.250723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '572c2b88-7aa7-4f6b-b2e2-e4da07152914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001578640CB30>]}
[0m10:42:03.313594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '572c2b88-7aa7-4f6b-b2e2-e4da07152914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015784BB6240>]}
[0m10:42:03.313594 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:42:03.801655 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:42:03.975819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:03.975819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:04.007574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '572c2b88-7aa7-4f6b-b2e2-e4da07152914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001578759B470>]}
[0m10:42:04.101504 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:42:04.101504 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:42:04.128875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '572c2b88-7aa7-4f6b-b2e2-e4da07152914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015787905FA0>]}
[0m10:42:04.136506 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:42:04.136506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '572c2b88-7aa7-4f6b-b2e2-e4da07152914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001578759BD10>]}
[0m10:42:04.136506 [info ] [MainThread]: 
[0m10:42:04.136506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:42:04.136506 [info ] [MainThread]: 
[0m10:42:04.136506 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:42:04.136506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:42:04.249655 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:42:04.249655 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:42:04.250655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:05.547023 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.304 seconds
[0m10:42:05.547023 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:42:05.562951 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:42:05.562951 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:42:05.562951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:06.556316 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.986 seconds
[0m10:42:06.558319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '572c2b88-7aa7-4f6b-b2e2-e4da07152914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001578754F170>]}
[0m10:42:06.562326 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:42:06.564331 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m10:42:06.564331 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:42:06.564331 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:42:06.566075 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:42:06.566075 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:42:06.609076 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m10:42:06.611084 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m10:42:06.611084 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (select 
* 
from PROJECT_DB.STAGE.PRODUCTS_DATA
        );
[0m10:42:06.611084 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:42:07.928351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.317 seconds
[0m10:42:07.944173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '572c2b88-7aa7-4f6b-b2e2-e4da07152914', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015782B31970>]}
[0m10:42:07.944173 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_products .................. [[32mSUCCESS 1[0m in 1.38s]
[0m10:42:07.944173 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:42:07.944173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:07.944173 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:42:07.944173 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:42:08.275530 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:42:08.275530 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:42:08.686283 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m10:42:08.686283 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m10:42:09.012483 [info ] [MainThread]: 
[0m10:42:09.012483 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m10:42:09.028211 [debug] [MainThread]: Command end result
[0m10:42:09.050189 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:42:09.056627 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:42:09.061519 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:42:09.061519 [info ] [MainThread]: 
[0m10:42:09.061519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:09.061519 [info ] [MainThread]: 
[0m10:42:09.061519 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:09.061519 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:09.061519 after 6.48 seconds
[0m10:42:09.061519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001578565B5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015785764470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015785764620>]}
[0m10:42:09.061519 [debug] [MainThread]: Flushing usage events
[0m10:42:09.952301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:15.475989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298FB43EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298F8AA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298B668BC0>]}


============================== 10:44:15.475989 | e7b41243-7691-4264-a41e-9435dd84801a ==============================
[0m10:44:15.475989 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:44:15.475989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile -m stg_products', 'send_anonymous_usage_stats': 'True'}
[0m10:44:15.962056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7b41243-7691-4264-a41e-9435dd84801a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002299084CD70>]}
[0m10:44:16.024930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7b41243-7691-4264-a41e-9435dd84801a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229908A2150>]}
[0m10:44:16.024930 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:44:16.496183 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:44:16.674872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:16.674872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:16.716732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7b41243-7691-4264-a41e-9435dd84801a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002299071FD40>]}
[0m10:44:16.787339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:44:16.798354 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:44:16.830138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7b41243-7691-4264-a41e-9435dd84801a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022991CF1D90>]}
[0m10:44:16.830138 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:44:16.830138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7b41243-7691-4264-a41e-9435dd84801a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229919DA9F0>]}
[0m10:44:16.830138 [info ] [MainThread]: 
[0m10:44:16.830138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:44:16.830138 [info ] [MainThread]: 
[0m10:44:16.830138 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:44:16.830138 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:44:16.946309 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:44:16.947311 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:44:16.947311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:18.914502 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.967 seconds
[0m10:44:18.922594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7b41243-7691-4264-a41e-9435dd84801a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022991D12AE0>]}
[0m10:44:18.922594 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:44:18.922594 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:44:18.922594 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:44:18.936329 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:44:18.936329 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:44:18.936329 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:44:18.936329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:18.936329 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:44:18.936329 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:44:19.261166 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was properly closed.
[0m10:44:19.261166 [debug] [MainThread]: Command end result
[0m10:44:19.293217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:44:19.296921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:44:19.296921 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:44:19.296921 [info ] [MainThread]: Compiled node 'stg_products' is:
select 
* 
from PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
[0m10:44:19.296921 [debug] [MainThread]: Command `dbt compile` succeeded at 10:44:19.296921 after 3.99 seconds
[0m10:44:19.296921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298D0221E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298D8E23F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002298D8E2300>]}
[0m10:44:19.296921 [debug] [MainThread]: Flushing usage events
[0m10:44:20.541371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:25.391366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EC8A9EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDC4E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDC4E510>]}


============================== 10:44:25.391366 | 2dc54efc-c25c-4894-a44e-53c5ac02b804 ==============================
[0m10:44:25.391366 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:44:25.391366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_products', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:44:25.911228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dc54efc-c25c-4894-a44e-53c5ac02b804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F089A9C0>]}
[0m10:44:25.992022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dc54efc-c25c-4894-a44e-53c5ac02b804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EF309E80>]}
[0m10:44:25.994022 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:44:26.508203 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:44:26.693732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:26.693732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:26.742780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dc54efc-c25c-4894-a44e-53c5ac02b804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F079F770>]}
[0m10:44:26.831242 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:44:26.833484 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:44:26.868767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dc54efc-c25c-4894-a44e-53c5ac02b804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F2062240>]}
[0m10:44:26.869766 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:44:26.869766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dc54efc-c25c-4894-a44e-53c5ac02b804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F1CFA7E0>]}
[0m10:44:26.871766 [info ] [MainThread]: 
[0m10:44:26.871766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:44:26.872765 [info ] [MainThread]: 
[0m10:44:26.873766 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:44:26.875140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:44:26.984574 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:44:26.985575 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:44:26.985575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:28.044472 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.061 seconds
[0m10:44:28.052005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:44:28.060372 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:44:28.060372 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:44:28.060372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:29.013184 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.949 seconds
[0m10:44:29.017219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dc54efc-c25c-4894-a44e-53c5ac02b804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F2050590>]}
[0m10:44:29.019257 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:44:29.019257 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m10:44:29.019257 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:44:29.019257 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:44:29.031525 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:44:29.032497 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:44:29.068398 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m10:44:29.068398 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m10:44:29.068398 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (select 
* 
from PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
        );
[0m10:44:29.068398 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:44:30.435776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.376 seconds
[0m10:44:30.467152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dc54efc-c25c-4894-a44e-53c5ac02b804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EF354710>]}
[0m10:44:30.467152 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_products .................. [[32mSUCCESS 1[0m in 1.45s]
[0m10:44:30.467152 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:44:30.467152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:30.467152 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:44:30.467152 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:44:30.794481 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:44:30.794481 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:44:31.118888 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m10:44:31.129303 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m10:44:31.440409 [info ] [MainThread]: 
[0m10:44:31.440409 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m10:44:31.440409 [debug] [MainThread]: Command end result
[0m10:44:31.492247 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:44:31.494256 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:44:31.510085 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:44:31.510085 [info ] [MainThread]: 
[0m10:44:31.514016 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:31.514016 [info ] [MainThread]: 
[0m10:44:31.514016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:44:31.514016 [debug] [MainThread]: Command `dbt run` succeeded at 10:44:31.514016 after 6.29 seconds
[0m10:44:31.514016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EF3E5F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F1CB34D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F0BC29C0>]}
[0m10:44:31.519570 [debug] [MainThread]: Flushing usage events
[0m10:44:32.414132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:46:10.146946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B2574E840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B24F7C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B24B554C0>]}


============================== 10:46:10.153665 | f11575be-8353-45bc-b768-63b5410d6022 ==============================
[0m10:46:10.153665 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:46:10.155671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_products', 'send_anonymous_usage_stats': 'True'}
[0m10:46:10.637307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f11575be-8353-45bc-b768-63b5410d6022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B27464140>]}
[0m10:46:10.698727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f11575be-8353-45bc-b768-63b5410d6022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B22BB72C0>]}
[0m10:46:10.698727 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:46:11.180699 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:46:11.345633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:46:11.345633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:46:11.394008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f11575be-8353-45bc-b768-63b5410d6022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B2623A150>]}
[0m10:46:11.476718 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:46:11.478723 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:46:11.504113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f11575be-8353-45bc-b768-63b5410d6022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B278B61B0>]}
[0m10:46:11.504113 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:46:11.504113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f11575be-8353-45bc-b768-63b5410d6022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B26413D10>]}
[0m10:46:11.504113 [info ] [MainThread]: 
[0m10:46:11.515931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:46:11.515931 [info ] [MainThread]: 
[0m10:46:11.515931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:46:11.515931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:46:11.612839 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:46:11.612839 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:46:11.612839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:12.934890 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.311 seconds
[0m10:46:12.937982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:46:12.950868 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:46:12.950868 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:46:12.950868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:13.864485 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.921 seconds
[0m10:46:13.874691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f11575be-8353-45bc-b768-63b5410d6022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B27502570>]}
[0m10:46:13.874691 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:46:13.874691 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m10:46:13.874691 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:46:13.874691 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:46:13.891720 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:46:13.892729 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:46:13.925260 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m10:46:13.926296 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m10:46:13.927292 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select 
-- * 
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null
select distinct *
from PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null;
[0m10:46:13.927292 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:46:15.124544 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafedc-3201-7e9a-000c-493e000231e2
[0m10:46:15.124544 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 28 unexpected ';'.
[0m10:46:15.132265 [debug] [Thread-1 (]: Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 28 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m10:46:15.147966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11575be-8353-45bc-b768-63b5410d6022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B24C04800>]}
[0m10:46:15.147966 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_products .............. [[31mERROR[0m in 1.26s]
[0m10:46:15.147966 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:46:15.147966 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 28 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql.
[0m10:46:15.147966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:15.147966 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:46:15.147966 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:46:15.477530 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:46:15.477530 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:46:15.806497 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m10:46:15.806497 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m10:46:16.119169 [info ] [MainThread]: 
[0m10:46:16.119169 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m10:46:16.119169 [debug] [MainThread]: Command end result
[0m10:46:16.159304 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:46:16.161407 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:46:16.169877 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:46:16.169877 [info ] [MainThread]: 
[0m10:46:16.170882 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:46:16.171878 [info ] [MainThread]: 
[0m10:46:16.172879 [error] [MainThread]:   Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 28 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m10:46:16.172879 [info ] [MainThread]: 
[0m10:46:16.174365 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:46:16.174365 [debug] [MainThread]: Command `dbt run` failed at 10:46:16.174365 after 6.19 seconds
[0m10:46:16.174365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B25083770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B2350A9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B2350AA80>]}
[0m10:46:16.174365 [debug] [MainThread]: Flushing usage events
[0m10:46:17.122620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:46:25.038288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BBEE4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BBEE44A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BBEE44D0>]}


============================== 10:46:25.054270 | cd1c2c74-dc17-4867-a628-77aa8403fca5 ==============================
[0m10:46:25.054270 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:46:25.054270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -m stg_products', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:46:25.525221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd1c2c74-dc17-4867-a628-77aa8403fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BCABF050>]}
[0m10:46:25.604366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd1c2c74-dc17-4867-a628-77aa8403fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BBA4FA10>]}
[0m10:46:25.604366 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:46:26.093883 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:46:26.263567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:46:26.263567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:46:26.295299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd1c2c74-dc17-4867-a628-77aa8403fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BDD5D760>]}
[0m10:46:26.374341 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:46:26.390381 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:46:26.422450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd1c2c74-dc17-4867-a628-77aa8403fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BBA4EED0>]}
[0m10:46:26.425730 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:46:26.425730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd1c2c74-dc17-4867-a628-77aa8403fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BDD33D10>]}
[0m10:46:26.425730 [info ] [MainThread]: 
[0m10:46:26.425730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:46:26.425730 [info ] [MainThread]: 
[0m10:46:26.425730 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:46:26.434439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:46:26.528125 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:46:26.528125 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:46:26.528125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:27.860933 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.320 seconds
[0m10:46:27.862940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd1c2c74-dc17-4867-a628-77aa8403fca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BCC9E8D0>]}
[0m10:46:27.866680 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:46:27.866680 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:46:27.868686 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:46:27.874440 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:46:27.876443 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:46:27.876443 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:46:27.876443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:27.876443 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:46:27.876443 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:46:28.197173 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was properly closed.
[0m10:46:28.197173 [debug] [MainThread]: Command end result
[0m10:46:28.208947 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:46:28.208947 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:46:28.224732 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:46:28.224732 [info ] [MainThread]: Compiled node 'stg_products' is:
-- select 
-- * 
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null
select distinct *
from PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
[0m10:46:28.224732 [debug] [MainThread]: Command `dbt compile` succeeded at 10:46:28.224732 after 3.35 seconds
[0m10:46:28.224732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BCC155B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BB3B51C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BB3B60F0>]}
[0m10:46:28.224732 [debug] [MainThread]: Flushing usage events
[0m10:46:29.125075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:46:33.882974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FDFD04A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FDFD1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FDFD38C0>]}


============================== 10:46:33.882974 | 007d63e4-7799-4ea5-ba73-d744e10ef1aa ==============================
[0m10:46:33.882974 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:46:33.882974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:46:34.397164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '007d63e4-7799-4ea5-ba73-d744e10ef1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FDF87CE0>]}
[0m10:46:34.460469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '007d63e4-7799-4ea5-ba73-d744e10ef1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FED23080>]}
[0m10:46:34.460469 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:46:34.948581 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:46:35.114256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:46:35.114256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:46:35.162144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '007d63e4-7799-4ea5-ba73-d744e10ef1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024980048800>]}
[0m10:46:35.241757 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:46:35.241757 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:46:35.289151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '007d63e4-7799-4ea5-ba73-d744e10ef1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249802523C0>]}
[0m10:46:35.289151 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:46:35.289151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '007d63e4-7799-4ea5-ba73-d744e10ef1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FEC96E10>]}
[0m10:46:35.291159 [info ] [MainThread]: 
[0m10:46:35.293166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:46:35.297174 [info ] [MainThread]: 
[0m10:46:35.299180 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:46:35.300316 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:46:35.403690 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:46:35.403690 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:46:35.403690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:36.683621 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.291 seconds
[0m10:46:36.699444 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:46:36.699444 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:46:36.699444 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:46:36.699444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:37.647573 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.945 seconds
[0m10:46:37.647573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '007d63e4-7799-4ea5-ba73-d744e10ef1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249802CA6F0>]}
[0m10:46:37.666047 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:46:37.666047 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m10:46:37.668061 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:46:37.668061 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:46:37.675221 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:46:37.676215 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:46:37.709468 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m10:46:37.711464 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m10:46:37.711464 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select 
-- * 
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null
select distinct *
from PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
        );
[0m10:46:37.712464 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:46:39.233307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.525 seconds
[0m10:46:39.268099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '007d63e4-7799-4ea5-ba73-d744e10ef1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FB371910>]}
[0m10:46:39.269101 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_products .................. [[32mSUCCESS 1[0m in 1.60s]
[0m10:46:39.270068 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:46:39.271067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:39.272102 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:46:39.272102 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:46:39.580961 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:46:39.596607 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:46:39.901351 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m10:46:39.901351 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m10:46:40.242412 [info ] [MainThread]: 
[0m10:46:40.242412 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m10:46:40.242412 [debug] [MainThread]: Command end result
[0m10:46:40.275213 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:46:40.280261 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:46:40.287414 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:46:40.287414 [info ] [MainThread]: 
[0m10:46:40.287414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:46:40.289613 [info ] [MainThread]: 
[0m10:46:40.290618 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:46:40.292269 [debug] [MainThread]: Command `dbt run` succeeded at 10:46:40.290618 after 6.57 seconds
[0m10:46:40.292269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FDE6C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FDAD8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249FDAD85C0>]}
[0m10:46:40.292269 [debug] [MainThread]: Flushing usage events
[0m10:46:41.190392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:59.139323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775C444B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775BEF0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775C4455E0>]}


============================== 10:47:59.139323 | 78103185-7251-4ff2-bba8-4e74ffc34f54 ==============================
[0m10:47:59.139323 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:47:59.139323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_products', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:47:59.626334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78103185-7251-4ff2-bba8-4e74ffc34f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775D0C9790>]}
[0m10:47:59.675697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78103185-7251-4ff2-bba8-4e74ffc34f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775D137DD0>]}
[0m10:47:59.675697 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:48:00.157217 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:48:00.315374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:48:00.315374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:48:00.364412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78103185-7251-4ff2-bba8-4e74ffc34f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775E250710>]}
[0m10:48:00.444011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:48:00.448000 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:48:00.469924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78103185-7251-4ff2-bba8-4e74ffc34f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775E6024B0>]}
[0m10:48:00.469924 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:48:00.469924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78103185-7251-4ff2-bba8-4e74ffc34f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775E252C30>]}
[0m10:48:00.469924 [info ] [MainThread]: 
[0m10:48:00.469924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:48:00.469924 [info ] [MainThread]: 
[0m10:48:00.469924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:48:00.485709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:48:00.588257 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:48:00.589341 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:48:00.589341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:01.903456 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.327 seconds
[0m10:48:01.918499 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:48:01.918499 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:48:01.918499 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:48:01.918499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:02.863964 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.946 seconds
[0m10:48:02.879808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78103185-7251-4ff2-bba8-4e74ffc34f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775EA532C0>]}
[0m10:48:02.879808 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:48:02.879808 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m10:48:02.879808 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:48:02.879808 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:48:02.899130 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:48:02.900164 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:48:02.930723 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m10:48:02.931724 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m10:48:02.932725 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select 
-- * 
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null
select  *
from PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
        );
[0m10:48:02.932725 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:48:04.253171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.322 seconds
[0m10:48:04.269140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78103185-7251-4ff2-bba8-4e74ffc34f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027759871850>]}
[0m10:48:04.269140 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_products .................. [[32mSUCCESS 1[0m in 1.39s]
[0m10:48:04.269140 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:48:04.269140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:04.269140 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:48:04.269140 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:48:04.608984 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:48:04.608984 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:48:04.933925 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m10:48:04.933925 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m10:48:05.356183 [info ] [MainThread]: 
[0m10:48:05.356183 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m10:48:05.371851 [debug] [MainThread]: Command end result
[0m10:48:05.400998 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:48:05.403027 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:48:05.409925 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:48:05.410966 [info ] [MainThread]: 
[0m10:48:05.410966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:05.410966 [info ] [MainThread]: 
[0m10:48:05.410966 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:48:05.410966 [debug] [MainThread]: Command `dbt run` succeeded at 10:48:05.410966 after 6.43 seconds
[0m10:48:05.410966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775B9251F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002775B925760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027759903740>]}
[0m10:48:05.410966 [debug] [MainThread]: Flushing usage events
[0m10:48:06.277350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:13.237928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E2F74D8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E302A57C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E320B4470>]}


============================== 10:52:13.237928 | 6b6bdec9-6925-4732-8ad8-89359bb7c649 ==============================
[0m10:52:13.237928 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:52:13.237928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile -m stg_products', 'send_anonymous_usage_stats': 'True'}
[0m10:52:13.722595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b6bdec9-6925-4732-8ad8-89359bb7c649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E32BB75F0>]}
[0m10:52:13.786501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b6bdec9-6925-4732-8ad8-89359bb7c649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E32991DF0>]}
[0m10:52:13.786501 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:52:14.271404 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:52:14.446395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:14.446959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:14.489399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b6bdec9-6925-4732-8ad8-89359bb7c649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E33B47C80>]}
[0m10:52:14.567914 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:52:14.567914 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:52:14.599420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b6bdec9-6925-4732-8ad8-89359bb7c649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E34C84CB0>]}
[0m10:52:14.599420 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:52:14.599420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b6bdec9-6925-4732-8ad8-89359bb7c649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E33B47F80>]}
[0m10:52:14.609807 [info ] [MainThread]: 
[0m10:52:14.609807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:52:14.609807 [info ] [MainThread]: 
[0m10:52:14.609807 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:52:14.616769 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:52:14.708879 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:52:14.708879 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:52:14.708879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:16.052438 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.329 seconds
[0m10:52:16.056435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b6bdec9-6925-4732-8ad8-89359bb7c649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E30123740>]}
[0m10:52:16.058959 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:52:16.058959 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:52:16.058959 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:52:16.065142 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:52:16.065142 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:52:16.074170 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:52:16.074170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:16.074170 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:52:16.074170 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:52:16.409406 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was properly closed.
[0m10:52:16.409406 [debug] [MainThread]: Command end result
[0m10:52:16.425270 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:52:16.425270 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:52:16.441043 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:52:16.441043 [info ] [MainThread]: Compiled node 'stg_products' is:
-- select 
-- * 
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null

SELECT DISTINCT product_id, distinct product_name, DISTINCT sub_product
FROM PRODUCTS_DATA
WHERE product_id IS NOT NULL;
[0m10:52:16.441043 [debug] [MainThread]: Command `dbt compile` succeeded at 10:52:16.441043 after 3.38 seconds
[0m10:52:16.441043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E32BB7F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E30A8E330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E30A8E360>]}
[0m10:52:16.441043 [debug] [MainThread]: Flushing usage events
[0m10:52:17.646027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:23.171522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029290534110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029290534680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292905353D0>]}


============================== 10:52:23.171522 | 7680d714-69d9-4928-9b6a-a069fd1dac59 ==============================
[0m10:52:23.171522 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:52:23.171522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:52:23.657479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7680d714-69d9-4928-9b6a-a069fd1dac59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029291260650>]}
[0m10:52:23.722574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7680d714-69d9-4928-9b6a-a069fd1dac59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928FA9A150>]}
[0m10:52:23.722574 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:52:24.190576 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:52:24.349264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:24.349264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:24.397068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7680d714-69d9-4928-9b6a-a069fd1dac59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292922E2F00>]}
[0m10:52:24.476395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:52:24.476395 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:52:24.508421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7680d714-69d9-4928-9b6a-a069fd1dac59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292926D1F10>]}
[0m10:52:24.508421 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:52:24.508421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7680d714-69d9-4928-9b6a-a069fd1dac59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292926C0260>]}
[0m10:52:24.508421 [info ] [MainThread]: 
[0m10:52:24.508421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:52:24.508421 [info ] [MainThread]: 
[0m10:52:24.508421 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:52:24.508421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:52:24.622919 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:52:24.622919 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:52:24.622919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:25.721980 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.099 seconds
[0m10:52:25.724522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:52:25.730014 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:52:25.730014 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:52:25.730014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:26.683899 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.945 seconds
[0m10:52:26.683899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7680d714-69d9-4928-9b6a-a069fd1dac59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928FF12570>]}
[0m10:52:26.683899 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:52:26.683899 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m10:52:26.683899 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:52:26.683899 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:52:26.700433 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:52:26.702425 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:52:26.725418 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m10:52:26.725418 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m10:52:26.725418 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select 
-- * 
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null

SELECT DISTINCT product_id, distinct product_name, DISTINCT sub_product
FROM PRODUCTS_DATA
WHERE product_id IS NOT NULL;
[0m10:52:26.735466 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:52:27.599005 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafee2-3201-7e57-000c-493e0001ed62
[0m10:52:27.599005 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 28 unexpected 'distinct'.
syntax error line 10 at position 28 unexpected ';'.
[0m10:52:27.616636 [debug] [Thread-1 (]: Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 28 unexpected 'distinct'.
  syntax error line 10 at position 28 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m10:52:27.618641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7680d714-69d9-4928-9b6a-a069fd1dac59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029292CA8B00>]}
[0m10:52:27.620646 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_products .............. [[31mERROR[0m in 0.93s]
[0m10:52:27.620646 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:52:27.620646 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 28 unexpected 'distinct'.
  syntax error line 10 at position 28 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql.
[0m10:52:27.620646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:27.620646 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:52:27.620646 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:52:27.961141 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:52:27.961141 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:52:28.285728 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m10:52:28.301526 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m10:52:28.850439 [info ] [MainThread]: 
[0m10:52:28.850439 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m10:52:28.850439 [debug] [MainThread]: Command end result
[0m10:52:28.872914 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:52:28.888158 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:52:28.894959 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:52:28.894959 [info ] [MainThread]: 
[0m10:52:28.894959 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:52:28.894959 [info ] [MainThread]: 
[0m10:52:28.894959 [error] [MainThread]:   Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 28 unexpected 'distinct'.
  syntax error line 10 at position 28 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m10:52:28.894959 [info ] [MainThread]: 
[0m10:52:28.894959 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:52:28.894959 [debug] [MainThread]: Command `dbt run` failed at 10:52:28.894959 after 5.88 seconds
[0m10:52:28.894959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928FA04F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002928FA055B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029290534440>]}
[0m10:52:28.894959 [debug] [MainThread]: Flushing usage events
[0m10:52:29.784670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:39.932905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E2039C0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E200AA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E2039CA10>]}


============================== 10:52:39.948736 | f7ee5e18-c7da-4e4b-86e2-d91a88dfe80d ==============================
[0m10:52:39.948736 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:52:39.948736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_products', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:52:40.450665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7ee5e18-c7da-4e4b-86e2-d91a88dfe80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E2039EBD0>]}
[0m10:52:40.511525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7ee5e18-c7da-4e4b-86e2-d91a88dfe80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E20D1F980>]}
[0m10:52:40.513530 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:52:40.998529 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:52:41.168843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:41.168843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:41.213724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7ee5e18-c7da-4e4b-86e2-d91a88dfe80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E211AC3B0>]}
[0m10:52:41.299497 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:52:41.299497 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:52:41.327726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7ee5e18-c7da-4e4b-86e2-d91a88dfe80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E22501E20>]}
[0m10:52:41.334938 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:52:41.334938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ee5e18-c7da-4e4b-86e2-d91a88dfe80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E2111BFB0>]}
[0m10:52:41.334938 [info ] [MainThread]: 
[0m10:52:41.337107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:52:41.337107 [info ] [MainThread]: 
[0m10:52:41.337107 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:52:41.337107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:52:41.433781 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:52:41.433781 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:52:41.433781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:42.744181 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.302 seconds
[0m10:52:42.746861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:52:42.758296 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:52:42.759802 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:52:42.759802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:43.684803 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.927 seconds
[0m10:52:43.684803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ee5e18-c7da-4e4b-86e2-d91a88dfe80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E211CF770>]}
[0m10:52:43.684803 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:52:43.684803 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m10:52:43.684803 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:52:43.684803 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:52:43.703220 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:52:43.704360 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:52:43.720440 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m10:52:43.736507 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m10:52:43.737547 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select 
-- * 
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null

SELECT DISTINCT product_id, distinct product_name, DISTINCT sub_product
FROM PRODUCTS_DATA
WHERE product_id IS NOT NULL
        );
[0m10:52:43.737547 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:52:44.610207 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafee2-3201-7db6-000c-493e00019de2
[0m10:52:44.610207 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 28 unexpected 'distinct'.
[0m10:52:44.610207 [debug] [Thread-1 (]: Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 28 unexpected 'distinct'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m10:52:44.625861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7ee5e18-c7da-4e4b-86e2-d91a88dfe80d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E22AF3AA0>]}
[0m10:52:44.625861 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_products .............. [[31mERROR[0m in 0.93s]
[0m10:52:44.625861 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:52:44.625861 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 28 unexpected 'distinct'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql.
[0m10:52:44.629421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:44.629421 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:52:44.629421 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:52:44.952642 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:52:44.952642 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:52:45.269352 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m10:52:45.269352 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m10:52:45.596843 [info ] [MainThread]: 
[0m10:52:45.596843 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m10:52:45.596843 [debug] [MainThread]: Command end result
[0m10:52:45.629569 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:52:45.629569 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:52:45.640449 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:52:45.640449 [info ] [MainThread]: 
[0m10:52:45.641452 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:52:45.642450 [info ] [MainThread]: 
[0m10:52:45.643448 [error] [MainThread]:   Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 28 unexpected 'distinct'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m10:52:45.644452 [info ] [MainThread]: 
[0m10:52:45.644904 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:52:45.646931 [debug] [MainThread]: Command `dbt run` failed at 10:52:45.646931 after 5.91 seconds
[0m10:52:45.648218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E1F3AA6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E1F802AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E200AA570>]}
[0m10:52:45.648218 [debug] [MainThread]: Flushing usage events
[0m10:52:46.522478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:35.864382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789B334B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789B334AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789B334890>]}


============================== 10:53:35.880253 | 996b7bce-a02e-44a9-bd8f-48788e5084f7 ==============================
[0m10:53:35.880253 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:53:35.880253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile -m stg_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:53:36.360964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '996b7bce-a02e-44a9-bd8f-48788e5084f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789BDB8410>]}
[0m10:53:36.419862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '996b7bce-a02e-44a9-bd8f-48788e5084f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789B003710>]}
[0m10:53:36.419862 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:53:36.885435 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:53:37.043988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:53:37.043988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:53:37.096520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '996b7bce-a02e-44a9-bd8f-48788e5084f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789B3362D0>]}
[0m10:53:37.170664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:53:37.170664 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:53:37.202445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '996b7bce-a02e-44a9-bd8f-48788e5084f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789D4F5610>]}
[0m10:53:37.202445 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:53:37.213736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '996b7bce-a02e-44a9-bd8f-48788e5084f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789D18FFB0>]}
[0m10:53:37.213736 [info ] [MainThread]: 
[0m10:53:37.213736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:53:37.213736 [info ] [MainThread]: 
[0m10:53:37.213736 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:53:37.220186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:53:37.329206 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:53:37.330205 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:53:37.330205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:38.643317 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.324 seconds
[0m10:53:38.643317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '996b7bce-a02e-44a9-bd8f-48788e5084f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789D18F350>]}
[0m10:53:38.659170 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:53:38.659170 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:53:38.659170 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:53:38.659170 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:53:38.659170 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:53:38.659170 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:53:38.659170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:38.659170 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:53:38.659170 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:53:39.021465 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was properly closed.
[0m10:53:39.021465 [debug] [MainThread]: Command end result
[0m10:53:39.053405 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:53:39.053405 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:53:39.053405 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:53:39.053405 [info ] [MainThread]: Compiled node 'stg_products' is:
-- select 
-- * 
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null

SELECT DISTINCT product_id, distinct product_name, DISTINCT sub_product
FROM PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
[0m10:53:39.069494 [debug] [MainThread]: Command `dbt compile` succeeded at 10:53:39.069494 after 3.35 seconds
[0m10:53:39.069494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789AA97BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789D4003B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789AF08920>]}
[0m10:53:39.069494 [debug] [MainThread]: Flushing usage events
[0m10:53:40.542517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:45.909514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157346C0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157346C1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157346C0BC0>]}


============================== 10:53:45.909514 | 681e8520-d7db-434f-b298-cd835cc40ce7 ==============================
[0m10:53:45.909514 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:53:45.909514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_products', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:53:46.395861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '681e8520-d7db-434f-b298-cd835cc40ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157353A3F80>]}
[0m10:53:46.443942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '681e8520-d7db-434f-b298-cd835cc40ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001573648C410>]}
[0m10:53:46.443942 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:53:46.929799 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:53:47.087960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:53:47.087960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:53:47.136170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '681e8520-d7db-434f-b298-cd835cc40ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015733C41D30>]}
[0m10:53:47.222176 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:53:47.222176 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:53:47.247187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '681e8520-d7db-434f-b298-cd835cc40ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015736842330>]}
[0m10:53:47.247187 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:53:47.247187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '681e8520-d7db-434f-b298-cd835cc40ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157364DBD10>]}
[0m10:53:47.247187 [info ] [MainThread]: 
[0m10:53:47.247187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:53:47.247187 [info ] [MainThread]: 
[0m10:53:47.247187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:53:47.263050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:53:47.367102 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:53:47.367102 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:53:47.367102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:48.467833 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.101 seconds
[0m10:53:48.483702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:53:48.483702 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:53:48.483702 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:53:48.483702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:49.435108 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.951 seconds
[0m10:53:49.447093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '681e8520-d7db-434f-b298-cd835cc40ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157368301A0>]}
[0m10:53:49.452814 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:53:49.452814 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m10:53:49.452814 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:53:49.452814 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:53:49.460831 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:53:49.462836 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:53:49.493646 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m10:53:49.495650 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m10:53:49.495650 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select 
-- * 
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null

SELECT DISTINCT product_id, distinct product_name, DISTINCT sub_product
FROM PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
        );
[0m10:53:49.495650 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:53:50.431616 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafee3-3201-7e9a-000c-493e00023202
[0m10:53:50.431616 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 28 unexpected 'distinct'.
[0m10:53:50.431616 [debug] [Thread-1 (]: Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 28 unexpected 'distinct'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m10:53:50.431616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '681e8520-d7db-434f-b298-cd835cc40ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015736E0A900>]}
[0m10:53:50.431616 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_products .............. [[31mERROR[0m in 0.98s]
[0m10:53:50.431616 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:53:50.431616 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 28 unexpected 'distinct'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql.
[0m10:53:50.431616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:50.431616 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:53:50.431616 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:53:50.745768 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:53:50.759512 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:53:51.092061 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m10:53:51.092370 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m10:53:51.421152 [info ] [MainThread]: 
[0m10:53:51.421152 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m10:53:51.421152 [debug] [MainThread]: Command end result
[0m10:53:51.450793 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:53:51.456015 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:53:51.460295 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:53:51.460295 [info ] [MainThread]: 
[0m10:53:51.460295 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:53:51.460295 [info ] [MainThread]: 
[0m10:53:51.460295 [error] [MainThread]:   Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 28 unexpected 'distinct'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m10:53:51.460295 [info ] [MainThread]: 
[0m10:53:51.460295 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:53:51.460295 [debug] [MainThread]: Command `dbt run` failed at 10:53:51.460295 after 5.72 seconds
[0m10:53:51.460295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015733BC0B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015733BC31A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157341CB230>]}
[0m10:53:51.460295 [debug] [MainThread]: Flushing usage events
[0m10:53:52.360471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:55:19.851092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002336D0F1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002336DAC2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002336F959B80>]}


============================== 10:55:19.856124 | d3e3e2fe-71f7-45a8-9175-da516cdb4dfb ==============================
[0m10:55:19.856124 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:55:19.856911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_products', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:55:20.362576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3e3e2fe-71f7-45a8-9175-da516cdb4dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002336FE4DB20>]}
[0m10:55:20.441966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3e3e2fe-71f7-45a8-9175-da516cdb4dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023370B04560>]}
[0m10:55:20.443602 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:55:20.937976 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:55:21.144234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:55:21.144234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:55:21.194101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3e3e2fe-71f7-45a8-9175-da516cdb4dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023371C6C530>]}
[0m10:55:21.283759 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:55:21.294253 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:55:21.327886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3e3e2fe-71f7-45a8-9175-da516cdb4dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023371FD6090>]}
[0m10:55:21.327886 [info ] [MainThread]: Found 4 models, 4 data tests, 4 sources, 474 macros
[0m10:55:21.327886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3e3e2fe-71f7-45a8-9175-da516cdb4dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023371BBBD10>]}
[0m10:55:21.327886 [info ] [MainThread]: 
[0m10:55:21.327886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:55:21.327886 [info ] [MainThread]: 
[0m10:55:21.327886 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:55:21.327886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:55:21.442782 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:55:21.443751 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:55:21.443751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:22.845835 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.402 seconds
[0m10:55:22.854598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:55:22.865025 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:55:22.865025 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:55:22.866190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:23.788978 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.930 seconds
[0m10:55:23.788978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3e3e2fe-71f7-45a8-9175-da516cdb4dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023371BB9B50>]}
[0m10:55:23.788978 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m10:55:23.803720 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m10:55:23.804176 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m10:55:23.804176 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m10:55:23.812693 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m10:55:23.813734 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m10:55:23.846429 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m10:55:23.846429 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m10:55:23.846429 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select 
-- * 
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null

SELECT *
FROM PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
        );
[0m10:55:23.846429 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:55:25.163934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.316 seconds
[0m10:55:25.179893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3e3e2fe-71f7-45a8-9175-da516cdb4dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002336F2F4740>]}
[0m10:55:25.179893 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_products .................. [[32mSUCCESS 1[0m in 1.38s]
[0m10:55:25.191957 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m10:55:25.191957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:25.191957 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:55:25.191957 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:55:25.515167 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:55:25.515167 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:55:25.898538 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m10:55:25.898538 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m10:55:26.229543 [info ] [MainThread]: 
[0m10:55:26.230543 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m10:55:26.231541 [debug] [MainThread]: Command end result
[0m10:55:26.260970 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:55:26.262970 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:55:26.271971 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:55:26.271971 [info ] [MainThread]: 
[0m10:55:26.274032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:55:26.274032 [info ] [MainThread]: 
[0m10:55:26.274969 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:55:26.275967 [debug] [MainThread]: Command `dbt run` succeeded at 10:55:26.275967 after 6.66 seconds
[0m10:55:26.275967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002336FD1B5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002336D3097C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002336C7E97C0>]}
[0m10:55:26.276969 [debug] [MainThread]: Flushing usage events
[0m10:55:27.505437 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:56:49.676761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAD6CD310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAD0C9CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAD2A3920>]}


============================== 10:56:49.692561 | 039e603c-fbf3-4473-ab24-b114691b8692 ==============================
[0m10:56:49.692561 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:56:49.692561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile -m stg_transactions.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:56:50.603724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '039e603c-fbf3-4473-ab24-b114691b8692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAE7E9850>]}
[0m10:56:50.667438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '039e603c-fbf3-4473-ab24-b114691b8692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAE8FEFC0>]}
[0m10:56:50.667438 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:56:51.261920 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:56:51.433401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:56:51.433401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:56:51.482778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '039e603c-fbf3-4473-ab24-b114691b8692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAF96D070>]}
[0m10:56:51.566339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:56:51.578944 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:56:51.607877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '039e603c-fbf3-4473-ab24-b114691b8692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAFCE7E60>]}
[0m10:56:51.607877 [info ] [MainThread]: Found 5 models, 4 data tests, 4 sources, 474 macros
[0m10:56:51.607877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '039e603c-fbf3-4473-ab24-b114691b8692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAFC38740>]}
[0m10:56:51.607877 [info ] [MainThread]: 
[0m10:56:51.607877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:56:51.607877 [info ] [MainThread]: 
[0m10:56:51.607877 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:56:51.607877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:56:54.808836 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:56:54.808836 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:56:54.808836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:56.165034 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.355 seconds
[0m10:56:56.165034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '039e603c-fbf3-4473-ab24-b114691b8692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAFB64860>]}
[0m10:56:56.181770 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_transactions
[0m10:56:56.181770 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_transactions'
[0m10:56:56.185609 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_transactions
[0m10:56:56.193902 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_transactions"
[0m10:56:56.199900 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_transactions
[0m10:56:56.200903 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_transactions
[0m10:56:56.202903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:56.202903 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:56:56.202903 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:56:56.523821 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_transactions' was properly closed.
[0m10:56:56.523821 [debug] [MainThread]: Command end result
[0m10:56:56.539837 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:56:56.555486 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:56:56.555486 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:56:56.555486 [info ] [MainThread]: Compiled node 'stg_transactions' is:
select 
* 
from PROJECT_DB.STAGE.TRANSACTIONS_DATA
where customer_id is not null
[0m10:56:56.555486 [debug] [MainThread]: Command `dbt compile` succeeded at 10:56:56.555486 after 7.04 seconds
[0m10:56:56.555486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DADA2F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAA521D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DAA523140>]}
[0m10:56:56.555486 [debug] [MainThread]: Flushing usage events
[0m10:56:57.430797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:57:08.694961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D07F690CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D07F6901D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D07F690140>]}


============================== 10:57:08.694961 | 97bb1883-6a59-4acd-89c9-a9dd023efe6a ==============================
[0m10:57:08.694961 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:57:08.694961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_transactions.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:57:09.202672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97bb1883-6a59-4acd-89c9-a9dd023efe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0002FDF70>]}
[0m10:57:09.260076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97bb1883-6a59-4acd-89c9-a9dd023efe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0004837A0>]}
[0m10:57:09.260076 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:57:09.767252 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:57:09.930211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:09.930211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:09.977406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97bb1883-6a59-4acd-89c9-a9dd023efe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0015B7200>]}
[0m10:57:10.056212 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:57:10.056212 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:57:10.087889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97bb1883-6a59-4acd-89c9-a9dd023efe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0019226F0>]}
[0m10:57:10.087889 [info ] [MainThread]: Found 5 models, 4 data tests, 4 sources, 474 macros
[0m10:57:10.087889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97bb1883-6a59-4acd-89c9-a9dd023efe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0018116A0>]}
[0m10:57:10.087889 [info ] [MainThread]: 
[0m10:57:10.087889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:10.087889 [info ] [MainThread]: 
[0m10:57:10.103866 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:57:10.103866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m10:57:10.202457 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m10:57:10.202457 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m10:57:10.202457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:11.522610 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.315 seconds
[0m10:57:11.532079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m10:57:11.532079 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m10:57:11.532079 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m10:57:11.532079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:12.536010 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.003 seconds
[0m10:57:12.552129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97bb1883-6a59-4acd-89c9-a9dd023efe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D001B90170>]}
[0m10:57:12.554715 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_transactions
[0m10:57:12.554715 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_transactions ................... [RUN]
[0m10:57:12.554715 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_transactions'
[0m10:57:12.554715 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_transactions
[0m10:57:12.554715 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_transactions"
[0m10:57:12.567880 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_transactions
[0m10:57:12.588144 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_transactions"
[0m10:57:12.588144 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_transactions"
[0m10:57:12.588144 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_transactions"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_transactions
         as
        (select 
* 
from PROJECT_DB.STAGE.TRANSACTIONS_DATA
where customer_id is not null
        );
[0m10:57:12.588144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:57:14.267942 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.672 seconds
[0m10:57:14.283931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97bb1883-6a59-4acd-89c9-a9dd023efe6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D07CA31A60>]}
[0m10:57:14.283931 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_transactions .............. [[32mSUCCESS 1[0m in 1.73s]
[0m10:57:14.283931 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_transactions
[0m10:57:14.283931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:14.283931 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m10:57:14.283931 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m10:57:14.622035 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m10:57:14.622035 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m10:57:14.955221 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_transactions' was left open.
[0m10:57:14.955221 [debug] [MainThread]: On model.CRB_PROJECT.stg_transactions: Close
[0m10:57:15.282999 [info ] [MainThread]: 
[0m10:57:15.282999 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m10:57:15.282999 [debug] [MainThread]: Command end result
[0m10:57:15.318064 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m10:57:15.321248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m10:57:15.328265 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m10:57:15.329271 [info ] [MainThread]: 
[0m10:57:15.329656 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:15.329656 [info ] [MainThread]: 
[0m10:57:15.329656 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:57:15.329656 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:15.329656 after 6.79 seconds
[0m10:57:15.329656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D07EAE1EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D07F13EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D001908E30>]}
[0m10:57:15.329656 [debug] [MainThread]: Flushing usage events
[0m10:57:16.318575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:59:43.098457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B99171FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B99171D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98FD9D7C0>]}


============================== 10:59:43.098457 | 92735106-aee0-40b4-9a60-cae719bad9eb ==============================
[0m10:59:43.098457 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:59:43.098457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile -m stg_locations.sql', 'send_anonymous_usage_stats': 'True'}
[0m10:59:43.587058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92735106-aee0-40b4-9a60-cae719bad9eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B993171250>]}
[0m10:59:43.648669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92735106-aee0-40b4-9a60-cae719bad9eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98FE67860>]}
[0m10:59:43.648669 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:59:44.120752 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:59:44.287790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:59:44.287790 [debug] [MainThread]: Partial parsing: added file: CRB_PROJECT://models\stage\stg_locations.sql
[0m10:59:44.477332 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.CRB_PROJECT.stg_locations' (models\stage\stg_locations.sql) depends on a source named 'crb_data.LOCATIONS_DATA' which was not found
[0m10:59:44.477332 [debug] [MainThread]: Command `dbt compile` failed at 10:59:44.477332 after 1.54 seconds
[0m10:59:44.477332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B992727E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9933ED970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9946D9880>]}
[0m10:59:44.477332 [debug] [MainThread]: Flushing usage events
[0m10:59:45.782174 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:08.448857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF89A1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCFB0C8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCF949FC80>]}


============================== 11:00:08.453883 | c17e2886-a93c-434c-a949-d51dcbf82741 ==============================
[0m11:00:08.453883 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:00:08.453883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile -m stg_locations.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:00:08.939925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c17e2886-a93c-434c-a949-d51dcbf82741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCFB746E40>]}
[0m11:00:09.003243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c17e2886-a93c-434c-a949-d51dcbf82741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCFC34EAB0>]}
[0m11:00:09.003243 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:00:09.476081 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:00:09.658051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:09.658051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:09.691556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c17e2886-a93c-434c-a949-d51dcbf82741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCFD4C3A70>]}
[0m11:00:09.770371 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:00:09.786337 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:00:09.802186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c17e2886-a93c-434c-a949-d51dcbf82741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCFD6ABDA0>]}
[0m11:00:09.818147 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 474 macros
[0m11:00:09.818147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c17e2886-a93c-434c-a949-d51dcbf82741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCFD6F39B0>]}
[0m11:00:09.820576 [info ] [MainThread]: 
[0m11:00:09.820576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:09.820576 [info ] [MainThread]: 
[0m11:00:09.822582 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:00:09.826589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:00:09.931239 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:00:09.931239 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:00:09.931239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:11.326938 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.394 seconds
[0m11:00:11.326938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c17e2886-a93c-434c-a949-d51dcbf82741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCFC271340>]}
[0m11:00:11.326938 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_locations
[0m11:00:11.326938 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_locations'
[0m11:00:11.326938 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_locations
[0m11:00:11.342716 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_locations"
[0m11:00:11.342716 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_locations
[0m11:00:11.342716 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_locations
[0m11:00:11.342716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:11.342716 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:00:11.342716 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:00:11.664516 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_locations' was properly closed.
[0m11:00:11.664516 [debug] [MainThread]: Command end result
[0m11:00:11.696880 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:00:11.700149 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:00:11.706176 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:00:11.707144 [info ] [MainThread]: Compiled node 'stg_locations' is:
select 
* 
from PROJECT_DB.STAGE.LOCATIONS_DATA
where customer_id is not null
[0m11:00:11.708004 [debug] [MainThread]: Command `dbt compile` succeeded at 11:00:11.708004 after 3.42 seconds
[0m11:00:11.709042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCFDD2AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCFB181AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DCFB181640>]}
[0m11:00:11.709042 [debug] [MainThread]: Flushing usage events
[0m11:00:12.570104 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:38.461557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AC0F98C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ABE8759A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ABEC01DC0>]}


============================== 11:00:38.461557 | cccfad7f-80f1-42d0-a4ad-25013b800bb0 ==============================
[0m11:00:38.461557 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:00:38.461557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_locations.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:00:38.948292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cccfad7f-80f1-42d0-a4ad-25013b800bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AC1652CF0>]}
[0m11:00:39.011563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cccfad7f-80f1-42d0-a4ad-25013b800bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AC1E8AE70>]}
[0m11:00:39.011563 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:00:39.496918 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:00:39.669057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:39.669057 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:39.706967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cccfad7f-80f1-42d0-a4ad-25013b800bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AC343F4A0>]}
[0m11:00:39.794870 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:00:39.797870 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:00:39.826294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cccfad7f-80f1-42d0-a4ad-25013b800bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AC37A6870>]}
[0m11:00:39.826294 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 474 macros
[0m11:00:39.826294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cccfad7f-80f1-42d0-a4ad-25013b800bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AC36BD460>]}
[0m11:00:39.826294 [info ] [MainThread]: 
[0m11:00:39.826294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:39.826294 [info ] [MainThread]: 
[0m11:00:39.826294 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:00:39.826294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:00:39.944342 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:00:39.944342 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:00:39.944342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:41.457385 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.507 seconds
[0m11:00:41.475575 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:00:41.491677 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:00:41.491677 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:00:41.492676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:42.493441 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.000 seconds
[0m11:00:42.496352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cccfad7f-80f1-42d0-a4ad-25013b800bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AC33B3290>]}
[0m11:00:42.500542 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_locations
[0m11:00:42.501571 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_locations ...................... [RUN]
[0m11:00:42.502542 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_locations'
[0m11:00:42.502542 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_locations
[0m11:00:42.510368 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_locations"
[0m11:00:42.511336 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_locations
[0m11:00:42.531955 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_locations"
[0m11:00:42.531955 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_locations"
[0m11:00:42.531955 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_locations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_locations"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_locations
         as
        (select 
* 
from PROJECT_DB.STAGE.LOCATIONS_DATA
where customer_id is not null
        );
[0m11:00:42.531955 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:00:44.074924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.529 seconds
[0m11:00:44.082410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cccfad7f-80f1-42d0-a4ad-25013b800bb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ABE9719D0>]}
[0m11:00:44.098340 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_locations ................. [[32mSUCCESS 1[0m in 1.58s]
[0m11:00:44.098340 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_locations
[0m11:00:44.098340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:44.098340 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:00:44.098340 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:00:44.432600 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:00:44.432600 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:00:44.782080 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_locations' was left open.
[0m11:00:44.782080 [debug] [MainThread]: On model.CRB_PROJECT.stg_locations: Close
[0m11:00:45.131339 [info ] [MainThread]: 
[0m11:00:45.132350 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m11:00:45.133494 [debug] [MainThread]: Command end result
[0m11:00:45.159957 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:00:45.159957 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:00:45.166316 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:00:45.166316 [info ] [MainThread]: 
[0m11:00:45.166316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:45.166316 [info ] [MainThread]: 
[0m11:00:45.166316 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:00:45.166316 [debug] [MainThread]: Command `dbt run` succeeded at 11:00:45.166316 after 6.87 seconds
[0m11:00:45.166316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AC149B5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AC110F350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AC110F9E0>]}
[0m11:00:45.166316 [debug] [MainThread]: Flushing usage events
[0m11:00:46.108867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:03:11.629756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52ABBA0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52B0DFE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52B0DCF50>]}


============================== 11:03:11.644049 | 92d075bb-9205-4079-8683-4aa1d0175f85 ==============================
[0m11:03:11.644049 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:03:11.644049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -m stg_products', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:03:12.130538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92d075bb-9205-4079-8683-4aa1d0175f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52B0B6480>]}
[0m11:03:12.177438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92d075bb-9205-4079-8683-4aa1d0175f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5284A2BA0>]}
[0m11:03:12.193138 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:03:12.659047 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:03:12.831579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:03:12.831579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:03:12.870207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92d075bb-9205-4079-8683-4aa1d0175f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52CF46CF0>]}
[0m11:03:12.949466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:03:12.949466 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:03:12.986566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92d075bb-9205-4079-8683-4aa1d0175f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52D2ACCB0>]}
[0m11:03:12.986566 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 474 macros
[0m11:03:12.986566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d075bb-9205-4079-8683-4aa1d0175f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52D12F9E0>]}
[0m11:03:12.986566 [info ] [MainThread]: 
[0m11:03:12.991622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:12.991622 [info ] [MainThread]: 
[0m11:03:12.991622 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:03:12.998059 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:03:13.095985 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:03:13.095985 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:03:13.095985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:14.451565 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.348 seconds
[0m11:03:14.453573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92d075bb-9205-4079-8683-4aa1d0175f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F528533830>]}
[0m11:03:14.458716 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m11:03:14.458716 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m11:03:14.458716 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m11:03:14.458716 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m11:03:14.458716 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m11:03:14.458716 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m11:03:14.458716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:14.458716 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:03:14.458716 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:03:14.806251 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was properly closed.
[0m11:03:14.809256 [debug] [MainThread]: Command end result
[0m11:03:14.830274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:03:14.837907 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:03:14.837907 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:03:14.846370 [info ] [MainThread]: Compiled node 'stg_products' is:
select
    product_id,
    product_family,
    distinct product_sub_family
from PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
[0m11:03:14.846370 [debug] [MainThread]: Command `dbt compile` succeeded at 11:03:14.846370 after 3.37 seconds
[0m11:03:14.846370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F528DA6EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F528E8E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F52A576BD0>]}
[0m11:03:14.846370 [debug] [MainThread]: Flushing usage events
[0m11:03:15.721155 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:03:25.286130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CDB4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901A5710A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CDB4F50>]}


============================== 11:03:25.286130 | a1185371-f234-4140-a3c4-a3417de38115 ==============================
[0m11:03:25.286130 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:03:25.286130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:03:25.773336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1185371-f234-4140-a3c4-a3417de38115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901DA19730>]}
[0m11:03:25.821349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1185371-f234-4140-a3c4-a3417de38115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901DB110A0>]}
[0m11:03:25.837310 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:03:26.291533 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:03:26.471369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:03:26.471369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:03:26.508342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1185371-f234-4140-a3c4-a3417de38115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901EBEB440>]}
[0m11:03:26.587788 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:03:26.587788 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:03:26.619370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1185371-f234-4140-a3c4-a3417de38115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901EF52930>]}
[0m11:03:26.619370 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 474 macros
[0m11:03:26.619370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1185371-f234-4140-a3c4-a3417de38115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901EBEBD10>]}
[0m11:03:26.619370 [info ] [MainThread]: 
[0m11:03:26.619370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:26.619370 [info ] [MainThread]: 
[0m11:03:26.619370 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:03:26.635210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:03:26.727185 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:03:26.727185 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:03:26.727185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:27.811929 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.070 seconds
[0m11:03:27.817390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:03:27.817390 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:03:27.817390 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:03:27.817390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:29.027255 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.212 seconds
[0m11:03:29.040153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1185371-f234-4140-a3c4-a3417de38115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901EBEBA10>]}
[0m11:03:29.043011 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m11:03:29.043011 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m11:03:29.043011 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m11:03:29.043011 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m11:03:29.056265 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m11:03:29.056265 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m11:03:29.089532 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m11:03:29.091537 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m11:03:29.091537 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (select
    product_id,
    product_family,
    distinct product_sub_family
from PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
        );
[0m11:03:29.091537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:03:30.196744 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeed-3201-7d7b-000c-493e0002222e
[0m11:03:30.196744 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 4 unexpected 'distinct'.
[0m11:03:30.220152 [debug] [Thread-1 (]: Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 4 unexpected 'distinct'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m11:03:30.222159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1185371-f234-4140-a3c4-a3417de38115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901F30B470>]}
[0m11:03:30.222159 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_products .............. [[31mERROR[0m in 1.18s]
[0m11:03:30.222159 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m11:03:30.222159 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 4 unexpected 'distinct'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql.
[0m11:03:30.222159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:30.222159 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:03:30.222159 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:03:30.544654 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:03:30.544654 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:03:30.880917 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m11:03:30.880917 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m11:03:31.218283 [info ] [MainThread]: 
[0m11:03:31.218283 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m11:03:31.218283 [debug] [MainThread]: Command end result
[0m11:03:31.243361 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:03:31.245360 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:03:31.252560 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:03:31.252560 [info ] [MainThread]: 
[0m11:03:31.253563 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:03:31.253563 [info ] [MainThread]: 
[0m11:03:31.253563 [error] [MainThread]:   Database Error in model stg_products (models\stage\stg_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 4 unexpected 'distinct'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m11:03:31.253563 [info ] [MainThread]: 
[0m11:03:31.253563 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:03:31.253563 [debug] [MainThread]: Command `dbt run` failed at 11:03:31.253563 after 6.12 seconds
[0m11:03:31.253563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CDDFFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CDB43B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CDB4680>]}
[0m11:03:31.253563 [debug] [MainThread]: Flushing usage events
[0m11:03:32.158678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:04:04.115307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014326CC0AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143269CA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014326CC0650>]}


============================== 11:04:04.115307 | 46ad1ea7-b6f0-40ea-80f9-d5bb06ef3bf4 ==============================
[0m11:04:04.115307 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:04:04.115307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile -m stg_products', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:04:04.585656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46ad1ea7-b6f0-40ea-80f9-d5bb06ef3bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014327A222D0>]}
[0m11:04:04.648724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46ad1ea7-b6f0-40ea-80f9-d5bb06ef3bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143279CB920>]}
[0m11:04:04.648724 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:04:05.133800 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:04:05.298133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:04:05.298133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:04:05.339471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46ad1ea7-b6f0-40ea-80f9-d5bb06ef3bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014328AFB440>]}
[0m11:04:05.415190 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:04:05.415190 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:04:05.446246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46ad1ea7-b6f0-40ea-80f9-d5bb06ef3bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014328D50AD0>]}
[0m11:04:05.454457 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 474 macros
[0m11:04:05.454457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46ad1ea7-b6f0-40ea-80f9-d5bb06ef3bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014328AFB980>]}
[0m11:04:05.454457 [info ] [MainThread]: 
[0m11:04:05.454457 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:04:05.454457 [info ] [MainThread]: 
[0m11:04:05.454457 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:04:05.462892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:04:05.565878 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:04:05.565878 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:04:05.565878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:07.000146 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.433 seconds
[0m11:04:07.000146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46ad1ea7-b6f0-40ea-80f9-d5bb06ef3bf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143279CA8A0>]}
[0m11:04:07.000146 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m11:04:07.000146 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m11:04:07.000146 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m11:04:07.020712 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m11:04:07.020712 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m11:04:07.020712 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m11:04:07.020712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:07.020712 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:04:07.020712 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:04:07.354106 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was properly closed.
[0m11:04:07.354106 [debug] [MainThread]: Command end result
[0m11:04:07.369802 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:04:07.369802 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:04:07.387597 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:04:07.387597 [info ] [MainThread]: Compiled node 'stg_products' is:
select
    distinct product_sub_family,
    product_family,
    product_id,
from PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
[0m11:04:07.387597 [debug] [MainThread]: Command `dbt compile` succeeded at 11:04:07.387597 after 3.43 seconds
[0m11:04:07.387597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014324A6E6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001432613D520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014326B60770>]}
[0m11:04:07.387597 [debug] [MainThread]: Flushing usage events
[0m11:04:08.617403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:04:22.966115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8D171520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC892A5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8CEDA570>]}


============================== 11:04:22.977642 | b598b140-9602-4e4f-a0bd-f1545bfb115b ==============================
[0m11:04:22.977642 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:04:22.977642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_products', 'send_anonymous_usage_stats': 'True'}
[0m11:04:23.449149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b598b140-9602-4e4f-a0bd-f1545bfb115b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8EEDE810>]}
[0m11:04:23.512995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b598b140-9602-4e4f-a0bd-f1545bfb115b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8DAE7530>]}
[0m11:04:23.512995 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:04:23.982447 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:04:24.164741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:04:24.166746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:04:24.204057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b598b140-9602-4e4f-a0bd-f1545bfb115b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8EEDE1E0>]}
[0m11:04:24.283245 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:04:24.299408 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:04:24.331087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b598b140-9602-4e4f-a0bd-f1545bfb115b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8F2F25D0>]}
[0m11:04:24.331087 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 474 macros
[0m11:04:24.331087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b598b140-9602-4e4f-a0bd-f1545bfb115b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8C649F70>]}
[0m11:04:24.331087 [info ] [MainThread]: 
[0m11:04:24.331087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:04:24.331087 [info ] [MainThread]: 
[0m11:04:24.331087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:04:24.331087 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:04:24.452099 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:04:24.452099 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:04:24.452099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:25.838398 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.395 seconds
[0m11:04:25.854344 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:04:25.854344 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:04:25.854344 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:04:25.854344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:26.793716 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.932 seconds
[0m11:04:26.793716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b598b140-9602-4e4f-a0bd-f1545bfb115b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8DE529C0>]}
[0m11:04:26.793716 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m11:04:26.793716 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m11:04:26.809454 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m11:04:26.809454 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m11:04:26.809454 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m11:04:26.809454 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m11:04:26.838068 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m11:04:26.838068 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m11:04:26.838068 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (select
    distinct product_sub_family,
    product_family,
    product_id,
from PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
        );
[0m11:04:26.838068 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:04:28.229904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.380 seconds
[0m11:04:28.251274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b598b140-9602-4e4f-a0bd-f1545bfb115b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8A5117F0>]}
[0m11:04:28.251274 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_products .................. [[32mSUCCESS 1[0m in 1.46s]
[0m11:04:28.251274 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m11:04:28.266952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:28.266952 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:04:28.266952 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:04:28.600196 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:04:28.600196 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:04:28.948565 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m11:04:28.948565 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m11:04:29.272952 [info ] [MainThread]: 
[0m11:04:29.272952 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m11:04:29.272952 [debug] [MainThread]: Command end result
[0m11:04:29.307735 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:04:29.310894 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:04:29.316436 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:04:29.316436 [info ] [MainThread]: 
[0m11:04:29.316436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:04:29.316436 [info ] [MainThread]: 
[0m11:04:29.316436 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:04:29.316436 [debug] [MainThread]: Command `dbt run` succeeded at 11:04:29.316436 after 6.51 seconds
[0m11:04:29.316436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8C5C1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8D145610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC8AF0E630>]}
[0m11:04:29.316436 [debug] [MainThread]: Flushing usage events
[0m11:04:30.225792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:05:33.562302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6D774B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6D50A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6D7754C0>]}


============================== 11:05:33.577489 | 167bd7ee-f479-4db6-a3ab-45c99ced0239 ==============================
[0m11:05:33.577489 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:05:33.577489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_products', 'send_anonymous_usage_stats': 'True'}
[0m11:05:34.087264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '167bd7ee-f479-4db6-a3ab-45c99ced0239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6E19A9C0>]}
[0m11:05:34.146964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '167bd7ee-f479-4db6-a3ab-45c99ced0239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6E46F470>]}
[0m11:05:34.148969 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:05:34.624342 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:05:34.783460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:05:34.783460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:05:34.838998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '167bd7ee-f479-4db6-a3ab-45c99ced0239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6F5AC230>]}
[0m11:05:34.925848 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:05:34.929847 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:05:34.952583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '167bd7ee-f479-4db6-a3ab-45c99ced0239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6F9129C0>]}
[0m11:05:34.952583 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 474 macros
[0m11:05:34.952583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '167bd7ee-f479-4db6-a3ab-45c99ced0239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6E4D1F70>]}
[0m11:05:34.952583 [info ] [MainThread]: 
[0m11:05:34.966182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:05:34.966182 [info ] [MainThread]: 
[0m11:05:34.968191 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:05:34.968191 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:05:35.071569 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:05:35.071569 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:05:35.071569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:36.401785 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.336 seconds
[0m11:05:36.417679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:05:36.421568 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:05:36.421568 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:05:36.421568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:37.340672 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.911 seconds
[0m11:05:37.347060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '167bd7ee-f479-4db6-a3ab-45c99ced0239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6F9135C0>]}
[0m11:05:37.353085 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m11:05:37.353085 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m11:05:37.355093 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m11:05:37.355093 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m11:05:37.364750 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m11:05:37.366756 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m11:05:37.404258 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m11:05:37.406639 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m11:05:37.407675 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select
--     distinct product_sub_family,
--     product_family,
--     product_id,
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null
select * from PROJECT_DB.STAGE.PRODUCTS_DATA
        );
[0m11:05:37.408637 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:05:38.703961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.299 seconds
[0m11:05:38.719871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167bd7ee-f479-4db6-a3ab-45c99ced0239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6AB41970>]}
[0m11:05:38.719871 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_products .................. [[32mSUCCESS 1[0m in 1.36s]
[0m11:05:38.719871 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m11:05:38.719871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:38.719871 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:05:38.735809 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:05:39.057585 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:05:39.057585 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:05:39.363357 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m11:05:39.363357 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m11:05:39.697351 [info ] [MainThread]: 
[0m11:05:39.698350 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m11:05:39.699350 [debug] [MainThread]: Command end result
[0m11:05:39.715014 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:05:39.715014 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:05:39.732490 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:05:39.733647 [info ] [MainThread]: 
[0m11:05:39.734656 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:05:39.735658 [info ] [MainThread]: 
[0m11:05:39.736650 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:05:39.738651 [debug] [MainThread]: Command `dbt run` succeeded at 11:05:39.738651 after 6.33 seconds
[0m11:05:39.738651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6D50A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6D667950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E6CB69010>]}
[0m11:05:39.738651 [debug] [MainThread]: Flushing usage events
[0m11:05:40.971019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:22.918711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F55981D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F22F8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F57E2FC0>]}


============================== 11:07:22.918711 | fcdea44e-a63f-4772-99b0-374c8d2bb79c ==============================
[0m11:07:22.918711 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:07:22.918711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:07:23.405192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcdea44e-a63f-4772-99b0-374c8d2bb79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F5B6B560>]}
[0m11:07:23.468593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcdea44e-a63f-4772-99b0-374c8d2bb79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F6680470>]}
[0m11:07:23.468593 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:07:23.955324 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:07:24.113083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:07:24.113083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:07:24.160513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcdea44e-a63f-4772-99b0-374c8d2bb79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F770BFB0>]}
[0m11:07:24.250179 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:07:24.255707 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:07:24.287659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcdea44e-a63f-4772-99b0-374c8d2bb79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F7AF2780>]}
[0m11:07:24.287659 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 474 macros
[0m11:07:24.287659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcdea44e-a63f-4772-99b0-374c8d2bb79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F799EC90>]}
[0m11:07:24.287659 [info ] [MainThread]: 
[0m11:07:24.287659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:07:24.287659 [info ] [MainThread]: 
[0m11:07:24.287659 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:07:24.287659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:07:24.411954 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:07:24.413961 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:07:24.413961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:25.890978 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.477 seconds
[0m11:07:25.915130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:07:25.915130 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:07:25.930859 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:07:25.931493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:26.869999 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.954 seconds
[0m11:07:26.885722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcdea44e-a63f-4772-99b0-374c8d2bb79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F7A0CE30>]}
[0m11:07:26.901520 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m11:07:26.901520 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m11:07:26.901520 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m11:07:26.901520 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m11:07:26.910866 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m11:07:26.910866 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m11:07:26.934382 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m11:07:26.934382 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m11:07:26.934382 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (select
    distinct product_sub_family,
    product_family,
    product_id,
from PROJECT_DB.STAGE.PRODUCTS_DATA
where product_id is not null
-- select * from PROJECT_DB.STAGE.PRODUCTS_DATA
        );
[0m11:07:26.934382 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:28.356554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.412 seconds
[0m11:07:28.372504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcdea44e-a63f-4772-99b0-374c8d2bb79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F2D81850>]}
[0m11:07:28.372504 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_products .................. [[32mSUCCESS 1[0m in 1.47s]
[0m11:07:28.372504 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m11:07:28.372504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:28.372504 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:07:28.372504 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:07:28.713053 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:07:28.713053 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:07:29.035521 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m11:07:29.035521 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m11:07:29.372996 [info ] [MainThread]: 
[0m11:07:29.372996 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m11:07:29.375532 [debug] [MainThread]: Command end result
[0m11:07:29.397620 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:07:29.401608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:07:29.407599 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:07:29.407599 [info ] [MainThread]: 
[0m11:07:29.407599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:29.407599 [info ] [MainThread]: 
[0m11:07:29.407599 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:07:29.407599 [debug] [MainThread]: Command `dbt run` succeeded at 11:07:29.407599 after 6.67 seconds
[0m11:07:29.407599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F2C918B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F2C91850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F2C918E0>]}
[0m11:07:29.407599 [debug] [MainThread]: Flushing usage events
[0m11:07:30.282323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:12:26.781008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2A052210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2A052240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2A052390>]}


============================== 11:12:26.812617 | ddb9811c-3583-4615-b1ab-55da790443c5 ==============================
[0m11:12:26.812617 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:12:26.812617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_products', 'send_anonymous_usage_stats': 'True'}
[0m11:12:28.082571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddb9811c-3583-4615-b1ab-55da790443c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2BFF7620>]}
[0m11:12:28.149507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddb9811c-3583-4615-b1ab-55da790443c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC28BA9160>]}
[0m11:12:28.149507 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:12:28.835871 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:12:30.453433 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m11:12:30.453433 [debug] [MainThread]: Partial parsing: deleted file: CRB_PROJECT://models\example\my_first_dbt_model.sql
[0m11:12:30.453433 [debug] [MainThread]: Partial parsing: deleted file: CRB_PROJECT://models\example\my_second_dbt_model.sql
[0m11:12:30.509008 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:12:30.527081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddb9811c-3583-4615-b1ab-55da790443c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2E10F890>]}
[0m11:12:30.600466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:12:30.618971 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:12:30.695913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddb9811c-3583-4615-b1ab-55da790443c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2E44D6A0>]}
[0m11:12:30.696915 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:12:30.696915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddb9811c-3583-4615-b1ab-55da790443c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2E381EE0>]}
[0m11:12:30.698914 [info ] [MainThread]: 
[0m11:12:30.698914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:12:30.699914 [info ] [MainThread]: 
[0m11:12:30.700913 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:12:30.701593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:12:34.014556 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:12:34.014556 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:12:34.014556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:35.603739 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.589 seconds
[0m11:12:35.612184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:12:35.627309 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:12:35.627309 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:12:35.627309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:36.612957 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.985 seconds
[0m11:12:36.612957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddb9811c-3583-4615-b1ab-55da790443c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2E7F4560>]}
[0m11:12:36.612957 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m11:12:36.612957 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m11:12:36.612957 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m11:12:36.612957 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m11:12:36.628891 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m11:12:36.628891 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m11:12:36.660422 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m11:12:36.660422 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m11:12:36.660422 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select
--     distinct product_sub_family,
--     product_family,
--     product_id,
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null
select * from PROJECT_DB.STAGE.PRODUCTS_DATA
        );
[0m11:12:36.660422 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:12:38.091450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.425 seconds
[0m11:12:38.107164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddb9811c-3583-4615-b1ab-55da790443c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2B754800>]}
[0m11:12:38.107164 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_products .................. [[32mSUCCESS 1[0m in 1.49s]
[0m11:12:38.107164 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m11:12:38.122982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:38.122982 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:12:38.122982 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:12:38.447104 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:12:38.447104 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:12:38.780456 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m11:12:38.781993 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m11:12:39.103680 [info ] [MainThread]: 
[0m11:12:39.103680 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.40 seconds (8.40s).
[0m11:12:39.103680 [debug] [MainThread]: Command end result
[0m11:12:39.135868 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:12:39.135868 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:12:39.135868 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:12:39.135868 [info ] [MainThread]: 
[0m11:12:39.135868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:12:39.135868 [info ] [MainThread]: 
[0m11:12:39.135868 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:12:39.135868 [debug] [MainThread]: Command `dbt run` succeeded at 11:12:39.135868 after 12.58 seconds
[0m11:12:39.135868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC294A9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2B7EAC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2E465070>]}
[0m11:12:39.135868 [debug] [MainThread]: Flushing usage events
[0m11:12:40.084943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:15.866206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F62B9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F6AF1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F8549C40>]}


============================== 11:24:15.882137 | 091c5de9-9168-43b6-8a3b-36513d94ff5f ==============================
[0m11:24:15.882137 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:24:15.882137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:24:16.644414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '091c5de9-9168-43b6-8a3b-36513d94ff5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F84E9B50>]}
[0m11:24:16.703327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '091c5de9-9168-43b6-8a3b-36513d94ff5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F87017F0>]}
[0m11:24:16.703327 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:24:17.213466 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:24:17.368726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:17.370732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:17.376492 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:24:17.404826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '091c5de9-9168-43b6-8a3b-36513d94ff5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3FAE14530>]}
[0m11:24:17.471321 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:24:17.473327 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:24:17.524610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '091c5de9-9168-43b6-8a3b-36513d94ff5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3FB15E180>]}
[0m11:24:17.524610 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:24:17.524610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '091c5de9-9168-43b6-8a3b-36513d94ff5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3FADD3140>]}
[0m11:24:17.529235 [info ] [MainThread]: 
[0m11:24:17.529235 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:24:17.529235 [info ] [MainThread]: 
[0m11:24:17.529235 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:24:17.529235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:24:17.687504 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:24:17.687504 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:24:17.687504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:19.441665 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.762 seconds
[0m11:24:19.467130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:24:19.482101 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:24:19.482101 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:24:19.482101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:20.503081 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.020 seconds
[0m11:24:20.506873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '091c5de9-9168-43b6-8a3b-36513d94ff5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3FB6AB110>]}
[0m11:24:20.513057 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m11:24:20.514057 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m11:24:20.514899 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m11:24:20.514899 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m11:24:20.523031 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m11:24:20.525120 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m11:24:20.560428 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m11:24:20.560428 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m11:24:20.560428 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select
--     distinct product_sub_family,
--     product_family,
--     product_id,
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null
SELECT 
    *
FROM PROJECT_DB.STAGE.PRODUCTS_DATA
GROUP BY product_id,product_family.product_sub_family
        );
[0m11:24:20.560428 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:24:21.742964 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff02-3201-7e9a-000c-493e0002329e
[0m11:24:21.742964 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 20
invalid identifier 'PRODUCT_FAMILY.PRODUCT_SUB_FAMILY'
[0m11:24:21.759507 [debug] [Thread-1 (]: Database Error in model stg_products (models\stage\stg_products.sql)
  000904 (42000): SQL compilation error: error line 12 at position 20
  invalid identifier 'PRODUCT_FAMILY.PRODUCT_SUB_FAMILY'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m11:24:21.759507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '091c5de9-9168-43b6-8a3b-36513d94ff5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F84B4800>]}
[0m11:24:21.759507 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_products .............. [[31mERROR[0m in 1.25s]
[0m11:24:21.759507 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m11:24:21.759507 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\stage\stg_products.sql)
  000904 (42000): SQL compilation error: error line 12 at position 20
  invalid identifier 'PRODUCT_FAMILY.PRODUCT_SUB_FAMILY'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql.
[0m11:24:21.759507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:21.759507 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:24:21.759507 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:24:22.090607 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:24:22.090607 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:24:22.560583 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m11:24:22.560583 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m11:24:22.944414 [info ] [MainThread]: 
[0m11:24:22.944414 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m11:24:22.944414 [debug] [MainThread]: Command end result
[0m11:24:22.975079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:24:22.977799 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:24:22.988217 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:24:22.988217 [info ] [MainThread]: 
[0m11:24:22.989214 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:24:22.990211 [info ] [MainThread]: 
[0m11:24:22.990211 [error] [MainThread]:   Database Error in model stg_products (models\stage\stg_products.sql)
  000904 (42000): SQL compilation error: error line 12 at position 20
  invalid identifier 'PRODUCT_FAMILY.PRODUCT_SUB_FAMILY'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_products.sql
[0m11:24:22.990211 [info ] [MainThread]: 
[0m11:24:22.990211 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:24:22.993730 [debug] [MainThread]: Command `dbt run` failed at 11:24:22.990211 after 7.39 seconds
[0m11:24:22.993730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F8C575F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F8B21B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3F8B20B60>]}
[0m11:24:22.994740 [debug] [MainThread]: Flushing usage events
[0m11:24:23.981084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:31.105847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026422EC4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026422C5A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026422EC5160>]}


============================== 11:24:31.105847 | 56d0f4cb-d532-4ed9-8e20-852fb4a3ea3b ==============================
[0m11:24:31.105847 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:24:31.105847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_products', 'send_anonymous_usage_stats': 'True'}
[0m11:24:31.617583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56d0f4cb-d532-4ed9-8e20-852fb4a3ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026422EA7590>]}
[0m11:24:31.671106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56d0f4cb-d532-4ed9-8e20-852fb4a3ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026422F0A510>]}
[0m11:24:31.671106 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:24:32.158140 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:24:32.316771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:32.316771 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:32.316771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:24:32.353033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56d0f4cb-d532-4ed9-8e20-852fb4a3ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026423BC38C0>]}
[0m11:24:32.419911 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:24:32.419911 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:24:32.453677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56d0f4cb-d532-4ed9-8e20-852fb4a3ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002642503DD60>]}
[0m11:24:32.453677 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:24:32.453677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d0f4cb-d532-4ed9-8e20-852fb4a3ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026424E56780>]}
[0m11:24:32.457252 [info ] [MainThread]: 
[0m11:24:32.457252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:24:32.457252 [info ] [MainThread]: 
[0m11:24:32.457252 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:24:32.457252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:24:32.602168 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:24:32.602168 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:24:32.602168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:33.902967 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.311 seconds
[0m11:24:33.924983 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:24:33.934863 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:24:33.934863 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:24:33.934863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:34.891470 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.960 seconds
[0m11:24:34.891470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d0f4cb-d532-4ed9-8e20-852fb4a3ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026425019070>]}
[0m11:24:34.891470 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m11:24:34.907245 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m11:24:34.907245 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m11:24:34.907245 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m11:24:34.916043 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m11:24:34.917180 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m11:24:34.947992 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m11:24:34.949959 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m11:24:34.949959 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select
--     distinct product_sub_family,
--     product_family,
--     product_id,
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null
SELECT 
    *
FROM PROJECT_DB.STAGE.PRODUCTS_DATA
GROUP BY product_id,product_family,product_sub_family
        );
[0m11:24:34.949959 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:24:36.363924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.417 seconds
[0m11:24:36.389876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d0f4cb-d532-4ed9-8e20-852fb4a3ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026420291970>]}
[0m11:24:36.391880 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_products .................. [[32mSUCCESS 1[0m in 1.48s]
[0m11:24:36.391880 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m11:24:36.391880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:36.391880 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:24:36.391880 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:24:36.739015 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:24:36.739015 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:24:37.058013 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m11:24:37.058013 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m11:24:37.384547 [info ] [MainThread]: 
[0m11:24:37.384547 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m11:24:37.384547 [debug] [MainThread]: Command end result
[0m11:24:37.411068 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:24:37.414076 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:24:37.416076 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:24:37.416076 [info ] [MainThread]: 
[0m11:24:37.416076 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:24:37.416076 [info ] [MainThread]: 
[0m11:24:37.416076 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:24:37.416076 [debug] [MainThread]: Command `dbt run` succeeded at 11:24:37.416076 after 6.49 seconds
[0m11:24:37.416076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026422BC22A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002641F2D4DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002641F74C5F0>]}
[0m11:24:37.416076 [debug] [MainThread]: Flushing usage events
[0m11:24:38.307987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:58.807612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2BFAED50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2B962570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2BFAD3A0>]}


============================== 11:25:58.817298 | f41d9343-6e5f-4f57-bffa-3ecd7d366094 ==============================
[0m11:25:58.817298 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:25:58.817298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_products', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:25:59.320290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f41d9343-6e5f-4f57-bffa-3ecd7d366094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2BA0F620>]}
[0m11:25:59.373478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f41d9343-6e5f-4f57-bffa-3ecd7d366094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2BFAD490>]}
[0m11:25:59.389658 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:25:59.884983 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:26:00.040714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:26:00.040714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:26:00.057364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:26:00.081182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f41d9343-6e5f-4f57-bffa-3ecd7d366094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2DDBAEA0>]}
[0m11:26:00.160473 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:26:00.165474 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:26:00.196671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f41d9343-6e5f-4f57-bffa-3ecd7d366094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2E0FDD90>]}
[0m11:26:00.196671 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:26:00.196671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f41d9343-6e5f-4f57-bffa-3ecd7d366094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2C935370>]}
[0m11:26:00.196671 [info ] [MainThread]: 
[0m11:26:00.201503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:00.201503 [info ] [MainThread]: 
[0m11:26:00.201503 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:26:00.201503 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:26:00.355826 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:26:00.355826 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:26:00.355826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:01.687271 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.331 seconds
[0m11:26:01.687271 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:26:01.707254 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:26:01.707254 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:26:01.707254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:02.719404 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.017 seconds
[0m11:26:02.731353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f41d9343-6e5f-4f57-bffa-3ecd7d366094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2E730080>]}
[0m11:26:02.747227 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m11:26:02.747227 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_products ....................... [RUN]
[0m11:26:02.747227 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m11:26:02.747227 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m11:26:02.765109 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m11:26:02.767120 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m11:26:02.804619 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m11:26:02.804619 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m11:26:02.806628 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_products
         as
        (-- select
--     distinct product_sub_family,
--     product_family,
--     product_id,
-- from PROJECT_DB.STAGE.PRODUCTS_DATA
-- where product_id is not null
SELECT 
    *
FROM PROJECT_DB.STAGE.PRODUCTS_DATA
-- GROUP BY product_id,product_family,product_sub_family
        );
[0m11:26:02.806628 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:26:04.534728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.733 seconds
[0m11:26:04.550384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f41d9343-6e5f-4f57-bffa-3ecd7d366094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB29351820>]}
[0m11:26:04.550384 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_products .................. [[32mSUCCESS 1[0m in 1.80s]
[0m11:26:04.550384 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m11:26:04.566040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:04.566040 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:26:04.566040 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:26:04.882840 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:26:04.882840 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:26:05.210977 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m11:26:05.210977 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m11:26:05.533606 [info ] [MainThread]: 
[0m11:26:05.533606 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m11:26:05.533606 [debug] [MainThread]: Command end result
[0m11:26:05.549322 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:26:05.585091 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:26:05.595244 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:26:05.596994 [info ] [MainThread]: 
[0m11:26:05.596994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:26:05.596994 [info ] [MainThread]: 
[0m11:26:05.596994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:26:05.596994 [debug] [MainThread]: Command `dbt run` succeeded at 11:26:05.596994 after 6.96 seconds
[0m11:26:05.596994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2B0336B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2B6C31A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB296A78F0>]}
[0m11:26:05.596994 [debug] [MainThread]: Flushing usage events
[0m11:26:06.515279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:19.309393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EAF68FB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EAF68C9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EAF68CC20>]}


============================== 11:38:19.325616 | 52b300bf-5d49-43a4-bd41-df4cce7a8e19 ==============================
[0m11:38:19.325616 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:38:19.325616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:38:21.051745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52b300bf-5d49-43a4-bd41-df4cce7a8e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB03A9790>]}
[0m11:38:21.109903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52b300bf-5d49-43a4-bd41-df4cce7a8e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EACD87470>]}
[0m11:38:21.109903 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:38:21.729019 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:38:21.880260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:21.880260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:21.880260 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:38:21.914071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52b300bf-5d49-43a4-bd41-df4cce7a8e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB02A38F0>]}
[0m11:38:21.978810 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:38:21.978810 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:38:22.029810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52b300bf-5d49-43a4-bd41-df4cce7a8e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB18A1D30>]}
[0m11:38:22.029810 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:38:22.029810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b300bf-5d49-43a4-bd41-df4cce7a8e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EAD37A9C0>]}
[0m11:38:22.029810 [info ] [MainThread]: 
[0m11:38:22.029810 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:22.029810 [info ] [MainThread]: 
[0m11:38:22.029810 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:38:22.029810 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:38:25.745301 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:38:25.745301 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:38:25.745301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:27.384323 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.628 seconds
[0m11:38:27.385332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:38:27.401332 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:38:27.401332 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:38:27.401332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:28.390281 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.988 seconds
[0m11:38:28.390281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b300bf-5d49-43a4-bd41-df4cce7a8e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB1533290>]}
[0m11:38:28.422507 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:38:28.422507 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:38:28.422507 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:38:28.422507 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:38:28.448715 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:38:28.449080 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:38:28.480774 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:38:28.481780 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:38:28.482743 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (SELECT
    customer_id,
    customer_name,
    company 
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE 
    customer_id 
IS 
    NOT NULL
        );
[0m11:38:28.482743 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:29.600033 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff10-3201-7e9a-000c-493e00023332
[0m11:38:29.600033 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 4
invalid identifier 'CUSTOMER_NAME'
[0m11:38:29.615757 [debug] [Thread-1 (]: Database Error in model stg_customers (models\stage\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:38:29.615757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b300bf-5d49-43a4-bd41-df4cce7a8e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EB157BB90>]}
[0m11:38:29.615757 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_customers ............. [[31mERROR[0m in 1.19s]
[0m11:38:29.615757 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:38:29.615757 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\stage\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql.
[0m11:38:29.615757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:29.615757 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:38:29.615757 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:38:29.961797 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:38:29.961797 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:38:30.281185 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:38:30.281185 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:38:30.603537 [info ] [MainThread]: 
[0m11:38:30.603537 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m11:38:30.603537 [debug] [MainThread]: Command end result
[0m11:38:30.636549 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:38:30.637559 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:38:30.637559 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:38:30.637559 [info ] [MainThread]: 
[0m11:38:30.637559 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:38:30.637559 [info ] [MainThread]: 
[0m11:38:30.637559 [error] [MainThread]:   Database Error in model stg_customers (models\stage\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:38:30.637559 [info ] [MainThread]: 
[0m11:38:30.637559 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:38:30.637559 [debug] [MainThread]: Command `dbt run` failed at 11:38:30.637559 after 11.54 seconds
[0m11:38:30.637559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EAEAE3F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EAC022F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EAC021BE0>]}
[0m11:38:30.637559 [debug] [MainThread]: Flushing usage events
[0m11:38:31.960952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:06.214786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144AFA0DC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144B2F30320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144B2F301A0>]}


============================== 11:39:06.223525 | 064404aa-157d-4d5b-8388-e6dc05c4f15f ==============================
[0m11:39:06.223525 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:39:06.223525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:39:06.694620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '064404aa-157d-4d5b-8388-e6dc05c4f15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144B3CB3830>]}
[0m11:39:06.758043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '064404aa-157d-4d5b-8388-e6dc05c4f15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144B2F49100>]}
[0m11:39:06.758043 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:39:07.228283 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:39:07.370851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:39:07.370851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:39:07.386922 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:39:07.408554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '064404aa-157d-4d5b-8388-e6dc05c4f15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144B4DCEF60>]}
[0m11:39:07.474860 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:39:07.474860 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:39:07.516805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '064404aa-157d-4d5b-8388-e6dc05c4f15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144B5132060>]}
[0m11:39:07.517786 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:39:07.518787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '064404aa-157d-4d5b-8388-e6dc05c4f15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144B4F96450>]}
[0m11:39:07.519817 [info ] [MainThread]: 
[0m11:39:07.520786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:07.520786 [info ] [MainThread]: 
[0m11:39:07.521785 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:39:07.522785 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:39:07.624006 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:39:07.624006 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:39:07.624006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:09.058267 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.449 seconds
[0m11:39:09.079408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:39:09.090546 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:39:09.090546 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:39:09.092571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:10.365939 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.284 seconds
[0m11:39:10.365939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '064404aa-157d-4d5b-8388-e6dc05c4f15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144B3D2CB90>]}
[0m11:39:10.381864 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:39:10.381864 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:39:10.381864 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:39:10.381864 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:39:10.381864 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:39:10.381864 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:39:10.412604 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:39:10.412604 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:39:10.412604 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (SELECT
    customer_id,
    customername as customer_name,
    company 
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE 
    customer_id 
IS 
    NOT NULL
        );
[0m11:39:10.427169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:39:11.737899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.313 seconds
[0m11:39:11.766249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '064404aa-157d-4d5b-8388-e6dc05c4f15f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144B0331B20>]}
[0m11:39:11.766755 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_customers ................. [[32mSUCCESS 1[0m in 1.38s]
[0m11:39:11.767384 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:39:11.768455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:11.769493 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:39:11.769493 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:39:12.084531 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:39:12.084531 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:39:12.405658 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:39:12.405658 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:39:12.738208 [info ] [MainThread]: 
[0m11:39:12.738208 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m11:39:12.738208 [debug] [MainThread]: Command end result
[0m11:39:12.765970 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:39:12.768001 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:39:12.769971 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:39:12.769971 [info ] [MainThread]: 
[0m11:39:12.769971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:12.769971 [info ] [MainThread]: 
[0m11:39:12.769971 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:39:12.769971 [debug] [MainThread]: Command `dbt run` succeeded at 11:39:12.769971 after 6.72 seconds
[0m11:39:12.779490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144B23C0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144AF9430B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144B2DFAED0>]}
[0m11:39:12.779490 [debug] [MainThread]: Flushing usage events
[0m11:39:13.649100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:28.945771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012621E504A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001262181B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012621E50BF0>]}


============================== 11:41:28.945771 | a8ec515d-5281-4382-8058-5e4c084cdfa2 ==============================
[0m11:41:28.945771 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:41:28.945771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:41:29.855976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8ec515d-5281-4382-8058-5e4c084cdfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012622BC1850>]}
[0m11:41:29.903086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8ec515d-5281-4382-8058-5e4c084cdfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001261F59D490>]}
[0m11:41:29.903086 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:41:30.481077 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:41:30.639132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:30.639132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:30.639132 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:41:30.676337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8ec515d-5281-4382-8058-5e4c084cdfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012623C9F080>]}
[0m11:41:30.731779 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:41:30.759802 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:41:30.779188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8ec515d-5281-4382-8058-5e4c084cdfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012623FE1D00>]}
[0m11:41:30.779188 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:41:30.779188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ec515d-5281-4382-8058-5e4c084cdfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012623C9F020>]}
[0m11:41:30.794923 [info ] [MainThread]: 
[0m11:41:30.794923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:30.794923 [info ] [MainThread]: 
[0m11:41:30.794923 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:30.794923 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:41:33.719699 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:41:33.719699 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:41:33.719699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:35.275809 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.553 seconds
[0m11:41:35.292547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:41:35.296295 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:41:35.296295 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:41:35.296295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:36.302169 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.000 seconds
[0m11:41:36.302169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ec515d-5281-4382-8058-5e4c084cdfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012623C9F170>]}
[0m11:41:36.302169 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:41:36.302169 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:41:36.314396 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:41:36.314396 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:41:36.314396 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:41:36.314396 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:41:36.345379 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:41:36.345379 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:41:36.345379 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (SELECT
    customer_id,
    customername.replace(',','') as customer_name,
    company 
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE 
    customer_id 
IS 
    NOT NULL
        );
[0m11:41:36.345379 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:41:37.488517 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff13-3201-7e9a-000c-493e00023342
[0m11:41:37.488517 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002141 (42601): SQL compilation error:
Unknown user-defined function CUSTOMERNAME.REPLACE
[0m11:41:37.504444 [debug] [Thread-1 (]: Database Error in model stg_customers (models\stage\stg_customers.sql)
  002141 (42601): SQL compilation error:
  Unknown user-defined function CUSTOMERNAME.REPLACE
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:41:37.507294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ec515d-5281-4382-8058-5e4c084cdfa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126212F4860>]}
[0m11:41:37.507294 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_customers ............. [[31mERROR[0m in 1.20s]
[0m11:41:37.507294 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:41:37.507294 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\stage\stg_customers.sql)
  002141 (42601): SQL compilation error:
  Unknown user-defined function CUSTOMERNAME.REPLACE
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql.
[0m11:41:37.507294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:37.507294 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:41:37.507294 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:41:37.837388 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:41:37.837388 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:41:38.172408 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:41:38.172408 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:41:38.500304 [info ] [MainThread]: 
[0m11:41:38.500304 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m11:41:38.500304 [debug] [MainThread]: Command end result
[0m11:41:38.525756 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:41:38.528737 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:41:38.532061 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:41:38.532061 [info ] [MainThread]: 
[0m11:41:38.532061 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:41:38.532061 [info ] [MainThread]: 
[0m11:41:38.532061 [error] [MainThread]:   Database Error in model stg_customers (models\stage\stg_customers.sql)
  002141 (42601): SQL compilation error:
  Unknown user-defined function CUSTOMERNAME.REPLACE
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:41:38.532061 [info ] [MainThread]: 
[0m11:41:38.532061 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:41:38.541232 [debug] [MainThread]: Command `dbt run` failed at 11:41:38.532061 after 9.77 seconds
[0m11:41:38.541232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126219B5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001261FBFE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001261FBFD520>]}
[0m11:41:38.542258 [debug] [MainThread]: Flushing usage events
[0m11:41:39.449341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:01.538612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F959C320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F959C6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F959C530>]}


============================== 11:46:01.542770 | aee4da12-fcf8-4ec6-b585-a862a37c7c75 ==============================
[0m11:46:01.542770 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:46:01.542770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:46:02.037988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aee4da12-fcf8-4ec6-b585-a862a37c7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F959C5C0>]}
[0m11:46:02.105497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aee4da12-fcf8-4ec6-b585-a862a37c7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F9E39940>]}
[0m11:46:02.105497 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:46:02.587512 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:46:02.738954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:02.738954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:02.738954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:46:02.778445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aee4da12-fcf8-4ec6-b585-a862a37c7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162FB541070>]}
[0m11:46:02.849688 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:46:02.852688 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:46:02.883108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aee4da12-fcf8-4ec6-b585-a862a37c7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162FB7055E0>]}
[0m11:46:02.883108 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:46:02.883108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aee4da12-fcf8-4ec6-b585-a862a37c7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162FA32C230>]}
[0m11:46:02.886000 [info ] [MainThread]: 
[0m11:46:02.886000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:02.886000 [info ] [MainThread]: 
[0m11:46:02.886000 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:02.886000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:46:02.992103 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:46:02.993099 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:46:02.993099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:04.521773 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.534 seconds
[0m11:46:04.536778 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:46:04.545825 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:46:04.545825 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:46:04.545825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:05.548638 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.008 seconds
[0m11:46:05.566383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aee4da12-fcf8-4ec6-b585-a862a37c7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162FB9901A0>]}
[0m11:46:05.568817 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:46:05.568817 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:46:05.568817 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:46:05.568817 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:46:05.581143 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:46:05.583150 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:46:05.615391 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:46:05.617357 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:46:05.617357 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (SELECT
    customer_id,
    SPLIT_PART(REPLACE(customername,',','')) as customer_name,
    company 
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE 
    customer_id 
IS 
    NOT NULL
        );
[0m11:46:05.618391 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:46:06.761911 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff18-3201-7db6-000c-493e00019f4e
[0m11:46:06.761911 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000938 (22023): SQL compilation error: error line 5 at position 4
not enough arguments for function [SPLIT_PART(REPLACE(CUSTOMERS_DATA.CUSTOMERNAME, ',', ''))], expected 3, got 1
[0m11:46:06.761911 [debug] [Thread-1 (]: Database Error in model stg_customers (models\stage\stg_customers.sql)
  000938 (22023): SQL compilation error: error line 5 at position 4
  not enough arguments for function [SPLIT_PART(REPLACE(CUSTOMERS_DATA.CUSTOMERNAME, ',', ''))], expected 3, got 1
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:46:06.761911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee4da12-fcf8-4ec6-b585-a862a37c7c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162FBC7F080>]}
[0m11:46:06.761911 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_customers ............. [[31mERROR[0m in 1.19s]
[0m11:46:06.761911 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:46:06.761911 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\stage\stg_customers.sql)
  000938 (22023): SQL compilation error: error line 5 at position 4
  not enough arguments for function [SPLIT_PART(REPLACE(CUSTOMERS_DATA.CUSTOMERNAME, ',', ''))], expected 3, got 1
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql.
[0m11:46:06.776736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:06.776736 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:46:06.776736 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:46:07.102576 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:46:07.102576 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:46:07.447722 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:46:07.447722 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:46:07.780035 [info ] [MainThread]: 
[0m11:46:07.780998 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m11:46:07.781964 [debug] [MainThread]: Command end result
[0m11:46:07.805304 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:46:07.805304 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:46:07.813875 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:46:07.813875 [info ] [MainThread]: 
[0m11:46:07.813875 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:46:07.813875 [info ] [MainThread]: 
[0m11:46:07.813875 [error] [MainThread]:   Database Error in model stg_customers (models\stage\stg_customers.sql)
  000938 (22023): SQL compilation error: error line 5 at position 4
  not enough arguments for function [SPLIT_PART(REPLACE(CUSTOMERS_DATA.CUSTOMERNAME, ',', ''))], expected 3, got 1
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:46:07.813875 [info ] [MainThread]: 
[0m11:46:07.813875 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:46:07.813875 [debug] [MainThread]: Command `dbt run` failed at 11:46:07.813875 after 6.45 seconds
[0m11:46:07.813875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F6C7B380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F733AAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162F733A8A0>]}
[0m11:46:07.813875 [debug] [MainThread]: Flushing usage events
[0m11:46:08.727950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:22.182073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60E0117C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60BDAE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60BDAE8D0>]}


============================== 11:47:22.188084 | b451a1cf-f6f1-4892-a792-40adec35dfb1 ==============================
[0m11:47:22.188084 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:47:22.190091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_customers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:47:22.664106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b451a1cf-f6f1-4892-a792-40adec35dfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60EC8CB00>]}
[0m11:47:22.735730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b451a1cf-f6f1-4892-a792-40adec35dfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60ED0C410>]}
[0m11:47:22.737750 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:47:23.229447 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:47:23.367889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:47:23.367889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:47:23.389154 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:47:23.416135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b451a1cf-f6f1-4892-a792-40adec35dfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60FDD2E70>]}
[0m11:47:23.485197 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:47:23.490201 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:47:23.518645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b451a1cf-f6f1-4892-a792-40adec35dfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C61015E270>]}
[0m11:47:23.518645 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:47:23.518645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b451a1cf-f6f1-4892-a792-40adec35dfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60DD26360>]}
[0m11:47:23.518645 [info ] [MainThread]: 
[0m11:47:23.518645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:23.518645 [info ] [MainThread]: 
[0m11:47:23.518645 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:47:23.518645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:47:23.628383 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:47:23.628383 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:47:23.628383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:24.958769 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.330 seconds
[0m11:47:24.960777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:47:24.968625 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:47:24.968625 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:47:24.968625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:25.920416 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.955 seconds
[0m11:47:25.936554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b451a1cf-f6f1-4892-a792-40adec35dfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60FDD3290>]}
[0m11:47:25.952410 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:47:25.952410 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:47:25.952410 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:47:25.952410 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:47:25.952410 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:47:25.952410 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:47:25.988153 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:47:25.988153 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:47:25.988153 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (-- SELECT
--     customer_id,
--     SPLIT_PART(REPLACE(customername,',','')) as customer_name,
--     company 
-- FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
-- WHERE 
--     customer_id 
-- IS 
--     NOT NULL
SELECT
    customer_id,
    SPLIT_PART(REPLACE(customername, ',', ''), ' ', 1) AS customer_name,
    company
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE customer_id IS NOT NULL;
[0m11:47:25.988153 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:47:26.958005 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff19-3201-7db6-000c-493e00019f62
[0m11:47:26.958005 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 29 unexpected ';'.
[0m11:47:26.958005 [debug] [Thread-1 (]: Database Error in model stg_customers (models\stage\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:47:26.958005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b451a1cf-f6f1-4892-a792-40adec35dfb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6104D1130>]}
[0m11:47:26.958005 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_customers ............. [[31mERROR[0m in 1.01s]
[0m11:47:26.958005 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:47:26.958005 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\stage\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql.
[0m11:47:26.973711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:26.973711 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:47:26.973711 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:47:27.297446 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:47:27.297446 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:47:27.621555 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:47:27.621555 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:47:27.960627 [info ] [MainThread]: 
[0m11:47:27.960627 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m11:47:27.960627 [debug] [MainThread]: Command end result
[0m11:47:27.987636 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:47:27.991067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:47:27.995674 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:47:27.995674 [info ] [MainThread]: 
[0m11:47:27.995674 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:47:27.995674 [info ] [MainThread]: 
[0m11:47:27.995674 [error] [MainThread]:   Database Error in model stg_customers (models\stage\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:47:27.995674 [info ] [MainThread]: 
[0m11:47:27.995674 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:47:27.995674 [debug] [MainThread]: Command `dbt run` failed at 11:47:27.995674 after 5.99 seconds
[0m11:47:27.995674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60DDACE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60A9A1D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60A9A30E0>]}
[0m11:47:27.995674 [debug] [MainThread]: Flushing usage events
[0m11:47:28.917475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:38.126508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6ADF5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6ADF5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6ADF4980>]}


============================== 11:47:38.126508 | 4a4d6478-d3ed-451b-b149-44d280df1814 ==============================
[0m11:47:38.126508 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:47:38.126508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m11:47:38.613360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a4d6478-d3ed-451b-b149-44d280df1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6ADF56A0>]}
[0m11:47:38.675039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a4d6478-d3ed-451b-b149-44d280df1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6AFB7BC0>]}
[0m11:47:38.676785 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:47:39.147173 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:47:39.299107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:47:39.299107 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:47:39.299107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:47:39.334074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a4d6478-d3ed-451b-b149-44d280df1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6CC4AF60>]}
[0m11:47:39.401699 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:47:39.401699 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:47:39.433039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a4d6478-d3ed-451b-b149-44d280df1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6CF8E2D0>]}
[0m11:47:39.433039 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:47:39.433039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a4d6478-d3ed-451b-b149-44d280df1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6CDF5D30>]}
[0m11:47:39.433039 [info ] [MainThread]: 
[0m11:47:39.433039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:39.433039 [info ] [MainThread]: 
[0m11:47:39.433039 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:47:39.433039 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:47:39.544263 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:47:39.545263 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:47:39.545263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:40.990196 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.444 seconds
[0m11:47:40.990196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:47:41.001221 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:47:41.001221 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:47:41.001221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:42.062437 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.066 seconds
[0m11:47:42.075229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a4d6478-d3ed-451b-b149-44d280df1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6CF64500>]}
[0m11:47:42.078460 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:47:42.078460 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:47:42.078460 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:47:42.078460 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:47:42.078460 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:47:42.095192 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:47:42.127826 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:47:42.129824 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:47:42.129824 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (-- SELECT
--     customer_id,
--     SPLIT_PART(REPLACE(customername,',','')) as customer_name,
--     company 
-- FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
-- WHERE 
--     customer_id 
-- IS 
--     NOT NULL
SELECT
    customer_id,
    SPLIT_PART(REPLACE(customername, ',', ''), ' ', 1) AS customer_name,
    company
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE customer_id IS NOT NULL
        );
[0m11:47:42.129824 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:47:43.391949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.271 seconds
[0m11:47:43.423813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a4d6478-d3ed-451b-b149-44d280df1814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C681C18E0>]}
[0m11:47:43.423813 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_customers ................. [[32mSUCCESS 1[0m in 1.35s]
[0m11:47:43.423813 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:47:43.423813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:43.423813 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:47:43.423813 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:47:43.749816 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:47:43.749816 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:47:44.087764 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:47:44.087764 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:47:44.419238 [info ] [MainThread]: 
[0m11:47:44.427110 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.99 seconds (4.99s).
[0m11:47:44.427110 [debug] [MainThread]: Command end result
[0m11:47:44.448820 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:47:44.452028 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:47:44.458432 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:47:44.459396 [info ] [MainThread]: 
[0m11:47:44.460395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:44.460952 [info ] [MainThread]: 
[0m11:47:44.461963 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:47:44.461963 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:44.461963 after 6.49 seconds
[0m11:47:44.461963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6A2FAE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6BAE4C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C6BAE4BC0>]}
[0m11:47:44.461963 [debug] [MainThread]: Flushing usage events
[0m11:47:45.340014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:25.031958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A3814620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A31C2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A3814350>]}


============================== 11:49:25.031958 | 4ef5b1b7-94ed-4fdc-9a9a-b116346193cc ==============================
[0m11:49:25.031958 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:49:25.031958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:25.524276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ef5b1b7-94ed-4fdc-9a9a-b116346193cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A2CC2B70>]}
[0m11:49:25.581592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ef5b1b7-94ed-4fdc-9a9a-b116346193cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A450B140>]}
[0m11:49:25.581592 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:49:26.071263 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:49:26.202804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:49:26.202804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:49:26.218491 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:49:26.240865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ef5b1b7-94ed-4fdc-9a9a-b116346193cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A450BB30>]}
[0m11:49:26.308196 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:49:26.323564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:49:26.339644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ef5b1b7-94ed-4fdc-9a9a-b116346193cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A5A21AF0>]}
[0m11:49:26.355311 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:49:26.355311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ef5b1b7-94ed-4fdc-9a9a-b116346193cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A5887DD0>]}
[0m11:49:26.355311 [info ] [MainThread]: 
[0m11:49:26.355311 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:49:26.355311 [info ] [MainThread]: 
[0m11:49:26.355311 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:49:26.355311 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:49:26.466275 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:49:26.467273 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:49:26.467273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:27.789048 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.322 seconds
[0m11:49:27.796251 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:49:27.805862 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:49:27.805862 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:49:27.805862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:28.771945 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.966 seconds
[0m11:49:28.775845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ef5b1b7-94ed-4fdc-9a9a-b116346193cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A45FCBC0>]}
[0m11:49:28.775845 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:49:28.775845 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:49:28.775845 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:49:28.775845 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:49:28.794024 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:49:28.795282 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:49:28.826305 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:49:28.827355 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:49:28.828342 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (-- SELECT
--     customer_id,
--     SPLIT_PART(REPLACE(customername,',','')) as customer_name,
--     company 
-- FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
-- WHERE 
--     customer_id 
-- IS 
--     NOT NULL
SELECT
    customer_id,
    REPLACE(customername, ',', ' ') AS customer_name,
    company
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE customer_id IS NOT NULL;
[0m11:49:28.828342 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:49:29.806708 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff1b-3201-7db6-000c-493e00019f72
[0m11:49:29.806708 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 29 unexpected ';'.
[0m11:49:29.811290 [debug] [Thread-1 (]: Database Error in model stg_customers (models\stage\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:49:29.814787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef5b1b7-94ed-4fdc-9a9a-b116346193cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A2CE4710>]}
[0m11:49:29.814787 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_customers ............. [[31mERROR[0m in 1.04s]
[0m11:49:29.814787 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:49:29.814787 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\stage\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql.
[0m11:49:29.814787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:29.814787 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:49:29.814787 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:49:30.138126 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:49:30.138126 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:49:30.474667 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:49:30.474667 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:49:30.808335 [info ] [MainThread]: 
[0m11:49:30.811340 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m11:49:30.814775 [debug] [MainThread]: Command end result
[0m11:49:30.839359 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:49:30.841357 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:49:30.847741 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:49:30.847741 [info ] [MainThread]: 
[0m11:49:30.848744 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:49:30.849961 [info ] [MainThread]: 
[0m11:49:30.849961 [error] [MainThread]:   Database Error in model stg_customers (models\stage\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:49:30.849961 [info ] [MainThread]: 
[0m11:49:30.849961 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:49:30.849961 [debug] [MainThread]: Command `dbt run` failed at 11:49:30.849961 after 5.98 seconds
[0m11:49:30.854715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A568E9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A3815070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A3814F80>]}
[0m11:49:30.854715 [debug] [MainThread]: Flushing usage events
[0m11:49:31.752839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:38.866131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024679830BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024679830D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024679833E30>]}


============================== 11:49:38.866131 | 8b57a902-4424-4006-acbf-ba08537e3bb5 ==============================
[0m11:49:38.866131 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:49:38.866131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:49:39.351459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b57a902-4424-4006-acbf-ba08537e3bb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467984C500>]}
[0m11:49:39.414637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b57a902-4424-4006-acbf-ba08537e3bb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467A66E8D0>]}
[0m11:49:39.414637 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:49:39.885901 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:49:40.036990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:49:40.036990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:49:40.045542 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:49:40.072615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b57a902-4424-4006-acbf-ba08537e3bb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467B70C530>]}
[0m11:49:40.137140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:49:40.144291 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:49:40.168554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b57a902-4424-4006-acbf-ba08537e3bb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467BA414F0>]}
[0m11:49:40.168554 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:49:40.168554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b57a902-4424-4006-acbf-ba08537e3bb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467933B050>]}
[0m11:49:40.168554 [info ] [MainThread]: 
[0m11:49:40.168554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:49:40.168554 [info ] [MainThread]: 
[0m11:49:40.168554 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:49:40.168554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:49:40.287946 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:49:40.287946 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:49:40.287946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:41.366917 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.090 seconds
[0m11:49:41.382966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:49:41.382966 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:49:41.382966 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:49:41.382966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:42.369098 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.977 seconds
[0m11:49:42.369098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b57a902-4424-4006-acbf-ba08537e3bb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467B8D4B60>]}
[0m11:49:42.369098 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:49:42.369098 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:49:42.369098 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:49:42.369098 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:49:42.385026 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:49:42.385026 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:49:42.407640 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:49:42.423378 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:49:42.423378 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (-- SELECT
--     customer_id,
--     SPLIT_PART(REPLACE(customername,',','')) as customer_name,
--     company 
-- FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
-- WHERE 
--     customer_id 
-- IS 
--     NOT NULL
SELECT
    customer_id,
    REPLACE(customername, ',', ' ') AS customer_name,
    company
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE customer_id IS NOT NULL
        );
[0m11:49:42.423378 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:49:44.117274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.695 seconds
[0m11:49:44.143100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b57a902-4424-4006-acbf-ba08537e3bb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024676BD1820>]}
[0m11:49:44.143100 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_customers ................. [[32mSUCCESS 1[0m in 1.76s]
[0m11:49:44.143100 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:49:44.147119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:44.147119 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:49:44.147119 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:49:44.551791 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:49:44.551791 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:49:44.924881 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:49:44.924881 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:49:45.298104 [info ] [MainThread]: 
[0m11:49:45.299072 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m11:49:45.300104 [debug] [MainThread]: Command end result
[0m11:49:45.321948 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:49:45.323946 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:49:45.330852 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:49:45.332915 [info ] [MainThread]: 
[0m11:49:45.333898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:45.334907 [info ] [MainThread]: 
[0m11:49:45.338452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:49:45.343261 [debug] [MainThread]: Command `dbt run` succeeded at 11:49:45.343261 after 6.63 seconds
[0m11:49:45.344254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246775CE7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246775CE720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246775CE6C0>]}
[0m11:49:45.344254 [debug] [MainThread]: Flushing usage events
[0m11:49:46.214713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:33.511838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200872C0A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200872C0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200872C39B0>]}


============================== 11:51:33.511838 | 338ab6cd-6f56-4fdf-bfba-bcdfb92a8371 ==============================
[0m11:51:33.511838 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:51:33.511838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:51:34.002274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '338ab6cd-6f56-4fdf-bfba-bcdfb92a8371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020087FEC4D0>]}
[0m11:51:34.066181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '338ab6cd-6f56-4fdf-bfba-bcdfb92a8371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200867F9D90>]}
[0m11:51:34.066181 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:51:34.535604 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:51:34.686280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:34.686280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:34.695329 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:51:34.723164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '338ab6cd-6f56-4fdf-bfba-bcdfb92a8371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200872DAF30>]}
[0m11:51:34.786468 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:51:34.786468 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:51:34.831586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '338ab6cd-6f56-4fdf-bfba-bcdfb92a8371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089411DF0>]}
[0m11:51:34.833325 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:51:34.833325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338ab6cd-6f56-4fdf-bfba-bcdfb92a8371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008907F170>]}
[0m11:51:34.833325 [info ] [MainThread]: 
[0m11:51:34.836008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:34.836008 [info ] [MainThread]: 
[0m11:51:34.836008 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:34.836008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:51:34.940376 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:51:34.940376 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:51:34.940376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:36.270042 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.330 seconds
[0m11:51:36.270042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:51:36.285840 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:51:36.285840 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:51:36.285840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:37.294204 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.006 seconds
[0m11:51:37.305409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338ab6cd-6f56-4fdf-bfba-bcdfb92a8371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200898352B0>]}
[0m11:51:37.305409 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:51:37.305409 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:51:37.305409 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:51:37.305409 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:51:37.305409 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:51:37.305409 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:51:37.339334 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:51:37.354024 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:51:37.354024 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (-- SELECT
--     customer_id,
--     REPLACE(customername, ',', ' ') AS customer_name,
--     company
-- FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
-- WHERE customer_id IS NOT NULL



SELECT
    customer_id,
    REGEXP_REPLACE(customername, '\\(.*?\\)', '') AS customer_name,
    company
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE customer_id IS NOT NULL;
[0m11:51:37.355260 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:38.276531 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff1d-3201-7e57-000c-493e0001eeae
[0m11:51:38.276531 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 29 unexpected ';'.
[0m11:51:38.276531 [debug] [Thread-1 (]: Database Error in model stg_customers (models\stage\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:51:38.292277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338ab6cd-6f56-4fdf-bfba-bcdfb92a8371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200867644A0>]}
[0m11:51:38.292277 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_customers ............. [[31mERROR[0m in 0.99s]
[0m11:51:38.292277 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:51:38.298647 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\stage\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql.
[0m11:51:38.298647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:38.298647 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:51:38.298647 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:51:38.632147 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:51:38.632147 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:51:38.973471 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:51:38.973471 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:51:39.313076 [info ] [MainThread]: 
[0m11:51:39.313076 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m11:51:39.313076 [debug] [MainThread]: Command end result
[0m11:51:39.341620 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:51:39.344621 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:51:39.345623 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:51:39.345623 [info ] [MainThread]: 
[0m11:51:39.345623 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:51:39.345623 [info ] [MainThread]: 
[0m11:51:39.345623 [error] [MainThread]:   Database Error in model stg_customers (models\stage\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:51:39.345623 [info ] [MainThread]: 
[0m11:51:39.345623 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:51:39.356931 [debug] [MainThread]: Command `dbt run` failed at 11:51:39.356931 after 6.01 seconds
[0m11:51:39.357932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200892645F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200890AC440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200849BBEC0>]}
[0m11:51:39.357932 [debug] [MainThread]: Flushing usage events
[0m11:51:40.332968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:48.329548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB5F2B4B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB5F2B4AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB5F2B4950>]}


============================== 11:51:48.329548 | 8510bd1d-a77e-46e3-95c3-d1fb4148b016 ==============================
[0m11:51:48.329548 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:51:48.329548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:51:48.811632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8510bd1d-a77e-46e3-95c3-d1fb4148b016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB5C6827E0>]}
[0m11:51:48.873158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8510bd1d-a77e-46e3-95c3-d1fb4148b016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB5FFD79E0>]}
[0m11:51:48.873158 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:51:49.349364 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:51:49.491957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:49.491957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:49.491957 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:51:49.529793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8510bd1d-a77e-46e3-95c3-d1fb4148b016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6110FB60>]}
[0m11:51:49.582749 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:51:49.598749 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:51:49.630368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8510bd1d-a77e-46e3-95c3-d1fb4148b016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB61451E80>]}
[0m11:51:49.630368 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:51:49.630368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8510bd1d-a77e-46e3-95c3-d1fb4148b016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB610BE360>]}
[0m11:51:49.630368 [info ] [MainThread]: 
[0m11:51:49.630368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:49.630368 [info ] [MainThread]: 
[0m11:51:49.630368 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:49.630368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:51:49.739259 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:51:49.739259 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:51:49.739259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:51.026771 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.288 seconds
[0m11:51:51.033583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:51:51.033583 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:51:51.033583 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:51:51.033583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:52.034612 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.999 seconds
[0m11:51:52.034612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8510bd1d-a77e-46e3-95c3-d1fb4148b016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB61424500>]}
[0m11:51:52.050440 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:51:52.050440 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:51:52.050440 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:51:52.050440 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:51:52.050440 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:51:52.050440 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:51:52.086440 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:51:52.086440 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:51:52.086440 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (-- SELECT
--     customer_id,
--     REPLACE(customername, ',', ' ') AS customer_name,
--     company
-- FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
-- WHERE customer_id IS NOT NULL



SELECT
    customer_id,
    REGEXP_REPLACE(customername, '\\(.*?\\)', '') AS customer_name,
    company
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE customer_id IS NOT NULL
        );
[0m11:51:52.086440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:53.459060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.379 seconds
[0m11:51:53.507318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8510bd1d-a77e-46e3-95c3-d1fb4148b016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB5C6818E0>]}
[0m11:51:53.523279 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_customers ................. [[32mSUCCESS 1[0m in 1.46s]
[0m11:51:53.523279 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:51:53.523279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:53.523279 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:51:53.523279 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:51:53.854335 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:51:53.856345 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:51:54.199306 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:51:54.201314 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:51:54.733680 [info ] [MainThread]: 
[0m11:51:54.735437 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m11:51:54.735437 [debug] [MainThread]: Command end result
[0m11:51:54.759459 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:51:54.762513 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:51:54.764513 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:51:54.764513 [info ] [MainThread]: 
[0m11:51:54.764513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:54.764513 [info ] [MainThread]: 
[0m11:51:54.771247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:54.771923 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:54.771923 after 6.60 seconds
[0m11:51:54.771923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB610BFFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB5F2B4DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB5F2B4200>]}
[0m11:51:54.771923 [debug] [MainThread]: Flushing usage events
[0m11:51:56.040066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:24.425498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0D433DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0D430170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0D432450>]}


============================== 11:53:24.430833 | 361b8a81-ee71-4723-a80d-ab65c613027b ==============================
[0m11:53:24.430833 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:53:24.431841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:53:24.915526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '361b8a81-ee71-4723-a80d-ab65c613027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0D430200>]}
[0m11:53:24.976892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '361b8a81-ee71-4723-a80d-ab65c613027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0E1CE570>]}
[0m11:53:24.977860 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:53:25.467190 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:53:25.620608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:25.620608 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:25.626623 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:53:25.650861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '361b8a81-ee71-4723-a80d-ab65c613027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0E1CC530>]}
[0m11:53:25.712383 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:53:25.728227 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:53:25.759867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '361b8a81-ee71-4723-a80d-ab65c613027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0F5D20C0>]}
[0m11:53:25.759867 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:53:25.759867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '361b8a81-ee71-4723-a80d-ab65c613027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0E1B3380>]}
[0m11:53:25.759867 [info ] [MainThread]: 
[0m11:53:25.759867 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:53:25.759867 [info ] [MainThread]: 
[0m11:53:25.759867 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:53:25.759867 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:53:25.868434 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:53:25.868434 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:53:25.869434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:27.222963 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.354 seconds
[0m11:53:27.224970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:53:27.238631 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:53:27.238631 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:53:27.238631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:28.179754 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.945 seconds
[0m11:53:28.179754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '361b8a81-ee71-4723-a80d-ab65c613027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0E1B2720>]}
[0m11:53:28.179754 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:53:28.179754 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:53:28.195726 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:53:28.195726 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:53:28.195726 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:53:28.195726 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:53:28.231612 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:53:28.248656 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:53:28.248656 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (-- SELECT
--     customer_id,
--     REPLACE(customername, ',', ' ') AS customer_name,
--     company
-- FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
-- WHERE customer_id IS NOT NULL



SELECT
    customer_id,
    REGEXP_REPLACE(customername, '\\(.*?\\)', '') AS customer_name,
    REPLACE(customer_name,',','') AS customer_name,
    company
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE customer_id IS NOT NULL
        );
[0m11:53:28.250163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:53:29.181013 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff1f-3201-7db6-000c-493e00019f92
[0m11:53:29.181013 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTOMER_NAME'
[0m11:53:29.181013 [debug] [Thread-1 (]: Database Error in model stg_customers (models\stage\stg_customers.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_NAME'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:53:29.196860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '361b8a81-ee71-4723-a80d-ab65c613027b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0C8D4800>]}
[0m11:53:29.198763 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_customers ............. [[31mERROR[0m in 0.99s]
[0m11:53:29.199723 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:53:29.200738 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\stage\stg_customers.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_NAME'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql.
[0m11:53:29.202762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:29.202762 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:53:29.202762 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:53:29.526212 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:53:29.526212 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:53:29.846307 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:53:29.846307 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:53:30.184612 [info ] [MainThread]: 
[0m11:53:30.185611 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m11:53:30.186578 [debug] [MainThread]: Command end result
[0m11:53:30.210195 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:53:30.212195 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:53:30.219322 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:53:30.219322 [info ] [MainThread]: 
[0m11:53:30.220350 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:53:30.221286 [info ] [MainThread]: 
[0m11:53:30.221286 [error] [MainThread]:   Database Error in model stg_customers (models\stage\stg_customers.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_NAME'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_customers.sql
[0m11:53:30.222897 [info ] [MainThread]: 
[0m11:53:30.222897 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:53:30.222897 [debug] [MainThread]: Command `dbt run` failed at 11:53:30.222897 after 5.96 seconds
[0m11:53:30.222897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0D430890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0AF12870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0C881190>]}
[0m11:53:30.222897 [debug] [MainThread]: Flushing usage events
[0m11:53:31.507833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:11.716682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D5583170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D1DDC5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D55835C0>]}


============================== 11:54:11.716682 | 3d333d2d-fae0-4ff8-8380-0132f47177e5 ==============================
[0m11:54:11.716682 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:54:11.716682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:54:12.188495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d333d2d-fae0-4ff8-8380-0132f47177e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D62596D0>]}
[0m11:54:12.252199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d333d2d-fae0-4ff8-8380-0132f47177e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D5763980>]}
[0m11:54:12.252199 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:54:12.722014 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:54:12.880690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:54:12.880690 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:54:12.880690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m11:54:12.910870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d333d2d-fae0-4ff8-8380-0132f47177e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D73DCD40>]}
[0m11:54:12.975291 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:54:12.988433 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:54:13.006166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d333d2d-fae0-4ff8-8380-0132f47177e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D763E450>]}
[0m11:54:13.006166 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m11:54:13.021888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d333d2d-fae0-4ff8-8380-0132f47177e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D5555130>]}
[0m11:54:13.021888 [info ] [MainThread]: 
[0m11:54:13.021888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:54:13.021888 [info ] [MainThread]: 
[0m11:54:13.021888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:54:13.021888 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m11:54:13.131049 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m11:54:13.132049 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m11:54:13.132049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:14.437399 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.308 seconds
[0m11:54:14.443986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m11:54:14.453266 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m11:54:14.453266 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m11:54:14.453266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:15.614089 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.161 seconds
[0m11:54:15.620434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d333d2d-fae0-4ff8-8380-0132f47177e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D77E8D10>]}
[0m11:54:15.625327 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m11:54:15.625327 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_customers ...................... [RUN]
[0m11:54:15.625327 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m11:54:15.627334 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m11:54:15.635115 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m11:54:15.635115 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m11:54:15.663551 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m11:54:15.663551 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m11:54:15.663551 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_customers
         as
        (-- SELECT
--     customer_id,
--     REPLACE(customername, ',', ' ') AS customer_name,
--     company
-- FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
-- WHERE customer_id IS NOT NULL



SELECT
    customer_id,
    REPLACE(REGEXP_REPLACE(customername, '\\(.*?\\)', ''),',','') AS customer_name,
    company
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE customer_id IS NOT NULL
        );
[0m11:54:15.663551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:54:17.041693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.372 seconds
[0m11:54:17.057719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d333d2d-fae0-4ff8-8380-0132f47177e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D2921A60>]}
[0m11:54:17.057719 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_customers ................. [[32mSUCCESS 1[0m in 1.43s]
[0m11:54:17.057719 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m11:54:17.057719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:17.057719 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m11:54:17.057719 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m11:54:17.390211 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m11:54:17.390211 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m11:54:17.721173 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m11:54:17.721173 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m11:54:18.043968 [info ] [MainThread]: 
[0m11:54:18.043968 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m11:54:18.043968 [debug] [MainThread]: Command end result
[0m11:54:18.076643 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m11:54:18.078876 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m11:54:18.087040 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m11:54:18.087040 [info ] [MainThread]: 
[0m11:54:18.088066 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:18.088066 [info ] [MainThread]: 
[0m11:54:18.089076 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:54:18.089076 [debug] [MainThread]: Command `dbt run` succeeded at 11:54:18.089076 after 6.53 seconds
[0m11:54:18.089076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D45EF620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D2712F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D7C580B0>]}
[0m11:54:18.089076 [debug] [MainThread]: Flushing usage events
[0m11:54:19.015372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:04:21.765175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FE3DF1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FE51A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FE3DF8F0>]}


============================== 12:04:21.776952 | 7e6ed2ab-7a26-4d8c-8cb0-6b787c4a09d6 ==============================
[0m12:04:21.776952 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:04:21.776952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile -m stg_churncustomers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:04:22.210807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e6ed2ab-7a26-4d8c-8cb0-6b787c4a09d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FE874170>]}
[0m12:04:22.277720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e6ed2ab-7a26-4d8c-8cb0-6b787c4a09d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FF289A00>]}
[0m12:04:22.279725 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:04:22.849687 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:04:22.999770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:04:22.999770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:04:23.016480 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:04:23.049432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e6ed2ab-7a26-4d8c-8cb0-6b787c4a09d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FF76D760>]}
[0m12:04:23.122189 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:04:23.131186 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:04:23.167000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e6ed2ab-7a26-4d8c-8cb0-6b787c4a09d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FF935EE0>]}
[0m12:04:23.167000 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:04:23.167000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e6ed2ab-7a26-4d8c-8cb0-6b787c4a09d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FF6D8F80>]}
[0m12:04:23.167000 [warn ] [MainThread]: The selection criterion 'stg_churncustomers' does not match any enabled nodes
[0m12:04:23.167000 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:04:23.167000 [debug] [MainThread]: Command end result
[0m12:04:23.190849 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:04:23.190849 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:04:23.200415 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:04:23.200415 [debug] [MainThread]: Command `dbt compile` succeeded at 12:04:23.200415 after 1.60 seconds
[0m12:04:23.200415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FBDDB7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FC63E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1FC63E810>]}
[0m12:04:23.200415 [debug] [MainThread]: Flushing usage events
[0m12:04:24.134979 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:04:59.735299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004F89A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020052A5BF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020052A59FD0>]}


============================== 12:04:59.735299 | 4bb80990-f770-44af-8f48-2ebd5b2fac1f ==============================
[0m12:04:59.735299 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:04:59.735299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile -m stg_churn_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:05:00.151471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb80990-f770-44af-8f48-2ebd5b2fac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200524BA240>]}
[0m12:05:00.218286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bb80990-f770-44af-8f48-2ebd5b2fac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020053224560>]}
[0m12:05:00.218286 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:05:00.716049 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:05:00.873331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:00.873331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:00.881097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:05:00.905861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bb80990-f770-44af-8f48-2ebd5b2fac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020053C1B320>]}
[0m12:05:00.970192 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:05:00.970192 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:05:01.002107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bb80990-f770-44af-8f48-2ebd5b2fac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200551252E0>]}
[0m12:05:01.002107 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:05:01.002107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb80990-f770-44af-8f48-2ebd5b2fac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020054D9C9E0>]}
[0m12:05:01.002107 [info ] [MainThread]: 
[0m12:05:01.002107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:05:01.002107 [info ] [MainThread]: 
[0m12:05:01.002107 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:05:01.002107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:05:04.113785 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:05:04.113785 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:05:04.113785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:05.574187 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.456 seconds
[0m12:05:05.574187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb80990-f770-44af-8f48-2ebd5b2fac1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200503B36B0>]}
[0m12:05:05.574187 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:05:05.574187 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:05:05.574187 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:05:05.588979 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:05:05.588979 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:05:05.590985 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:05:05.590985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:05.590985 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:05:05.590985 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:05:05.921460 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was properly closed.
[0m12:05:05.928193 [debug] [MainThread]: Command end result
[0m12:05:05.947245 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:05:05.949252 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:05:05.953173 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:05:05.953173 [info ] [MainThread]: Compiled node 'stg_churn_customers' is:
WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
churncustomers AS (
    SELECT
        t.customer_id,
        RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
        t.revenue
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    JOIN customers c 
        ON t.customer_id=c.customer_id
)
SELECT * from churncustomers;
[0m12:05:05.953173 [debug] [MainThread]: Command `dbt compile` succeeded at 12:05:05.953173 after 6.39 seconds
[0m12:05:05.953173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020052F378F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020052ABEEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200523DBAD0>]}
[0m12:05:05.953173 [debug] [MainThread]: Flushing usage events
[0m12:05:06.876937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:19.260883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185880A4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018587D4A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185880A43B0>]}


============================== 12:05:19.262306 | 21bc2708-3c1a-422d-9aef-29c9212a0fc1 ==============================
[0m12:05:19.262306 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:05:19.262306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_churn_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:05:19.698968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21bc2708-3c1a-422d-9aef-29c9212a0fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018589E63E90>]}
[0m12:05:19.760125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21bc2708-3c1a-422d-9aef-29c9212a0fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018587A82120>]}
[0m12:05:19.760125 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:05:20.243480 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:05:20.385802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:20.385802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:20.401538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:05:20.423307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21bc2708-3c1a-422d-9aef-29c9212a0fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018589EEB440>]}
[0m12:05:20.491240 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:05:20.491240 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:05:20.522688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21bc2708-3c1a-422d-9aef-29c9212a0fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001858A2009B0>]}
[0m12:05:20.522688 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:05:20.522688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21bc2708-3c1a-422d-9aef-29c9212a0fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018589EA3200>]}
[0m12:05:20.522688 [info ] [MainThread]: 
[0m12:05:20.522688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:05:20.522688 [info ] [MainThread]: 
[0m12:05:20.522688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:05:20.522688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:05:20.643349 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:05:20.643349 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:05:20.644347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:21.972317 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.329 seconds
[0m12:05:21.972317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:05:21.988018 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:05:21.988018 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:05:21.988018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:22.903570 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.921 seconds
[0m12:05:22.903570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21bc2708-3c1a-422d-9aef-29c9212a0fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018589E62330>]}
[0m12:05:22.903570 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:05:22.903570 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:05:22.919220 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:05:22.919220 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:05:22.919220 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:05:22.919220 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:05:22.962313 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:05:22.963313 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:05:22.964313 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
churncustomers AS (
    SELECT
        t.customer_id,
        RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
        t.revenue
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    JOIN customers c 
        ON t.customer_id=c.customer_id
)
SELECT * from churncustomers;
[0m12:05:22.964313 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:05:24.091381 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff2b-3201-7db6-000c-493e00019fd2
[0m12:05:24.091381 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 28 unexpected ';'.
[0m12:05:24.107047 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 28 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:05:24.107047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21bc2708-3c1a-422d-9aef-29c9212a0fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018587584920>]}
[0m12:05:24.107047 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 1.19s]
[0m12:05:24.107047 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:05:24.107047 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 28 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m12:05:24.107047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:24.107047 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:05:24.107047 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:05:24.448595 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:05:24.448595 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:05:24.769091 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:05:24.769091 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:05:25.108570 [info ] [MainThread]: 
[0m12:05:25.109569 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m12:05:25.110571 [debug] [MainThread]: Command end result
[0m12:05:25.133138 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:05:25.136460 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:05:25.139454 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:05:25.139454 [info ] [MainThread]: 
[0m12:05:25.139454 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:05:25.145063 [info ] [MainThread]: 
[0m12:05:25.146542 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 28 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:05:25.147522 [info ] [MainThread]: 
[0m12:05:25.147522 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:05:25.149536 [debug] [MainThread]: Command `dbt run` failed at 12:05:25.149536 after 6.05 seconds
[0m12:05:25.149536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185880A4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018587DA2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185875B8A40>]}
[0m12:05:25.150527 [debug] [MainThread]: Flushing usage events
[0m12:05:26.011856 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:09:25.218945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002875EA35160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002875EA34590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002875EA351F0>]}


============================== 12:09:25.218945 | aa2db085-889f-47b4-aaa1-112e6738203c ==============================
[0m12:09:25.218945 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:09:25.218945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_churn_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:09:25.801140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa2db085-889f-47b4-aaa1-112e6738203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002875F85C140>]}
[0m12:09:25.867865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa2db085-889f-47b4-aaa1-112e6738203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002875F800FB0>]}
[0m12:09:25.867865 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:09:26.364881 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:09:26.535306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:26.535306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:26.535306 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:09:26.570956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa2db085-889f-47b4-aaa1-112e6738203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002875F85C590>]}
[0m12:09:26.647645 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:09:26.652456 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:09:26.694412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa2db085-889f-47b4-aaa1-112e6738203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028760C82510>]}
[0m12:09:26.695419 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:09:26.695419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2db085-889f-47b4-aaa1-112e6738203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002875F543350>]}
[0m12:09:26.697416 [info ] [MainThread]: 
[0m12:09:26.698385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:26.698385 [info ] [MainThread]: 
[0m12:09:26.699385 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:26.700384 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:09:26.822336 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:09:26.823336 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:09:26.823336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:28.422639 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.600 seconds
[0m12:09:28.428829 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:09:28.438503 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:09:28.438503 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:09:28.438503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:29.384159 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.945 seconds
[0m12:09:29.386167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2db085-889f-47b4-aaa1-112e6738203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028760B602F0>]}
[0m12:09:29.395610 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:09:29.395610 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:09:29.395610 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:09:29.395610 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:09:29.395610 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:09:29.395610 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:09:29.440856 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:09:29.442825 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:09:29.442825 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (-- WITH customers AS (
--     SELECT 
--         customer_id,
--         customer_name,
--         company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- churncustomers AS (
--     SELECT
--         t.customer_id,
--         RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
--         t.revenue,
--         count(*) 
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     JOIN customers c 
--         ON t.customer_id=c.customer_id
--     WHERE DATEDIFF(payment_date,date)=1
-- )
-- SELECT * from churncustomers 

WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
churncustomers AS (
    SELECT
        t.customer_id,
        RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS rank_payment_date,
        t.revenue,
        COUNT(*) AS transaction_count
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    JOIN customers c 
        ON t.customer_id = c.customer_id
    WHERE DATEDIFF(day, t.payment_date, t.date) = 1
)
SELECT * FROM churncustomers
        );
[0m12:09:29.443822 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:09:30.413707 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff2f-3201-7d7b-000c-493e000223aa
[0m12:09:30.413707 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 39 at position 24
invalid identifier 'T.PAYMENT_DATE'
[0m12:09:30.433049 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 39 at position 24
  invalid identifier 'T.PAYMENT_DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:09:30.433049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2db085-889f-47b4-aaa1-112e6738203c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028761183C50>]}
[0m12:09:30.433049 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 1.04s]
[0m12:09:30.433049 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:09:30.433049 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 39 at position 24
  invalid identifier 'T.PAYMENT_DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m12:09:30.433049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:30.433049 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:09:30.433049 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:09:30.769744 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:09:30.770744 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:09:31.092113 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:09:31.092113 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:09:31.422641 [info ] [MainThread]: 
[0m12:09:31.422641 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m12:09:31.422641 [debug] [MainThread]: Command end result
[0m12:09:31.461869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:09:31.463902 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:09:31.470021 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:09:31.470021 [info ] [MainThread]: 
[0m12:09:31.470021 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:09:31.470021 [info ] [MainThread]: 
[0m12:09:31.470021 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 39 at position 24
  invalid identifier 'T.PAYMENT_DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:09:31.473770 [info ] [MainThread]: 
[0m12:09:31.473770 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:09:31.473770 [debug] [MainThread]: Command `dbt run` failed at 12:09:31.473770 after 6.43 seconds
[0m12:09:31.473770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002875F833A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002875EDD0F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002875E7A5EB0>]}
[0m12:09:31.473770 [debug] [MainThread]: Flushing usage events
[0m12:09:32.440438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:11.871185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225C994C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225C9951F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225C9943B0>]}


============================== 12:10:11.875276 | 2527dd81-8682-4421-8ad3-e3c73d08fdbb ==============================
[0m12:10:11.875276 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:10:11.876246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_churn_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:10:12.306012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2527dd81-8682-4421-8ad3-e3c73d08fdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225D694B00>]}
[0m12:10:12.369006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2527dd81-8682-4421-8ad3-e3c73d08fdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225BEF9EB0>]}
[0m12:10:12.370007 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:10:12.862626 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:10:13.005758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:10:13.005758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:10:13.021440 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:10:13.049813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2527dd81-8682-4421-8ad3-e3c73d08fdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225E7DC530>]}
[0m12:10:13.114421 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:10:13.114421 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:10:13.146179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2527dd81-8682-4421-8ad3-e3c73d08fdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225EB219D0>]}
[0m12:10:13.146179 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:10:13.146179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2527dd81-8682-4421-8ad3-e3c73d08fdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225E996300>]}
[0m12:10:13.146179 [info ] [MainThread]: 
[0m12:10:13.150338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:13.150338 [info ] [MainThread]: 
[0m12:10:13.150338 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:10:13.150338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:10:13.258092 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:10:13.258092 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:10:13.259092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:14.586037 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.328 seconds
[0m12:10:14.588044 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:10:14.601842 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:10:14.603849 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:10:14.603849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:15.559880 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.965 seconds
[0m12:10:15.559880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2527dd81-8682-4421-8ad3-e3c73d08fdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225F048440>]}
[0m12:10:15.577169 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:10:15.577169 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:10:15.577169 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:10:15.577169 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:10:15.577169 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:10:15.592264 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:10:15.625082 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:10:15.627084 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:10:15.627084 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (-- WITH customers AS (
--     SELECT 
--         customer_id,
--         customer_name,
--         company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- churncustomers AS (
--     SELECT
--         t.customer_id,
--         RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
--         t.revenue,
--         count(*) 
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     JOIN customers c 
--         ON t.customer_id=c.customer_id
--     WHERE DATEDIFF(payment_date,date)=1
-- )
-- SELECT * from churncustomers 

WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
churncustomers AS (
    SELECT
        t.customer_id,
        RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS rank_payment_date,
        t.revenue,
        COUNT(*) AS transaction_count
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    JOIN customers c 
        ON t.customer_id = c.customer_id
    WHERE DATEDIFF(day, rank_payment_date, t.date) = 1
)
SELECT * FROM churncustomers
        );
[0m12:10:15.628083 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:10:16.595314 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff30-3201-7d7b-000c-493e000223ae
[0m12:10:16.595314 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 39 at position 43
invalid identifier 'T.DATE'
[0m12:10:16.595314 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 39 at position 43
  invalid identifier 'T.DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:10:16.606975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2527dd81-8682-4421-8ad3-e3c73d08fdbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225F0D2570>]}
[0m12:10:16.606975 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 1.02s]
[0m12:10:16.606975 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:10:16.606975 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 39 at position 43
  invalid identifier 'T.DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m12:10:16.611020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:16.611020 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:10:16.611020 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:10:16.926998 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:10:16.926998 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:10:17.256969 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:10:17.256969 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:10:17.581964 [info ] [MainThread]: 
[0m12:10:17.581964 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m12:10:17.581964 [debug] [MainThread]: Command end result
[0m12:10:17.614544 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:10:17.619600 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:10:17.621619 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:10:17.621619 [info ] [MainThread]: 
[0m12:10:17.621619 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:10:17.621619 [info ] [MainThread]: 
[0m12:10:17.621619 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 39 at position 43
  invalid identifier 'T.DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:10:17.621619 [info ] [MainThread]: 
[0m12:10:17.621619 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:10:17.621619 [debug] [MainThread]: Command `dbt run` failed at 12:10:17.621619 after 5.93 seconds
[0m12:10:17.621619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225EA95820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225D695370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225CA04BF0>]}
[0m12:10:17.621619 [debug] [MainThread]: Flushing usage events
[0m12:10:18.500076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:31.866344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76EB50530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76EB53DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76EB50B60>]}


============================== 12:10:31.866344 | 19e30677-b316-4a47-a9a8-54c43daf362e ==============================
[0m12:10:31.866344 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:10:31.866344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:10:32.293447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19e30677-b316-4a47-a9a8-54c43daf362e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7708C9310>]}
[0m12:10:32.352852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19e30677-b316-4a47-a9a8-54c43daf362e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76E089D30>]}
[0m12:10:32.354857 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:10:32.838374 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:10:32.988906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:10:32.988906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:10:32.988906 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:10:33.019754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19e30677-b316-4a47-a9a8-54c43daf362e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F770B14A70>]}
[0m12:10:33.094102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:10:33.096107 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:10:33.115778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19e30677-b316-4a47-a9a8-54c43daf362e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F770CC12B0>]}
[0m12:10:33.115778 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:10:33.115778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19e30677-b316-4a47-a9a8-54c43daf362e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F77095C9E0>]}
[0m12:10:33.115778 [info ] [MainThread]: 
[0m12:10:33.124487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:33.124487 [info ] [MainThread]: 
[0m12:10:33.124487 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:10:33.124487 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:10:33.235457 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:10:33.235457 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:10:33.235457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:34.670330 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.436 seconds
[0m12:10:34.672337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:10:34.686335 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:10:34.686335 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:10:34.686335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:35.578651 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.901 seconds
[0m12:10:35.578651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19e30677-b316-4a47-a9a8-54c43daf362e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7711D81D0>]}
[0m12:10:35.594664 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:10:35.594664 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:10:35.594664 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:10:35.594664 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:10:35.594664 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:10:35.594664 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:10:35.644041 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:10:35.646008 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:10:35.646008 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (-- WITH customers AS (
--     SELECT 
--         customer_id,
--         customer_name,
--         company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- churncustomers AS (
--     SELECT
--         t.customer_id,
--         RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
--         t.revenue,
--         count(*) 
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     JOIN customers c 
--         ON t.customer_id=c.customer_id
--     WHERE DATEDIFF(payment_date,date)=1
-- )
-- SELECT * from churncustomers 

WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
churncustomers AS (
    SELECT
        t.customer_id,
        RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS rank_payment_date,
        t.revenue,
        COUNT(*) AS transaction_count
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    JOIN customers c 
        ON t.customer_id = c.customer_id
    WHERE DATEDIFF(day, rank_payment_date) = 1
)
SELECT * FROM churncustomers
        );
[0m12:10:35.647010 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:10:36.566449 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff30-3201-7e57-000c-493e0001ef22
[0m12:10:36.566449 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000938 (22023): SQL compilation error: error line 39 at position 10
not enough arguments for function [DATEDIFF('DAY', RANK_PAYMENT_DATE)], expected 3, got 2
[0m12:10:36.566449 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000938 (22023): SQL compilation error: error line 39 at position 10
  not enough arguments for function [DATEDIFF('DAY', RANK_PAYMENT_DATE)], expected 3, got 2
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:10:36.566449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19e30677-b316-4a47-a9a8-54c43daf362e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F77127A3C0>]}
[0m12:10:36.566449 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 0.97s]
[0m12:10:36.566449 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:10:36.582128 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000938 (22023): SQL compilation error: error line 39 at position 10
  not enough arguments for function [DATEDIFF('DAY', RANK_PAYMENT_DATE)], expected 3, got 2
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m12:10:36.582128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:36.582128 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:10:36.582128 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:10:36.896831 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:10:36.896831 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:10:37.234213 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:10:37.234213 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:10:37.554553 [info ] [MainThread]: 
[0m12:10:37.554553 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m12:10:37.554553 [debug] [MainThread]: Command end result
[0m12:10:37.583443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:10:37.583443 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:10:37.589417 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:10:37.589417 [info ] [MainThread]: 
[0m12:10:37.596958 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:10:37.608111 [info ] [MainThread]: 
[0m12:10:37.624747 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000938 (22023): SQL compilation error: error line 39 at position 10
  not enough arguments for function [DATEDIFF('DAY', RANK_PAYMENT_DATE)], expected 3, got 2
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:10:37.624747 [info ] [MainThread]: 
[0m12:10:37.624747 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:10:37.632949 [debug] [MainThread]: Command `dbt run` failed at 12:10:37.632949 after 5.93 seconds
[0m12:10:37.632949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76E9EF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76AF51280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76F7ECBF0>]}
[0m12:10:37.632949 [debug] [MainThread]: Flushing usage events
[0m12:10:38.503524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:58.989672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E259C7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E259C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E259C3B0>]}


============================== 12:10:58.995004 | ba87c7fe-38ed-4f51-b34c-cb5c05b49e4e ==============================
[0m12:10:58.995004 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:10:58.995004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:10:59.512754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba87c7fe-38ed-4f51-b34c-cb5c05b49e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E2574A40>]}
[0m12:10:59.588059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba87c7fe-38ed-4f51-b34c-cb5c05b49e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3DF9A73E0>]}
[0m12:10:59.590065 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:11:00.175478 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:11:00.360876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:00.360876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:00.362007 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:11:00.397077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba87c7fe-38ed-4f51-b34c-cb5c05b49e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E43246B0>]}
[0m12:11:00.478765 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:11:00.478765 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:11:00.514576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba87c7fe-38ed-4f51-b34c-cb5c05b49e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E46F2450>]}
[0m12:11:00.514576 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:11:00.514576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba87c7fe-38ed-4f51-b34c-cb5c05b49e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E438FEC0>]}
[0m12:11:00.514576 [info ] [MainThread]: 
[0m12:11:00.519099 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:00.519099 [info ] [MainThread]: 
[0m12:11:00.519099 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:11:00.519099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:11:00.757433 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:11:00.758433 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:11:00.758433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:02.403223 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.645 seconds
[0m12:11:02.410600 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:11:02.420749 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:11:02.420749 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:11:02.421912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:03.354204 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.932 seconds
[0m12:11:03.357349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba87c7fe-38ed-4f51-b34c-cb5c05b49e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E4363290>]}
[0m12:11:03.361456 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:11:03.361456 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:11:03.362456 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:11:03.363555 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:11:03.371642 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:11:03.372641 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:11:03.404852 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:11:03.407013 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:11:03.407013 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (-- WITH customers AS (
--     SELECT 
--         customer_id,
--         customer_name,
--         company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- churncustomers AS (
--     SELECT
--         t.customer_id,
--         RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
--         t.revenue,
--         count(*) 
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     JOIN customers c 
--         ON t.customer_id=c.customer_id
--     WHERE DATEDIFF(payment_date,date)=1
-- )
-- SELECT * from churncustomers 

WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
churncustomers AS (
    SELECT
        t.customer_id,
        RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS rank_payment_date,
        t.revenue,
        COUNT(*) AS transaction_count
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    JOIN customers c 
        ON t.customer_id = c.customer_id
    WHERE DATEDIFF(day, rank_payment_date,t.payment_month) = 1
)
SELECT * FROM churncustomers
        );
[0m12:11:03.408016 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:11:04.333346 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff31-3201-7e57-000c-493e0001ef2a
[0m12:11:04.334371 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 39 at position 10
Invalid argument types for function 'DATE_DIFFDATEINDAYS': (NUMBER(18,0), DATE)
[0m12:11:04.337370 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001044 (42P13): SQL compilation error: error line 39 at position 10
  Invalid argument types for function 'DATE_DIFFDATEINDAYS': (NUMBER(18,0), DATE)
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:11:04.339574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba87c7fe-38ed-4f51-b34c-cb5c05b49e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E4C42570>]}
[0m12:11:04.340573 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 0.98s]
[0m12:11:04.341573 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:11:04.342572 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001044 (42P13): SQL compilation error: error line 39 at position 10
  Invalid argument types for function 'DATE_DIFFDATEINDAYS': (NUMBER(18,0), DATE)
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m12:11:04.344761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:04.344761 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:11:04.344761 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:11:04.670112 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:11:04.671102 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:11:05.009667 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:11:05.010666 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:11:05.329726 [info ] [MainThread]: 
[0m12:11:05.329726 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m12:11:05.330727 [debug] [MainThread]: Command end result
[0m12:11:05.353862 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:11:05.357866 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:11:05.367167 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:11:05.368169 [info ] [MainThread]: 
[0m12:11:05.371173 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:11:05.372163 [info ] [MainThread]: 
[0m12:11:05.372163 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001044 (42P13): SQL compilation error: error line 39 at position 10
  Invalid argument types for function 'DATE_DIFFDATEINDAYS': (NUMBER(18,0), DATE)
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:11:05.373164 [info ] [MainThread]: 
[0m12:11:05.374163 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:11:05.375164 [debug] [MainThread]: Command `dbt run` failed at 12:11:05.375164 after 6.55 seconds
[0m12:11:05.376165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E20ABE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E2116210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3E2440770>]}
[0m12:11:05.376165 [debug] [MainThread]: Flushing usage events
[0m12:11:06.309854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:57.696579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028965160860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028962859400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289647977D0>]}


============================== 12:11:57.696579 | 0807cf07-8b26-49ec-8c73-4a9a076ca150 ==============================
[0m12:11:57.696579 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:11:57.705784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_churn_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:11:58.646620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0807cf07-8b26-49ec-8c73-4a9a076ca150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289651639E0>]}
[0m12:11:58.718853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0807cf07-8b26-49ec-8c73-4a9a076ca150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028964BE3FE0>]}
[0m12:11:58.718853 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:11:59.323140 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:11:59.480765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:59.480765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:59.488780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:11:59.519596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0807cf07-8b26-49ec-8c73-4a9a076ca150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002896703AA80>]}
[0m12:11:59.589361 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:11:59.603808 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:11:59.619496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0807cf07-8b26-49ec-8c73-4a9a076ca150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028967351AF0>]}
[0m12:11:59.635471 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:11:59.635471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0807cf07-8b26-49ec-8c73-4a9a076ca150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028966F2EC00>]}
[0m12:11:59.635471 [info ] [MainThread]: 
[0m12:11:59.635471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:59.635471 [info ] [MainThread]: 
[0m12:11:59.635471 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:11:59.635471 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:12:02.836383 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:12:02.840207 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:12:02.840207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:04.206609 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.366 seconds
[0m12:12:04.209022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:12:04.221964 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:12:04.221964 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:12:04.221964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:05.137955 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.914 seconds
[0m12:12:05.144962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0807cf07-8b26-49ec-8c73-4a9a076ca150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028967191640>]}
[0m12:12:05.154017 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:12:05.154967 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:12:05.156968 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:12:05.158009 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:12:05.177471 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:12:05.179302 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:12:05.212567 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:12:05.214569 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:12:05.214569 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (-- WITH customers AS (
--     SELECT 
--         customer_id,
--         customer_name,
--         company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- churncustomers AS (
--     SELECT
--         t.customer_id,
--         RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
--         t.revenue,
--         count(*) 
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     JOIN customers c 
--         ON t.customer_id=c.customer_id
--     WHERE DATEDIFF(payment_date,date)=1
-- )
-- SELECT * from churncustomers 


WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_date) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) = 1
)
SELECT 
    COUNT(*) AS number_of_churned_customers
FROM churned_customers;
[0m12:12:05.215601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:12:06.258637 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff32-3201-7db6-000c-493e00019ff6
[0m12:12:06.258637 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 51 at position 22 unexpected ';'.
[0m12:12:06.274412 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 22 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:12:06.290138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0807cf07-8b26-49ec-8c73-4a9a076ca150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289678F2570>]}
[0m12:12:06.290138 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 1.12s]
[0m12:12:06.290138 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:12:06.290138 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 22 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m12:12:06.290138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:06.290138 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:12:06.290138 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:12:06.620067 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:12:06.620067 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:12:06.954312 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:12:06.954312 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:12:07.264989 [info ] [MainThread]: 
[0m12:12:07.264989 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m12:12:07.264989 [debug] [MainThread]: Command end result
[0m12:12:07.300948 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:12:07.304754 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:12:07.311630 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:12:07.312640 [info ] [MainThread]: 
[0m12:12:07.313639 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:12:07.314649 [info ] [MainThread]: 
[0m12:12:07.314649 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 22 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:12:07.315643 [info ] [MainThread]: 
[0m12:12:07.315643 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:12:07.317342 [debug] [MainThread]: Command `dbt run` failed at 12:12:07.317342 after 9.79 seconds
[0m12:12:07.317342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289645E2C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289645E04A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289645E1520>]}
[0m12:12:07.317342 [debug] [MainThread]: Flushing usage events
[0m12:12:08.211313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:17.088360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E371A60800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E371A61130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E371A613A0>]}


============================== 12:12:17.093398 | bc95cee1-3f53-43a8-b7fa-266a6d1843f3 ==============================
[0m12:12:17.093398 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:12:17.094418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_churn_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:12:17.569798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc95cee1-3f53-43a8-b7fa-266a6d1843f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3737876E0>]}
[0m12:12:17.642534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc95cee1-3f53-43a8-b7fa-266a6d1843f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3727639B0>]}
[0m12:12:17.642534 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:12:18.118862 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:12:18.266499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:18.266499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:18.282310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:12:18.306851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc95cee1-3f53-43a8-b7fa-266a6d1843f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E373868440>]}
[0m12:12:18.373339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:12:18.389149 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:12:18.420536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc95cee1-3f53-43a8-b7fa-266a6d1843f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E373B81A90>]}
[0m12:12:18.420536 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:12:18.420536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc95cee1-3f53-43a8-b7fa-266a6d1843f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E373BA7710>]}
[0m12:12:18.420536 [info ] [MainThread]: 
[0m12:12:18.420536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:12:18.420536 [info ] [MainThread]: 
[0m12:12:18.420536 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:12:18.420536 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:12:18.538118 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:12:18.539116 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:12:18.539116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:20.017065 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.478 seconds
[0m12:12:20.026712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:12:20.058520 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:12:20.058520 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:12:20.074610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:21.146526 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.072 seconds
[0m12:12:21.149044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc95cee1-3f53-43a8-b7fa-266a6d1843f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E373A025D0>]}
[0m12:12:21.149044 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:12:21.149044 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:12:21.149044 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:12:21.149044 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:12:21.164773 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:12:21.166799 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:12:21.198155 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:12:21.200187 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:12:21.200187 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (-- WITH customers AS (
--     SELECT 
--         customer_id,
--         customer_name,
--         company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- churncustomers AS (
--     SELECT
--         t.customer_id,
--         RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
--         t.revenue,
--         count(*) 
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     JOIN customers c 
--         ON t.customer_id=c.customer_id
--     WHERE DATEDIFF(payment_date,date)=1
-- )
-- SELECT * from churncustomers 


WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_date) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) = 1
)
SELECT 
    COUNT(*) AS number_of_churned_customers
FROM churned_customers
        );
[0m12:12:21.201189 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:12:22.298416 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff32-3201-7e57-000c-493e0001ef32
[0m12:12:22.314583 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 34 at position 12
invalid identifier 'PAYMENT_DATE'
[0m12:12:22.314583 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 34 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:12:22.314583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc95cee1-3f53-43a8-b7fa-266a6d1843f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E370F04380>]}
[0m12:12:22.314583 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 1.17s]
[0m12:12:22.314583 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:12:22.314583 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 34 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m12:12:22.314583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:22.314583 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:12:22.314583 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:12:22.673163 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:12:22.673163 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:12:23.007772 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:12:23.007772 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:12:23.345509 [info ] [MainThread]: 
[0m12:12:23.345509 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m12:12:23.345509 [debug] [MainThread]: Command end result
[0m12:12:23.382896 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:12:23.386590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:12:23.389623 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:12:23.389623 [info ] [MainThread]: 
[0m12:12:23.394265 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:12:23.395274 [info ] [MainThread]: 
[0m12:12:23.396276 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 34 at position 12
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:12:23.397273 [info ] [MainThread]: 
[0m12:12:23.397273 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:12:23.399275 [debug] [MainThread]: Command `dbt run` failed at 12:12:23.398274 after 6.47 seconds
[0m12:12:23.399884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3718939E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E36F7166F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37136B5F0>]}
[0m12:12:23.399884 [debug] [MainThread]: Flushing usage events
[0m12:12:24.302169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:13:00.574233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C6C0DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C992F8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C992E630>]}


============================== 12:13:00.578254 | 0305bc28-291f-402f-98bb-39c848a9285e ==============================
[0m12:13:00.578254 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:13:00.578254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:13:01.074645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0305bc28-291f-402f-98bb-39c848a9285e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CAE644D0>]}
[0m12:13:01.132211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0305bc28-291f-402f-98bb-39c848a9285e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C96010D0>]}
[0m12:13:01.147892 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:13:01.615670 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:13:01.775541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:13:01.775541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:13:01.775541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:13:01.815909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0305bc28-291f-402f-98bb-39c848a9285e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CBFCB440>]}
[0m12:13:01.882511 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:13:01.886525 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:13:01.914236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0305bc28-291f-402f-98bb-39c848a9285e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CC2E1B20>]}
[0m12:13:01.914236 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:13:01.914236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0305bc28-291f-402f-98bb-39c848a9285e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C9BEFEC0>]}
[0m12:13:01.914236 [info ] [MainThread]: 
[0m12:13:01.914236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:13:01.914236 [info ] [MainThread]: 
[0m12:13:01.914236 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:13:01.914236 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:13:02.033327 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:13:02.033327 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:13:02.033327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:03.369178 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.335 seconds
[0m12:13:03.371188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:13:03.385261 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:13:03.385261 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:13:03.386261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:04.372409 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.988 seconds
[0m12:13:04.372409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0305bc28-291f-402f-98bb-39c848a9285e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CAD04E30>]}
[0m12:13:04.372409 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:13:04.372409 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:13:04.383947 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:13:04.383947 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:13:04.388330 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:13:04.388330 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:13:04.420213 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:13:04.420213 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:13:04.420213 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (-- WITH customers AS (
--     SELECT 
--         customer_id,
--         customer_name,
--         company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- churncustomers AS (
--     SELECT
--         t.customer_id,
--         RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
--         t.revenue,
--         count(*) 
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     JOIN customers c 
--         ON t.customer_id=c.customer_id
--     WHERE DATEDIFF(payment_date,date)=1
-- )
-- SELECT * from churncustomers 


WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) = 1
)
SELECT 
    COUNT(*) AS number_of_churned_customers
FROM churned_customers
        );
[0m12:13:04.420213 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:13:06.354469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.929 seconds
[0m12:13:06.370136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0305bc28-291f-402f-98bb-39c848a9285e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C7551A60>]}
[0m12:13:06.370136 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.99s]
[0m12:13:06.370136 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:13:06.370136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:06.370136 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:13:06.370136 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:13:06.696432 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:13:06.696432 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:13:07.317938 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:13:07.319942 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:13:07.641239 [info ] [MainThread]: 
[0m12:13:07.641239 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m12:13:07.642239 [debug] [MainThread]: Command end result
[0m12:13:07.660821 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:13:07.660821 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:13:07.672711 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:13:07.673158 [info ] [MainThread]: 
[0m12:13:07.674187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:13:07.674187 [info ] [MainThread]: 
[0m12:13:07.675646 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:13:07.676380 [debug] [MainThread]: Command `dbt run` succeeded at 12:13:07.676380 after 7.27 seconds
[0m12:13:07.676380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CC129580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CAE64F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8CBF433E0>]}
[0m12:13:07.677455 [debug] [MainThread]: Flushing usage events
[0m12:13:09.199066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:13.118603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79D404B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79D404BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79D404A70>]}


============================== 12:14:13.127731 | 0e0e40e2-ddca-480d-9a8e-6d00ee5bb26d ==============================
[0m12:14:13.127731 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:14:13.127731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:14:13.607149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e0e40e2-ddca-480d-9a8e-6d00ee5bb26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79DF91370>]}
[0m12:14:13.666612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e0e40e2-ddca-480d-9a8e-6d00ee5bb26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79B1CE630>]}
[0m12:14:13.666612 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:14:14.153420 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:14:14.310263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:14:14.310263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:14:14.310263 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:14:14.339627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e0e40e2-ddca-480d-9a8e-6d00ee5bb26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79E192EA0>]}
[0m12:14:14.417664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:14:14.420316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:14:14.448977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e0e40e2-ddca-480d-9a8e-6d00ee5bb26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79F5B2780>]}
[0m12:14:14.450986 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:14:14.450986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e0e40e2-ddca-480d-9a8e-6d00ee5bb26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79F24D7C0>]}
[0m12:14:14.451993 [info ] [MainThread]: 
[0m12:14:14.451993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:14:14.451993 [info ] [MainThread]: 
[0m12:14:14.451993 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:14:14.451993 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:14:14.563092 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:14:14.563092 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:14:14.564092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:15.895389 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.345 seconds
[0m12:14:15.918113 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:14:15.927285 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:14:15.927285 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:14:15.927285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:16.855120 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.926 seconds
[0m12:14:16.855120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e0e40e2-ddca-480d-9a8e-6d00ee5bb26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79F4C0920>]}
[0m12:14:16.855120 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:14:16.855120 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:14:16.855120 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:14:16.855120 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:14:16.874595 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:14:16.875695 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:14:16.891300 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:14:16.908329 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:14:16.909323 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (-- WITH customers AS (
--     SELECT 
--         customer_id,
--         customer_name,
--         company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- churncustomers AS (
--     SELECT
--         t.customer_id,
--         RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
--         t.revenue,
--         count(*) 
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     JOIN customers c 
--         ON t.customer_id=c.customer_id
--     WHERE DATEDIFF(payment_date,date)=1
-- )
-- SELECT * from churncustomers 


WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) = 1
)
SELECT 
    * ,COUNT(*) AS number_of_churned_customers
FROM churned_customers
        );
[0m12:14:16.909323 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:14:18.034391 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff34-3201-7e57-000c-493e0001efa6
[0m12:14:18.034391 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[CHURNED_CUSTOMERS.CUSTOMER_ID] is not a valid group by expression
[0m12:14:18.034391 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000979 (42601): SQL compilation error:
  [CHURNED_CUSTOMERS.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:14:18.034391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0e40e2-ddca-480d-9a8e-6d00ee5bb26d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79FB445C0>]}
[0m12:14:18.034391 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 1.18s]
[0m12:14:18.034391 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:14:18.034391 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000979 (42601): SQL compilation error:
  [CHURNED_CUSTOMERS.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m12:14:18.050112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:18.050112 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:14:18.050112 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:14:18.391874 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:14:18.391874 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:14:18.746829 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:14:18.746829 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:14:19.069512 [info ] [MainThread]: 
[0m12:14:19.069512 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m12:14:19.069512 [debug] [MainThread]: Command end result
[0m12:14:19.101368 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:14:19.101368 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:14:19.110192 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:14:19.110192 [info ] [MainThread]: 
[0m12:14:19.110192 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:14:19.110192 [info ] [MainThread]: 
[0m12:14:19.110192 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000979 (42601): SQL compilation error:
  [CHURNED_CUSTOMERS.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:14:19.110192 [info ] [MainThread]: 
[0m12:14:19.110192 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:14:19.110192 [debug] [MainThread]: Command `dbt run` failed at 12:14:19.110192 after 6.16 seconds
[0m12:14:19.110192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79F1E7FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79F186090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79F185310>]}
[0m12:14:19.110192 [debug] [MainThread]: Flushing usage events
[0m12:14:20.332841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:57.729520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5E8BC0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5E6A76780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5E8BC1100>]}


============================== 12:14:57.745428 | 6b940007-d502-4cbd-b638-6d7b539f6c29 ==============================
[0m12:14:57.745428 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:14:57.745428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:14:58.231697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b940007-d502-4cbd-b638-6d7b539f6c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5E9B19790>]}
[0m12:14:58.294229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b940007-d502-4cbd-b638-6d7b539f6c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5E8EA79B0>]}
[0m12:14:58.294229 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:14:58.769753 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:14:58.908845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:14:58.908845 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:14:58.908845 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:14:58.988866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b940007-d502-4cbd-b638-6d7b539f6c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5EACFE9C0>]}
[0m12:14:59.047379 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:14:59.063144 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:14:59.094992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b940007-d502-4cbd-b638-6d7b539f6c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5EB021D00>]}
[0m12:14:59.097001 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:14:59.097001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b940007-d502-4cbd-b638-6d7b539f6c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5E8EF3770>]}
[0m12:14:59.099008 [info ] [MainThread]: 
[0m12:14:59.099008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:14:59.099008 [info ] [MainThread]: 
[0m12:14:59.099008 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:14:59.099008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:14:59.211239 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:14:59.211239 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:14:59.211239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:00.528918 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.318 seconds
[0m12:15:00.544706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:15:00.566162 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:15:00.566162 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:15:00.566162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:01.532552 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.978 seconds
[0m12:15:01.548442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b940007-d502-4cbd-b638-6d7b539f6c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5EB340440>]}
[0m12:15:01.548442 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:15:01.548442 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:15:01.548442 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:15:01.548442 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:15:01.548442 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:15:01.548442 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:15:01.585868 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:15:01.585868 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:15:01.585868 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (-- WITH customers AS (
--     SELECT 
--         customer_id,
--         customer_name,
--         company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- churncustomers AS (
--     SELECT
--         t.customer_id,
--         RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
--         t.revenue,
--         count(*) 
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     JOIN customers c 
--         ON t.customer_id=c.customer_id
--     WHERE DATEDIFF(payment_date,date)=1
-- )
-- SELECT * from churncustomers 


WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) = 1
)
SELECT 
    * 
    -- , COUNT(*) AS number_of_churned_customers
FROM churned_customers
        );
[0m12:15:01.585868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:15:02.730013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.137 seconds
[0m12:15:02.745810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b940007-d502-4cbd-b638-6d7b539f6c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5E62919A0>]}
[0m12:15:02.745810 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.20s]
[0m12:15:02.761458 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:15:02.761458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:02.761458 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:15:02.761458 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:15:03.100203 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:15:03.100203 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:15:03.437455 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:15:03.437455 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:15:03.763117 [info ] [MainThread]: 
[0m12:15:03.765034 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m12:15:03.765034 [debug] [MainThread]: Command end result
[0m12:15:03.788946 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:15:03.790932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:15:03.794442 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:15:03.794442 [info ] [MainThread]: 
[0m12:15:03.794442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:03.794442 [info ] [MainThread]: 
[0m12:15:03.794442 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:15:03.794442 [debug] [MainThread]: Command `dbt run` succeeded at 12:15:03.794442 after 6.22 seconds
[0m12:15:03.794442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5E9AF4BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5EB037890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F5E98F3350>]}
[0m12:15:03.794442 [debug] [MainThread]: Flushing usage events
[0m12:15:04.686203 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:05.676488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD8531520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD85304A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD85303E0>]}


============================== 12:16:05.682523 | 23d221fb-f0c3-4ad1-a3f7-c7d715cb685b ==============================
[0m12:16:05.682523 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:16:05.682523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_churn_customers', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:16:06.186360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23d221fb-f0c3-4ad1-a3f7-c7d715cb685b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD9159790>]}
[0m12:16:06.242090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23d221fb-f0c3-4ad1-a3f7-c7d715cb685b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD4F89100>]}
[0m12:16:06.242090 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:16:06.718650 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:16:06.865568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:06.865568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:06.865568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:16:06.904100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23d221fb-f0c3-4ad1-a3f7-c7d715cb685b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FDA33BB90>]}
[0m12:16:06.967490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:16:06.967490 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:16:07.009406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23d221fb-f0c3-4ad1-a3f7-c7d715cb685b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FDA651C40>]}
[0m12:16:07.009406 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:16:07.009406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23d221fb-f0c3-4ad1-a3f7-c7d715cb685b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD7A0AF60>]}
[0m12:16:07.009406 [info ] [MainThread]: 
[0m12:16:07.013686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:07.014691 [info ] [MainThread]: 
[0m12:16:07.014691 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:07.016701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:16:07.120822 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:16:07.120822 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:16:07.121822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:08.451723 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.330 seconds
[0m12:16:08.452842 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:16:08.452842 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:16:08.468775 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:16:08.468775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:09.460148 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.997 seconds
[0m12:16:09.460148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23d221fb-f0c3-4ad1-a3f7-c7d715cb685b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FDAC139E0>]}
[0m12:16:09.460148 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:16:09.460148 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:16:09.460148 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:16:09.475868 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:16:09.476971 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:16:09.476971 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:16:09.504714 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:16:09.519372 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:16:09.520424 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (-- WITH customers AS (
--     SELECT 
--         customer_id,
--         customer_name,
--         company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- churncustomers AS (
--     SELECT
--         t.customer_id,
--         RANK() OVER(PARTITION BY t.customer_id ORDER BY t.payment_month) AS payment_date,
--         t.revenue,
--         count(*) 
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     JOIN customers c 
--         ON t.customer_id=c.customer_id
--     WHERE DATEDIFF(payment_date,date)=1
-- )
-- SELECT * from churncustomers 


WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    -- WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) = 1
)
SELECT 
    * 
    -- , COUNT(*) AS number_of_churned_customers
FROM churned_customers
        );
[0m12:16:09.521410 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:16:11.094639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.574 seconds
[0m12:16:11.105346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23d221fb-f0c3-4ad1-a3f7-c7d715cb685b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD58D1B80>]}
[0m12:16:11.105346 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.65s]
[0m12:16:11.105346 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:16:11.121264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:11.121264 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:16:11.121264 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:16:11.447191 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:16:11.447191 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:16:11.765400 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:16:11.765400 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:16:12.093217 [info ] [MainThread]: 
[0m12:16:12.093217 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.08 seconds (5.08s).
[0m12:16:12.093217 [debug] [MainThread]: Command end result
[0m12:16:12.122673 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:16:12.122673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:16:12.122673 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:16:12.122673 [info ] [MainThread]: 
[0m12:16:12.138047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:12.139332 [info ] [MainThread]: 
[0m12:16:12.139332 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:16:12.139332 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:12.139332 after 6.63 seconds
[0m12:16:12.139332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD7C8D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD83CF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD5C7FC80>]}
[0m12:16:12.139332 [debug] [MainThread]: Flushing usage events
[0m12:16:13.365368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:41.287164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDE5E4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDE5E4FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDE5E4830>]}


============================== 12:25:41.303075 | 91a709c9-b3ee-4e83-8f06-d4ae6e6ec3d6 ==============================
[0m12:25:41.303075 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:25:41.305086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile -m stg_new_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:41.774681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91a709c9-b3ee-4e83-8f06-d4ae6e6ec3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDF342870>]}
[0m12:25:41.850521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91a709c9-b3ee-4e83-8f06-d4ae6e6ec3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDE289EE0>]}
[0m12:25:41.852524 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:25:42.348030 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:25:42.500505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:42.500505 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:42.500505 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:25:42.539789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91a709c9-b3ee-4e83-8f06-d4ae6e6ec3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE03FEEA0>]}
[0m12:25:42.606509 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:25:42.611409 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:25:42.637744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91a709c9-b3ee-4e83-8f06-d4ae6e6ec3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE0628B90>]}
[0m12:25:42.637744 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:25:42.637744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a709c9-b3ee-4e83-8f06-d4ae6e6ec3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDDA60F80>]}
[0m12:25:42.637744 [info ] [MainThread]: 
[0m12:25:42.637744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:42.637744 [info ] [MainThread]: 
[0m12:25:42.637744 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:25:42.649159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:25:42.757206 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:25:42.757206 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:25:42.757206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:44.272083 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.512 seconds
[0m12:25:44.280419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a709c9-b3ee-4e83-8f06-d4ae6e6ec3d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE05B28D0>]}
[0m12:25:44.280419 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m12:25:44.280419 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m12:25:44.280419 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m12:25:44.287726 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m12:25:44.287726 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m12:25:44.287726 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m12:25:44.287726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:44.287726 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:25:44.287726 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:25:44.612244 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was properly closed.
[0m12:25:44.612244 [debug] [MainThread]: Command end result
[0m12:25:44.639228 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:25:44.643742 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:25:44.643742 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:25:44.643742 [info ] [MainThread]: Compiled node 'stg_new_customers' is:
SELECT 
    customer_id,
    MIN(payment_month) AS first_purchase_date,
    DATE_TRUNC('month',MIN(payment_month)) AS first_purchase_month,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions GROUP BY customer_id
[0m12:25:44.643742 [debug] [MainThread]: Command `dbt compile` succeeded at 12:25:44.643742 after 3.54 seconds
[0m12:25:44.643742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE036A300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE0368EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE0BCB740>]}
[0m12:25:44.643742 [debug] [MainThread]: Flushing usage events
[0m12:25:45.880430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:01.291356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27A8FD4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27A66A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27A8FC350>]}


============================== 12:26:01.299394 | ef1b4320-dc03-4c6c-81ae-34d0e8ba3d2f ==============================
[0m12:26:01.299394 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:26:01.299394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_new_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:26:01.787443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef1b4320-dc03-4c6c-81ae-34d0e8ba3d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E277CA2BA0>]}
[0m12:26:01.853568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef1b4320-dc03-4c6c-81ae-34d0e8ba3d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27B5DCA40>]}
[0m12:26:01.853568 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:26:02.334949 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:26:02.493518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:26:02.493518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:26:02.493518 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:26:02.530733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef1b4320-dc03-4c6c-81ae-34d0e8ba3d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27A7CAB70>]}
[0m12:26:02.601182 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:26:02.605196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:26:02.624300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef1b4320-dc03-4c6c-81ae-34d0e8ba3d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27CAB6630>]}
[0m12:26:02.624300 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:26:02.624300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef1b4320-dc03-4c6c-81ae-34d0e8ba3d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27C8DB890>]}
[0m12:26:02.624300 [info ] [MainThread]: 
[0m12:26:02.624300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:02.624300 [info ] [MainThread]: 
[0m12:26:02.624300 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:26:02.639967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:26:02.744579 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:26:02.745575 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:26:02.745575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:04.205948 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.467 seconds
[0m12:26:04.215409 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:26:04.221982 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:26:04.221982 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:26:04.221982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:05.202481 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.987 seconds
[0m12:26:05.218935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef1b4320-dc03-4c6c-81ae-34d0e8ba3d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27CAAC860>]}
[0m12:26:05.218935 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m12:26:05.218935 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_new_customers .................. [RUN]
[0m12:26:05.218935 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m12:26:05.218935 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m12:26:05.218935 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m12:26:05.235073 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m12:26:05.262950 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_new_customers"
[0m12:26:05.262950 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_new_customers"
[0m12:26:05.262950 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_new_customers
         as
        (SELECT 
    customer_id,
    MIN(payment_month) AS first_purchase_date,
    DATE_TRUNC('month',MIN(payment_month)) AS first_purchase_month,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions GROUP BY customer_id
        );
[0m12:26:05.262950 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:26:06.645555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.390 seconds
[0m12:26:06.693607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef1b4320-dc03-4c6c-81ae-34d0e8ba3d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E277CA1B50>]}
[0m12:26:06.693607 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_new_customers ............. [[32mSUCCESS 1[0m in 1.47s]
[0m12:26:06.693607 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m12:26:06.693607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:06.693607 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:26:06.693607 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:26:07.028278 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:26:07.028278 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:26:07.348863 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was left open.
[0m12:26:07.348863 [debug] [MainThread]: On model.CRB_PROJECT.stg_new_customers: Close
[0m12:26:07.683100 [info ] [MainThread]: 
[0m12:26:07.683100 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m12:26:07.683100 [debug] [MainThread]: Command end result
[0m12:26:07.734488 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:26:07.736522 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:26:07.738233 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:26:07.738233 [info ] [MainThread]: 
[0m12:26:07.738233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:07.738233 [info ] [MainThread]: 
[0m12:26:07.738233 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:26:07.738233 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:07.738233 after 6.61 seconds
[0m12:26:07.738233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27A05C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27A40AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E279779A00>]}
[0m12:26:07.738233 [debug] [MainThread]: Flushing usage events
[0m12:26:08.665731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:02.756055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A13E7CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A13E7B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A13E7A70>]}


============================== 12:29:02.771785 | b1f6c51c-1a51-4616-8f62-08fe150bdda0 ==============================
[0m12:29:02.771785 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:29:02.771785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_new_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:03.665410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1f6c51c-1a51-4616-8f62-08fe150bdda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A217FB30>]}
[0m12:29:03.728601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1f6c51c-1a51-4616-8f62-08fe150bdda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A144B170>]}
[0m12:29:03.728601 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:29:04.316623 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:29:04.453069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:04.453069 [debug] [MainThread]: Partial parsing: updated file: CRB_PROJECT://models\stage\stg_new_customers.sql
[0m12:29:04.654182 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.CRB_PROJECT.stg_new_customers' (models\stage\stg_new_customers.sql) depends on a node named 'transactions' which was not found
[0m12:29:04.654182 [debug] [MainThread]: Command `dbt run` failed at 12:29:04.654182 after 2.06 seconds
[0m12:29:04.654182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A0F6FB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A0F6FBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A21B3080>]}
[0m12:29:04.654182 [debug] [MainThread]: Flushing usage events
[0m12:29:05.933498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:25.224660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221425A4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221425A4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221425A4410>]}


============================== 12:29:25.224660 | 379e78ec-e473-4b95-b170-d664e2c96224 ==============================
[0m12:29:25.224660 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:29:25.224660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_new_customers', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:29:25.709829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '379e78ec-e473-4b95-b170-d664e2c96224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022143391850>]}
[0m12:29:25.759488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '379e78ec-e473-4b95-b170-d664e2c96224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141D075F0>]}
[0m12:29:25.759488 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:29:26.243339 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:29:26.397088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:26.398086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:26.404089 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:29:26.432308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '379e78ec-e473-4b95-b170-d664e2c96224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002214349AF60>]}
[0m12:29:26.512432 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:29:26.528423 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:29:26.560405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '379e78ec-e473-4b95-b170-d664e2c96224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002214461F950>]}
[0m12:29:26.560405 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:29:26.560405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '379e78ec-e473-4b95-b170-d664e2c96224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221447B2690>]}
[0m12:29:26.565677 [info ] [MainThread]: 
[0m12:29:26.565677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:29:26.565677 [info ] [MainThread]: 
[0m12:29:26.565677 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:29:26.565677 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:29:29.435118 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:29:29.444782 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:29:29.444782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:30.844690 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.401 seconds
[0m12:29:30.851925 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:29:30.860809 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:29:30.860809 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:29:30.860809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:31.827018 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.969 seconds
[0m12:29:31.827018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '379e78ec-e473-4b95-b170-d664e2c96224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221433B5D00>]}
[0m12:29:31.827018 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m12:29:31.827018 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_new_customers .................. [RUN]
[0m12:29:31.827018 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m12:29:31.827018 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m12:29:31.842929 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m12:29:31.842929 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m12:29:31.869802 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_new_customers"
[0m12:29:31.869802 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_new_customers"
[0m12:29:31.869802 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_new_customers
         as
        (-- SELECT 
--     customer_id,
--     MIN(payment_month) AS first_purchase_date,
--     DATE_TRUNC('month',MIN(payment_month)) AS first_purchase_month,
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions GROUP BY customer_id

    SELECT
    first_purchase_month,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM (
    SELECT
        customer_id,
        DATE_TRUNC('month', MIN(transaction_date)) AS first_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
) subquery
GROUP BY first_purchase_month
ORDER BY first_purchase_month
        );
[0m12:29:31.869802 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:29:32.971174 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff43-3201-7d7b-000c-493e00022412
[0m12:29:32.971174 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 32
invalid identifier 'TRANSACTION_DATE'
[0m12:29:32.974994 [debug] [Thread-1 (]: Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  000904 (42000): SQL compilation error: error line 15 at position 32
  invalid identifier 'TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql
[0m12:29:32.974994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '379e78ec-e473-4b95-b170-d664e2c96224', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022141A74740>]}
[0m12:29:32.990754 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_new_customers ......... [[31mERROR[0m in 1.15s]
[0m12:29:32.990754 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m12:29:32.990754 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  000904 (42000): SQL compilation error: error line 15 at position 32
  invalid identifier 'TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql.
[0m12:29:32.990754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:32.990754 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:29:32.990754 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:29:33.314315 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:29:33.314315 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:29:33.634714 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was left open.
[0m12:29:33.642530 [debug] [MainThread]: On model.CRB_PROJECT.stg_new_customers: Close
[0m12:29:33.961320 [info ] [MainThread]: 
[0m12:29:33.961320 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m12:29:33.961320 [debug] [MainThread]: Command end result
[0m12:29:33.986042 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:29:33.989042 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:29:33.994043 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:29:33.994043 [info ] [MainThread]: 
[0m12:29:33.994043 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:29:33.994043 [info ] [MainThread]: 
[0m12:29:33.994043 [error] [MainThread]:   Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  000904 (42000): SQL compilation error: error line 15 at position 32
  invalid identifier 'TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql
[0m12:29:33.994043 [info ] [MainThread]: 
[0m12:29:33.994043 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:29:33.994043 [debug] [MainThread]: Command `dbt run` failed at 12:29:33.994043 after 8.93 seconds
[0m12:29:33.994043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221445DF3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022144612480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022142F90B60>]}
[0m12:29:33.994043 [debug] [MainThread]: Flushing usage events
[0m12:29:34.904341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:52.876887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021837A93F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021834D698E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021835030530>]}


============================== 12:29:52.892592 | 7218844b-530a-4cfd-a0ca-3c0ff5627933 ==============================
[0m12:29:52.892592 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:29:52.892592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_new_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:29:53.363352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7218844b-530a-4cfd-a0ca-3c0ff5627933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002183865DAC0>]}
[0m12:29:53.426417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7218844b-530a-4cfd-a0ca-3c0ff5627933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218387B7B30>]}
[0m12:29:53.426417 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:29:53.895756 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:29:54.054487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:54.054487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:54.057448 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:29:54.090912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7218844b-530a-4cfd-a0ca-3c0ff5627933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002183991BB90>]}
[0m12:29:54.157307 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:29:54.157307 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:29:54.188212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7218844b-530a-4cfd-a0ca-3c0ff5627933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021839ACF680>]}
[0m12:29:54.188212 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:29:54.188212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7218844b-530a-4cfd-a0ca-3c0ff5627933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218387B5370>]}
[0m12:29:54.188212 [info ] [MainThread]: 
[0m12:29:54.188212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:29:54.188212 [info ] [MainThread]: 
[0m12:29:54.188212 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:29:54.188212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:29:54.319344 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:29:54.319344 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:29:54.320344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:55.630842 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.321 seconds
[0m12:29:55.646665 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:29:55.662482 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:29:55.662482 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:29:55.662482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:56.617832 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.954 seconds
[0m12:29:56.633879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7218844b-530a-4cfd-a0ca-3c0ff5627933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021839B688C0>]}
[0m12:29:56.633879 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m12:29:56.633879 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_new_customers .................. [RUN]
[0m12:29:56.633879 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m12:29:56.633879 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m12:29:56.649805 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m12:29:56.649805 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m12:29:56.677765 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_new_customers"
[0m12:29:56.677765 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_new_customers"
[0m12:29:56.677765 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_new_customers
         as
        (-- SELECT 
--     customer_id,
--     MIN(payment_month) AS first_purchase_date,
--     DATE_TRUNC('month',MIN(payment_month)) AS first_purchase_month,
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions GROUP BY customer_id

    SELECT
    first_purchase_month,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM (
    SELECT
        customer_id,
        DATE_TRUNC('month', MIN(payment_month)) AS first_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
) subquery
GROUP BY first_purchase_month
ORDER BY first_purchase_month
        );
[0m12:29:56.677765 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:29:58.008818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.325 seconds
[0m12:29:58.024906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7218844b-530a-4cfd-a0ca-3c0ff5627933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021834E518E0>]}
[0m12:29:58.024906 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_new_customers ............. [[32mSUCCESS 1[0m in 1.39s]
[0m12:29:58.024906 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m12:29:58.040650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:58.040650 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:29:58.040650 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:29:58.372296 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:29:58.372296 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:29:58.704166 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was left open.
[0m12:29:58.704166 [debug] [MainThread]: On model.CRB_PROJECT.stg_new_customers: Close
[0m12:29:59.029233 [info ] [MainThread]: 
[0m12:29:59.044403 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m12:29:59.044403 [debug] [MainThread]: Command end result
[0m12:29:59.066350 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:29:59.068383 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:29:59.074350 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:29:59.074350 [info ] [MainThread]: 
[0m12:29:59.075351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:29:59.076362 [info ] [MainThread]: 
[0m12:29:59.077490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:29:59.078497 [debug] [MainThread]: Command `dbt run` succeeded at 12:29:59.078497 after 6.35 seconds
[0m12:29:59.078497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002183582E180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002183582E3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002183582E270>]}
[0m12:29:59.079529 [debug] [MainThread]: Flushing usage events
[0m12:30:00.029870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:49.511047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C87224770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C86BD2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C87224470>]}


============================== 12:31:49.526975 | 00c15b0e-d31d-4fa4-8757-009c5a0556c0 ==============================
[0m12:31:49.526975 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:31:49.526975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_new_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:50.011917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00c15b0e-d31d-4fa4-8757-009c5a0556c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C87CE03B0>]}
[0m12:31:50.077461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00c15b0e-d31d-4fa4-8757-009c5a0556c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C866F7C80>]}
[0m12:31:50.079467 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:31:50.579790 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:31:50.720138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:50.720138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:50.749778 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:31:50.773584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00c15b0e-d31d-4fa4-8757-009c5a0556c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C89274E60>]}
[0m12:31:50.842025 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:31:50.842025 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:31:50.884650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00c15b0e-d31d-4fa4-8757-009c5a0556c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8940A8D0>]}
[0m12:31:50.885648 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:31:50.885648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c15b0e-d31d-4fa4-8757-009c5a0556c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8930DDF0>]}
[0m12:31:50.887648 [info ] [MainThread]: 
[0m12:31:50.887648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:50.888648 [info ] [MainThread]: 
[0m12:31:50.889647 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:50.890649 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:31:50.996727 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:31:50.996727 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:31:50.998732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:52.328623 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.331 seconds
[0m12:31:52.336111 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:31:52.347673 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:31:52.347673 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:31:52.348673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:53.326675 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.979 seconds
[0m12:31:53.331668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c15b0e-d31d-4fa4-8757-009c5a0556c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C894003B0>]}
[0m12:31:53.336217 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m12:31:53.336217 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_new_customers .................. [RUN]
[0m12:31:53.337217 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m12:31:53.337217 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m12:31:53.345158 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m12:31:53.346158 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m12:31:53.376959 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_new_customers"
[0m12:31:53.378922 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_new_customers"
[0m12:31:53.378922 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_new_customers
         as
        (SELECT
    customer_id,
    first_purchase_month,
    COUNT(DISTINCT customer_id) AS new_customers_count
FROM (
    SELECT
        customer_id,
        DATE_TRUNC('month', MIN(payment_month)) AS first_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
) subquery
GROUP BY first_purchase_month
ORDER BY first_purchase_month
        );
[0m12:31:53.379952 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:31:54.259380 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff45-3201-7db6-000c-493e000250d6
[0m12:31:54.259380 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 4 at position 4
'SUBQUERY.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
[0m12:31:54.266664 [debug] [Thread-1 (]: Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001104 (42601): SQL compilation error: error line 4 at position 4
  'SUBQUERY.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql
[0m12:31:54.266664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c15b0e-d31d-4fa4-8757-009c5a0556c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C866F49E0>]}
[0m12:31:54.266664 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_new_customers ......... [[31mERROR[0m in 0.93s]
[0m12:31:54.266664 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m12:31:54.266664 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001104 (42601): SQL compilation error: error line 4 at position 4
  'SUBQUERY.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql.
[0m12:31:54.266664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:54.266664 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:31:54.266664 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:31:54.597070 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:31:54.598080 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:31:54.916668 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was left open.
[0m12:31:54.916668 [debug] [MainThread]: On model.CRB_PROJECT.stg_new_customers: Close
[0m12:31:55.255163 [info ] [MainThread]: 
[0m12:31:55.255163 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m12:31:55.255163 [debug] [MainThread]: Command end result
[0m12:31:55.280451 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:31:55.283881 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:31:55.285202 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:31:55.285202 [info ] [MainThread]: 
[0m12:31:55.285202 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:31:55.285202 [info ] [MainThread]: 
[0m12:31:55.285202 [error] [MainThread]:   Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001104 (42601): SQL compilation error: error line 4 at position 4
  'SUBQUERY.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql
[0m12:31:55.285202 [info ] [MainThread]: 
[0m12:31:55.294763 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:31:55.296594 [debug] [MainThread]: Command `dbt run` failed at 12:31:55.296594 after 5.93 seconds
[0m12:31:55.297322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C87225160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C86FB9CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C86F20590>]}
[0m12:31:55.297322 [debug] [MainThread]: Flushing usage events
[0m12:31:56.175142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:01.394915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBA7818E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBA783E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBA781100>]}


============================== 12:37:01.410689 | 96a763b9-d7f7-4659-be9e-cf775e6273d4 ==============================
[0m12:37:01.410689 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:37:01.410689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_new_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:37:01.881218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96a763b9-d7f7-4659-be9e-cf775e6273d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB9CBA150>]}
[0m12:37:01.944426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96a763b9-d7f7-4659-be9e-cf775e6273d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBB4BF380>]}
[0m12:37:01.944426 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:37:02.425313 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:37:02.576872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:02.576872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:02.583429 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:37:02.605295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96a763b9-d7f7-4659-be9e-cf775e6273d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBC552240>]}
[0m12:37:02.667489 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:37:02.683573 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:37:02.715060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96a763b9-d7f7-4659-be9e-cf775e6273d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBC8E6720>]}
[0m12:37:02.715060 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:37:02.715060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a763b9-d7f7-4659-be9e-cf775e6273d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBC7B4320>]}
[0m12:37:02.715060 [info ] [MainThread]: 
[0m12:37:02.715060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:02.715060 [info ] [MainThread]: 
[0m12:37:02.715060 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:37:02.715060 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:37:02.822846 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:37:02.823844 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:37:02.823844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:04.205746 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.383 seconds
[0m12:37:04.207755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:37:04.216242 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:37:04.216242 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:37:04.216242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:05.541967 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.322 seconds
[0m12:37:05.541967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a763b9-d7f7-4659-be9e-cf775e6273d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBCC86EA0>]}
[0m12:37:05.541967 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m12:37:05.541967 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_new_customers .................. [RUN]
[0m12:37:05.541967 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m12:37:05.541967 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m12:37:05.558093 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m12:37:05.558093 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m12:37:05.588317 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_new_customers"
[0m12:37:05.588317 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_new_customers"
[0m12:37:05.588317 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_new_customers
         as
        (WITH first_purchase AS (
     SELECT
        customer_id,
        DATE_TRUNC('month', MIN(payment_month)) AS first_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
)
SELECT
    customer_id,
    first_purchase_month,
    COUNT(DISTINCT customer_id) AS new_customers_count 
FROM first_purchase 
GROUP BY first_purchase_month
ORDER BY first_purchase_month
        );
[0m12:37:05.596567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:37:06.579658 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff4b-3201-7e57-000c-493e0002603a
[0m12:37:06.579658 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 11 at position 4
'FIRST_PURCHASE.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
[0m12:37:06.579658 [debug] [Thread-1 (]: Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001104 (42601): SQL compilation error: error line 11 at position 4
  'FIRST_PURCHASE.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql
[0m12:37:06.579658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a763b9-d7f7-4659-be9e-cf775e6273d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBCE945C0>]}
[0m12:37:06.579658 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_new_customers ......... [[31mERROR[0m in 1.04s]
[0m12:37:06.579658 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m12:37:06.579658 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001104 (42601): SQL compilation error: error line 11 at position 4
  'FIRST_PURCHASE.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql.
[0m12:37:06.595632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:06.595632 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:37:06.595632 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:37:06.905509 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:37:06.921267 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:37:07.245091 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was left open.
[0m12:37:07.245091 [debug] [MainThread]: On model.CRB_PROJECT.stg_new_customers: Close
[0m12:37:07.565258 [info ] [MainThread]: 
[0m12:37:07.565258 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m12:37:07.581231 [debug] [MainThread]: Command end result
[0m12:37:07.606121 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:37:07.609119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:37:07.611553 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:37:07.611553 [info ] [MainThread]: 
[0m12:37:07.611553 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:37:07.611553 [info ] [MainThread]: 
[0m12:37:07.611553 [error] [MainThread]:   Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001104 (42601): SQL compilation error: error line 11 at position 4
  'FIRST_PURCHASE.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql
[0m12:37:07.611553 [info ] [MainThread]: 
[0m12:37:07.611553 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:37:07.611553 [debug] [MainThread]: Command `dbt run` failed at 12:37:07.611553 after 6.38 seconds
[0m12:37:07.611553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBA2BF5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FBB40CBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB851C8F0>]}
[0m12:37:07.611553 [debug] [MainThread]: Flushing usage events
[0m12:37:08.521203 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:00.147925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F59EF36B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F59F78470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F59F79EB0>]}


============================== 12:39:00.147925 | 107ff42f-8e4f-4835-80a1-2f71987db3c9 ==============================
[0m12:39:00.147925 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:39:00.147925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_new_customers', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:39:00.630280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '107ff42f-8e4f-4835-80a1-2f71987db3c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5AFAD670>]}
[0m12:39:00.693540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '107ff42f-8e4f-4835-80a1-2f71987db3c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5B076BD0>]}
[0m12:39:00.693540 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:39:01.163242 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:39:01.321972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:01.321972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:01.321972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:39:01.353676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '107ff42f-8e4f-4835-80a1-2f71987db3c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5B1A3290>]}
[0m12:39:01.426296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:39:01.430305 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:39:01.462691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '107ff42f-8e4f-4835-80a1-2f71987db3c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5C42F320>]}
[0m12:39:01.463692 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:39:01.463692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '107ff42f-8e4f-4835-80a1-2f71987db3c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5C5BECF0>]}
[0m12:39:01.465717 [info ] [MainThread]: 
[0m12:39:01.466692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:01.466692 [info ] [MainThread]: 
[0m12:39:01.467690 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:39:01.468478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:39:01.569113 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:39:01.569113 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:39:01.569113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:03.091433 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.516 seconds
[0m12:39:03.100881 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:39:03.110865 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:39:03.110865 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:39:03.110865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:04.514903 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.404 seconds
[0m12:39:04.514903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '107ff42f-8e4f-4835-80a1-2f71987db3c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5C5BE5A0>]}
[0m12:39:04.514903 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m12:39:04.514903 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_new_customers .................. [RUN]
[0m12:39:04.514903 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m12:39:04.514903 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m12:39:04.533186 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m12:39:04.534186 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m12:39:04.558051 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_new_customers"
[0m12:39:04.558051 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_new_customers"
[0m12:39:04.558051 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_new_customers
         as
        (WITH first_purchase AS (
     SELECT
        customer_id,
        DATE_TRUNC('month', MIN(payment_month)) AS first_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
)
SELECT
    customer_id,
    first_purchase_month,
    COUNT(DISTINCT customer_id) AS new_customers_count 
FROM first_purchase 
GROUP BY first_purchase_month
ORDER BY first_purchase_month
        );
[0m12:39:04.558051 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:05.539228 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff4d-3201-7e57-000c-493e0002603e
[0m12:39:05.539228 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 11 at position 4
'FIRST_PURCHASE.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
[0m12:39:05.555016 [debug] [Thread-1 (]: Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001104 (42601): SQL compilation error: error line 11 at position 4
  'FIRST_PURCHASE.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql
[0m12:39:05.555016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '107ff42f-8e4f-4835-80a1-2f71987db3c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F5CBAD400>]}
[0m12:39:05.555016 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_new_customers ......... [[31mERROR[0m in 1.04s]
[0m12:39:05.555016 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m12:39:05.555016 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001104 (42601): SQL compilation error: error line 11 at position 4
  'FIRST_PURCHASE.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql.
[0m12:39:05.555016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:05.555016 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:39:05.555016 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:39:05.888179 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:39:05.888179 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:39:06.195656 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was left open.
[0m12:39:06.211641 [debug] [MainThread]: On model.CRB_PROJECT.stg_new_customers: Close
[0m12:39:06.533241 [info ] [MainThread]: 
[0m12:39:06.536176 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.07 seconds (5.07s).
[0m12:39:06.540177 [debug] [MainThread]: Command end result
[0m12:39:06.574644 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:39:06.574644 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:39:06.574644 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:39:06.574644 [info ] [MainThread]: 
[0m12:39:06.574644 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:39:06.590314 [info ] [MainThread]: 
[0m12:39:06.591678 [error] [MainThread]:   Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001104 (42601): SQL compilation error: error line 11 at position 4
  'FIRST_PURCHASE.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql
[0m12:39:06.592574 [info ] [MainThread]: 
[0m12:39:06.593364 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:39:06.594372 [debug] [MainThread]: Command `dbt run` failed at 12:39:06.594372 after 6.61 seconds
[0m12:39:06.594987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F59FE6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F59E76FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F59C1AD20>]}
[0m12:39:06.594987 [debug] [MainThread]: Flushing usage events
[0m12:39:07.958459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:15.051929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019992BBA120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199927F8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019993919DC0>]}


============================== 12:39:15.063022 | 473fe85b-0118-4a1e-9e2c-bb2316c46b67 ==============================
[0m12:39:15.063022 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:39:15.063022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_churn_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:15.541113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '473fe85b-0118-4a1e-9e2c-bb2316c46b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019996247F50>]}
[0m12:39:15.602789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '473fe85b-0118-4a1e-9e2c-bb2316c46b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019992415490>]}
[0m12:39:15.602789 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:39:16.081671 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:39:16.227618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:16.227618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:16.243461 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:39:16.267660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '473fe85b-0118-4a1e-9e2c-bb2316c46b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001999811E690>]}
[0m12:39:16.333878 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:39:16.333878 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:39:16.365669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '473fe85b-0118-4a1e-9e2c-bb2316c46b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001999848A5A0>]}
[0m12:39:16.365669 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:39:16.365669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '473fe85b-0118-4a1e-9e2c-bb2316c46b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019998480C20>]}
[0m12:39:16.365669 [info ] [MainThread]: 
[0m12:39:16.365669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:16.365669 [info ] [MainThread]: 
[0m12:39:16.365669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:39:16.365669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:39:16.482706 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:39:16.482706 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:39:16.483517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:17.533772 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.065 seconds
[0m12:39:17.549809 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:39:17.565805 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:39:17.565805 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:39:17.565805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:18.731710 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.172 seconds
[0m12:39:18.747747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '473fe85b-0118-4a1e-9e2c-bb2316c46b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199984803B0>]}
[0m12:39:18.747747 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:39:18.747747 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:39:18.747747 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:39:18.747747 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:39:18.764744 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:39:18.766751 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:39:18.797759 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:39:18.799760 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:39:18.799760 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 12
)
SELECT 
    COUNT(*) AS number_of_churned_customers
FROM churned_customers;
[0m12:39:18.799760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:19.700370 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff4d-3201-7e56-000c-493e000242ea
[0m12:39:19.700370 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 30 at position 22 unexpected ';'.
[0m12:39:19.700370 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 22 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:39:19.700370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '473fe85b-0118-4a1e-9e2c-bb2316c46b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019995734920>]}
[0m12:39:19.700370 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 0.95s]
[0m12:39:19.716307 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:39:19.716307 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 22 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m12:39:19.716307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:19.716307 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:39:19.716307 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:39:20.030577 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:39:20.046654 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:39:20.363570 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:39:20.363570 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:39:20.688198 [info ] [MainThread]: 
[0m12:39:20.688198 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m12:39:20.688198 [debug] [MainThread]: Command end result
[0m12:39:20.724272 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:39:20.725304 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:39:20.726809 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:39:20.726809 [info ] [MainThread]: 
[0m12:39:20.726809 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:39:20.734564 [info ] [MainThread]: 
[0m12:39:20.735156 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 22 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:39:20.736163 [info ] [MainThread]: 
[0m12:39:20.736163 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:39:20.738017 [debug] [MainThread]: Command `dbt run` failed at 12:39:20.737163 after 5.84 seconds
[0m12:39:20.738017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019995C7F710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019996FAE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019995716AB0>]}
[0m12:39:20.738017 [debug] [MainThread]: Flushing usage events
[0m12:39:21.638581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:29.575094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174300C3A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174300C0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174300C0140>]}


============================== 12:39:29.582668 | 2edb4c96-aaf1-4f77-9ef9-313fbe68ccf6 ==============================
[0m12:39:29.582668 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:39:29.582668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_churn_customers', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:30.088667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2edb4c96-aaf1-4f77-9ef9-313fbe68ccf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742F5FA300>]}
[0m12:39:30.158076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2edb4c96-aaf1-4f77-9ef9-313fbe68ccf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742FE57CE0>]}
[0m12:39:30.160043 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:39:30.630140 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:39:30.791779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:30.791779 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:30.791779 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:39:30.829582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2edb4c96-aaf1-4f77-9ef9-313fbe68ccf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017431EFAD80>]}
[0m12:39:30.899007 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:39:30.906929 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:39:30.932403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2edb4c96-aaf1-4f77-9ef9-313fbe68ccf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017432156510>]}
[0m12:39:30.932403 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:39:30.932403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2edb4c96-aaf1-4f77-9ef9-313fbe68ccf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017432200CE0>]}
[0m12:39:30.932403 [info ] [MainThread]: 
[0m12:39:30.944143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:30.944143 [info ] [MainThread]: 
[0m12:39:30.944143 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:39:30.944143 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:39:31.053188 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:39:31.053188 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:39:31.054189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:32.149456 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.097 seconds
[0m12:39:32.149456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:39:32.160256 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:39:32.160256 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:39:32.160256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:33.087672 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.923 seconds
[0m12:39:33.087672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2edb4c96-aaf1-4f77-9ef9-313fbe68ccf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017430EEFC80>]}
[0m12:39:33.087672 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:39:33.087672 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:39:33.087672 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:39:33.087672 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:39:33.103448 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:39:33.103448 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:39:33.135293 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:39:33.135293 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:39:33.135293 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 12
)
SELECT 
    COUNT(*) AS number_of_churned_customers
FROM churned_customers
        );
[0m12:39:33.135293 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:35.144799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.000 seconds
[0m12:39:35.160286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2edb4c96-aaf1-4f77-9ef9-313fbe68ccf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742D461940>]}
[0m12:39:35.160286 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 2.07s]
[0m12:39:35.160286 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:39:35.160286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:35.160286 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:39:35.160286 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:39:35.548651 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:39:35.548651 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:39:35.889013 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:39:35.889013 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:39:36.212098 [info ] [MainThread]: 
[0m12:39:36.212098 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m12:39:36.212098 [debug] [MainThread]: Command end result
[0m12:39:36.239532 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:39:36.242829 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:39:36.243257 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:39:36.243257 [info ] [MainThread]: 
[0m12:39:36.243257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:36.243257 [info ] [MainThread]: 
[0m12:39:36.243257 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:36.243257 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:36.243257 after 6.85 seconds
[0m12:39:36.253453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742F53EC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742F53DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017432973CE0>]}
[0m12:39:36.254123 [debug] [MainThread]: Flushing usage events
[0m12:39:37.135087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:16.064847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4825C59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4825C59A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D482558F80>]}


============================== 12:41:16.080605 | 3181a0b6-428b-472d-a6a0-5298d5d05645 ==============================
[0m12:41:16.080605 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:41:16.080605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:41:16.551321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3181a0b6-428b-472d-a6a0-5298d5d05645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4836A9790>]}
[0m12:41:16.614640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3181a0b6-428b-472d-a6a0-5298d5d05645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4833D5D30>]}
[0m12:41:16.614640 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:41:17.083643 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:41:17.236236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:17.236236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:17.242929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:41:17.272283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3181a0b6-428b-472d-a6a0-5298d5d05645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D484796D80>]}
[0m12:41:17.336782 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:41:17.336782 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:41:17.368565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3181a0b6-428b-472d-a6a0-5298d5d05645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D484A2E8D0>]}
[0m12:41:17.368565 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:41:17.368565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3181a0b6-428b-472d-a6a0-5298d5d05645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D484A90260>]}
[0m12:41:17.368565 [info ] [MainThread]: 
[0m12:41:17.368565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:41:17.368565 [info ] [MainThread]: 
[0m12:41:17.368565 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:41:17.368565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:41:17.485772 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:41:17.486742 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:41:17.486742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:18.903185 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.417 seconds
[0m12:41:18.910502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:41:18.919298 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:41:18.919298 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:41:18.919298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:19.890834 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.979 seconds
[0m12:41:19.890834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3181a0b6-428b-472d-a6a0-5298d5d05645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D483742930>]}
[0m12:41:19.912438 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:41:19.913474 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:41:19.914437 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:41:19.915438 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:41:19.925479 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:41:19.926446 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:41:19.957345 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:41:19.958347 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:41:19.958347 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 1
)
SELECT 
    last_payment_date ,COUNT(*) AS number_of_churned_customers
FROM churned_customers GROUP BY last_payment
        );
[0m12:41:19.958347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:41:20.924503 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff4f-3201-7e56-000c-493e00024306
[0m12:41:20.924503 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 30 at position 32
invalid identifier 'LAST_PAYMENT'
[0m12:41:20.924503 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 30 at position 32
  invalid identifier 'LAST_PAYMENT'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:41:20.941405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3181a0b6-428b-472d-a6a0-5298d5d05645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D481F047D0>]}
[0m12:41:20.943026 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 1.01s]
[0m12:41:20.943026 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:41:20.943026 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 30 at position 32
  invalid identifier 'LAST_PAYMENT'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m12:41:20.947635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:20.947635 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:41:20.947635 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:41:21.278792 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:41:21.278792 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:41:21.604731 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:41:21.604731 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:41:21.928045 [info ] [MainThread]: 
[0m12:41:21.928045 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m12:41:21.943997 [debug] [MainThread]: Command end result
[0m12:41:21.968811 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:41:21.970810 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:41:21.976974 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:41:21.977943 [info ] [MainThread]: 
[0m12:41:21.978941 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:41:21.978941 [info ] [MainThread]: 
[0m12:41:21.979940 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  000904 (42000): SQL compilation error: error line 30 at position 32
  invalid identifier 'LAST_PAYMENT'
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:41:21.981187 [info ] [MainThread]: 
[0m12:41:21.981187 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:41:21.981187 [debug] [MainThread]: Command `dbt run` failed at 12:41:21.981187 after 6.07 seconds
[0m12:41:21.984247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FC825610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D481E5A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D481E5A5D0>]}
[0m12:41:21.984247 [debug] [MainThread]: Flushing usage events
[0m12:41:22.946109 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:37.065764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E157165580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E156B42570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E157164B60>]}


============================== 12:41:37.081496 | 27e1400e-bdd7-4933-bb07-6cfbbbb8654e ==============================
[0m12:41:37.081496 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:41:37.081496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_churn_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:41:38.038580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27e1400e-bdd7-4933-bb07-6cfbbbb8654e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E156F2E600>]}
[0m12:41:38.101266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27e1400e-bdd7-4933-bb07-6cfbbbb8654e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E157C3AE70>]}
[0m12:41:38.101266 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:41:38.680850 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:41:38.843761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:38.843761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:38.852666 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:41:38.876455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27e1400e-bdd7-4933-bb07-6cfbbbb8654e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1566C63C0>]}
[0m12:41:38.944009 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:41:38.968251 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:41:38.989567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27e1400e-bdd7-4933-bb07-6cfbbbb8654e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E159321DF0>]}
[0m12:41:38.989567 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:41:38.989567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e1400e-bdd7-4933-bb07-6cfbbbb8654e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E158FEFEC0>]}
[0m12:41:38.989567 [info ] [MainThread]: 
[0m12:41:39.003689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:41:39.003689 [info ] [MainThread]: 
[0m12:41:39.005429 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:41:39.005429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:41:42.048507 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:41:42.048507 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:41:42.050511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:43.430439 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.383 seconds
[0m12:41:43.430439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:41:43.450695 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:41:43.450695 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:41:43.450695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:44.431031 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.981 seconds
[0m12:41:44.431031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e1400e-bdd7-4933-bb07-6cfbbbb8654e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1571D4E30>]}
[0m12:41:44.431031 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:41:44.431031 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:41:44.431031 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:41:44.431031 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:41:44.450834 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:41:44.451833 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:41:44.484697 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:41:44.486664 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:41:44.487665 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 1
)
SELECT 
    last_payment_date ,COUNT(*) AS number_of_churned_customers
FROM churned_customers GROUP BY last_payment_date
        );
[0m12:41:44.487665 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:41:45.681477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.201 seconds
[0m12:41:45.713327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e1400e-bdd7-4933-bb07-6cfbbbb8654e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1598ED340>]}
[0m12:41:45.713327 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.27s]
[0m12:41:45.713327 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:41:45.713327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:45.713327 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:41:45.713327 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:41:46.105956 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:41:46.105956 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:41:46.425887 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:41:46.441797 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:41:46.782016 [info ] [MainThread]: 
[0m12:41:46.782016 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.78 seconds (7.78s).
[0m12:41:46.782016 [debug] [MainThread]: Command end result
[0m12:41:46.822132 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:41:46.822132 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:41:46.822132 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:41:46.822132 [info ] [MainThread]: 
[0m12:41:46.833010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:46.835021 [info ] [MainThread]: 
[0m12:41:46.835021 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:41:46.835021 [debug] [MainThread]: Command `dbt run` succeeded at 12:41:46.835021 after 9.94 seconds
[0m12:41:46.835021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E157164920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E157164B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E157164980>]}
[0m12:41:46.835021 [debug] [MainThread]: Flushing usage events
[0m12:41:47.733375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:27.121069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D0FE2C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CEE71BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CF0D9400>]}


============================== 12:42:27.121069 | 403a319f-4fba-41d5-83d2-d11ca2b5dbda ==============================
[0m12:42:27.121069 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:42:27.121069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_churn_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:42:27.607696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '403a319f-4fba-41d5-83d2-d11ca2b5dbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D2992A20>]}
[0m12:42:27.671212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '403a319f-4fba-41d5-83d2-d11ca2b5dbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D16F5FA0>]}
[0m12:42:27.671212 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:42:28.146649 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:42:28.294972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:28.294972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:28.300989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:42:28.325055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '403a319f-4fba-41d5-83d2-d11ca2b5dbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D3C4D880>]}
[0m12:42:28.391087 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:42:28.391087 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:42:28.421987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '403a319f-4fba-41d5-83d2-d11ca2b5dbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D3C1C5F0>]}
[0m12:42:28.421987 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:42:28.421987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '403a319f-4fba-41d5-83d2-d11ca2b5dbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D39E1EB0>]}
[0m12:42:28.421987 [info ] [MainThread]: 
[0m12:42:28.437671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:28.437671 [info ] [MainThread]: 
[0m12:42:28.437671 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:28.437671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:42:28.544101 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:42:28.544101 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:42:28.545140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:29.877306 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.335 seconds
[0m12:42:29.877306 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:42:29.893358 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:42:29.893358 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:42:29.893358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:30.865435 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.981 seconds
[0m12:42:30.881191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '403a319f-4fba-41d5-83d2-d11ca2b5dbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D3BD6150>]}
[0m12:42:30.881191 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:42:30.881191 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:42:30.881191 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:42:30.881191 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:42:30.881191 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:42:30.897110 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:42:30.929969 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:42:30.931937 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:42:30.931937 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 1
)
-- SELECT 
--     last_payment_date ,COUNT(*) AS number_of_churned_customers
-- FROM churned_customers GROUP BY last_payment_date
SELECT * FROM churned_customers
        );
[0m12:42:30.931937 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:32.064604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.137 seconds
[0m12:42:32.093904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '403a319f-4fba-41d5-83d2-d11ca2b5dbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D10349B0>]}
[0m12:42:32.094959 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.20s]
[0m12:42:32.095931 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:42:32.097970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:32.097970 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:42:32.097970 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:42:32.422025 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:42:32.422025 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:42:33.034316 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:42:33.050197 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:42:33.372495 [info ] [MainThread]: 
[0m12:42:33.388191 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m12:42:33.388191 [debug] [MainThread]: Command end result
[0m12:42:33.417743 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:42:33.419675 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:42:33.419675 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:42:33.419675 [info ] [MainThread]: 
[0m12:42:33.419675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:33.419675 [info ] [MainThread]: 
[0m12:42:33.430368 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:42:33.431708 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:33.431708 after 6.47 seconds
[0m12:42:33.431708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0CF0117C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D16F57C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D2590C20>]}
[0m12:42:33.431708 [debug] [MainThread]: Flushing usage events
[0m12:42:34.338270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:12.391031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243D1681370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243D16839B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243D16815B0>]}


============================== 12:43:12.396185 | b0efb976-34fd-4414-b0be-553594d668e1 ==============================
[0m12:43:12.396185 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:43:12.397161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_churn_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:12.887019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0efb976-34fd-4414-b0be-553594d668e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243D1699A90>]}
[0m12:43:12.947016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0efb976-34fd-4414-b0be-553594d668e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243D21BE630>]}
[0m12:43:12.949039 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:43:13.439046 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:43:13.596123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:13.596123 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:13.603129 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:43:13.627959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0efb976-34fd-4414-b0be-553594d668e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243D346E9C0>]}
[0m12:43:13.705923 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:43:13.710079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:43:13.739904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0efb976-34fd-4414-b0be-553594d668e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243D363C4D0>]}
[0m12:43:13.740907 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:43:13.740907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0efb976-34fd-4414-b0be-553594d668e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243D344FEC0>]}
[0m12:43:13.742905 [info ] [MainThread]: 
[0m12:43:13.743904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:13.743904 [info ] [MainThread]: 
[0m12:43:13.744905 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:43:13.745905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:43:13.836729 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:43:13.836729 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:43:13.836729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:15.201883 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.353 seconds
[0m12:43:15.206391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:43:15.215666 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:43:15.217672 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:43:15.217672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:16.186522 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.968 seconds
[0m12:43:16.188530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0efb976-34fd-4414-b0be-553594d668e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243D3699430>]}
[0m12:43:16.194135 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:43:16.194135 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:43:16.194135 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:43:16.194135 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:43:16.194135 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:43:16.194135 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:43:16.238652 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:43:16.241166 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:43:16.241166 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
) SELECT * FROM last_payment
-- ),
-- churned_customers AS (
--     SELECT
--         c.customer_id,
--         c.customer_name,
--         c.company,
--         lp.last_payment_date
--     FROM customers c
--     JOIN last_payment lp
--         ON c.customer_id = lp.customer_id
--     WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 1
-- )
-- SELECT 
--     last_payment_date ,COUNT(*) AS number_of_churned_customers
-- FROM churned_customers GROUP BY last_payment_date
-- SELECT * FROM churned_customers
        );
[0m12:43:16.242174 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:43:17.594925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.354 seconds
[0m12:43:17.619134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0efb976-34fd-4414-b0be-553594d668e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243D0B246E0>]}
[0m12:43:17.620874 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.42s]
[0m12:43:17.620874 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:43:17.622881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:17.622881 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:43:17.622881 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:43:17.950521 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:43:17.950521 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:43:18.283863 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:43:18.283863 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:43:18.613846 [info ] [MainThread]: 
[0m12:43:18.613846 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m12:43:18.613846 [debug] [MainThread]: Command end result
[0m12:43:18.641090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:43:18.643357 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:43:18.649969 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:43:18.650907 [info ] [MainThread]: 
[0m12:43:18.651481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:18.652491 [info ] [MainThread]: 
[0m12:43:18.652491 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:43:18.653522 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:18.653522 after 6.43 seconds
[0m12:43:18.654519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243D10486B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243CE019850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243CF41E960>]}
[0m12:43:18.654519 [debug] [MainThread]: Flushing usage events
[0m12:43:19.562333 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:59.253895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086D6149E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086DB20320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086BBEE8D0>]}


============================== 12:43:59.253895 | 7354b72c-6c1b-4b17-b3f9-fc679c1388a2 ==============================
[0m12:43:59.253895 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:43:59.253895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_churn_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:43:59.740244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7354b72c-6c1b-4b17-b3f9-fc679c1388a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086EAC9850>]}
[0m12:43:59.804346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7354b72c-6c1b-4b17-b3f9-fc679c1388a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086DE07A10>]}
[0m12:43:59.804346 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:44:00.279340 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:44:00.416159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:44:00.431966 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:44:00.431966 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:44:00.465966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7354b72c-6c1b-4b17-b3f9-fc679c1388a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086FC9BB90>]}
[0m12:44:00.533492 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:44:00.533492 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:44:00.564847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7354b72c-6c1b-4b17-b3f9-fc679c1388a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086FE4F260>]}
[0m12:44:00.564847 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:44:00.564847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7354b72c-6c1b-4b17-b3f9-fc679c1388a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086FC10950>]}
[0m12:44:00.564847 [info ] [MainThread]: 
[0m12:44:00.564847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:00.564847 [info ] [MainThread]: 
[0m12:44:00.564847 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:00.564847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:44:00.666311 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:44:00.666311 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:44:00.666311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:02.009258 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.342 seconds
[0m12:44:02.025041 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:44:02.025041 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:44:02.025041 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:44:02.025041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:02.995414 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.968 seconds
[0m12:44:02.995414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7354b72c-6c1b-4b17-b3f9-fc679c1388a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086EBBE870>]}
[0m12:44:03.008820 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:44:03.011080 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:44:03.011080 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:44:03.011080 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:44:03.019653 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:44:03.019653 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:44:03.036621 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:44:03.054065 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:44:03.055060 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
) 
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 1
)
-- SELECT 
--     last_payment_date ,COUNT(*) AS number_of_churned_customers
-- FROM churned_customers GROUP BY last_payment_date
SELECT * FROM churned_customers
        );
[0m12:44:03.055060 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:44:04.115886 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff52-3201-7d7b-000c-493e0002244e
[0m12:44:04.115886 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 0 unexpected ')'.
syntax error line 17 at position 1 unexpected ','.
[0m12:44:04.129747 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected ')'.
  syntax error line 17 at position 1 unexpected ','.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:44:04.129747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7354b72c-6c1b-4b17-b3f9-fc679c1388a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020870597CE0>]}
[0m12:44:04.129747 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 1.12s]
[0m12:44:04.129747 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:44:04.137472 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected ')'.
  syntax error line 17 at position 1 unexpected ','.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m12:44:04.137472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:04.137472 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:44:04.137472 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:44:04.465643 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:44:04.465643 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:44:04.789662 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:44:04.789662 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:44:05.120297 [info ] [MainThread]: 
[0m12:44:05.120297 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m12:44:05.120297 [debug] [MainThread]: Command end result
[0m12:44:05.145116 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:44:05.145116 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:44:05.145116 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:44:05.153988 [info ] [MainThread]: 
[0m12:44:05.154999 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:44:05.155996 [info ] [MainThread]: 
[0m12:44:05.155996 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected ')'.
  syntax error line 17 at position 1 unexpected ','.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m12:44:05.157002 [info ] [MainThread]: 
[0m12:44:05.158036 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:44:05.158998 [debug] [MainThread]: Command `dbt run` failed at 12:44:05.158998 after 6.07 seconds
[0m12:44:05.159836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086DB20320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086DB20770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002086DB977D0>]}
[0m12:44:05.159836 [debug] [MainThread]: Flushing usage events
[0m12:44:06.051683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:18.832999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E1E8A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E55351C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E5534BC0>]}


============================== 12:44:18.848814 | 1439a714-79b2-4020-a1b6-08dd2696d3cd ==============================
[0m12:44:18.848814 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:44:18.848814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_churn_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:44:19.340964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1439a714-79b2-4020-a1b6-08dd2696d3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E6175970>]}
[0m12:44:19.398076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1439a714-79b2-4020-a1b6-08dd2696d3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E4F29520>]}
[0m12:44:19.398076 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:44:19.894503 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:44:20.042066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:44:20.042066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:44:20.055369 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:44:20.074743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1439a714-79b2-4020-a1b6-08dd2696d3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E735C6B0>]}
[0m12:44:20.152723 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:44:20.157660 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:44:20.184355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1439a714-79b2-4020-a1b6-08dd2696d3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E758A420>]}
[0m12:44:20.184355 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:44:20.184355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1439a714-79b2-4020-a1b6-08dd2696d3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E75CD8E0>]}
[0m12:44:20.184355 [info ] [MainThread]: 
[0m12:44:20.184355 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:20.184355 [info ] [MainThread]: 
[0m12:44:20.184355 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:20.184355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:44:20.295050 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:44:20.296053 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:44:20.296053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:21.650125 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.354 seconds
[0m12:44:21.653866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:44:21.653866 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:44:21.653866 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:44:21.653866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:22.617100 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.955 seconds
[0m12:44:22.617100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1439a714-79b2-4020-a1b6-08dd2696d3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E76908C0>]}
[0m12:44:22.617100 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:44:22.617100 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:44:22.632884 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:44:22.632884 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:44:22.632884 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:44:22.632884 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:44:22.671910 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:44:22.671910 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:44:22.671910 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
) ,
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 1
)
-- SELECT 
--     last_payment_date ,COUNT(*) AS number_of_churned_customers
-- FROM churned_customers GROUP BY last_payment_date
SELECT * FROM churned_customers
        );
[0m12:44:22.671910 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:44:23.873390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.195 seconds
[0m12:44:23.884917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1439a714-79b2-4020-a1b6-08dd2696d3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E2901880>]}
[0m12:44:23.884917 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.25s]
[0m12:44:23.884917 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:44:23.901015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:23.901015 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:44:23.901015 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:44:24.232011 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:44:24.232011 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:44:24.564955 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:44:24.564955 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:44:24.906432 [info ] [MainThread]: 
[0m12:44:24.906432 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m12:44:24.906432 [debug] [MainThread]: Command end result
[0m12:44:24.925152 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:44:24.925152 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:44:24.944093 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:44:24.945057 [info ] [MainThread]: 
[0m12:44:24.945651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:44:24.946659 [info ] [MainThread]: 
[0m12:44:24.946659 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:44:24.947691 [debug] [MainThread]: Command `dbt run` succeeded at 12:44:24.947691 after 6.26 seconds
[0m12:44:24.947691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E55353D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E5534E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229E5534BC0>]}
[0m12:44:24.947691 [debug] [MainThread]: Flushing usage events
[0m12:44:25.826681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:55.094755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB8884950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB88848F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB8884620>]}


============================== 12:45:55.100207 | ae780fbf-5743-45fa-aa4d-4d00b04a8e99 ==============================
[0m12:45:55.100207 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:45:55.101207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_churn_customers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:55.593298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae780fbf-5743-45fa-aa4d-4d00b04a8e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB9524B00>]}
[0m12:45:55.647329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae780fbf-5743-45fa-aa4d-4d00b04a8e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB76BFC80>]}
[0m12:45:55.647329 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:45:56.127655 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:45:56.274404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:56.274404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:56.274404 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:45:56.297115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae780fbf-5743-45fa-aa4d-4d00b04a8e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB8552F60>]}
[0m12:45:56.365424 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:45:56.381175 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:45:56.414176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae780fbf-5743-45fa-aa4d-4d00b04a8e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBAA6A690>]}
[0m12:45:56.414829 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:45:56.414829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae780fbf-5743-45fa-aa4d-4d00b04a8e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBAA60410>]}
[0m12:45:56.414829 [info ] [MainThread]: 
[0m12:45:56.414829 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:56.414829 [info ] [MainThread]: 
[0m12:45:56.414829 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:45:56.414829 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:45:56.522667 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:45:56.522667 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:45:56.523666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:57.841562 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.318 seconds
[0m12:45:57.845162 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:45:57.845162 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:45:57.845162 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:45:57.845162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:58.835372 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.981 seconds
[0m12:45:58.848485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae780fbf-5743-45fa-aa4d-4d00b04a8e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBAD60440>]}
[0m12:45:58.864270 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:45:58.864270 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:45:58.864270 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:45:58.874119 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:45:58.885099 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:45:58.886481 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:45:58.917317 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:45:58.919324 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:45:58.919324 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 1
)

SELECT * FROM churned_customers
        );
[0m12:45:58.920361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:46:00.119934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.209 seconds
[0m12:46:00.151326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae780fbf-5743-45fa-aa4d-4d00b04a8e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB7D54AA0>]}
[0m12:46:00.151326 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.29s]
[0m12:46:00.151326 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:46:00.151326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:00.151326 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:46:00.151326 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:46:00.461465 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:46:00.461465 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:46:00.810004 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:46:00.810004 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:46:01.139524 [info ] [MainThread]: 
[0m12:46:01.139524 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m12:46:01.139524 [debug] [MainThread]: Command end result
[0m12:46:01.166060 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:46:01.167081 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:46:01.176138 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:46:01.176138 [info ] [MainThread]: 
[0m12:46:01.176138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:01.176138 [info ] [MainThread]: 
[0m12:46:01.176138 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:46:01.176138 [debug] [MainThread]: Command `dbt run` succeeded at 12:46:01.176138 after 6.26 seconds
[0m12:46:01.176138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB88678F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBA9981D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DB8A74BF0>]}
[0m12:46:01.176138 [debug] [MainThread]: Flushing usage events
[0m12:46:02.112811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:49.258708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB7484800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB74844D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB7484320>]}


============================== 12:46:49.258708 | 477319bf-cbe9-44c4-bd2d-1cea3570c8f5 ==============================
[0m12:46:49.258708 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:46:49.258708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:46:49.747278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '477319bf-cbe9-44c4-bd2d-1cea3570c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB8149850>]}
[0m12:46:49.811852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '477319bf-cbe9-44c4-bd2d-1cea3570c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB7467A10>]}
[0m12:46:49.818057 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:46:50.282073 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:46:50.430393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:50.430393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:50.430393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:46:50.468613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '477319bf-cbe9-44c4-bd2d-1cea3570c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB92FF680>]}
[0m12:46:50.535257 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:46:50.535257 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:46:50.566754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '477319bf-cbe9-44c4-bd2d-1cea3570c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB94CC9B0>]}
[0m12:46:50.566754 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:46:50.571053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '477319bf-cbe9-44c4-bd2d-1cea3570c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB9568410>]}
[0m12:46:50.571053 [info ] [MainThread]: 
[0m12:46:50.571053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:50.571053 [info ] [MainThread]: 
[0m12:46:50.571053 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:46:50.575609 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:46:50.679751 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:46:50.680721 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:46:50.680721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:52.001418 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.320 seconds
[0m12:46:52.005456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:46:52.005456 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:46:52.017238 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:46:52.017238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:53.025804 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.012 seconds
[0m12:46:53.025804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '477319bf-cbe9-44c4-bd2d-1cea3570c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB92FD550>]}
[0m12:46:53.035508 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:46:53.035508 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:46:53.035508 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:46:53.035508 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:46:53.035508 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:46:53.035508 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:46:53.071780 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:46:53.071780 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:46:53.071780 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
) SELECT * from customers
-- ,
-- last_payment AS (
--     SELECT
--         customer_id,
--         MAX(payment_month) AS last_payment_date
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- ),
-- churned_customers AS (
--     SELECT
--         c.customer_id,
--         c.customer_name,
--         c.company,
--         lp.last_payment_date
--     FROM customers c
--     JOIN last_payment lp
--         ON c.customer_id = lp.customer_id
--     WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 1
-- )

-- SELECT * FROM churned_customers
        );
[0m12:46:53.071780 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:46:54.396141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.313 seconds
[0m12:46:54.412279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '477319bf-cbe9-44c4-bd2d-1cea3570c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB4851880>]}
[0m12:46:54.412279 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.38s]
[0m12:46:54.412279 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:46:54.427929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:54.427929 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:46:54.427929 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:46:54.750870 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:46:54.750870 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:46:55.075248 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:46:55.075248 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:46:55.390693 [info ] [MainThread]: 
[0m12:46:55.390693 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.82 seconds (4.82s).
[0m12:46:55.406814 [debug] [MainThread]: Command end result
[0m12:46:55.433095 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:46:55.436119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:46:55.443180 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:46:55.443180 [info ] [MainThread]: 
[0m12:46:55.444183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:55.445182 [info ] [MainThread]: 
[0m12:46:55.445182 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:46:55.447185 [debug] [MainThread]: Command `dbt run` succeeded at 12:46:55.446181 after 6.35 seconds
[0m12:46:55.447185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB737AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB98C0AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB6C579E0>]}
[0m12:46:55.447185 [debug] [MainThread]: Flushing usage events
[0m12:46:56.358862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:38.216086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150DF91340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150DF90470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150DF93530>]}


============================== 12:47:38.222159 | 228ddfc3-fe50-49c5-942c-340739713ea3 ==============================
[0m12:47:38.222159 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:47:38.222159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_churn_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:47:38.698547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '228ddfc3-fe50-49c5-942c-340739713ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150ECC1850>]}
[0m12:47:38.763702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '228ddfc3-fe50-49c5-942c-340739713ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150B41B950>]}
[0m12:47:38.765706 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:47:39.244449 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:47:39.398326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:39.398326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:39.398326 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:47:39.435653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '228ddfc3-fe50-49c5-942c-340739713ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150E135760>]}
[0m12:47:39.501217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:47:39.511968 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:47:39.543344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '228ddfc3-fe50-49c5-942c-340739713ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215100B5D90>]}
[0m12:47:39.545352 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:47:39.545352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '228ddfc3-fe50-49c5-942c-340739713ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150DBA5970>]}
[0m12:47:39.545352 [info ] [MainThread]: 
[0m12:47:39.545352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:39.548642 [info ] [MainThread]: 
[0m12:47:39.548642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:39.548642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:47:39.653213 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:47:39.654211 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:47:39.654211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:41.275335 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.622 seconds
[0m12:47:41.281789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:47:41.291251 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:47:41.291251 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:47:41.291251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:42.293803 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.009 seconds
[0m12:47:42.293803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '228ddfc3-fe50-49c5-942c-340739713ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150FD9F320>]}
[0m12:47:42.309619 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:47:42.309619 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:47:42.309619 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:47:42.309619 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:47:42.309619 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:47:42.309619 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:47:42.353594 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:47:42.355634 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:47:42.355634 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
) SELECT * from last_payment
-- ,
-- churned_customers AS (
--     SELECT
--         c.customer_id,
--         c.customer_name,
--         c.company,
--         lp.last_payment_date
--     FROM customers c
--     JOIN last_payment lp
--         ON c.customer_id = lp.customer_id
--     WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 1
-- )

-- SELECT * FROM churned_customers
        );
[0m12:47:42.356636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:44.007197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.655 seconds
[0m12:47:44.023035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228ddfc3-fe50-49c5-942c-340739713ea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150B3318B0>]}
[0m12:47:44.023035 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.71s]
[0m12:47:44.038253 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:47:44.038253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:44.038253 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:47:44.038253 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:47:44.363631 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:47:44.363631 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:47:44.696983 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:47:44.699006 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:47:45.023645 [info ] [MainThread]: 
[0m12:47:45.023645 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m12:47:45.039555 [debug] [MainThread]: Command end result
[0m12:47:45.060526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:47:45.064045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:47:45.068064 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:47:45.068064 [info ] [MainThread]: 
[0m12:47:45.068064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:45.073002 [info ] [MainThread]: 
[0m12:47:45.073002 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:47:45.075046 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:45.075046 after 7.03 seconds
[0m12:47:45.075046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150EB94BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150FD7D460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150DE57950>]}
[0m12:47:45.076012 [debug] [MainThread]: Flushing usage events
[0m12:47:45.976348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:15.479884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104C9E2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104D4503E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104D4503B0>]}


============================== 12:48:15.479884 | 2550e023-9290-4094-80e3-6f0ecef13020 ==============================
[0m12:48:15.479884 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:48:15.479884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_churn_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:48:15.971730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2550e023-9290-4094-80e3-6f0ecef13020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104D314170>]}
[0m12:48:16.028555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2550e023-9290-4094-80e3-6f0ecef13020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104E129A00>]}
[0m12:48:16.028555 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:48:16.516415 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:48:16.671115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:16.671115 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:16.671115 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:48:16.708108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2550e023-9290-4094-80e3-6f0ecef13020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104F29BB90>]}
[0m12:48:16.784668 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:48:16.787388 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:48:16.803076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2550e023-9290-4094-80e3-6f0ecef13020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104F68DD30>]}
[0m12:48:16.818816 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:48:16.818816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2550e023-9290-4094-80e3-6f0ecef13020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104F34CE60>]}
[0m12:48:16.820822 [info ] [MainThread]: 
[0m12:48:16.820822 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:16.820822 [info ] [MainThread]: 
[0m12:48:16.820822 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:48:16.820822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:48:16.928827 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:48:16.928827 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:48:16.928827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:18.300687 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.368 seconds
[0m12:48:18.304443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:48:18.304443 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:48:18.304443 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:48:18.304443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:19.317996 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.000 seconds
[0m12:48:19.321737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2550e023-9290-4094-80e3-6f0ecef13020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104F9801A0>]}
[0m12:48:19.324920 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:48:19.324920 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:48:19.324920 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:48:19.324920 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:48:19.324920 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:48:19.324920 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:48:19.359731 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:48:19.359731 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:48:19.359731 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE DATEDIFF(month, lp.last_payment_date, CURRENT_DATE) <= 1
)

SELECT * FROM churned_customers
        );
[0m12:48:19.359731 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:48:20.649854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.280 seconds
[0m12:48:20.676030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2550e023-9290-4094-80e3-6f0ecef13020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104A851A30>]}
[0m12:48:20.677027 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.34s]
[0m12:48:20.678028 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:48:20.680028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:20.680028 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:48:20.680028 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:48:21.015103 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:48:21.015103 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:48:21.340786 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:48:21.340786 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:48:21.670357 [info ] [MainThread]: 
[0m12:48:21.670357 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m12:48:21.673077 [debug] [MainThread]: Command end result
[0m12:48:21.706775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:48:21.709836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:48:21.716692 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:48:21.718822 [info ] [MainThread]: 
[0m12:48:21.718822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:21.718822 [info ] [MainThread]: 
[0m12:48:21.718822 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:48:21.718822 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:21.718822 after 6.40 seconds
[0m12:48:21.718822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104CE3E330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104D1EAED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104B20E9C0>]}
[0m12:48:21.718822 [debug] [MainThread]: Flushing usage events
[0m12:48:22.648439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:25.679701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D27F67AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D2882A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D265A1400>]}


============================== 12:49:25.679701 | d751a68f-405a-4a8a-88c6-778680b527c1 ==============================
[0m12:49:25.679701 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:49:25.679701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:49:26.173348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd751a68f-405a-4a8a-88c6-778680b527c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D28A77E90>]}
[0m12:49:26.229401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd751a68f-405a-4a8a-88c6-778680b527c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D28635910>]}
[0m12:49:26.229401 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:49:26.700528 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:49:26.858911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:26.858911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:26.864933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:49:26.893008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd751a68f-405a-4a8a-88c6-778680b527c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D29643E60>]}
[0m12:49:26.957515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:49:26.962849 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:49:26.989217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd751a68f-405a-4a8a-88c6-778680b527c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D2AA8ED50>]}
[0m12:49:26.989217 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:49:26.996238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd751a68f-405a-4a8a-88c6-778680b527c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D2A8BC9E0>]}
[0m12:49:26.996238 [info ] [MainThread]: 
[0m12:49:26.996238 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:26.996238 [info ] [MainThread]: 
[0m12:49:26.996238 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:26.996238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:49:27.103183 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:49:27.104183 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:49:27.104183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:28.515051 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.421 seconds
[0m12:49:28.531023 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:49:28.548284 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:49:28.550290 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:49:28.550290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:29.518976 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.969 seconds
[0m12:49:29.531356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd751a68f-405a-4a8a-88c6-778680b527c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D2AA3A450>]}
[0m12:49:29.534995 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:49:29.534995 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:49:29.534995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:49:29.534995 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:49:29.534995 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:49:29.534995 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:49:29.579027 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:49:29.580990 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:49:29.580990 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE lp.last_payment_date >= DATEADD(month, -1, CURRENT_DATE)
)

SELECT * FROM churned_customers
        );
[0m12:49:29.582023 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:30.738715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.166 seconds
[0m12:49:30.795574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd751a68f-405a-4a8a-88c6-778680b527c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D25E61B80>]}
[0m12:49:30.796080 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.25s]
[0m12:49:30.796899 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:49:30.797920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:30.798937 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:49:30.798937 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:49:31.121180 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:49:31.121180 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:49:31.476420 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:49:31.476420 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:49:31.815691 [info ] [MainThread]: 
[0m12:49:31.816701 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.82 seconds (4.82s).
[0m12:49:31.818690 [debug] [MainThread]: Command end result
[0m12:49:31.844720 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:49:31.848686 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:49:31.855686 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:49:31.855686 [info ] [MainThread]: 
[0m12:49:31.856686 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:31.857685 [info ] [MainThread]: 
[0m12:49:31.857685 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:49:31.859029 [debug] [MainThread]: Command `dbt run` succeeded at 12:49:31.859029 after 6.33 seconds
[0m12:49:31.860070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D280F5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D285FF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D285FFD10>]}
[0m12:49:31.860070 [debug] [MainThread]: Flushing usage events
[0m12:49:33.104679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:49.269745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019721EBD520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019721EBCC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019721EBF260>]}


============================== 12:50:49.269745 | 846de7d9-5690-4d40-8b10-ffd1eaf745f3 ==============================
[0m12:50:49.269745 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:50:49.269745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:49.756842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '846de7d9-5690-4d40-8b10-ffd1eaf745f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019722BD4D70>]}
[0m12:50:49.814060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '846de7d9-5690-4d40-8b10-ffd1eaf745f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019722942E70>]}
[0m12:50:49.814060 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:50:50.289245 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:50:50.437474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:50.439479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:50.445498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:50:50.474323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '846de7d9-5690-4d40-8b10-ffd1eaf745f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019723CEE840>]}
[0m12:50:50.541301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:50:50.541301 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:50:50.576151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '846de7d9-5690-4d40-8b10-ffd1eaf745f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019723EEEAB0>]}
[0m12:50:50.576151 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:50:50.576151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '846de7d9-5690-4d40-8b10-ffd1eaf745f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019723EA5CD0>]}
[0m12:50:50.576151 [info ] [MainThread]: 
[0m12:50:50.580597 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:50.580597 [info ] [MainThread]: 
[0m12:50:50.580597 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:50:50.580597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:50:50.684705 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:50:50.684705 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:50:50.685705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:52.104788 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.420 seconds
[0m12:50:52.106804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:50:52.119108 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:50:52.119108 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:50:52.119108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:53.190281 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.077 seconds
[0m12:50:53.190281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '846de7d9-5690-4d40-8b10-ffd1eaf745f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019723F4C200>]}
[0m12:50:53.206109 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:50:53.206109 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:50:53.206109 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:50:53.206109 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:50:53.217601 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:50:53.217601 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:50:53.244230 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:50:53.244230 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:50:53.244230 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE lp.last_payment_date >= DATEADD(day, -30, CURRENT_DATE)
)

SELECT * FROM churned_customers
        );
[0m12:50:53.244230 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:50:54.497656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.241 seconds
[0m12:50:54.518487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846de7d9-5690-4d40-8b10-ffd1eaf745f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971F2718E0>]}
[0m12:50:54.518487 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.31s]
[0m12:50:54.527949 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:50:54.530191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:54.531185 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:50:54.531185 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:50:54.854014 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:50:54.855020 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:50:55.179248 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:50:55.179248 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:50:55.519537 [info ] [MainThread]: 
[0m12:50:55.520097 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m12:50:55.521209 [debug] [MainThread]: Command end result
[0m12:50:55.544114 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:50:55.547244 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:50:55.555448 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:50:55.555448 [info ] [MainThread]: 
[0m12:50:55.556447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:55.556447 [info ] [MainThread]: 
[0m12:50:55.557445 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:50:55.558445 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:55.558445 after 6.44 seconds
[0m12:50:55.559473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019721B07950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971FB41400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019721EBC9E0>]}
[0m12:50:55.559473 [debug] [MainThread]: Flushing usage events
[0m12:50:56.805232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:22.005185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FC794590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FC7946E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FC794350>]}


============================== 12:51:22.005185 | 4379dd5f-96ea-46e3-b77d-2c5e128639d0 ==============================
[0m12:51:22.005185 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:51:22.005185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:51:22.486679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4379dd5f-96ea-46e3-b77d-2c5e128639d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FD33ACF0>]}
[0m12:51:22.550321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4379dd5f-96ea-46e3-b77d-2c5e128639d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FD514CE0>]}
[0m12:51:22.552328 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:51:23.004862 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:51:23.163636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:23.163636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:23.163636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:51:23.195554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4379dd5f-96ea-46e3-b77d-2c5e128639d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FE62C530>]}
[0m12:51:23.269078 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:51:23.273456 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:51:23.301916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4379dd5f-96ea-46e3-b77d-2c5e128639d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FE7FE2D0>]}
[0m12:51:23.301916 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:51:23.304464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4379dd5f-96ea-46e3-b77d-2c5e128639d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FD517F20>]}
[0m12:51:23.304464 [info ] [MainThread]: 
[0m12:51:23.304464 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:23.304464 [info ] [MainThread]: 
[0m12:51:23.304464 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:51:23.304464 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:51:23.412261 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:51:23.412261 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:51:23.413264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:24.687818 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.281 seconds
[0m12:51:24.687818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:51:24.703792 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:51:24.703792 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:51:24.703792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:25.707011 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.006 seconds
[0m12:51:25.707011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4379dd5f-96ea-46e3-b77d-2c5e128639d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FE7BB080>]}
[0m12:51:25.724936 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:51:25.724936 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:51:25.725902 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:51:25.727074 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:51:25.734117 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:51:25.735102 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:51:25.760071 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:51:25.760071 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:51:25.760071 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    -- WHERE lp.last_payment_date >= DATEADD(day, -30, CURRENT_DATE)
)

SELECT * FROM churned_customers
        );
[0m12:51:25.760071 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:51:27.169954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.405 seconds
[0m12:51:27.185724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4379dd5f-96ea-46e3-b77d-2c5e128639d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F9B619D0>]}
[0m12:51:27.185724 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.46s]
[0m12:51:27.185724 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:51:27.201825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:27.201825 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:51:27.201825 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:51:27.536122 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:51:27.538134 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:51:27.877336 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:51:27.877336 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:51:28.203876 [info ] [MainThread]: 
[0m12:51:28.203876 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m12:51:28.203876 [debug] [MainThread]: Command end result
[0m12:51:28.234770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:51:28.234770 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:51:28.234770 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:51:28.234770 [info ] [MainThread]: 
[0m12:51:28.245073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:28.247080 [info ] [MainThread]: 
[0m12:51:28.247080 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:51:28.248123 [debug] [MainThread]: Command `dbt run` succeeded at 12:51:28.248123 after 6.40 seconds
[0m12:51:28.249087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FC43AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FC7C6FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268FC794710>]}
[0m12:51:28.249087 [debug] [MainThread]: Flushing usage events
[0m12:51:29.126412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:12.947624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD068CDD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD068CFEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD068CCB90>]}


============================== 12:53:12.947624 | d12ff92e-143f-4686-86db-9ef4ec2d3e14 ==============================
[0m12:53:12.947624 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:53:12.947624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_churn_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:53:13.428199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd12ff92e-143f-4686-86db-9ef4ec2d3e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD07509790>]}
[0m12:53:13.491724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd12ff92e-143f-4686-86db-9ef4ec2d3e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD068EA660>]}
[0m12:53:13.491724 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:53:13.967473 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:53:14.115485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:14.117492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:14.121504 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:53:14.151192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd12ff92e-143f-4686-86db-9ef4ec2d3e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0770B770>]}
[0m12:53:14.217110 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:53:14.217110 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:53:14.248951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd12ff92e-143f-4686-86db-9ef4ec2d3e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD08A219D0>]}
[0m12:53:14.248951 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:53:14.248951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd12ff92e-143f-4686-86db-9ef4ec2d3e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD07680950>]}
[0m12:53:14.248951 [info ] [MainThread]: 
[0m12:53:14.248951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:14.248951 [info ] [MainThread]: 
[0m12:53:14.248951 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:53:14.248951 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:53:14.365009 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:53:14.365009 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:53:14.366009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:15.657134 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.292 seconds
[0m12:53:15.661049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:53:15.675226 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:53:15.675226 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:53:15.675226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:16.681293 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.006 seconds
[0m12:53:16.681293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd12ff92e-143f-4686-86db-9ef4ec2d3e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD08839340>]}
[0m12:53:16.681293 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:53:16.681293 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:53:16.681293 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:53:16.681293 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:53:16.701154 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:53:16.701154 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:53:16.736028 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:53:16.737242 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:53:16.737242 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
     WHERE lp.last_payment_date >= CURRENT_DATE - INTERVAL '30 days'
)

SELECT * FROM churned_customers
        );
[0m12:53:16.737242 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:53:17.889039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.152 seconds
[0m12:53:17.904686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12ff92e-143f-4686-86db-9ef4ec2d3e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD05D74710>]}
[0m12:53:17.904686 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.22s]
[0m12:53:17.920932 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:53:17.921337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:17.921337 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:53:17.921337 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:53:18.253911 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:53:18.253911 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:53:18.805949 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:53:18.805949 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:53:19.139531 [info ] [MainThread]: 
[0m12:53:19.139531 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m12:53:19.139531 [debug] [MainThread]: Command end result
[0m12:53:19.169158 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:53:19.175571 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:53:19.179494 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:53:19.179494 [info ] [MainThread]: 
[0m12:53:19.179494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:19.179494 [info ] [MainThread]: 
[0m12:53:19.179494 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:53:19.179494 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:19.179494 after 6.40 seconds
[0m12:53:19.179494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD03D8B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD063DAA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD0460E780>]}
[0m12:53:19.179494 [debug] [MainThread]: Flushing usage events
[0m12:53:20.408430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:41.898985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A05A0E0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A059D5A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A05A0E1100>]}


============================== 12:58:41.898985 | cb6d0811-2c9f-4119-a86f-6929b507437d ==============================
[0m12:58:41.898985 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:58:41.898985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:58:42.846778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb6d0811-2c9f-4119-a86f-6929b507437d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A05961A3F0>]}
[0m12:58:42.905913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb6d0811-2c9f-4119-a86f-6929b507437d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A05A234B30>]}
[0m12:58:42.907918 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:58:43.484447 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:58:43.630269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:43.630269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:43.630269 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m12:58:43.664344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb6d0811-2c9f-4119-a86f-6929b507437d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A05C0CD220>]}
[0m12:58:43.730761 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:58:43.751380 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:58:43.787291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb6d0811-2c9f-4119-a86f-6929b507437d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A05C211BB0>]}
[0m12:58:43.788291 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:58:43.789293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb6d0811-2c9f-4119-a86f-6929b507437d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A05C185370>]}
[0m12:58:43.790320 [info ] [MainThread]: 
[0m12:58:43.791291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:43.791291 [info ] [MainThread]: 
[0m12:58:43.792290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:58:43.793290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m12:58:46.981899 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m12:58:46.992318 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m12:58:46.992318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:48.357998 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.378 seconds
[0m12:58:48.389890 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m12:58:48.389890 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m12:58:48.389890 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m12:58:48.389890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:49.391588 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.997 seconds
[0m12:58:49.391588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb6d0811-2c9f-4119-a86f-6929b507437d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A05C210DA0>]}
[0m12:58:49.407286 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m12:58:49.407286 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m12:58:49.407286 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m12:58:49.407286 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m12:58:49.407286 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:58:49.407286 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m12:58:49.452019 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m12:58:49.454017 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m12:58:49.454017 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
     WHERE lp.last_payment_date >=(CURRENT_DATE - INTERVAL '30 days')::DATE
)

SELECT * FROM churned_customers
        );
[0m12:58:49.455018 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:50.603772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.164 seconds
[0m12:58:50.635218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6d0811-2c9f-4119-a86f-6929b507437d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0574818B0>]}
[0m12:58:50.635218 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.23s]
[0m12:58:50.635218 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m12:58:50.635218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:50.635218 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m12:58:50.635218 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m12:58:50.957271 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m12:58:50.957271 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m12:58:51.283763 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m12:58:51.283763 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m12:58:51.607384 [info ] [MainThread]: 
[0m12:58:51.607384 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.82 seconds (7.82s).
[0m12:58:51.623270 [debug] [MainThread]: Command end result
[0m12:58:51.660486 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m12:58:51.660486 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m12:58:51.673914 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m12:58:51.675921 [info ] [MainThread]: 
[0m12:58:51.675921 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:51.675921 [info ] [MainThread]: 
[0m12:58:51.675921 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:58:51.675921 [debug] [MainThread]: Command `dbt run` succeeded at 12:58:51.675921 after 9.95 seconds
[0m12:58:51.675921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A059D5A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A057E7E840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A057E7E7E0>]}
[0m12:58:51.675921 [debug] [MainThread]: Flushing usage events
[0m12:58:53.091543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:00:19.073083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FC350530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FC3513D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FC3507D0>]}


============================== 13:00:19.073083 | c0c7eb29-7ced-4919-a824-4b38826bb5b8 ==============================
[0m13:00:19.073083 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:00:19.073083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_churn_customers', 'send_anonymous_usage_stats': 'True'}
[0m13:00:19.562661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0c7eb29-7ced-4919-a824-4b38826bb5b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FBE8F140>]}
[0m13:00:19.621856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0c7eb29-7ced-4919-a824-4b38826bb5b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FD024E60>]}
[0m13:00:19.621856 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:00:20.108086 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:00:20.265860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:20.265860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:20.265860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:00:20.293059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0c7eb29-7ced-4919-a824-4b38826bb5b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FE0D2DB0>]}
[0m13:00:20.371126 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:00:20.374723 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:00:20.389846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0c7eb29-7ced-4919-a824-4b38826bb5b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FE15F530>]}
[0m13:00:20.404721 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m13:00:20.404721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0c7eb29-7ced-4919-a824-4b38826bb5b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FE13CA10>]}
[0m13:00:20.405728 [info ] [MainThread]: 
[0m13:00:20.405728 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:00:20.405728 [info ] [MainThread]: 
[0m13:00:20.405728 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:20.405728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:00:20.513519 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:00:20.513519 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:00:20.514521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:21.788900 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.277 seconds
[0m13:00:21.805049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:00:21.836860 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:00:21.836860 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:00:21.836860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:22.803052 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.971 seconds
[0m13:00:22.817135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0c7eb29-7ced-4919-a824-4b38826bb5b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FD082030>]}
[0m13:00:22.817135 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m13:00:22.817135 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m13:00:22.817135 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m13:00:22.817135 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m13:00:22.833662 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m13:00:22.834669 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m13:00:22.867610 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m13:00:22.869618 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m13:00:22.869618 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
     WHERE lp.last_payment_date >=(CURRENT_DATE - INTERVAL '30 days')::DATE
)

SELECT * FROM churned_customers
        );
[0m13:00:22.870618 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:00:23.932740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.076 seconds
[0m13:00:23.964545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0c7eb29-7ced-4919-a824-4b38826bb5b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F96F1700>]}
[0m13:00:23.964545 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.15s]
[0m13:00:23.964545 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m13:00:23.964545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:23.964545 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:00:23.964545 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:00:24.288449 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:00:24.288449 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:00:24.612609 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m13:00:24.612609 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m13:00:24.950968 [info ] [MainThread]: 
[0m13:00:24.950968 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m13:00:24.968864 [debug] [MainThread]: Command end result
[0m13:00:25.001773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:00:25.001773 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:00:25.014920 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:00:25.014920 [info ] [MainThread]: 
[0m13:00:25.014920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:25.014920 [info ] [MainThread]: 
[0m13:00:25.014920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:00:25.014920 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:25.014920 after 6.11 seconds
[0m13:00:25.014920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246F8D0ADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FC1EC0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FC4F5370>]}
[0m13:00:25.014920 [debug] [MainThread]: Flushing usage events
[0m13:00:25.966363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:27.985940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE7E16CAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE7E16CD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE7E16D2E0>]}


============================== 13:03:28.001924 | 839234a2-83a0-4165-8d1b-286e9965b5a6 ==============================
[0m13:03:28.001924 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:03:28.001924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_new_customers', 'send_anonymous_usage_stats': 'True'}
[0m13:03:28.478131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '839234a2-83a0-4165-8d1b-286e9965b5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE7E16DC40>]}
[0m13:03:28.525837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '839234a2-83a0-4165-8d1b-286e9965b5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE7DF9CCE0>]}
[0m13:03:28.541937 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:03:29.013684 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:03:29.178763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:29.178763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:29.184783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:03:29.214525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '839234a2-83a0-4165-8d1b-286e9965b5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE7FF9D4F0>]}
[0m13:03:29.279533 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:03:29.279533 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:03:29.314411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '839234a2-83a0-4165-8d1b-286e9965b5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE0019ED20>]}
[0m13:03:29.314411 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:03:29.325455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '839234a2-83a0-4165-8d1b-286e9965b5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE7EE88FB0>]}
[0m13:03:29.327502 [info ] [MainThread]: 
[0m13:03:29.327502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:03:29.327502 [info ] [MainThread]: 
[0m13:03:29.327502 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:03:29.327502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:03:29.436969 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:03:29.436969 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:03:29.437972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:30.782594 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.346 seconds
[0m13:03:30.784603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:03:30.794478 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:03:30.794478 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:03:30.794478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:31.764922 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.974 seconds
[0m13:03:31.764922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '839234a2-83a0-4165-8d1b-286e9965b5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE003068D0>]}
[0m13:03:31.780796 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m13:03:31.780796 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_new_customers .................. [RUN]
[0m13:03:31.780796 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m13:03:31.780796 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m13:03:31.792863 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m13:03:31.792863 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m13:03:31.816011 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_new_customers"
[0m13:03:31.825907 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_new_customers"
[0m13:03:31.825907 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_new_customers
         as
        (WITH customers AS (
    SELECT customer_id, customer_name, company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
first_payment AS (
    SELECT customer_id, MIN(payment_month)::DATE AS first_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
new_customers AS (
SELECT c.customer_id, c.customer_name, c.company, fp.first_payment_date
    FROM customers c
    JOIN first_payment fp ON c.customer_id = fp.customer_id
    WHERE fp.first_payment_date >= (CURRENT_DATE - INTERVAL '1 year')::DATE
)
SELECT * FROM new_customers
        );
[0m13:03:31.825907 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:03:33.059465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.243 seconds
[0m13:03:33.091141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '839234a2-83a0-4165-8d1b-286e9965b5a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE7B521940>]}
[0m13:03:33.091141 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_new_customers ............. [[32mSUCCESS 1[0m in 1.31s]
[0m13:03:33.091141 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m13:03:33.091141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:33.091141 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:03:33.091141 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:03:33.414893 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:03:33.414893 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:03:33.952412 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was left open.
[0m13:03:33.959939 [debug] [MainThread]: On model.CRB_PROJECT.stg_new_customers: Close
[0m13:03:34.263291 [info ] [MainThread]: 
[0m13:03:34.263291 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m13:03:34.263291 [debug] [MainThread]: Command end result
[0m13:03:34.299400 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:03:34.302757 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:03:34.309724 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:03:34.309724 [info ] [MainThread]: 
[0m13:03:34.309724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:03:34.309724 [info ] [MainThread]: 
[0m13:03:34.309724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:03:34.309724 [debug] [MainThread]: Command `dbt run` succeeded at 13:03:34.309724 after 6.47 seconds
[0m13:03:34.309724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE7DE40590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE7BF1E6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE7BF1E5A0>]}
[0m13:03:34.309724 [debug] [MainThread]: Flushing usage events
[0m13:03:35.206909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:08:11.755316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F5030380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F5033D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F5030B00>]}


============================== 13:08:11.771056 | cd5ecb07-908a-4a53-ac1d-adfad6035b5f ==============================
[0m13:08:11.771056 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:08:11.771056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_new_customers', 'send_anonymous_usage_stats': 'True'}
[0m13:08:12.241473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd5ecb07-908a-4a53-ac1d-adfad6035b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F5D92870>]}
[0m13:08:12.304498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd5ecb07-908a-4a53-ac1d-adfad6035b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F4481C40>]}
[0m13:08:12.304498 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:08:12.807975 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:08:12.949995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:08:12.949995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:08:12.966058 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:08:12.997153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd5ecb07-908a-4a53-ac1d-adfad6035b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F6E6F440>]}
[0m13:08:13.061935 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:08:13.061935 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:08:13.099439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd5ecb07-908a-4a53-ac1d-adfad6035b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F701EA20>]}
[0m13:08:13.099439 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:08:13.099439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd5ecb07-908a-4a53-ac1d-adfad6035b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F5D05370>]}
[0m13:08:13.099439 [info ] [MainThread]: 
[0m13:08:13.099439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:08:13.099439 [info ] [MainThread]: 
[0m13:08:13.099439 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:08:13.099439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:08:13.212698 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:08:13.212698 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:08:13.212698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:14.610392 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.397 seconds
[0m13:08:14.623031 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:08:14.633052 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:08:14.633052 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:08:14.633052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:15.554081 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.932 seconds
[0m13:08:15.569873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd5ecb07-908a-4a53-ac1d-adfad6035b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F71B6810>]}
[0m13:08:15.569873 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m13:08:15.569873 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_new_customers .................. [RUN]
[0m13:08:15.569873 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m13:08:15.569873 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m13:08:15.588666 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m13:08:15.589962 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m13:08:15.621545 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_new_customers"
[0m13:08:15.622547 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_new_customers"
[0m13:08:15.624084 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_new_customers
         as
        (WITH customers AS (
    SELECT customer_id, customer_name, company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
first_payment AS (
    SELECT customer_id, MIN(payment_month)::DATE AS first_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
new_customers AS (
    SELECT c.customer_id, c.customer_name, c.company, fp.first_payment_date
    FROM customers c
    JOIN first_payment fp ON c.customer_id = fp.customer_id
    WHERE fp.first_payment_date >= DATEADD(year, -1, CURRENT_DATE)
)
SELECT * FROM new_customers;
[0m13:08:15.624084 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:08:16.747655 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff6a-3201-7d7b-000c-493e00022502
[0m13:08:16.747655 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 27 unexpected ';'.
[0m13:08:16.763301 [debug] [Thread-1 (]: Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 27 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql
[0m13:08:16.763301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd5ecb07-908a-4a53-ac1d-adfad6035b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F44D4860>]}
[0m13:08:16.763301 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_new_customers ......... [[31mERROR[0m in 1.19s]
[0m13:08:16.763301 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m13:08:16.763301 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 27 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql.
[0m13:08:16.763301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:16.763301 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:08:16.763301 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:08:17.092759 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:08:17.092759 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:08:17.427665 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was left open.
[0m13:08:17.427665 [debug] [MainThread]: On model.CRB_PROJECT.stg_new_customers: Close
[0m13:08:17.763993 [info ] [MainThread]: 
[0m13:08:17.763993 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m13:08:17.763993 [debug] [MainThread]: Command end result
[0m13:08:17.791260 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:08:17.794173 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:08:17.801979 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:08:17.801979 [info ] [MainThread]: 
[0m13:08:17.802979 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:08:17.802979 [info ] [MainThread]: 
[0m13:08:17.803979 [error] [MainThread]:   Database Error in model stg_new_customers (models\stage\stg_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 27 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_new_customers.sql
[0m13:08:17.804976 [info ] [MainThread]: 
[0m13:08:17.805977 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:08:17.806371 [debug] [MainThread]: Command `dbt run` failed at 13:08:17.806371 after 6.21 seconds
[0m13:08:17.806371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F4AB0B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F5D04BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F4481C10>]}
[0m13:08:17.806371 [debug] [MainThread]: Flushing usage events
[0m13:08:19.018743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:08:24.827528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F5E7C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F5E7FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F5E7F590>]}


============================== 13:08:24.841251 | 9e6582c8-6267-4d89-91c0-c266549552a8 ==============================
[0m13:08:24.841251 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:08:24.842256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_new_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:08:25.311842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e6582c8-6267-4d89-91c0-c266549552a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F7BD8E00>]}
[0m13:08:25.375184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e6582c8-6267-4d89-91c0-c266549552a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F6B27BF0>]}
[0m13:08:25.375184 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:08:25.853069 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:08:25.988683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:08:25.988683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:08:26.004575 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:08:26.026592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e6582c8-6267-4d89-91c0-c266549552a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F7C014F0>]}
[0m13:08:26.092342 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:08:26.108891 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:08:26.143257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e6582c8-6267-4d89-91c0-c266549552a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F7DE94F0>]}
[0m13:08:26.143257 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:08:26.143257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e6582c8-6267-4d89-91c0-c266549552a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F6B25370>]}
[0m13:08:26.143257 [info ] [MainThread]: 
[0m13:08:26.147075 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:08:26.147075 [info ] [MainThread]: 
[0m13:08:26.147075 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:08:26.147075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:08:26.243224 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:08:26.243224 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:08:26.243224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:27.321994 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.086 seconds
[0m13:08:27.343356 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:08:27.346246 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:08:27.346246 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:08:27.346246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:28.341368 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.002 seconds
[0m13:08:28.367911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e6582c8-6267-4d89-91c0-c266549552a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F5359D00>]}
[0m13:08:28.372780 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m13:08:28.372780 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_new_customers .................. [RUN]
[0m13:08:28.372780 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m13:08:28.372780 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m13:08:28.372780 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m13:08:28.372780 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m13:08:28.411282 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_new_customers"
[0m13:08:28.411282 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_new_customers"
[0m13:08:28.411282 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_new_customers
         as
        (WITH customers AS (
    SELECT customer_id, customer_name, company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
first_payment AS (
    SELECT customer_id, MIN(payment_month)::DATE AS first_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
new_customers AS (
    SELECT c.customer_id, c.customer_name, c.company, fp.first_payment_date
    FROM customers c
    JOIN first_payment fp ON c.customer_id = fp.customer_id
    WHERE fp.first_payment_date >= DATEADD(year, -1, CURRENT_DATE)
)
SELECT * FROM new_customers
        );
[0m13:08:28.411282 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:08:29.664720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.255 seconds
[0m13:08:29.696824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e6582c8-6267-4d89-91c0-c266549552a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F3241910>]}
[0m13:08:29.696824 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_new_customers ............. [[32mSUCCESS 1[0m in 1.32s]
[0m13:08:29.696824 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m13:08:29.696824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:29.696824 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:08:29.696824 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:08:30.023543 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:08:30.023543 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:08:30.367408 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was left open.
[0m13:08:30.367408 [debug] [MainThread]: On model.CRB_PROJECT.stg_new_customers: Close
[0m13:08:30.681104 [info ] [MainThread]: 
[0m13:08:30.681104 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m13:08:30.681104 [debug] [MainThread]: Command end result
[0m13:08:30.706529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:08:30.708546 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:08:30.715894 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:08:30.716898 [info ] [MainThread]: 
[0m13:08:30.716898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:08:30.717897 [info ] [MainThread]: 
[0m13:08:30.718895 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:08:30.719897 [debug] [MainThread]: Command `dbt run` succeeded at 13:08:30.719897 after 6.04 seconds
[0m13:08:30.719897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F5602660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F5601C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F7DE94F0>]}
[0m13:08:30.719897 [debug] [MainThread]: Flushing usage events
[0m13:08:31.636912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:50.858742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290ABEA59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290AC789400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290AE73D5B0>]}


============================== 13:09:50.858742 | 21356457-6121-4cfc-910d-f2d8b4eb93ef ==============================
[0m13:09:50.858742 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:09:50.858742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_new_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:09:51.356937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21356457-6121-4cfc-910d-f2d8b4eb93ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290AEBB7B90>]}
[0m13:09:51.420822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21356457-6121-4cfc-910d-f2d8b4eb93ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290AE5511C0>]}
[0m13:09:51.420822 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:09:51.906192 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:09:52.064738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:09:52.064738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:09:52.064738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:09:52.099708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21356457-6121-4cfc-910d-f2d8b4eb93ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290B0A0B320>]}
[0m13:09:52.160527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:09:52.176612 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:09:52.210497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21356457-6121-4cfc-910d-f2d8b4eb93ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290B0D29E80>]}
[0m13:09:52.210497 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:09:52.210497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21356457-6121-4cfc-910d-f2d8b4eb93ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290B0B82E10>]}
[0m13:09:52.210497 [info ] [MainThread]: 
[0m13:09:52.215849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:09:52.215849 [info ] [MainThread]: 
[0m13:09:52.215849 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:09:52.215849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:09:52.328076 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:09:52.328076 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:09:52.328076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:53.938645 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.601 seconds
[0m13:09:53.945794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:09:53.954832 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:09:53.955810 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:09:53.955810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:54.875657 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.920 seconds
[0m13:09:54.878704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21356457-6121-4cfc-910d-f2d8b4eb93ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290AC938F80>]}
[0m13:09:54.880658 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m13:09:54.880658 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_new_customers .................. [RUN]
[0m13:09:54.880658 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m13:09:54.880658 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m13:09:54.888494 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m13:09:54.888494 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m13:09:54.930054 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_new_customers"
[0m13:09:54.932226 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_new_customers"
[0m13:09:54.933226 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_new_customers
         as
        (WITH customers AS (
    SELECT customer_id, customer_name, company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
first_payment AS (
    SELECT customer_id, MIN(payment_month)::DATE AS first_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
new_customers AS (
    SELECT c.customer_id, c.customer_name, c.company, fp.first_payment_date
    FROM customers c
    JOIN first_payment fp ON c.customer_id = fp.customer_id
    WHERE fp.first_payment_date >= DATEADD(day, -365, CURRENT_DATE)
)
SELECT * FROM new_customers
        );
[0m13:09:54.933226 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:09:56.096476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.166 seconds
[0m13:09:56.119208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21356457-6121-4cfc-910d-f2d8b4eb93ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290AC033410>]}
[0m13:09:56.119208 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_new_customers ............. [[32mSUCCESS 1[0m in 1.24s]
[0m13:09:56.119208 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m13:09:56.128326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:56.128326 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:09:56.128326 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:09:56.471712 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:09:56.471712 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:09:56.791477 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was left open.
[0m13:09:56.791477 [debug] [MainThread]: On model.CRB_PROJECT.stg_new_customers: Close
[0m13:09:57.132531 [info ] [MainThread]: 
[0m13:09:57.132531 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m13:09:57.132531 [debug] [MainThread]: Command end result
[0m13:09:57.171631 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:09:57.171631 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:09:57.171631 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:09:57.171631 [info ] [MainThread]: 
[0m13:09:57.182289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:09:57.183444 [info ] [MainThread]: 
[0m13:09:57.184785 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:09:57.184785 [debug] [MainThread]: Command `dbt run` succeeded at 13:09:57.184785 after 6.49 seconds
[0m13:09:57.184785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290AC720B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290AE101F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290AE6835F0>]}
[0m13:09:57.184785 [debug] [MainThread]: Flushing usage events
[0m13:09:58.404648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:03.593266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EE4428A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EE1AA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EE441820>]}


============================== 13:16:03.608594 | 7eaecfca-c438-4078-b369-375151734147 ==============================
[0m13:16:03.608594 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:16:03.608594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_new_customers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:16:05.274503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7eaecfca-c438-4078-b369-375151734147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EEFFE120>]}
[0m13:16:05.332183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7eaecfca-c438-4078-b369-375151734147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EF1FF3B0>]}
[0m13:16:05.332183 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:16:05.974842 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:16:06.131429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:16:06.131429 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:16:06.137190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:16:06.168288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eaecfca-c438-4078-b369-375151734147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F02B9F70>]}
[0m13:16:06.232791 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:16:06.264820 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:16:06.360916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eaecfca-c438-4078-b369-375151734147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F05E5EB0>]}
[0m13:16:06.360916 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:16:06.365603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eaecfca-c438-4078-b369-375151734147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F0602030>]}
[0m13:16:06.367026 [info ] [MainThread]: 
[0m13:16:06.368066 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:06.370036 [info ] [MainThread]: 
[0m13:16:06.376002 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:16:06.379566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:16:10.445576 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:16:10.445576 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:16:10.445576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:11.919418 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.487 seconds
[0m13:16:11.935558 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:16:11.951332 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:16:11.951332 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:16:11.951332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:13.264135 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.300 seconds
[0m13:16:13.267128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eaecfca-c438-4078-b369-375151734147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F0A1A1E0>]}
[0m13:16:13.273447 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_new_customers
[0m13:16:13.273447 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_new_customers .................. [RUN]
[0m13:16:13.273447 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_new_customers'
[0m13:16:13.273447 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_new_customers
[0m13:16:13.273447 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_new_customers"
[0m13:16:13.273447 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_new_customers
[0m13:16:13.311307 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_new_customers"
[0m13:16:13.311307 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_new_customers"
[0m13:16:13.311307 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_new_customers
         as
        (WITH customers AS (
    SELECT customer_id, customer_name, company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
first_payment AS (
    SELECT customer_id, MIN(payment_month)::DATE AS first_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
new_customers AS (
    SELECT c.customer_id, c.customer_name, c.company, fp.first_payment_date
    FROM customers c
    JOIN first_payment fp ON c.customer_id = fp.customer_id
    WHERE fp.first_payment_date >= DATEADD(day, -365, CURRENT_DATE)
)
SELECT * FROM new_customers
        );
[0m13:16:13.311307 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:16:14.613708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.309 seconds
[0m13:16:14.644702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eaecfca-c438-4078-b369-375151734147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F0A39A60>]}
[0m13:16:14.644702 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_new_customers ............. [[32mSUCCESS 1[0m in 1.37s]
[0m13:16:14.644702 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_new_customers
[0m13:16:14.644702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:14.644702 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:16:14.644702 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:16:14.968321 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:16:14.968321 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:16:15.303282 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_new_customers' was left open.
[0m13:16:15.303282 [debug] [MainThread]: On model.CRB_PROJECT.stg_new_customers: Close
[0m13:16:15.629430 [info ] [MainThread]: 
[0m13:16:15.629430 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.25 seconds (9.25s).
[0m13:16:15.630436 [debug] [MainThread]: Command end result
[0m13:16:15.653493 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:16:15.656556 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:16:15.663984 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:16:15.664987 [info ] [MainThread]: 
[0m13:16:15.665987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:15.665987 [info ] [MainThread]: 
[0m13:16:15.665987 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:16:15.665987 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:15.665987 after 12.25 seconds
[0m13:16:15.665987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EC08DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F0419670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EBBD0DA0>]}
[0m13:16:15.665987 [debug] [MainThread]: Flushing usage events
[0m13:16:16.633555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:28.547865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002944CE2A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029450421430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029450420560>]}


============================== 13:16:28.547865 | bed8dfb9-0a69-40b9-9fc7-2142b3e5cd4d ==============================
[0m13:16:28.547865 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:16:28.547865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_churn_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:16:29.050197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bed8dfb9-0a69-40b9-9fc7-2142b3e5cd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002945115CB00>]}
[0m13:16:29.097831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bed8dfb9-0a69-40b9-9fc7-2142b3e5cd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002945101A510>]}
[0m13:16:29.097831 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:16:29.587975 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:16:29.737683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:16:29.737683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:16:29.737683 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:16:29.775158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bed8dfb9-0a69-40b9-9fc7-2142b3e5cd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029452189730>]}
[0m13:16:29.843708 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:16:29.847721 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:16:29.875180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bed8dfb9-0a69-40b9-9fc7-2142b3e5cd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294523ED130>]}
[0m13:16:29.875180 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:16:29.875180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed8dfb9-0a69-40b9-9fc7-2142b3e5cd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294510AC9E0>]}
[0m13:16:29.875180 [info ] [MainThread]: 
[0m13:16:29.875180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:29.875180 [info ] [MainThread]: 
[0m13:16:29.875180 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:16:29.875180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:16:29.987184 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:16:29.987184 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:16:29.988184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:31.435787 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.452 seconds
[0m13:16:31.451657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:16:31.467733 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:16:31.467733 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:16:31.467733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:32.440652 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.982 seconds
[0m13:16:32.456407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed8dfb9-0a69-40b9-9fc7-2142b3e5cd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029452189DF0>]}
[0m13:16:32.460470 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m13:16:32.460470 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m13:16:32.460470 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m13:16:32.460470 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m13:16:32.479076 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m13:16:32.479630 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m13:16:32.511070 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m13:16:32.513039 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m13:16:32.514071 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    WHERE revenue_type = 1
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE lp.last_payment_date >= (CURRENT_DATE - INTERVAL '1 year')::DATE
)

SELECT * FROM churned_customers;
[0m13:16:32.514071 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:16:33.666485 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff72-3201-7e56-000c-493e000243a2
[0m13:16:33.666485 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 30 at position 31 unexpected ';'.
[0m13:16:33.694126 [debug] [Thread-1 (]: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 31 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m13:16:33.698371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed8dfb9-0a69-40b9-9fc7-2142b3e5cd4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002944F8C4950>]}
[0m13:16:33.698371 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.stg_churn_customers ....... [[31mERROR[0m in 1.23s]
[0m13:16:33.698371 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m13:16:33.698371 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.stg_churn_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 31 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql.
[0m13:16:33.698371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:33.698371 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:16:33.698371 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:16:34.025178 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:16:34.025178 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:16:34.344549 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m13:16:34.344549 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m13:16:34.673843 [info ] [MainThread]: 
[0m13:16:34.675314 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m13:16:34.676460 [debug] [MainThread]: Command end result
[0m13:16:34.699623 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:16:34.699623 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:16:34.710217 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:16:34.710217 [info ] [MainThread]: 
[0m13:16:34.711217 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:16:34.721138 [info ] [MainThread]: 
[0m13:16:34.722139 [error] [MainThread]:   Database Error in model stg_churn_customers (models\stage\stg_churn_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 31 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\stage\stg_churn_customers.sql
[0m13:16:34.723136 [info ] [MainThread]: 
[0m13:16:34.723136 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:16:34.724170 [debug] [MainThread]: Command `dbt run` failed at 13:16:34.724170 after 6.33 seconds
[0m13:16:34.724170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002944CE2A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002944E06FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002944E1BE8A0>]}
[0m13:16:34.724170 [debug] [MainThread]: Flushing usage events
[0m13:16:35.622451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:45.680382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25C709EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25C709F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25CA8E480>]}


============================== 13:16:45.680382 | a1c697a9-ea4e-4194-bbd5-23199be6c4e0 ==============================
[0m13:16:45.680382 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:16:45.680382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_churn_customers', 'send_anonymous_usage_stats': 'True'}
[0m13:16:46.182329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1c697a9-ea4e-4194-bbd5-23199be6c4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25D47CB00>]}
[0m13:16:46.249376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1c697a9-ea4e-4194-bbd5-23199be6c4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25D1CECF0>]}
[0m13:16:46.249376 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:16:46.757284 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:16:46.966780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:16:46.966780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:16:46.979477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:16:47.017219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1c697a9-ea4e-4194-bbd5-23199be6c4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25C89C4D0>]}
[0m13:16:47.095921 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:16:47.100396 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:16:47.128916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1c697a9-ea4e-4194-bbd5-23199be6c4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25F2C4080>]}
[0m13:16:47.135785 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:16:47.135785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c697a9-ea4e-4194-bbd5-23199be6c4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25F403590>]}
[0m13:16:47.137791 [info ] [MainThread]: 
[0m13:16:47.137791 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:47.142320 [info ] [MainThread]: 
[0m13:16:47.146817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:16:47.148899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:16:47.274077 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:16:47.274077 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:16:47.274077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:48.556262 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.284 seconds
[0m13:16:48.566025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:16:48.566025 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:16:48.566025 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:16:48.566025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:49.549828 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.972 seconds
[0m13:16:49.554835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c697a9-ea4e-4194-bbd5-23199be6c4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25F222120>]}
[0m13:16:49.559487 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_churn_customers
[0m13:16:49.560654 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.stg_churn_customers ................ [RUN]
[0m13:16:49.561636 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_churn_customers'
[0m13:16:49.563038 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_churn_customers
[0m13:16:49.572086 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_churn_customers"
[0m13:16:49.574086 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_churn_customers
[0m13:16:49.598624 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_churn_customers"
[0m13:16:49.598624 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_churn_customers"
[0m13:16:49.609505 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_churn_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_churn_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.stg_churn_customers
         as
        (WITH customers AS (
    SELECT 
        customer_id,
        customer_name,
        company
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_payment_date
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    WHERE revenue_type = 1
    GROUP BY customer_id
),
churned_customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company,
        lp.last_payment_date
    FROM customers c
    JOIN last_payment lp
        ON c.customer_id = lp.customer_id
    WHERE lp.last_payment_date >= (CURRENT_DATE - INTERVAL '1 year')::DATE
)

SELECT * FROM churned_customers
        );
[0m13:16:49.609505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:16:50.752058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.157 seconds
[0m13:16:50.783983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c697a9-ea4e-4194-bbd5-23199be6c4e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25A5719A0>]}
[0m13:16:50.783983 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.stg_churn_customers ........... [[32mSUCCESS 1[0m in 1.22s]
[0m13:16:50.783983 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_churn_customers
[0m13:16:50.783983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:50.783983 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:16:50.783983 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:16:51.110097 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:16:51.110097 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:16:51.444999 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_churn_customers' was left open.
[0m13:16:51.444999 [debug] [MainThread]: On model.CRB_PROJECT.stg_churn_customers: Close
[0m13:16:51.788731 [info ] [MainThread]: 
[0m13:16:51.788731 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.64 seconds (4.64s).
[0m13:16:51.788731 [debug] [MainThread]: Command end result
[0m13:16:51.815917 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:16:51.818888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:16:51.824954 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:16:51.824954 [info ] [MainThread]: 
[0m13:16:51.824954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:51.824954 [info ] [MainThread]: 
[0m13:16:51.824954 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:16:51.829011 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:51.829011 after 6.31 seconds
[0m13:16:51.829011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25D187B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25D187FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25C709EE0>]}
[0m13:16:51.829011 [debug] [MainThread]: Flushing usage events
[0m13:16:53.102851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:21.847243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163318B43E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016330D310A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163318B45C0>]}


============================== 13:21:21.847243 | 385e5271-df2d-474e-9d04-4c2a36dbb2cd ==============================
[0m13:21:21.847243 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:21:21.847243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile -m crb_report.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:22.329567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '385e5271-df2d-474e-9d04-4c2a36dbb2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001632EC82870>]}
[0m13:21:22.395366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '385e5271-df2d-474e-9d04-4c2a36dbb2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163322AF620>]}
[0m13:21:22.395366 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:21:22.861348 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:21:23.025099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:23.025099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:23.025099 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:21:23.060567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '385e5271-df2d-474e-9d04-4c2a36dbb2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163318E1AC0>]}
[0m13:21:23.115514 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:21:23.131553 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:21:23.163270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '385e5271-df2d-474e-9d04-4c2a36dbb2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163338AC920>]}
[0m13:21:23.163270 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:21:23.163270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '385e5271-df2d-474e-9d04-4c2a36dbb2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332595370>]}
[0m13:21:23.163270 [info ] [MainThread]: 
[0m13:21:23.163270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:23.163270 [info ] [MainThread]: 
[0m13:21:23.163270 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:21:23.163270 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:21:23.282497 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:21:23.282497 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:21:23.282497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:24.612355 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.333 seconds
[0m13:21:24.612355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '385e5271-df2d-474e-9d04-4c2a36dbb2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001632F5C4E60>]}
[0m13:21:24.612355 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m13:21:24.612355 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m13:21:24.612355 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m13:21:24.631861 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m13:21:24.633867 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m13:21:24.633867 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m13:21:24.633867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:24.633867 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:21:24.633867 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:21:24.964676 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was properly closed.
[0m13:21:24.964676 [debug] [MainThread]: Command end result
[0m13:21:24.991770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:21:24.996119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:21:25.002431 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:21:25.003400 [info ] [MainThread]: Compiled node 'crb_report' is:
WITH customer_data AS (
    SELECT
        customer_id,
        signup_date,
        last_purchase_date,
        CASE
            WHEN last_purchase_date IS NULL THEN 'New'
            WHEN last_purchase_date < DATEADD(year, -1, CURRENT_DATE) THEN 'Churned'
            ELSE 'Active'
        END AS customer_status
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        prod_sub_family,
        SUM(revenue) AS total_revenue
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
    GROUP BY product_id, product_family, prod_sub_family
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        transaction_date,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY transaction_date) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        c.customer_status,
        t.product_id,
        p.product_family,
        p.prod_sub_family,
        t.transaction_date,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
l.country,
        l.state,
l.city,
        SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY p.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb;
[0m13:21:25.006540 [debug] [MainThread]: Command `dbt compile` succeeded at 13:21:25.006540 after 3.32 seconds
[0m13:21:25.007550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633261E840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016332218CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163336BFF50>]}
[0m13:21:25.007550 [debug] [MainThread]: Flushing usage events
[0m13:21:26.619319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:38.826495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDDE33E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDDB3A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDDE303B0>]}


============================== 13:21:38.842576 | 7c08e56d-12b6-44fe-861a-5c40185b0bef ==============================
[0m13:21:38.842576 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:21:38.842576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m crb_report.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:39.362360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c08e56d-12b6-44fe-861a-5c40185b0bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDEADD010>]}
[0m13:21:39.410024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c08e56d-12b6-44fe-861a-5c40185b0bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDE80F920>]}
[0m13:21:39.425861 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:21:39.893912 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:21:40.057696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:40.058698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:40.064697 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:21:40.088105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c08e56d-12b6-44fe-861a-5c40185b0bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDFBE3B30>]}
[0m13:21:40.149927 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:21:40.149927 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:21:40.193306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c08e56d-12b6-44fe-861a-5c40185b0bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDDFC5370>]}
[0m13:21:40.193306 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:21:40.193306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c08e56d-12b6-44fe-861a-5c40185b0bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDEB3AF60>]}
[0m13:21:40.197614 [info ] [MainThread]: 
[0m13:21:40.197614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:40.197614 [info ] [MainThread]: 
[0m13:21:40.197614 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:21:40.197614 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:21:40.305094 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:21:40.306091 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:21:40.306091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:41.764024 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.470 seconds
[0m13:21:41.779701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:21:41.779701 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:21:41.779701 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:21:41.779701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:42.701793 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.910 seconds
[0m13:21:42.701793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c08e56d-12b6-44fe-861a-5c40185b0bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDFC2D550>]}
[0m13:21:42.701793 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m13:21:42.701793 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m13:21:42.701793 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m13:21:42.701793 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m13:21:42.722164 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m13:21:42.723164 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m13:21:42.753381 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m13:21:42.757377 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m13:21:42.758377 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        signup_date,
        last_purchase_date,
        CASE
            WHEN last_purchase_date IS NULL THEN 'New'
            WHEN last_purchase_date < DATEADD(year, -1, CURRENT_DATE) THEN 'Churned'
            ELSE 'Active'
        END AS customer_status
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        prod_sub_family,
        SUM(revenue) AS total_revenue
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
    GROUP BY product_id, product_family, prod_sub_family
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        transaction_date,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY transaction_date) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        c.customer_status,
        t.product_id,
        p.product_family,
        p.prod_sub_family,
        t.transaction_date,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
l.country,
        l.state,
l.city,
        SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY p.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb;
[0m13:21:42.758377 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:43.652613 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff77-3201-7db6-000c-493e00025296
[0m13:21:43.652613 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 70 at position 17 unexpected ';'.
[0m13:21:43.652613 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 70 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m13:21:43.652613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c08e56d-12b6-44fe-861a-5c40185b0bef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE056C890>]}
[0m13:21:43.652613 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 0.95s]
[0m13:21:43.652613 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m13:21:43.652613 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 70 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m13:21:43.652613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:43.652613 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:21:43.652613 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:21:43.974920 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:21:43.974920 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:21:44.303066 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m13:21:44.303066 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m13:21:44.620041 [info ] [MainThread]: 
[0m13:21:44.620041 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m13:21:44.620041 [debug] [MainThread]: Command end result
[0m13:21:44.649427 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:21:44.649427 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:21:44.660116 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:21:44.660985 [info ] [MainThread]: 
[0m13:21:44.660985 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:21:44.660985 [info ] [MainThread]: 
[0m13:21:44.660985 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 70 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m13:21:44.660985 [info ] [MainThread]: 
[0m13:21:44.660985 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:21:44.660985 [debug] [MainThread]: Command `dbt run` failed at 13:21:44.660985 after 5.99 seconds
[0m13:21:44.667201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDDE4AD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDDDE7E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDDDDE7920>]}
[0m13:21:44.667201 [debug] [MainThread]: Flushing usage events
[0m13:21:45.577951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:57.441037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107479C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107479CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107479C260>]}


============================== 13:21:57.441037 | eb313f6f-1af1-4ae8-802e-429bb1ded1be ==============================
[0m13:21:57.441037 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:21:57.441037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m crb_report.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:57.933945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb313f6f-1af1-4ae8-802e-429bb1ded1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021071B42AB0>]}
[0m13:21:57.994395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb313f6f-1af1-4ae8-802e-429bb1ded1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107512DD00>]}
[0m13:21:57.994395 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:21:58.463371 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:21:58.622679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:58.622679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:58.628438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:21:58.654175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb313f6f-1af1-4ae8-802e-429bb1ded1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210765AB440>]}
[0m13:21:58.718371 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:21:58.718371 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:21:58.751693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb313f6f-1af1-4ae8-802e-429bb1ded1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210768C9DC0>]}
[0m13:21:58.751693 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:21:58.751693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb313f6f-1af1-4ae8-802e-429bb1ded1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210754A0950>]}
[0m13:21:58.765607 [info ] [MainThread]: 
[0m13:21:58.765607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:58.765607 [info ] [MainThread]: 
[0m13:21:58.765607 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:21:58.765607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:21:58.872651 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:21:58.873651 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:21:58.873651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:00.211253 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.339 seconds
[0m13:22:00.216839 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:22:00.216839 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:22:00.216839 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:22:00.216839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:01.219895 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.993 seconds
[0m13:22:01.222277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb313f6f-1af1-4ae8-802e-429bb1ded1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021071BD3770>]}
[0m13:22:01.222277 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m13:22:01.222277 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m13:22:01.222277 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m13:22:01.222277 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m13:22:01.238774 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m13:22:01.240781 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m13:22:01.270420 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m13:22:01.270420 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m13:22:01.270420 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        signup_date,
        last_purchase_date,
        CASE
            WHEN last_purchase_date IS NULL THEN 'New'
            WHEN last_purchase_date < DATEADD(year, -1, CURRENT_DATE) THEN 'Churned'
            ELSE 'Active'
        END AS customer_status
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        prod_sub_family,
        SUM(revenue) AS total_revenue
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
    GROUP BY product_id, product_family, prod_sub_family
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        transaction_date,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY transaction_date) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        c.customer_status,
        t.product_id,
        p.product_family,
        p.prod_sub_family,
        t.transaction_date,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
l.country,
        l.state,
l.city,
        SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY p.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m13:22:01.270420 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:22:02.189877 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff78-3201-7e56-000c-493e0002448a
[0m13:22:02.189877 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'SIGNUP_DATE'
[0m13:22:02.205617 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'SIGNUP_DATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m13:22:02.205617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb313f6f-1af1-4ae8-802e-429bb1ded1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021076BD6AB0>]}
[0m13:22:02.205617 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 0.98s]
[0m13:22:02.205617 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m13:22:02.205617 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'SIGNUP_DATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m13:22:02.205617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:02.205617 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:22:02.205617 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:22:02.531717 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:22:02.531717 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:22:02.881246 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m13:22:02.883268 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m13:22:03.206605 [info ] [MainThread]: 
[0m13:22:03.206605 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m13:22:03.222739 [debug] [MainThread]: Command end result
[0m13:22:03.258024 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:22:03.260055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:22:03.261384 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:22:03.261384 [info ] [MainThread]: 
[0m13:22:03.261384 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:22:03.261384 [info ] [MainThread]: 
[0m13:22:03.261384 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'SIGNUP_DATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m13:22:03.261384 [info ] [MainThread]: 
[0m13:22:03.261384 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:22:03.271696 [debug] [MainThread]: Command `dbt run` failed at 13:22:03.271696 after 5.99 seconds
[0m13:22:03.272706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021072281A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210751073E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107253E390>]}
[0m13:22:03.273627 [debug] [MainThread]: Flushing usage events
[0m13:22:04.209980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:55.303557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C064E600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C064F680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C064EF30>]}


============================== 13:51:55.308770 | 647a12b7-7bd5-41fb-8c68-faa5f6dd71ac ==============================
[0m13:51:55.308770 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:51:55.308770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -m mart_rank_products', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:51:56.582345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '647a12b7-7bd5-41fb-8c68-faa5f6dd71ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C1864B00>]}
[0m13:51:56.650011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '647a12b7-7bd5-41fb-8c68-faa5f6dd71ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C02D7B30>]}
[0m13:51:56.652015 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:51:57.267825 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:51:57.425943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:57.425943 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:57.425943 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:51:57.461972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '647a12b7-7bd5-41fb-8c68-faa5f6dd71ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C183D760>]}
[0m13:51:57.527881 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:51:57.543637 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:51:57.591193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '647a12b7-7bd5-41fb-8c68-faa5f6dd71ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C2B20080>]}
[0m13:51:57.591193 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:51:57.591193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647a12b7-7bd5-41fb-8c68-faa5f6dd71ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C2B40410>]}
[0m13:51:57.607334 [info ] [MainThread]: 
[0m13:51:57.607334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:51:57.607334 [info ] [MainThread]: 
[0m13:51:57.607334 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:51:57.607334 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:52:00.913028 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:52:00.922731 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:52:00.922731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:02.684216 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.763 seconds
[0m13:52:02.684216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647a12b7-7bd5-41fb-8c68-faa5f6dd71ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BDF83650>]}
[0m13:52:02.700927 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_products
[0m13:52:02.700927 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_products'
[0m13:52:02.700927 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_products
[0m13:52:02.700927 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_products"
[0m13:52:02.700927 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_products
[0m13:52:02.700927 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_products
[0m13:52:02.700927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:02.700927 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:52:02.700927 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:52:03.085811 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_products' was properly closed.
[0m13:52:03.085811 [debug] [MainThread]: Command end result
[0m13:52:03.107376 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:52:03.111128 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:52:03.117146 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:52:03.117146 [info ] [MainThread]: Compiled node 'mart_rank_products' is:
WITH product_ranking AS(
    SELECT
    p.productid, p.product_name, p.product_sub_family,
    SUM(t.quantity) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_products p ON t.product_id = p.productid
GROUP BY p.productid, p.product_name, p.product_sub_family
ORDER BY revenue_rank
)
SELECT * from product_ranking
[0m13:52:03.117146 [debug] [MainThread]: Command `dbt compile` succeeded at 13:52:03.117146 after 8.00 seconds
[0m13:52:03.117146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C01DF590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BFF61DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5BFF63E00>]}
[0m13:52:03.117146 [debug] [MainThread]: Flushing usage events
[0m13:52:04.099658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:52:17.800963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E0A4A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7DE3A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E0A47D0>]}


============================== 13:52:17.805565 | dac64e9d-9143-4ff1-bc6a-c23da7ba94d9 ==============================
[0m13:52:17.805565 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:52:17.806567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_rank_products', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:52:18.292924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dac64e9d-9143-4ff1-bc6a-c23da7ba94d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7D60A240>]}
[0m13:52:18.347538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dac64e9d-9143-4ff1-bc6a-c23da7ba94d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7EDC3E30>]}
[0m13:52:18.347538 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:52:18.830647 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:52:18.986699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:18.986699 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:18.992459 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:52:19.018314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dac64e9d-9143-4ff1-bc6a-c23da7ba94d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7FE73A70>]}
[0m13:52:19.083400 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:52:19.083400 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:52:19.130896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dac64e9d-9143-4ff1-bc6a-c23da7ba94d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E00315D30>]}
[0m13:52:19.130896 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:52:19.130896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac64e9d-9143-4ff1-bc6a-c23da7ba94d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E295370>]}
[0m13:52:19.130896 [info ] [MainThread]: 
[0m13:52:19.133894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:19.133894 [info ] [MainThread]: 
[0m13:52:19.133894 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:52:19.133894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:52:19.239684 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:52:19.239684 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:52:19.240684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:20.704730 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.472 seconds
[0m13:52:20.718527 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:52:20.720582 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:52:20.720582 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:52:20.720582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:21.708327 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.981 seconds
[0m13:52:21.708327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dac64e9d-9143-4ff1-bc6a-c23da7ba94d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E0E9A30>]}
[0m13:52:21.708327 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_products
[0m13:52:21.708327 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.mart_rank_products .................. [RUN]
[0m13:52:21.724233 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_products'
[0m13:52:21.724233 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_products
[0m13:52:21.724233 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_products"
[0m13:52:21.724233 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_products
[0m13:52:21.772073 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_products"
[0m13:52:21.774090 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_products"
[0m13:52:21.774090 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_products"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
  
   as (
    WITH product_ranking AS(
    SELECT
    p.productid, p.product_name, p.product_sub_family,
    SUM(t.quantity) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_products p ON t.product_id = p.productid
GROUP BY p.productid, p.product_name, p.product_sub_family
ORDER BY revenue_rank
)
SELECT * from product_ranking
  );
[0m13:52:21.775075 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:52:22.855042 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff96-3201-7db6-000c-493e000252b6
[0m13:52:22.855042 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'P.PRODUCTID'
[0m13:52:22.870263 [debug] [Thread-1 (]: Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'P.PRODUCTID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql
[0m13:52:22.870263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dac64e9d-9143-4ff1-bc6a-c23da7ba94d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E008C6990>]}
[0m13:52:22.870263 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.mart_rank_products ......... [[31mERROR[0m in 1.16s]
[0m13:52:22.870263 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_products
[0m13:52:22.870263 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_products' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'P.PRODUCTID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql.
[0m13:52:22.878694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:22.878694 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:52:22.878694 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:52:23.203561 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:52:23.205568 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:52:23.533644 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_products' was left open.
[0m13:52:23.535667 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_products: Close
[0m13:52:23.862892 [info ] [MainThread]: 
[0m13:52:23.862892 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m13:52:23.862892 [debug] [MainThread]: Command end result
[0m13:52:23.891367 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:52:23.894364 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:52:23.900653 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:52:23.900653 [info ] [MainThread]: 
[0m13:52:23.900653 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:52:23.904550 [info ] [MainThread]: 
[0m13:52:23.906574 [error] [MainThread]:   Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'P.PRODUCTID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql
[0m13:52:23.906574 [info ] [MainThread]: 
[0m13:52:23.909013 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:52:23.910034 [debug] [MainThread]: Command `dbt run` failed at 13:52:23.910034 after 6.27 seconds
[0m13:52:23.911049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E0878F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7DF96240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E7E1157F0>]}
[0m13:52:23.911049 [debug] [MainThread]: Flushing usage events
[0m13:52:24.832473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:52:35.213757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253C017F740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253BCF045F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253C017FBC0>]}


============================== 13:52:35.229686 | a9406d7b-b4cc-4d26-b989-ff9c7c42329e ==============================
[0m13:52:35.229686 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:52:35.229686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_rank_products', 'send_anonymous_usage_stats': 'True'}
[0m13:52:35.701487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9406d7b-b4cc-4d26-b989-ff9c7c42329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253C1279790>]}
[0m13:52:35.765180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9406d7b-b4cc-4d26-b989-ff9c7c42329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253C1317920>]}
[0m13:52:35.765180 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:52:36.239572 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:52:36.378213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:36.378213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:36.393891 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:52:36.419229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9406d7b-b4cc-4d26-b989-ff9c7c42329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253C08D3380>]}
[0m13:52:36.500837 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:52:36.500837 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:52:36.532247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9406d7b-b4cc-4d26-b989-ff9c7c42329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253C25FFFE0>]}
[0m13:52:36.532247 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:52:36.532247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9406d7b-b4cc-4d26-b989-ff9c7c42329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253C25B67B0>]}
[0m13:52:36.532247 [info ] [MainThread]: 
[0m13:52:36.532247 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:36.532247 [info ] [MainThread]: 
[0m13:52:36.532247 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:52:36.532247 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:52:36.642268 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:52:36.643270 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:52:36.643270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:37.947437 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.318 seconds
[0m13:52:37.963100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:52:37.963100 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:52:37.963100 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:52:37.963100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:38.935466 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.968 seconds
[0m13:52:38.935466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9406d7b-b4cc-4d26-b989-ff9c7c42329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253C27924B0>]}
[0m13:52:38.951274 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_products
[0m13:52:38.951274 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.mart_rank_products .................. [RUN]
[0m13:52:38.951274 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_products'
[0m13:52:38.951274 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_products
[0m13:52:38.951274 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_products"
[0m13:52:38.951274 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_products
[0m13:52:38.987007 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_products"
[0m13:52:38.987007 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_products"
[0m13:52:38.987007 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_products"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
  
   as (
    WITH product_ranking AS(
    SELECT
    p.product_id, p.product_name, p.product_sub_family,
    SUM(t.quantity) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_products p ON t.product_id = p.productid
GROUP BY p.productid, p.product_name, p.product_sub_family
ORDER BY revenue_rank
)
SELECT * from product_ranking
  );
[0m13:52:38.987007 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:52:39.859776 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff96-3201-7e56-000c-493e0002449e
[0m13:52:39.859776 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 18
invalid identifier 'P.PRODUCT_NAME'
[0m13:52:39.875508 [debug] [Thread-1 (]: Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 18
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql
[0m13:52:39.875508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9406d7b-b4cc-4d26-b989-ff9c7c42329e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253BFAE4740>]}
[0m13:52:39.875508 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.mart_rank_products ......... [[31mERROR[0m in 0.92s]
[0m13:52:39.875508 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_products
[0m13:52:39.875508 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_products' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 18
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql.
[0m13:52:39.875508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:39.875508 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:52:39.875508 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:52:40.202503 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:52:40.202503 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:52:40.520347 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_products' was left open.
[0m13:52:40.536090 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_products: Close
[0m13:52:40.862452 [info ] [MainThread]: 
[0m13:52:40.862452 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m13:52:40.862452 [debug] [MainThread]: Command end result
[0m13:52:40.887556 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:52:40.890588 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:52:40.894560 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:52:40.894560 [info ] [MainThread]: 
[0m13:52:40.894560 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:52:40.894560 [info ] [MainThread]: 
[0m13:52:40.894560 [error] [MainThread]:   Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  000904 (42000): SQL compilation error: error line 6 at position 18
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql
[0m13:52:40.894560 [info ] [MainThread]: 
[0m13:52:40.894560 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:52:40.894560 [debug] [MainThread]: Command `dbt run` failed at 13:52:40.894560 after 5.84 seconds
[0m13:52:40.894560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253BDA671A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253C2CC53A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253C05F7FB0>]}
[0m13:52:40.894560 [debug] [MainThread]: Flushing usage events
[0m13:52:42.057713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:28.771954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294874644A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294872C3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294874646E0>]}


============================== 13:53:28.777967 | 0fe32566-f050-4e28-bf38-bea13558897a ==============================
[0m13:53:28.777967 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:53:28.777967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_rank_products', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:53:29.293382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fe32566-f050-4e28-bf38-bea13558897a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029488163BF0>]}
[0m13:53:29.355767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fe32566-f050-4e28-bf38-bea13558897a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029486E7DFA0>]}
[0m13:53:29.357598 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:53:29.837210 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:53:29.976809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:53:29.976809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:53:29.992572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:53:30.022271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fe32566-f050-4e28-bf38-bea13558897a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948927D760>]}
[0m13:53:30.086716 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:53:30.086716 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:53:30.127541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fe32566-f050-4e28-bf38-bea13558897a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948944FFB0>]}
[0m13:53:30.127541 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:53:30.127541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fe32566-f050-4e28-bf38-bea13558897a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294894ADBE0>]}
[0m13:53:30.127541 [info ] [MainThread]: 
[0m13:53:30.127541 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:30.127541 [info ] [MainThread]: 
[0m13:53:30.127541 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:53:30.133974 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:53:30.243135 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:53:30.243135 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:53:30.243135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:31.563648 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.333 seconds
[0m13:53:31.579698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:53:31.579698 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:53:31.579698 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:53:31.579698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:32.551826 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.958 seconds
[0m13:53:32.551826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fe32566-f050-4e28-bf38-bea13558897a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294891B5460>]}
[0m13:53:32.551826 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_products
[0m13:53:32.551826 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.mart_rank_products .................. [RUN]
[0m13:53:32.551826 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_products'
[0m13:53:32.551826 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_products
[0m13:53:32.567547 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_products"
[0m13:53:32.567547 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_products
[0m13:53:32.612258 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_products"
[0m13:53:32.614253 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_products"
[0m13:53:32.614253 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_products"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
  
   as (
    WITH product_ranking AS(
    SELECT
    p.product_id, p.product_family, p.product_sub_family,
    SUM(t.quantity) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_products p ON t.product_id = p.productid
GROUP BY p.product_id, p.product_family, p.product_sub_family
ORDER BY revenue_rank
)
SELECT * from product_ranking
  );
[0m13:53:32.615254 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:53:33.555778 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff97-3201-7d7b-000c-493e000225ee
[0m13:53:33.555778 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 38
invalid identifier 'P.PRODUCTID'
[0m13:53:33.571526 [debug] [Thread-1 (]: Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  000904 (42000): SQL compilation error: error line 10 at position 38
  invalid identifier 'P.PRODUCTID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql
[0m13:53:33.575022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fe32566-f050-4e28-bf38-bea13558897a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029489BCA420>]}
[0m13:53:33.575022 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.mart_rank_products ......... [[31mERROR[0m in 1.02s]
[0m13:53:33.577031 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_products
[0m13:53:33.577031 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_products' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  000904 (42000): SQL compilation error: error line 10 at position 38
  invalid identifier 'P.PRODUCTID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql.
[0m13:53:33.580389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:33.580389 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:53:33.580389 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:53:33.904294 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:53:33.904294 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:53:34.215607 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_products' was left open.
[0m13:53:34.215607 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_products: Close
[0m13:53:34.558536 [info ] [MainThread]: 
[0m13:53:34.560559 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m13:53:34.566320 [debug] [MainThread]: Command end result
[0m13:53:34.599515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:53:34.614990 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:53:34.626897 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:53:34.626897 [info ] [MainThread]: 
[0m13:53:34.629698 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:53:34.629698 [info ] [MainThread]: 
[0m13:53:34.631710 [error] [MainThread]:   Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  000904 (42000): SQL compilation error: error line 10 at position 38
  invalid identifier 'P.PRODUCTID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql
[0m13:53:34.631710 [info ] [MainThread]: 
[0m13:53:34.631710 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:53:34.633798 [debug] [MainThread]: Command `dbt run` failed at 13:53:34.633798 after 6.03 seconds
[0m13:53:34.633798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029487634BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029487464E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294874646E0>]}
[0m13:53:34.633798 [debug] [MainThread]: Flushing usage events
[0m13:53:35.521570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:50.219432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002786051CB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785FE506B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785FE501A0>]}


============================== 13:53:50.228722 | d7e1e9cc-f570-4257-9e14-282ad6bf44f1 ==============================
[0m13:53:50.228722 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:53:50.228722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_rank_products', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:53:51.170509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7e1e9cc-f570-4257-9e14-282ad6bf44f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027860759F40>]}
[0m13:53:51.231811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7e1e9cc-f570-4257-9e14-282ad6bf44f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027860F44B30>]}
[0m13:53:51.231811 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:53:51.836279 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:53:51.987299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:53:51.987299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:53:51.987299 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:53:52.027589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7e1e9cc-f570-4257-9e14-282ad6bf44f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002786105FF50>]}
[0m13:53:52.093012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:53:52.103708 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:53:52.125571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7e1e9cc-f570-4257-9e14-282ad6bf44f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278625347A0>]}
[0m13:53:52.125571 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:53:52.125571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7e1e9cc-f570-4257-9e14-282ad6bf44f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002786257B9E0>]}
[0m13:53:52.125571 [info ] [MainThread]: 
[0m13:53:52.125571 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:52.125571 [info ] [MainThread]: 
[0m13:53:52.125571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:53:52.141203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:53:55.216854 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:53:55.216854 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:53:55.216854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:56.712741 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.507 seconds
[0m13:53:56.728849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:53:56.728849 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:53:56.728849 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:53:56.728849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:57.685387 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.944 seconds
[0m13:53:57.687397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7e1e9cc-f570-4257-9e14-282ad6bf44f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278624A2720>]}
[0m13:53:57.687397 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_products
[0m13:53:57.687397 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.mart_rank_products .................. [RUN]
[0m13:53:57.687397 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_products'
[0m13:53:57.687397 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_products
[0m13:53:57.695810 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_products"
[0m13:53:57.702248 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_products
[0m13:53:57.734307 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_products"
[0m13:53:57.736351 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_products"
[0m13:53:57.736351 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_products"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
  
   as (
    WITH product_ranking AS(
    SELECT
    p.product_id, p.product_family, p.product_sub_family,
    SUM(t.quantity) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_products p ON t.product_id = p.product_id
GROUP BY p.product_id, p.product_family, p.product_sub_family
ORDER BY revenue_rank
)
SELECT * from product_ranking
  );
[0m13:53:57.737340 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:53:58.754536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.030 seconds
[0m13:53:58.786264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7e1e9cc-f570-4257-9e14-282ad6bf44f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785F9D4380>]}
[0m13:53:58.786264 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PROJECT_SCHEMA.mart_rank_products ............. [[32mSUCCESS 1[0m in 1.10s]
[0m13:53:58.786264 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_products
[0m13:53:58.792153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:58.792153 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:53:58.792153 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:53:59.109989 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:53:59.114637 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:53:59.430726 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_products' was left open.
[0m13:53:59.430726 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_products: Close
[0m13:53:59.763205 [info ] [MainThread]: 
[0m13:53:59.763205 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.64 seconds (7.64s).
[0m13:53:59.763205 [debug] [MainThread]: Command end result
[0m13:53:59.791108 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:53:59.793459 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:53:59.800790 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:53:59.800790 [info ] [MainThread]: 
[0m13:53:59.801823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:53:59.802788 [info ] [MainThread]: 
[0m13:53:59.803820 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:53:59.804787 [debug] [MainThread]: Command `dbt run` succeeded at 13:53:59.804787 after 9.76 seconds
[0m13:53:59.804787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785F9B11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785F9B2D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785F9B2C60>]}
[0m13:53:59.805787 [debug] [MainThread]: Flushing usage events
[0m13:54:01.063075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:00.042293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8499535C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84C3B7D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84C3B7CB0>]}


============================== 13:55:00.061070 | 0dfdfc14-a503-4736-bd7c-af1573b83159 ==============================
[0m13:55:00.061070 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:55:00.061070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_rank_products', 'send_anonymous_usage_stats': 'True'}
[0m13:55:00.542980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dfdfc14-a503-4736-bd7c-af1573b83159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84CB02120>]}
[0m13:55:00.604111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dfdfc14-a503-4736-bd7c-af1573b83159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84DC23800>]}
[0m13:55:00.604111 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:55:01.080575 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:55:01.237259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:01.237259 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:01.253001 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:55:01.283214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dfdfc14-a503-4736-bd7c-af1573b83159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84CF10BC0>]}
[0m13:55:01.352916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:55:01.356882 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:55:01.386238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dfdfc14-a503-4736-bd7c-af1573b83159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84EF0CA10>]}
[0m13:55:01.386238 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:55:01.386238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dfdfc14-a503-4736-bd7c-af1573b83159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84DC82FC0>]}
[0m13:55:01.386238 [info ] [MainThread]: 
[0m13:55:01.390813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:01.391818 [info ] [MainThread]: 
[0m13:55:01.391818 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:55:01.391818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:55:01.506952 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:55:01.506952 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:55:01.507952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:03.333914 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.831 seconds
[0m13:55:03.333914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:55:03.349892 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:55:03.349892 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:55:03.349892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:04.321343 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.969 seconds
[0m13:55:04.321343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dfdfc14-a503-4736-bd7c-af1573b83159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84EFD9340>]}
[0m13:55:04.321343 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_products
[0m13:55:04.321343 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.mart_rank_products .................. [RUN]
[0m13:55:04.321343 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_products'
[0m13:55:04.321343 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_products
[0m13:55:04.337095 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_products"
[0m13:55:04.337095 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_products
[0m13:55:04.366416 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_products"
[0m13:55:04.366416 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_products"
[0m13:55:04.366416 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_products"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
  
   as (
    WITH product_ranking AS(
    SELECT
    p.product_id, p.product_family, p.product_sub_family,
    SUM(t.quantity) AS total_revenue,
    DENSE_RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_products p ON t.product_id = p.product_id
GROUP BY p.product_id, p.product_family, p.product_sub_family
ORDER BY revenue_rank
)
SELECT * from product_ranking
  );
[0m13:55:04.366416 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:55:05.501749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.125 seconds
[0m13:55:05.523554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dfdfc14-a503-4736-bd7c-af1573b83159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84A2B1790>]}
[0m13:55:05.523554 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PROJECT_SCHEMA.mart_rank_products ............. [[32mSUCCESS 1[0m in 1.20s]
[0m13:55:05.523554 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_products
[0m13:55:05.523554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:05.523554 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:55:05.523554 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:55:05.856930 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:55:05.856930 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:55:06.202117 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_products' was left open.
[0m13:55:06.202117 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_products: Close
[0m13:55:06.523939 [info ] [MainThread]: 
[0m13:55:06.523939 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m13:55:06.523939 [debug] [MainThread]: Command end result
[0m13:55:06.567860 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:55:06.570852 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:55:06.577114 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:55:06.577114 [info ] [MainThread]: 
[0m13:55:06.577114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:06.577114 [info ] [MainThread]: 
[0m13:55:06.577114 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:55:06.577114 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:06.577114 after 6.70 seconds
[0m13:55:06.577114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84CA19E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84CA1A900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B84CA182F0>]}
[0m13:55:06.577114 [debug] [MainThread]: Flushing usage events
[0m13:55:07.474425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:31.057100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234409C1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234409C0D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234409C05C0>]}


============================== 13:55:31.060511 | 1603b333-7566-4bbc-8b34-af16a81407f1 ==============================
[0m13:55:31.060511 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:55:31.060511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_rank_products', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:31.543073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1603b333-7566-4bbc-8b34-af16a81407f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002343DD628D0>]}
[0m13:55:31.606084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1603b333-7566-4bbc-8b34-af16a81407f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002343FDB6E10>]}
[0m13:55:31.606084 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:55:32.099223 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:55:32.257210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:32.257210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:32.263229 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:55:32.293090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1603b333-7566-4bbc-8b34-af16a81407f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023441423380>]}
[0m13:55:32.359058 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:55:32.359058 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:55:32.392713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1603b333-7566-4bbc-8b34-af16a81407f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234429CFEF0>]}
[0m13:55:32.392713 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:55:32.406611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1603b333-7566-4bbc-8b34-af16a81407f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023442792F60>]}
[0m13:55:32.406611 [info ] [MainThread]: 
[0m13:55:32.408621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:32.408621 [info ] [MainThread]: 
[0m13:55:32.408621 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:55:32.408621 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:55:32.514254 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:55:32.514254 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:55:32.515254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:33.922377 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.407 seconds
[0m13:55:33.925312 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:55:33.925312 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:55:33.925312 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:55:33.925312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:34.892375 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.960 seconds
[0m13:55:34.900495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1603b333-7566-4bbc-8b34-af16a81407f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002344173CF80>]}
[0m13:55:34.900495 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_products
[0m13:55:34.900495 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.mart_rank_products .................. [RUN]
[0m13:55:34.908464 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_products'
[0m13:55:34.908464 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_products
[0m13:55:34.910471 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_products"
[0m13:55:34.910471 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_products
[0m13:55:34.947218 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_products"
[0m13:55:34.949223 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_products"
[0m13:55:34.949223 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_products"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
  
   as (
    WITH product_ranking AS(
    SELECT
    p.product_id, p.product_family, p.product_sub_family,
    SUM(t.quantity) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_products p ON t.product_id = p.product_id
GROUP BY p.product_id, p.product_family, p.product_sub_family
ORDER BY revenue_rank
)
SELECT * from product_ranking
  );
[0m13:55:34.949223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:55:35.942536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.999 seconds
[0m13:55:35.982320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1603b333-7566-4bbc-8b34-af16a81407f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002343DD618E0>]}
[0m13:55:35.982320 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PROJECT_SCHEMA.mart_rank_products ............. [[32mSUCCESS 1[0m in 1.07s]
[0m13:55:35.982320 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_products
[0m13:55:35.984325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:35.984325 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:55:35.984325 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:55:36.312803 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:55:36.312803 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:55:36.625817 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_products' was left open.
[0m13:55:36.625817 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_products: Close
[0m13:55:36.946463 [info ] [MainThread]: 
[0m13:55:36.946463 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m13:55:36.960109 [debug] [MainThread]: Command end result
[0m13:55:36.982494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:55:36.985429 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:55:36.989412 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:55:36.989412 [info ] [MainThread]: 
[0m13:55:36.989412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:36.989412 [info ] [MainThread]: 
[0m13:55:36.989412 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:55:36.989412 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:36.989412 after 6.11 seconds
[0m13:55:36.989412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002343E4E2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234404CB950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234407ECB60>]}
[0m13:55:36.989412 [debug] [MainThread]: Flushing usage events
[0m13:55:38.273724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:14.960759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC4C62A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC4CFA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC4F90EF0>]}


============================== 13:59:14.960759 | 59e85358-b04d-44be-9284-9c61cde84c7f ==============================
[0m13:59:14.960759 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:59:14.960759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile -m mart_rank_customers', 'send_anonymous_usage_stats': 'True'}
[0m13:59:15.448739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59e85358-b04d-44be-9284-9c61cde84c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC4FAAD80>]}
[0m13:59:15.512422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59e85358-b04d-44be-9284-9c61cde84c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC5A8AFF0>]}
[0m13:59:15.512422 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:59:15.996863 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:59:16.155384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:16.155384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:16.155384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:59:16.193113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59e85358-b04d-44be-9284-9c61cde84c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC6DAAF90>]}
[0m13:59:16.264861 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:59:16.268871 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:59:16.298442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59e85358-b04d-44be-9284-9c61cde84c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC6FC1610>]}
[0m13:59:16.298442 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m13:59:16.298442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59e85358-b04d-44be-9284-9c61cde84c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC70EEAB0>]}
[0m13:59:16.298442 [info ] [MainThread]: 
[0m13:59:16.298442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:16.298442 [info ] [MainThread]: 
[0m13:59:16.298442 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:59:16.308485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:59:16.415843 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:59:16.415843 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:59:16.415843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:17.755467 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.337 seconds
[0m13:59:17.763560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59e85358-b04d-44be-9284-9c61cde84c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC70D6810>]}
[0m13:59:17.773197 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m13:59:17.773197 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m13:59:17.773197 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m13:59:17.773197 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m13:59:17.773197 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m13:59:17.773197 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m13:59:17.773197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:17.773197 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:59:17.773197 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:59:18.115412 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was properly closed.
[0m13:59:18.115412 [debug] [MainThread]: Command end result
[0m13:59:18.131195 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:59:18.131195 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:59:18.146978 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:59:18.146978 [info ] [MainThread]: Compiled node 'mart_rank_customers' is:
WITH customer_ranking AS(
    SELECT
    c.customer_id,c.customer_name,c.company
    SUM(t.quantity) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_customers c ON t.customer_id = c.customer_id
GROUP BY c.customer_id,c.customer_name,c.company
ORDER BY revenue_rank
)
SELECT * from customer_ranking
[0m13:59:18.146978 [debug] [MainThread]: Command `dbt compile` succeeded at 13:59:18.146978 after 3.35 seconds
[0m13:59:18.146978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC4898A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC4A108C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC4A9AA20>]}
[0m13:59:18.146978 [debug] [MainThread]: Flushing usage events
[0m13:59:19.557904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:29.576821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FDEB1CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FDEB34A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FDEB1430>]}


============================== 13:59:29.592617 | a5b7f0f7-d2de-4f6a-9a3d-e402fc148890 ==============================
[0m13:59:29.592617 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:59:29.594623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_rank_customers', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:59:30.078100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5b7f0f7-d2de-4f6a-9a3d-e402fc148890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FEC4C080>]}
[0m13:59:30.141927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5b7f0f7-d2de-4f6a-9a3d-e402fc148890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FCF3F380>]}
[0m13:59:30.141927 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:59:30.613300 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:59:30.772039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:30.772039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:30.772039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m13:59:30.800675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5b7f0f7-d2de-4f6a-9a3d-e402fc148890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FFD3C530>]}
[0m13:59:30.863439 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:59:30.881491 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:59:30.913205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5b7f0f7-d2de-4f6a-9a3d-e402fc148890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FFF618E0>]}
[0m13:59:30.913205 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m13:59:30.913205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b7f0f7-d2de-4f6a-9a3d-e402fc148890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FFEB05F0>]}
[0m13:59:30.913205 [info ] [MainThread]: 
[0m13:59:30.917576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:30.917576 [info ] [MainThread]: 
[0m13:59:30.917576 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:59:30.917576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m13:59:31.022381 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m13:59:31.022381 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m13:59:31.023376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:32.056421 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.037 seconds
[0m13:59:32.056421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m13:59:32.072295 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m13:59:32.072295 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m13:59:32.072295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:33.562946 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.499 seconds
[0m13:59:33.578579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b7f0f7-d2de-4f6a-9a3d-e402fc148890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FFD3D550>]}
[0m13:59:33.578579 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m13:59:33.578579 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.mart_rank_customers ................. [RUN]
[0m13:59:33.578579 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m13:59:33.578579 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m13:59:33.578579 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m13:59:33.578579 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m13:59:33.618023 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m13:59:33.618023 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m13:59:33.618023 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
  
   as (
    WITH customer_ranking AS(
    SELECT
    c.customer_id,c.customer_name,c.company
    SUM(t.quantity) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_customers c ON t.customer_id = c.customer_id
GROUP BY c.customer_id,c.customer_name,c.company
ORDER BY revenue_rank
)
SELECT * from customer_ranking
  );
[0m13:59:33.627709 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:59:34.704509 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff9d-3201-7d7b-000c-493e0002260e
[0m13:59:34.706254 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 7 unexpected '('.
syntax error line 7 at position 8 unexpected 't'.
syntax error line 7 at position 20 unexpected 'AS'.
syntax error line 8 at position 46 unexpected ')'.
[0m13:59:34.721980 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 7 unexpected '('.
  syntax error line 7 at position 8 unexpected 't'.
  syntax error line 7 at position 20 unexpected 'AS'.
  syntax error line 8 at position 46 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m13:59:34.721980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b7f0f7-d2de-4f6a-9a3d-e402fc148890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FFD12A50>]}
[0m13:59:34.721980 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.mart_rank_customers ........ [[31mERROR[0m in 1.14s]
[0m13:59:34.721980 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m13:59:34.721980 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 7 unexpected '('.
  syntax error line 7 at position 8 unexpected 't'.
  syntax error line 7 at position 20 unexpected 'AS'.
  syntax error line 8 at position 46 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m13:59:34.721980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:34.721980 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m13:59:34.721980 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m13:59:35.049908 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m13:59:35.050644 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m13:59:35.383528 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m13:59:35.385538 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m13:59:35.717590 [info ] [MainThread]: 
[0m13:59:35.717590 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m13:59:35.717590 [debug] [MainThread]: Command end result
[0m13:59:35.740218 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m13:59:35.740218 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m13:59:35.751139 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m13:59:35.751139 [info ] [MainThread]: 
[0m13:59:35.753148 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:59:35.753148 [info ] [MainThread]: 
[0m13:59:35.753148 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 7 unexpected '('.
  syntax error line 7 at position 8 unexpected 't'.
  syntax error line 7 at position 20 unexpected 'AS'.
  syntax error line 8 at position 46 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m13:59:35.753148 [info ] [MainThread]: 
[0m13:59:35.753148 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:59:35.753148 [debug] [MainThread]: Command `dbt run` failed at 13:59:35.753148 after 6.33 seconds
[0m13:59:35.753148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FD9B9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FDD7A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5FDD7A6C0>]}
[0m13:59:35.753148 [debug] [MainThread]: Flushing usage events
[0m13:59:36.630992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:57.761920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C65BF236E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C659504380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C659A01400>]}


============================== 14:00:57.774444 | 280eb76c-9e50-4504-821b-0e811fae67b5 ==============================
[0m14:00:57.774444 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:00:57.774444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_rank_customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:00:58.264688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '280eb76c-9e50-4504-821b-0e811fae67b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C65BA5E720>]}
[0m14:00:58.328104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '280eb76c-9e50-4504-821b-0e811fae67b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C65BD7F0E0>]}
[0m14:00:58.328104 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:00:58.813026 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:00:58.969263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:58.969263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:58.975278 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:00:59.002597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '280eb76c-9e50-4504-821b-0e811fae67b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C65DD8C590>]}
[0m14:00:59.067852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:00:59.078375 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:00:59.099322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '280eb76c-9e50-4504-821b-0e811fae67b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C65E104050>]}
[0m14:00:59.099322 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:00:59.099322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '280eb76c-9e50-4504-821b-0e811fae67b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C65E11C7D0>]}
[0m14:00:59.099322 [info ] [MainThread]: 
[0m14:00:59.113085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:00:59.113085 [info ] [MainThread]: 
[0m14:00:59.113085 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:00:59.115092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:00:59.218106 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:00:59.218106 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:00:59.218106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:00.680015 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.467 seconds
[0m14:01:00.700154 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:01:00.712064 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:01:00.712064 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:01:00.712064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:01.652080 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.946 seconds
[0m14:01:01.652080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '280eb76c-9e50-4504-821b-0e811fae67b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C65DF8DAC0>]}
[0m14:01:01.667840 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:01:01.667840 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.mart_rank_customers ................. [RUN]
[0m14:01:01.667840 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:01:01.667840 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:01:01.676669 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:01:01.678675 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:01:01.703636 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:01:01.703636 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:01:01.703636 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
  
   as (
    WITH customer_ranking AS
(
    SELECT
    c.customer_id,c.customer_name,c.company,
    SUM(t.quantity) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_customers c ON t.customer_id = c.customer_id
GROUP BY c.customer_id,c.customer_name,c.company
ORDER BY revenue_rank
)
SELECT * from customer_ranking
  );
[0m14:01:01.703636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:01:02.784108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.085 seconds
[0m14:01:02.815688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280eb76c-9e50-4504-821b-0e811fae67b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6592C1A00>]}
[0m14:01:02.815688 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PROJECT_SCHEMA.mart_rank_customers ............ [[32mSUCCESS 1[0m in 1.15s]
[0m14:01:02.815688 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:01:02.815688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:02.815688 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:01:02.815688 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:01:03.163988 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:01:03.163988 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:01:03.495954 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:01:03.512122 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:01:03.851185 [info ] [MainThread]: 
[0m14:01:03.857162 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m14:01:03.857162 [debug] [MainThread]: Command end result
[0m14:01:03.889400 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:01:03.889400 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:01:03.889400 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:01:03.889400 [info ] [MainThread]: 
[0m14:01:03.889400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:01:03.889400 [info ] [MainThread]: 
[0m14:01:03.889400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:01:03.906041 [debug] [MainThread]: Command `dbt run` succeeded at 14:01:03.906041 after 6.31 seconds
[0m14:01:03.906041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C65BDEB920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C65BA5FB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C65BA5FD10>]}
[0m14:01:03.906041 [debug] [MainThread]: Flushing usage events
[0m14:01:05.372667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:56.209473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028058874260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028058874740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028058875460>]}


============================== 14:01:56.209473 | 1716b17e-5cdd-4bfd-b745-eee9637897c7 ==============================
[0m14:01:56.209473 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:01:56.209473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_rank_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:01:56.696113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1716b17e-5cdd-4bfd-b745-eee9637897c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028059529790>]}
[0m14:01:56.760889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1716b17e-5cdd-4bfd-b745-eee9637897c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280588BEC90>]}
[0m14:01:56.762896 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:01:57.243694 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:01:57.387012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:01:57.387012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:01:57.387012 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:01:57.426353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1716b17e-5cdd-4bfd-b745-eee9637897c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280593280B0>]}
[0m14:01:57.492841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:01:57.492841 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:01:57.534750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1716b17e-5cdd-4bfd-b745-eee9637897c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002805A8AC4D0>]}
[0m14:01:57.535781 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:01:57.535781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1716b17e-5cdd-4bfd-b745-eee9637897c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002805AA3C320>]}
[0m14:01:57.537781 [info ] [MainThread]: 
[0m14:01:57.537781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:57.538784 [info ] [MainThread]: 
[0m14:01:57.539748 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:01:57.540749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:01:57.644744 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:01:57.644744 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:01:57.644744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:58.981258 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.351 seconds
[0m14:01:58.997302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:01:59.013102 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:01:59.013102 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:01:59.013102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:00.001463 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.980 seconds
[0m14:02:00.005483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1716b17e-5cdd-4bfd-b745-eee9637897c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002805AC7A1E0>]}
[0m14:02:00.009496 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:02:00.009496 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:02:00.009496 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:02:00.009496 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:02:00.017618 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:02:00.017618 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:02:00.046759 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:02:00.046759 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:02:00.046759 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (WITH customer_ranking AS
(
    SELECT
    c.customer_id,c.customer_name,c.company,
    SUM(t.quantity) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_customers c ON t.customer_id = c.customer_id
GROUP BY c.customer_id,c.customer_name,c.company
ORDER BY revenue_rank
)
SELECT * from customer_ranking
        );
[0m14:02:00.046759 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:02:01.494200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.440 seconds
[0m14:02:01.515785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1716b17e-5cdd-4bfd-b745-eee9637897c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028055C41A00>]}
[0m14:02:01.515785 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_rank_customers ........... [[32mSUCCESS 1[0m in 1.51s]
[0m14:02:01.515785 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:02:01.515785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:01.515785 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:02:01.515785 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:02:01.850206 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:02:01.850206 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:02:02.192883 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:02:02.192883 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:02:02.508554 [info ] [MainThread]: 
[0m14:02:02.524548 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.97 seconds (4.97s).
[0m14:02:02.524548 [debug] [MainThread]: Command end result
[0m14:02:02.566557 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:02:02.568566 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:02:02.568566 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:02:02.568566 [info ] [MainThread]: 
[0m14:02:02.568566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:02.568566 [info ] [MainThread]: 
[0m14:02:02.568566 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:02:02.568566 [debug] [MainThread]: Command `dbt run` succeeded at 14:02:02.568566 after 6.53 seconds
[0m14:02:02.579860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028058570770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028057DDB2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002805AA3F1D0>]}
[0m14:02:02.579860 [debug] [MainThread]: Flushing usage events
[0m14:02:03.526268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:26.437905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027350D504A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734E065910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002735078C800>]}


============================== 14:04:26.437905 | 1eef76c4-d3f3-485c-a75b-7429ec7ccb63 ==============================
[0m14:04:26.437905 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:04:26.437905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_rank_customers', 'send_anonymous_usage_stats': 'True'}
[0m14:04:26.938531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eef76c4-d3f3-485c-a75b-7429ec7ccb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027351A3AF00>]}
[0m14:04:27.001533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1eef76c4-d3f3-485c-a75b-7429ec7ccb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027352B5A210>]}
[0m14:04:27.001533 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:04:27.473568 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:04:27.639126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:04:27.639665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:04:27.641670 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:04:27.675055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eef76c4-d3f3-485c-a75b-7429ec7ccb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027352BEC590>]}
[0m14:04:27.741829 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:04:27.741829 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:04:27.777219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eef76c4-d3f3-485c-a75b-7429ec7ccb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027352E18560>]}
[0m14:04:27.777219 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:04:27.777219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eef76c4-d3f3-485c-a75b-7429ec7ccb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734EA27020>]}
[0m14:04:27.777219 [info ] [MainThread]: 
[0m14:04:27.781999 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:27.781999 [info ] [MainThread]: 
[0m14:04:27.781999 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:27.781999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:04:27.885582 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:04:27.885582 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:04:27.886587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:29.495885 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.611 seconds
[0m14:04:29.503421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:04:29.513641 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:04:29.513641 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:04:29.513641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:30.456450 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.947 seconds
[0m14:04:30.456450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eef76c4-d3f3-485c-a75b-7429ec7ccb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027352F505C0>]}
[0m14:04:30.456450 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:04:30.456450 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:04:30.472131 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:04:30.472131 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:04:30.472131 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:04:30.472131 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:04:30.511982 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:04:30.511982 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:04:30.511982 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (WITH customer_ranking AS
(
    SELECT
    c.customer_id,c.customer_name,c.company,
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_customers c ON t.customer_id = c.customer_id
GROUP BY c.customer_id,c.customer_name,c.company
ORDER BY revenue_rank
)
SELECT * from customer_ranking
        );
[0m14:04:30.511982 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:32.365054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.850 seconds
[0m14:04:32.381787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eef76c4-d3f3-485c-a75b-7429ec7ccb63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027350204A70>]}
[0m14:04:32.381787 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_rank_customers ........... [[32mSUCCESS 1[0m in 1.93s]
[0m14:04:32.381787 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:04:32.381787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:32.381787 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:04:32.381787 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:04:32.707189 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:04:32.722530 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:04:33.051577 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:04:33.054109 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:04:33.388558 [info ] [MainThread]: 
[0m14:04:33.390847 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m14:04:33.392882 [debug] [MainThread]: Command end result
[0m14:04:33.420451 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:04:33.420451 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:04:33.433714 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:04:33.433714 [info ] [MainThread]: 
[0m14:04:33.433714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:33.433714 [info ] [MainThread]: 
[0m14:04:33.433714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:04:33.433714 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:33.433714 after 7.16 seconds
[0m14:04:33.433714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027350516930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002734D3C0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027352E18260>]}
[0m14:04:33.433714 [debug] [MainThread]: Flushing usage events
[0m14:04:34.729549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:59.523226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2E00B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2E299100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2DD94E60>]}


============================== 14:04:59.533624 | 32d48d9a-8a25-4478-9cd2-bebc16ce654b ==============================
[0m14:04:59.533624 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:04:59.533624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_rank_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:00.028150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32d48d9a-8a25-4478-9cd2-bebc16ce654b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2DA4A3F0>]}
[0m14:05:00.091241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32d48d9a-8a25-4478-9cd2-bebc16ce654b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2F281E80>]}
[0m14:05:00.091241 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:05:00.589743 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:05:00.742960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:00.742960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:00.759796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:05:00.793325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32d48d9a-8a25-4478-9cd2-bebc16ce654b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2E51AE10>]}
[0m14:05:00.868784 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:05:00.871785 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:05:00.904384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32d48d9a-8a25-4478-9cd2-bebc16ce654b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E3050FC50>]}
[0m14:05:00.905383 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:05:00.906384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32d48d9a-8a25-4478-9cd2-bebc16ce654b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2E009EB0>]}
[0m14:05:00.907078 [info ] [MainThread]: 
[0m14:05:00.908567 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:00.908902 [info ] [MainThread]: 
[0m14:05:00.909955 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:00.910955 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:05:01.008827 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:05:01.008827 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:05:01.008827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:02.506026 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.507 seconds
[0m14:05:02.521848 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:05:02.521848 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:05:02.521848 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:05:02.521848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:03.541762 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.006 seconds
[0m14:05:03.545793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32d48d9a-8a25-4478-9cd2-bebc16ce654b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E3050F890>]}
[0m14:05:03.545793 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:05:03.545793 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:05:03.545793 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:05:03.545793 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:05:03.559406 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:05:03.561411 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:05:03.578873 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:05:03.593507 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:05:03.594071 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (WITH customer_ranking AS
(
    SELECT
    c.customer_id,c.customer_name,c.company,
    SUM(t.revenue) AS total_revenue,
    RANK() OVER (PARTITION BY c.customer_id ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_customers c ON t.customer_id = c.customer_id
GROUP BY c.customer_id,c.customer_name,c.company
ORDER BY revenue_rank
)
SELECT * from customer_ranking
        );
[0m14:05:03.594761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:05.044356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.461 seconds
[0m14:05:05.076590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32d48d9a-8a25-4478-9cd2-bebc16ce654b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2D9B48F0>]}
[0m14:05:05.076590 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_rank_customers ........... [[32mSUCCESS 1[0m in 1.53s]
[0m14:05:05.076590 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:05:05.076590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:05.076590 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:05:05.076590 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:05:05.406650 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:05:05.406650 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:05:05.729423 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:05:05.729423 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:05:06.064207 [info ] [MainThread]: 
[0m14:05:06.064207 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m14:05:06.064207 [debug] [MainThread]: Command end result
[0m14:05:06.086676 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:05:06.086676 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:05:06.096518 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:05:06.096518 [info ] [MainThread]: 
[0m14:05:06.097533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:06.098528 [info ] [MainThread]: 
[0m14:05:06.099525 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:05:06.100527 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:06.100527 after 6.73 seconds
[0m14:05:06.100527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2E00B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2C2AE870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2C2AE750>]}
[0m14:05:06.101558 [debug] [MainThread]: Flushing usage events
[0m14:05:07.014418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:38.590725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C278744E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C278745100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C278744B90>]}


============================== 14:07:38.611387 | 33a79c36-2759-441f-a973-e1e654d4caef ==============================
[0m14:07:38.611387 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:07:38.611387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_rank_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:39.108188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33a79c36-2759-441f-a973-e1e654d4caef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C278788830>]}
[0m14:07:39.169341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33a79c36-2759-441f-a973-e1e654d4caef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2782AF620>]}
[0m14:07:39.169341 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:07:39.647367 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:07:39.812470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:07:39.812470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:07:39.812470 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:07:39.850326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33a79c36-2759-441f-a973-e1e654d4caef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C278746690>]}
[0m14:07:39.916784 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:07:39.916784 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:07:39.948487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33a79c36-2759-441f-a973-e1e654d4caef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27A77F710>]}
[0m14:07:39.948487 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:07:39.948487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33a79c36-2759-441f-a973-e1e654d4caef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27A8202C0>]}
[0m14:07:39.948487 [info ] [MainThread]: 
[0m14:07:39.957819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:39.957819 [info ] [MainThread]: 
[0m14:07:39.957819 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:07:39.957819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:07:40.050538 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:07:40.050538 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:07:40.050538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:41.671437 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.614 seconds
[0m14:07:41.671437 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:07:41.691928 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:07:41.691928 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:07:41.691928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:42.642632 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.957 seconds
[0m14:07:42.658506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33a79c36-2759-441f-a973-e1e654d4caef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27ADC9100>]}
[0m14:07:42.658506 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:07:42.658506 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:07:42.658506 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:07:42.658506 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:07:42.674507 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:07:42.674507 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:07:42.704515 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:07:42.704515 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:07:42.704515 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (WITH customer_ranking AS
(
    SELECT
    c.customer_id,c.customer_name,c.company,
    SUM(t.revenue) OVER (PARTITION BY c.customer_id) AS total_revenue,
    RANK() OVER (PARTITION BY c.customer_id ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_customers c ON t.customer_id = c.customer_id
GROUP BY c.customer_id,c.customer_name,c.company
ORDER BY revenue_rank
)
SELECT * from customer_ranking
        );
[0m14:07:42.704515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:07:43.631412 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa5-3201-7db6-000c-493e00025342
[0m14:07:43.631412 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[T.REVENUE] is not a valid group by expression
[0m14:07:43.631412 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:07:43.647119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33a79c36-2759-441f-a973-e1e654d4caef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C27AD79130>]}
[0m14:07:43.647119 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_rank_customers ....... [[31mERROR[0m in 0.97s]
[0m14:07:43.647119 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:07:43.647119 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m14:07:43.647119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:43.647119 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:07:43.647119 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:07:43.987643 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:07:43.987643 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:07:44.311024 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:07:44.311024 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:07:44.682145 [info ] [MainThread]: 
[0m14:07:44.682145 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m14:07:44.682145 [debug] [MainThread]: Command end result
[0m14:07:44.721596 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:07:44.726656 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:07:44.730688 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:07:44.730688 [info ] [MainThread]: 
[0m14:07:44.730688 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:07:44.730688 [info ] [MainThread]: 
[0m14:07:44.730688 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:07:44.730688 [info ] [MainThread]: 
[0m14:07:44.730688 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:07:44.730688 [debug] [MainThread]: Command `dbt run` failed at 14:07:44.730688 after 6.29 seconds
[0m14:07:44.737815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C278442ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2784B4DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C278727530>]}
[0m14:07:44.737815 [debug] [MainThread]: Flushing usage events
[0m14:07:45.671282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:25.175296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208ED8F3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208ED3F8B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208ED3FB470>]}


============================== 14:08:25.175296 | 9fe04d5e-d2b9-4e75-829b-5580ac70c51a ==============================
[0m14:08:25.175296 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:08:25.190980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_rank_customers', 'send_anonymous_usage_stats': 'True'}
[0m14:08:25.677211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fe04d5e-d2b9-4e75-829b-5580ac70c51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EE2B4B30>]}
[0m14:08:25.740386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fe04d5e-d2b9-4e75-829b-5580ac70c51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EE500470>]}
[0m14:08:25.740386 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:08:26.212465 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:08:26.354729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:26.354729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:26.370562 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:08:26.402934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fe04d5e-d2b9-4e75-829b-5580ac70c51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EE392F60>]}
[0m14:08:26.470978 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:08:26.470978 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:08:26.504355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fe04d5e-d2b9-4e75-829b-5580ac70c51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EE6D6A50>]}
[0m14:08:26.504355 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:08:26.504355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fe04d5e-d2b9-4e75-829b-5580ac70c51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EE503CB0>]}
[0m14:08:26.508356 [info ] [MainThread]: 
[0m14:08:26.508356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:26.508356 [info ] [MainThread]: 
[0m14:08:26.508356 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:08:26.508356 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:08:26.613139 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:08:26.614215 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:08:26.614215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:27.909783 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.295 seconds
[0m14:08:27.912535 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:08:27.923220 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:08:27.923220 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:08:27.923220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:28.889300 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.962 seconds
[0m14:08:28.893331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fe04d5e-d2b9-4e75-829b-5580ac70c51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EFDCC920>]}
[0m14:08:28.896039 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:08:28.896039 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:08:28.896039 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:08:28.896039 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:08:28.907950 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:08:28.909954 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:08:28.932227 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:08:28.932227 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:08:28.932227 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (WITH customer_ranking AS
(
    SELECT
    c.customer_id,c.customer_name,c.company,
    SUM(t.revenue) OVER (PARTITION BY c.customer_id) AS total_revenue,
    RANK() OVER (PARTITION BY c.customer_id ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_customers c ON t.customer_id = c.customer_id
GROUP BY c.customer_id
ORDER BY revenue_rank
)
SELECT * from customer_ranking
        );
[0m14:08:28.932227 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:08:29.899667 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa6-3201-7e57-000c-493e00026252
[0m14:08:29.899667 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[T.REVENUE] is not a valid group by expression
[0m14:08:29.915092 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:08:29.915092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fe04d5e-d2b9-4e75-829b-5580ac70c51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208F005BBF0>]}
[0m14:08:29.915092 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_rank_customers ....... [[31mERROR[0m in 1.02s]
[0m14:08:29.915092 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:08:29.915092 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m14:08:29.915092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:29.915092 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:08:29.915092 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:08:30.237878 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:08:30.237878 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:08:30.559297 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:08:30.559297 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:08:30.895068 [info ] [MainThread]: 
[0m14:08:30.895068 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m14:08:30.895068 [debug] [MainThread]: Command end result
[0m14:08:30.918657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:08:30.922008 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:08:30.926041 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:08:30.926041 [info ] [MainThread]: 
[0m14:08:30.926041 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:08:30.926041 [info ] [MainThread]: 
[0m14:08:30.926041 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:08:30.926041 [info ] [MainThread]: 
[0m14:08:30.926041 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:08:30.926041 [debug] [MainThread]: Command `dbt run` failed at 14:08:30.926041 after 5.91 seconds
[0m14:08:30.933766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EA131BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208EE2E7CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208E7BE7530>]}
[0m14:08:30.933766 [debug] [MainThread]: Flushing usage events
[0m14:08:31.818371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:46.362623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED700BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED46A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED703D40>]}


============================== 14:08:46.375578 | 0457df71-35ef-405e-ab98-dceb5b045bfa ==============================
[0m14:08:46.375578 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:08:46.375578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_rank_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:47.291247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0457df71-35ef-405e-ab98-dceb5b045bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED2A8830>]}
[0m14:08:47.348123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0457df71-35ef-405e-ab98-dceb5b045bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246EE484CE0>]}
[0m14:08:47.348123 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:08:47.928217 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:08:48.086067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:48.086067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:48.086067 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:08:48.121716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0457df71-35ef-405e-ab98-dceb5b045bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED701CA0>]}
[0m14:08:48.183735 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:08:48.212613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:08:48.231520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0457df71-35ef-405e-ab98-dceb5b045bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246EF8E60F0>]}
[0m14:08:48.247213 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:08:48.247213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0457df71-35ef-405e-ab98-dceb5b045bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED5C4A10>]}
[0m14:08:48.247213 [info ] [MainThread]: 
[0m14:08:48.247213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:48.247213 [info ] [MainThread]: 
[0m14:08:48.247213 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:08:48.247213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:08:51.287416 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:08:51.289422 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:08:51.289422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:52.829794 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.541 seconds
[0m14:08:52.829794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:08:52.845855 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:08:52.845855 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:08:52.845855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:54.073269 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.228 seconds
[0m14:08:54.079140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0457df71-35ef-405e-ab98-dceb5b045bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246EF97DFA0>]}
[0m14:08:54.083151 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:08:54.083151 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:08:54.085158 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:08:54.085158 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:08:54.085158 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:08:54.085158 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:08:54.124087 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:08:54.124087 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:08:54.124087 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (WITH customer_ranking AS
(
    SELECT
    c.customer_id,c.customer_name,c.company,
    SUM(t.revenue) OVER (PARTITION BY c.customer_id) AS total_revenue,
    RANK() OVER (PARTITION BY c.customer_id ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_customers c ON t.customer_id = c.customer_id
ORDER BY revenue_rank
)
SELECT * from customer_ranking
        );
[0m14:08:54.124087 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:08:55.219481 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa6-3201-7e56-000c-493e00024542
[0m14:08:55.220526 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[T.REVENUE] is not a valid group by expression
[0m14:08:55.227535 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:08:55.227535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0457df71-35ef-405e-ab98-dceb5b045bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED7198B0>]}
[0m14:08:55.227535 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_rank_customers ....... [[31mERROR[0m in 1.14s]
[0m14:08:55.227535 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:08:55.241501 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m14:08:55.242785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:55.244001 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:08:55.244001 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:08:55.579590 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:08:55.579590 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:08:55.905716 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:08:55.905716 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:08:56.230921 [info ] [MainThread]: 
[0m14:08:56.230921 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m14:08:56.230921 [debug] [MainThread]: Command end result
[0m14:08:56.266130 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:08:56.268118 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:08:56.268118 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:08:56.268118 [info ] [MainThread]: 
[0m14:08:56.275722 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:08:56.275722 [info ] [MainThread]: 
[0m14:08:56.277732 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:08:56.277732 [info ] [MainThread]: 
[0m14:08:56.279117 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:08:56.280082 [debug] [MainThread]: Command `dbt run` failed at 14:08:56.280082 after 10.08 seconds
[0m14:08:56.280082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED52C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246EB40A6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED6B7920>]}
[0m14:08:56.281081 [debug] [MainThread]: Flushing usage events
[0m14:08:57.580290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:19.173033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B5BB3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B582A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B36EFC80>]}


============================== 14:09:19.173033 | 969c9198-d7bf-41f4-85da-4175a7397698 ==============================
[0m14:09:19.173033 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:09:19.173033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_rank_customers', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:09:19.666351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '969c9198-d7bf-41f4-85da-4175a7397698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B5BCD820>]}
[0m14:09:19.735569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '969c9198-d7bf-41f4-85da-4175a7397698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B6918FB0>]}
[0m14:09:19.737417 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:09:20.198274 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:09:20.346217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:20.346217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:20.355891 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:09:20.386579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '969c9198-d7bf-41f4-85da-4175a7397698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B7A2C530>]}
[0m14:09:20.449966 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:09:20.456165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:09:20.481301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '969c9198-d7bf-41f4-85da-4175a7397698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B7BFC920>]}
[0m14:09:20.481301 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:09:20.481301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969c9198-d7bf-41f4-85da-4175a7397698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B7A4B4A0>]}
[0m14:09:20.481301 [info ] [MainThread]: 
[0m14:09:20.481301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:20.481301 [info ] [MainThread]: 
[0m14:09:20.481301 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:09:20.481301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:09:20.600183 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:09:20.600183 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:09:20.600183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:21.932348 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.332 seconds
[0m14:09:21.948200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:09:21.963911 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:09:21.963911 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:09:21.963911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:23.048695 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.093 seconds
[0m14:09:23.063900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969c9198-d7bf-41f4-85da-4175a7397698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B79C7F20>]}
[0m14:09:23.063900 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:09:23.063900 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:09:23.063900 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:09:23.063900 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:09:23.063900 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:09:23.063900 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:09:23.103362 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:09:23.103362 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:09:23.103362 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (WITH customer_ranking AS
(
    SELECT
    c.customer_id,c.customer_name,c.company,
    SUM(t.revenue) OVER (PARTITION BY c.customer_id) AS total_revenue,
    RANK() OVER ( ORDER BY SUM(t.revenue) DESC) AS revenue_rank
FROM stg_transactions t
JOIN stg_customers c ON t.customer_id = c.customer_id
ORDER BY revenue_rank
)
SELECT * from customer_ranking
        );
[0m14:09:23.103362 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:09:24.035504 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa7-3201-7db6-000c-493e0002534e
[0m14:09:24.035504 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[T.REVENUE] is not a valid group by expression
[0m14:09:24.035504 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:09:24.051255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '969c9198-d7bf-41f4-85da-4175a7397698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B5054B60>]}
[0m14:09:24.051255 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_rank_customers ....... [[31mERROR[0m in 0.97s]
[0m14:09:24.051255 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:09:24.051255 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m14:09:24.051255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:24.051255 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:09:24.051255 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:09:24.504506 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:09:24.504506 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:09:24.826527 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:09:24.826527 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:09:25.162705 [info ] [MainThread]: 
[0m14:09:25.162705 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m14:09:25.168217 [debug] [MainThread]: Command end result
[0m14:09:25.205217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:09:25.209371 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:09:25.215341 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:09:25.215341 [info ] [MainThread]: 
[0m14:09:25.215341 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:09:25.215341 [info ] [MainThread]: 
[0m14:09:25.215341 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:09:25.215341 [info ] [MainThread]: 
[0m14:09:25.215341 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:09:25.221142 [debug] [MainThread]: Command `dbt run` failed at 14:09:25.221142 after 6.21 seconds
[0m14:09:25.221898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B582A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B5502A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2B5BCEB70>]}
[0m14:09:25.221898 [debug] [MainThread]: Flushing usage events
[0m14:09:26.154241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:20.958703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E15F181880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E15F1815E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E15F183A40>]}


============================== 14:15:20.958703 | c23f7cf9-7aba-4e89-9d12-4d01218ce3a9 ==============================
[0m14:15:20.958703 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:15:20.958703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_rank_customers', 'send_anonymous_usage_stats': 'True'}
[0m14:15:21.698721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c23f7cf9-7aba-4e89-9d12-4d01218ce3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E15C522990>]}
[0m14:15:21.762376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c23f7cf9-7aba-4e89-9d12-4d01218ce3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E15FE679B0>]}
[0m14:15:21.762376 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:15:22.248117 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:15:22.406352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:22.406352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:22.406352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:15:22.444167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c23f7cf9-7aba-4e89-9d12-4d01218ce3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E15F1823F0>]}
[0m14:15:22.510177 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:15:22.510177 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:15:22.575977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c23f7cf9-7aba-4e89-9d12-4d01218ce3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1612F6330>]}
[0m14:15:22.576909 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:15:22.576909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c23f7cf9-7aba-4e89-9d12-4d01218ce3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E15F183740>]}
[0m14:15:22.576909 [info ] [MainThread]: 
[0m14:15:22.576909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:22.576909 [info ] [MainThread]: 
[0m14:15:22.576909 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:22.576909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:15:22.694197 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:15:22.694197 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:15:22.694197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:24.145650 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.456 seconds
[0m14:15:24.162759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:15:24.162759 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:15:24.162759 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:15:24.162759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:25.132793 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.964 seconds
[0m14:15:25.148596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c23f7cf9-7aba-4e89-9d12-4d01218ce3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E160F47F20>]}
[0m14:15:25.148596 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:15:25.148596 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:15:25.148596 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:15:25.148596 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:15:25.164606 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:15:25.166509 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:15:25.197241 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:15:25.199207 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:15:25.199207 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (WITH customers AS
(
    SELECT
    c.customer_id,c.customer_name,c.company
FROM stg_customers c 
),
total_revenue AS(
    customer_id,
    SUM(revenue) OVER(PARTITION BY customer_id) AS total_revenue,
    RANK() OVER(ORDER BY total_revenue DESC) as revenue_rank
    JOIN customers c ON t.customer_id = total_revenue.customer_id
    ORDER BY revenue_rank
)

SELECT * from total_revenue
        );
[0m14:15:25.200242 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:26.118249 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffad-3201-7db6-000c-493e00025356
[0m14:15:26.118249 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 15 unexpected ','.
syntax error line 11 at position 17 unexpected 'OVER'.
syntax error line 11 at position 22 unexpected 'PARTITION'.
syntax error line 11 at position 48 unexpected 'AS'.
syntax error line 12 at position 43 unexpected ')'.
[0m14:15:26.133985 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 15 unexpected ','.
  syntax error line 11 at position 17 unexpected 'OVER'.
  syntax error line 11 at position 22 unexpected 'PARTITION'.
  syntax error line 11 at position 48 unexpected 'AS'.
  syntax error line 12 at position 43 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:15:26.133985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c23f7cf9-7aba-4e89-9d12-4d01218ce3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E15E6247A0>]}
[0m14:15:26.133985 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_rank_customers ....... [[31mERROR[0m in 0.99s]
[0m14:15:26.133985 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:15:26.133985 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 15 unexpected ','.
  syntax error line 11 at position 17 unexpected 'OVER'.
  syntax error line 11 at position 22 unexpected 'PARTITION'.
  syntax error line 11 at position 48 unexpected 'AS'.
  syntax error line 12 at position 43 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m14:15:26.133985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:26.133985 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:15:26.133985 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:15:26.475471 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:15:26.475471 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:15:26.801731 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:15:26.802728 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:15:27.122116 [info ] [MainThread]: 
[0m14:15:27.122116 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m14:15:27.122116 [debug] [MainThread]: Command end result
[0m14:15:27.158544 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:15:27.160658 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:15:27.169128 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:15:27.169128 [info ] [MainThread]: 
[0m14:15:27.170131 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:15:27.171142 [info ] [MainThread]: 
[0m14:15:27.171142 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 15 unexpected ','.
  syntax error line 11 at position 17 unexpected 'OVER'.
  syntax error line 11 at position 22 unexpected 'PARTITION'.
  syntax error line 11 at position 48 unexpected 'AS'.
  syntax error line 12 at position 43 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:15:27.171142 [info ] [MainThread]: 
[0m14:15:27.171142 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:15:27.171142 [debug] [MainThread]: Command `dbt run` failed at 14:15:27.171142 after 6.40 seconds
[0m14:15:27.171142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E15E8731A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E15BB1ADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E15BB19910>]}
[0m14:15:27.171142 [debug] [MainThread]: Flushing usage events
[0m14:15:28.446330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:03.686587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6F670470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6CAC57C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6CA12BA0>]}


============================== 14:16:03.706663 | 1e95a5eb-a79b-4413-b2f7-6c558abeb01a ==============================
[0m14:16:03.706663 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:16:03.707714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_rank_customers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:04.206353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e95a5eb-a79b-4413-b2f7-6c558abeb01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A70087D70>]}
[0m14:16:04.272656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e95a5eb-a79b-4413-b2f7-6c558abeb01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6EBA5FA0>]}
[0m14:16:04.274656 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:16:04.770370 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:16:04.940364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:04.940364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:04.940364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:16:04.978376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e95a5eb-a79b-4413-b2f7-6c558abeb01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A7041AA20>]}
[0m14:16:05.053443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:16:05.057456 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:16:05.086892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e95a5eb-a79b-4413-b2f7-6c558abeb01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A716DC9B0>]}
[0m14:16:05.086892 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:16:05.086892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e95a5eb-a79b-4413-b2f7-6c558abeb01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6D327320>]}
[0m14:16:05.086892 [info ] [MainThread]: 
[0m14:16:05.086892 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:05.086892 [info ] [MainThread]: 
[0m14:16:05.086892 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:16:05.086892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:16:05.203754 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:16:05.203754 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:16:05.203754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:06.575468 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.370 seconds
[0m14:16:06.575468 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:16:06.591217 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:16:06.592183 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:16:06.592183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:07.598810 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.007 seconds
[0m14:16:07.602775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e95a5eb-a79b-4413-b2f7-6c558abeb01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A716DFF20>]}
[0m14:16:07.611783 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:16:07.611783 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:16:07.612783 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:16:07.612783 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:16:07.619785 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:16:07.621785 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:16:07.655422 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:16:07.657685 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:16:07.657685 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (WITH customers AS
(
    SELECT
    c.customer_id,c.customer_name,c.company
FROM stg_customers c 
),
total_revenue AS(
    total_revenuecustomer_id,
    SUM(total_revenue.revenue) OVER(PARTITION BY total_revenue.customer_id) AS total_revenue,
    RANK() OVER(ORDER BY total_revenue DESC) as revenue_rank
    JOIN customers c ON t.customer_id = total_revenue.customer_id
    ORDER BY revenue_rank
)

SELECT * from total_revenue
        );
[0m14:16:07.658684 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:16:08.610073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffae-3201-7e9a-000c-493e000233ea
[0m14:16:08.610073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 28 unexpected ','.
syntax error line 11 at position 21 unexpected '.'.
syntax error line 11 at position 76 unexpected 'AS'.
[0m14:16:08.614148 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 28 unexpected ','.
  syntax error line 11 at position 21 unexpected '.'.
  syntax error line 11 at position 76 unexpected 'AS'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:16:08.616113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e95a5eb-a79b-4413-b2f7-6c558abeb01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6EB14590>]}
[0m14:16:08.616113 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_rank_customers ....... [[31mERROR[0m in 1.00s]
[0m14:16:08.617147 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:16:08.618113 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 28 unexpected ','.
  syntax error line 11 at position 21 unexpected '.'.
  syntax error line 11 at position 76 unexpected 'AS'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m14:16:08.619114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:08.620147 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:16:08.620147 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:16:08.945842 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:16:08.945842 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:16:09.256450 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:16:09.267704 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:16:09.596345 [info ] [MainThread]: 
[0m14:16:09.596345 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m14:16:09.598344 [debug] [MainThread]: Command end result
[0m14:16:09.621342 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:16:09.623320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:16:09.627886 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:16:09.627886 [info ] [MainThread]: 
[0m14:16:09.627886 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:16:09.627886 [info ] [MainThread]: 
[0m14:16:09.627886 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 28 unexpected ','.
  syntax error line 11 at position 21 unexpected '.'.
  syntax error line 11 at position 76 unexpected 'AS'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:16:09.627886 [info ] [MainThread]: 
[0m14:16:09.627886 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:16:09.627886 [debug] [MainThread]: Command `dbt run` failed at 14:16:09.627886 after 6.10 seconds
[0m14:16:09.627886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6F645520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6EE56A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6EE571A0>]}
[0m14:16:09.627886 [debug] [MainThread]: Flushing usage events
[0m14:16:10.490186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:48.993916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025648B67CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025648B67B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025648B65F40>]}


============================== 14:16:48.993916 | 391cccf2-3291-4f57-ab87-42f5445fc32a ==============================
[0m14:16:48.993916 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:16:48.993916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_rank_customers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:49.480529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '391cccf2-3291-4f57-ab87-42f5445fc32a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564A21ACF0>]}
[0m14:16:49.544240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '391cccf2-3291-4f57-ab87-42f5445fc32a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564A050560>]}
[0m14:16:49.544240 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:16:50.013262 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:16:50.169902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:50.169902 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:50.175661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:16:50.199492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '391cccf2-3291-4f57-ab87-42f5445fc32a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256496DC590>]}
[0m14:16:50.262825 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:16:50.278928 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:16:50.310740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '391cccf2-3291-4f57-ab87-42f5445fc32a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564B6DCD70>]}
[0m14:16:50.310740 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:16:50.310740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '391cccf2-3291-4f57-ab87-42f5445fc32a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564B782480>]}
[0m14:16:50.310740 [info ] [MainThread]: 
[0m14:16:50.310740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:50.310740 [info ] [MainThread]: 
[0m14:16:50.310740 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:16:50.310740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:16:50.420634 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:16:50.421630 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:16:50.421630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:51.757730 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.338 seconds
[0m14:16:51.757730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:16:51.773819 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:16:51.773819 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:16:51.773819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:52.763522 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.993 seconds
[0m14:16:52.763522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '391cccf2-3291-4f57-ab87-42f5445fc32a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564B6DCEF0>]}
[0m14:16:52.763522 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:16:52.763522 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:16:52.763522 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:16:52.779203 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:16:52.779203 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:16:52.779203 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:16:52.819488 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:16:52.819488 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:16:52.819488 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (-- WITH customers AS
-- (
--     SELECT
--     c.customer_id,c.customer_name,c.company
-- FROM stg_customers c 
-- ),
-- total_revenue AS(
--     total_revenuecustomer_id,
--     SUM(total_revenue.revenue) OVER(PARTITION BY total_revenue.customer_id) AS total_revenue,
--     RANK() OVER(ORDER BY total_revenue DESC) as revenue_rank
--     JOIN customers c ON t.customer_id = total_revenue.customer_id
--     ORDER BY revenue_rank
-- )

-- SELECT * from total_revenue





WITH customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company
    FROM stg_customers c 
),
total_revenue AS (
    SELECT
        t.customer_id,
        SUM(t.revenue) OVER(PARTITION BY t.customer_id) AS total_revenue,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS revenue_rank
    FROM stg_transactions t
    JOIN customers c ON t.customer_id = c.customer_id
    GROUP BY t.customer_id
)

SELECT * 
FROM total_revenue
ORDER BY revenue_rank;
[0m14:16:52.819488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:16:53.718650 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffae-3201-7e9a-000c-493e000233f6
[0m14:16:53.718650 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 42 at position 21 unexpected ';'.
[0m14:16:53.718650 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 21 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:16:53.718650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '391cccf2-3291-4f57-ab87-42f5445fc32a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564BCA4AA0>]}
[0m14:16:53.718650 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_rank_customers ....... [[31mERROR[0m in 0.96s]
[0m14:16:53.718650 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:16:53.718650 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 21 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m14:16:53.718650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:53.718650 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:16:53.718650 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:16:54.045391 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:16:54.045391 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:16:54.379766 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:16:54.389285 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:16:54.708007 [info ] [MainThread]: 
[0m14:16:54.708007 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m14:16:54.708007 [debug] [MainThread]: Command end result
[0m14:16:54.754836 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:16:54.757835 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:16:54.764910 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:16:54.764910 [info ] [MainThread]: 
[0m14:16:54.764910 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:16:54.766831 [info ] [MainThread]: 
[0m14:16:54.766831 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 21 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:16:54.768702 [info ] [MainThread]: 
[0m14:16:54.769714 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:16:54.770709 [debug] [MainThread]: Command `dbt run` failed at 14:16:54.770709 after 5.94 seconds
[0m14:16:54.772964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256490FFEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564B780740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025649814E30>]}
[0m14:16:54.772964 [debug] [MainThread]: Flushing usage events
[0m14:16:55.689661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:02.632837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021021D6CD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021021D6CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021021D6C890>]}


============================== 14:17:02.649789 | 6d95c8c4-c8af-4a00-8f78-1d2e3758445e ==============================
[0m14:17:02.649789 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:17:02.649789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_rank_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:17:03.125122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d95c8c4-c8af-4a00-8f78-1d2e3758445e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021021D6FB90>]}
[0m14:17:03.187172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d95c8c4-c8af-4a00-8f78-1d2e3758445e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102275B9B0>]}
[0m14:17:03.189142 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:17:03.658950 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:17:03.821981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:17:03.821981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:17:03.821981 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:17:03.864609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d95c8c4-c8af-4a00-8f78-1d2e3758445e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021023D77230>]}
[0m14:17:03.928436 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:17:03.928436 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:17:03.959754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d95c8c4-c8af-4a00-8f78-1d2e3758445e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021023EE6240>]}
[0m14:17:03.959754 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:17:03.959754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d95c8c4-c8af-4a00-8f78-1d2e3758445e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021023EFE060>]}
[0m14:17:03.959754 [info ] [MainThread]: 
[0m14:17:03.959754 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:03.959754 [info ] [MainThread]: 
[0m14:17:03.959754 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:17:03.975435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:17:04.080163 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:17:04.080163 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:17:04.080163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:05.142351 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.062 seconds
[0m14:17:05.145712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:17:05.158261 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:17:05.158261 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:17:05.158261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:06.100670 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.942 seconds
[0m14:17:06.104392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d95c8c4-c8af-4a00-8f78-1d2e3758445e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021021DB4E30>]}
[0m14:17:06.108523 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:17:06.108523 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:17:06.109559 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:17:06.110524 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:17:06.117330 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:17:06.118300 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:17:06.149284 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:17:06.149284 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:17:06.149284 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (-- WITH customers AS
-- (
--     SELECT
--     c.customer_id,c.customer_name,c.company
-- FROM stg_customers c 
-- ),
-- total_revenue AS(
--     total_revenuecustomer_id,
--     SUM(total_revenue.revenue) OVER(PARTITION BY total_revenue.customer_id) AS total_revenue,
--     RANK() OVER(ORDER BY total_revenue DESC) as revenue_rank
--     JOIN customers c ON t.customer_id = total_revenue.customer_id
--     ORDER BY revenue_rank
-- )

-- SELECT * from total_revenue





WITH customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company
    FROM stg_customers c 
),
total_revenue AS (
    SELECT
        t.customer_id,
        SUM(t.revenue) OVER(PARTITION BY t.customer_id) AS total_revenue,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS revenue_rank
    FROM stg_transactions t
    JOIN customers c ON t.customer_id = c.customer_id
    GROUP BY t.customer_id
)

SELECT * 
FROM total_revenue
ORDER BY revenue_rank
        );
[0m14:17:06.149284 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:07.450130 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffaf-3201-7e56-000c-493e0002455e
[0m14:17:07.450130 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[T.REVENUE] is not a valid group by expression
[0m14:17:07.458993 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:17:07.460997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d95c8c4-c8af-4a00-8f78-1d2e3758445e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021024368890>]}
[0m14:17:07.460997 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_rank_customers ....... [[31mERROR[0m in 1.35s]
[0m14:17:07.460997 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:17:07.460997 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m14:17:07.460997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:07.460997 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:17:07.460997 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:17:07.783860 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:17:07.783860 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:17:08.114664 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:17:08.116673 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:17:08.432691 [info ] [MainThread]: 
[0m14:17:08.432691 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m14:17:08.432691 [debug] [MainThread]: Command end result
[0m14:17:08.466620 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:17:08.469617 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:17:08.478263 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:17:08.478263 [info ] [MainThread]: 
[0m14:17:08.479265 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:17:08.479265 [info ] [MainThread]: 
[0m14:17:08.479265 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  000979 (42601): SQL compilation error:
  [T.REVENUE] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:17:08.479265 [info ] [MainThread]: 
[0m14:17:08.482264 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:17:08.484328 [debug] [MainThread]: Command `dbt run` failed at 14:17:08.484328 after 6.00 seconds
[0m14:17:08.485305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210218D5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101F399DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210212A9DF0>]}
[0m14:17:08.485305 [debug] [MainThread]: Flushing usage events
[0m14:17:09.719805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:50.418856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656E7134D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656DE475F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656D624380>]}


============================== 14:17:50.434563 | c4fa929a-dbfd-4416-b865-3fec993398b6 ==============================
[0m14:17:50.434563 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:17:50.434563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_rank_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:17:50.904870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4fa929a-dbfd-4416-b865-3fec993398b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656BAC2990>]}
[0m14:17:50.975836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4fa929a-dbfd-4416-b865-3fec993398b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656DB78FB0>]}
[0m14:17:50.975836 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:17:51.454189 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:17:51.607222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:17:51.607222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:17:51.623108 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:17:51.656010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4fa929a-dbfd-4416-b865-3fec993398b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165706EB7A0>]}
[0m14:17:51.729632 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:17:51.733632 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:17:51.766560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4fa929a-dbfd-4416-b865-3fec993398b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016570734800>]}
[0m14:17:51.766560 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:17:51.767560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4fa929a-dbfd-4416-b865-3fec993398b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001657050C2C0>]}
[0m14:17:51.768560 [info ] [MainThread]: 
[0m14:17:51.769575 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:51.769575 [info ] [MainThread]: 
[0m14:17:51.770560 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:17:51.771560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:17:51.875660 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:17:51.875660 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:17:51.875660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:53.228264 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.350 seconds
[0m14:17:53.230272 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:17:53.243264 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:17:53.243264 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:17:53.243264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:54.186422 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.951 seconds
[0m14:17:54.201952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4fa929a-dbfd-4416-b865-3fec993398b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016570AE0EF0>]}
[0m14:17:54.201952 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:17:54.201952 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:17:54.201952 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:17:54.201952 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:17:54.214356 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:17:54.215356 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:17:54.247826 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:17:54.248795 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:17:54.249829 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (-- WITH customers AS
-- (
--     SELECT
--     c.customer_id,c.customer_name,c.company
-- FROM stg_customers c 
-- ),
-- total_revenue AS(
--     total_revenuecustomer_id,
--     SUM(total_revenue.revenue) OVER(PARTITION BY total_revenue.customer_id) AS total_revenue,
--     RANK() OVER(ORDER BY total_revenue DESC) as revenue_rank
--     JOIN customers c ON t.customer_id = total_revenue.customer_id
--     ORDER BY revenue_rank
-- )

-- SELECT * from total_revenue



WITH customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company
    FROM stg_customers c 
),
total_revenue AS (
    SELECT
        t.customer_id,
        SUM(t.revenue) AS total_revenue,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS revenue_rank
    FROM stg_transactions t
    JOIN customers c ON t.customer_id = c.customer_id
    GROUP BY t.customer_id
)

SELECT * 
FROM total_revenue
ORDER BY revenue_rank;
[0m14:17:54.249829 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:55.169207 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffaf-3201-7db6-000c-493e0002536a
[0m14:17:55.169207 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 40 at position 21 unexpected ';'.
[0m14:17:55.171212 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 21 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:17:55.174726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4fa929a-dbfd-4416-b865-3fec993398b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656DBC4770>]}
[0m14:17:55.174726 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_rank_customers ....... [[31mERROR[0m in 0.97s]
[0m14:17:55.174726 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:17:55.174726 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 21 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m14:17:55.174726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:55.174726 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:17:55.174726 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:17:55.942970 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:17:55.942970 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:17:56.271734 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:17:56.271734 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:17:56.603144 [info ] [MainThread]: 
[0m14:17:56.603144 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m14:17:56.603144 [debug] [MainThread]: Command end result
[0m14:17:56.636082 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:17:56.636082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:17:56.646962 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:17:56.646962 [info ] [MainThread]: 
[0m14:17:56.648969 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:17:56.649969 [info ] [MainThread]: 
[0m14:17:56.649969 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 21 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m14:17:56.651000 [info ] [MainThread]: 
[0m14:17:56.651981 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:17:56.652969 [debug] [MainThread]: Command `dbt run` failed at 14:17:56.652969 after 6.39 seconds
[0m14:17:56.653581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656E357470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656C4BE510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656C4BE450>]}
[0m14:17:56.653581 [debug] [MainThread]: Flushing usage events
[0m14:17:57.567463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:03.860648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B261708C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B26170500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B261710D0>]}


============================== 14:18:03.860648 | 7ba027e0-18cb-42ca-898e-0e3fdab1a8f4 ==============================
[0m14:18:03.860648 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:18:03.876335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_rank_customers', 'send_anonymous_usage_stats': 'True'}
[0m14:18:04.345965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ba027e0-18cb-42ca-898e-0e3fdab1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B26DE9790>]}
[0m14:18:04.409382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ba027e0-18cb-42ca-898e-0e3fdab1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B26CE3980>]}
[0m14:18:04.409382 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:18:04.878279 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:18:05.021133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:18:05.021133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:18:05.039600 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:18:05.068990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ba027e0-18cb-42ca-898e-0e3fdab1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B26EE3020>]}
[0m14:18:05.138428 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:18:05.139934 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:18:05.171886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ba027e0-18cb-42ca-898e-0e3fdab1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B281235C0>]}
[0m14:18:05.171886 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:18:05.171886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ba027e0-18cb-42ca-898e-0e3fdab1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B281E92E0>]}
[0m14:18:05.171886 [info ] [MainThread]: 
[0m14:18:05.171886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:05.171886 [info ] [MainThread]: 
[0m14:18:05.171886 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:18:05.171886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:18:05.272812 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:18:05.272812 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:18:05.272812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:06.560682 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.281 seconds
[0m14:18:06.560682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:18:06.578378 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:18:06.578378 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:18:06.578378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:07.823793 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.253 seconds
[0m14:18:07.834227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ba027e0-18cb-42ca-898e-0e3fdab1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B28123F20>]}
[0m14:18:07.839490 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m14:18:07.841496 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_customers ................ [RUN]
[0m14:18:07.841496 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m14:18:07.841496 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m14:18:07.841496 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:18:07.850858 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m14:18:07.882820 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m14:18:07.883787 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m14:18:07.884806 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
         as
        (-- WITH customers AS
-- (
--     SELECT
--     c.customer_id,c.customer_name,c.company
-- FROM stg_customers c 
-- ),
-- total_revenue AS(
--     total_revenuecustomer_id,
--     SUM(total_revenue.revenue) OVER(PARTITION BY total_revenue.customer_id) AS total_revenue,
--     RANK() OVER(ORDER BY total_revenue DESC) as revenue_rank
--     JOIN customers c ON t.customer_id = total_revenue.customer_id
--     ORDER BY revenue_rank
-- )

-- SELECT * from total_revenue



WITH customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company
    FROM stg_customers c 
),
total_revenue AS (
    SELECT
        t.customer_id,
        SUM(t.revenue) AS total_revenue,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS revenue_rank
    FROM stg_transactions t
    JOIN customers c ON t.customer_id = c.customer_id
    GROUP BY t.customer_id
)

SELECT * 
FROM total_revenue
ORDER BY revenue_rank
        );
[0m14:18:07.884806 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:18:10.006571 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.121 seconds
[0m14:18:10.031368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ba027e0-18cb-42ca-898e-0e3fdab1a8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B25614500>]}
[0m14:18:10.031368 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_rank_customers ........... [[32mSUCCESS 1[0m in 2.19s]
[0m14:18:10.031368 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m14:18:10.031368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:10.031368 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:18:10.031368 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:18:10.353951 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:18:10.355955 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:18:10.680724 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m14:18:10.682745 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m14:18:11.008412 [info ] [MainThread]: 
[0m14:18:11.008412 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m14:18:11.008412 [debug] [MainThread]: Command end result
[0m14:18:11.034883 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:18:11.037880 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:18:11.037880 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:18:11.044580 [info ] [MainThread]: 
[0m14:18:11.045105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:11.047129 [info ] [MainThread]: 
[0m14:18:11.047129 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:18:11.049142 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:11.049142 after 7.34 seconds
[0m14:18:11.049142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B261710D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B26173E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B26170380>]}
[0m14:18:11.051154 [debug] [MainThread]: Flushing usage events
[0m14:18:11.962137 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:38.360811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026542A303B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026542A304A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026542A31820>]}


============================== 14:23:38.374853 | 068a5f73-7774-44fa-ab48-59a91b9cb5b1 ==============================
[0m14:23:38.374853 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:23:38.374853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_rank_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:23:38.844827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '068a5f73-7774-44fa-ab48-59a91b9cb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026543744B00>]}
[0m14:23:38.917115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '068a5f73-7774-44fa-ab48-59a91b9cb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026541F69E20>]}
[0m14:23:38.917115 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:23:39.393598 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:23:39.550875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:39.550875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:39.550875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:23:39.590762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '068a5f73-7774-44fa-ab48-59a91b9cb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002654488D2B0>]}
[0m14:23:39.656238 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:23:39.663885 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:23:39.698532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '068a5f73-7774-44fa-ab48-59a91b9cb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026544A5D430>]}
[0m14:23:39.698532 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:23:39.698532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '068a5f73-7774-44fa-ab48-59a91b9cb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026544A920F0>]}
[0m14:23:39.698532 [info ] [MainThread]: 
[0m14:23:39.703671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:39.703671 [info ] [MainThread]: 
[0m14:23:39.705083 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:39.708091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:23:39.806684 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:23:39.806684 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:23:39.806684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:41.281226 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.465 seconds
[0m14:23:41.287188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:23:41.290197 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:23:41.290197 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:23:41.290197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:42.274695 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.986 seconds
[0m14:23:42.274695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '068a5f73-7774-44fa-ab48-59a91b9cb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026544BD71A0>]}
[0m14:23:42.290477 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_products
[0m14:23:42.290477 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_rank_products ................. [RUN]
[0m14:23:42.290477 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_products'
[0m14:23:42.290477 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_products
[0m14:23:42.306218 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_products"
[0m14:23:42.307914 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_products
[0m14:23:42.344089 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_products"
[0m14:23:42.346057 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_products"
[0m14:23:42.347089 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
         as
        (-- WITH product_ranking AS(
--     SELECT
--     p.product_id, p.product_family, p.product_sub_family,
--     SUM(t.quantity) AS total_revenue,
--     RANK() OVER (ORDER BY SUM(t.quantity) DESC) AS revenue_rank
-- FROM stg_transactions t
-- JOIN stg_products p ON t.product_id = p.product_id
-- GROUP BY p.product_id, p.product_family, p.product_sub_family
-- ORDER BY revenue_rank
-- )
-- SELECT * from product_ranking

WITH products AS (
    SELECT
        p.product_id,
        p.product_family, 
        p.product_sub_family,
    FROM stg_products p
),
total_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS revenue_rank
    FROM stg_transactions t
    JOIN products p ON t.product_id = p.product_id
    GROUP BY t.product_id
)

SELECT * 
FROM total_revenue
ORDER BY revenue_rank
        );
[0m14:23:42.347089 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:43.847232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.501 seconds
[0m14:23:43.863175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '068a5f73-7774-44fa-ab48-59a91b9cb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653FDD1A60>]}
[0m14:23:43.863175 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_rank_products ............ [[32mSUCCESS 1[0m in 1.57s]
[0m14:23:43.879254 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_products
[0m14:23:43.879254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:43.879254 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:23:43.879254 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:23:44.211479 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:23:44.211479 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:23:44.546466 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_products' was left open.
[0m14:23:44.546466 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_products: Close
[0m14:23:44.881147 [info ] [MainThread]: 
[0m14:23:44.881147 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m14:23:44.888113 [debug] [MainThread]: Command end result
[0m14:23:44.928449 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:23:44.944694 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:23:44.950732 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:23:44.950732 [info ] [MainThread]: 
[0m14:23:44.951799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:44.952806 [info ] [MainThread]: 
[0m14:23:44.952806 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:23:44.953821 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:44.953821 after 6.75 seconds
[0m14:23:44.954864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002654227EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026540769280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653F3C3080>]}
[0m14:23:44.954864 [debug] [MainThread]: Flushing usage events
[0m14:23:46.231618 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:07.568349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017127294B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001712702A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017127294680>]}


============================== 14:32:07.568349 | 575cf309-9733-455c-b09b-b4c3491bf64d ==============================
[0m14:32:07.568349 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:32:07.568349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m crb_report.sql', 'send_anonymous_usage_stats': 'True'}
[0m14:32:08.619701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '575cf309-9733-455c-b09b-b4c3491bf64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017127F47290>]}
[0m14:32:08.683759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '575cf309-9733-455c-b09b-b4c3491bf64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017127C4F980>]}
[0m14:32:08.683759 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:32:09.264204 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:32:09.406949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:32:09.406949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:32:09.422797 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:32:09.447514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '575cf309-9733-455c-b09b-b4c3491bf64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171290AFCB0>]}
[0m14:32:09.525708 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:32:09.529256 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:32:09.567427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '575cf309-9733-455c-b09b-b4c3491bf64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001712925CBC0>]}
[0m14:32:09.567427 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:32:09.569433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '575cf309-9733-455c-b09b-b4c3491bf64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171293EE7B0>]}
[0m14:32:09.571441 [info ] [MainThread]: 
[0m14:32:09.571441 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:09.571441 [info ] [MainThread]: 
[0m14:32:09.573447 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:32:09.573447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:32:12.730801 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:32:12.732807 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:32:12.732807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:14.175284 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.452 seconds
[0m14:32:14.190995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:32:14.190995 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:32:14.190995 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:32:14.190995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:15.256334 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.070 seconds
[0m14:32:15.272515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '575cf309-9733-455c-b09b-b4c3491bf64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017127F72A80>]}
[0m14:32:15.280020 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:32:15.280020 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:32:15.280020 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:32:15.280020 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:32:15.291460 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:32:15.293051 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:32:15.321404 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:32:15.324403 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:32:15.325403 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        prod_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        c.customer_status,
        t.product_id,
        p.product_family,
        p.prod_sub_family,
        t.transaction_date,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
l.country,
        l.state,
l.city,
        SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY p.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m14:32:15.325403 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:32:16.490318 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffbe-3201-7d7b-000c-493e000226e2
[0m14:32:16.490318 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 8
invalid identifier 'PROD_SUB_FAMILY'
[0m14:32:16.505991 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'PROD_SUB_FAMILY'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:32:16.505991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '575cf309-9733-455c-b09b-b4c3491bf64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171292BA330>]}
[0m14:32:16.505991 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.23s]
[0m14:32:16.505991 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:32:16.505991 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'PROD_SUB_FAMILY'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:32:16.514062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:16.514062 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:32:16.514062 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:32:16.857572 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:32:16.857572 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:32:17.187617 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:32:17.187617 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:32:17.520117 [info ] [MainThread]: 
[0m14:32:17.520117 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.95 seconds (7.95s).
[0m14:32:17.520117 [debug] [MainThread]: Command end result
[0m14:32:17.542947 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:32:17.542947 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:32:17.555487 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:32:17.555487 [info ] [MainThread]: 
[0m14:32:17.555487 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:32:17.557691 [info ] [MainThread]: 
[0m14:32:17.558699 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'PROD_SUB_FAMILY'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:32:17.558699 [info ] [MainThread]: 
[0m14:32:17.559698 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:32:17.560700 [debug] [MainThread]: Command `dbt run` failed at 14:32:17.560700 after 10.19 seconds
[0m14:32:17.561730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017126BCF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017127294C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017127294B30>]}
[0m14:32:17.561730 [debug] [MainThread]: Flushing usage events
[0m14:32:18.472856 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:35.655949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002719F4CA240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002719F4CA330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002719F4CABD0>]}


============================== 14:32:35.655949 | 1f34cf47-70cd-4fc4-bd20-c4d0fb01e98b ==============================
[0m14:32:35.655949 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:32:35.655949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m crb_report.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:32:36.172809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f34cf47-70cd-4fc4-bd20-c4d0fb01e98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271A03522D0>]}
[0m14:32:36.239617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f34cf47-70cd-4fc4-bd20-c4d0fb01e98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002719EB49C10>]}
[0m14:32:36.239617 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:32:36.725101 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:32:36.879709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:32:36.879709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:32:36.885469 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:32:36.908059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f34cf47-70cd-4fc4-bd20-c4d0fb01e98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271A025B320>]}
[0m14:32:36.977924 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:32:36.990775 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:32:37.021085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f34cf47-70cd-4fc4-bd20-c4d0fb01e98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271A1756420>]}
[0m14:32:37.021085 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:32:37.021085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f34cf47-70cd-4fc4-bd20-c4d0fb01e98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271A0412960>]}
[0m14:32:37.021085 [info ] [MainThread]: 
[0m14:32:37.021085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:37.021085 [info ] [MainThread]: 
[0m14:32:37.021085 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:32:37.021085 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:32:37.134735 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:32:37.134735 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:32:37.135735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:38.385805 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.250 seconds
[0m14:32:38.389413 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:32:38.394179 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:32:38.394179 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:32:38.394179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:39.427083 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.025 seconds
[0m14:32:39.432017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f34cf47-70cd-4fc4-bd20-c4d0fb01e98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271A17ED3D0>]}
[0m14:32:39.433481 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:32:39.433481 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:32:39.433481 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:32:39.433481 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:32:39.446370 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:32:39.447370 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:32:39.475724 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:32:39.478730 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:32:39.479762 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        c.customer_status,
        t.product_id,
        p.product_family,
        p.prod_sub_family,
        t.transaction_date,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
l.country,
        l.state,
l.city,
        SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY p.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m14:32:39.480762 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:32:40.469056 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffbe-3201-7e57-000c-493e000262e6
[0m14:32:40.470056 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 37 at position 8
invalid identifier 'C.CUSTOMER_STATUS'
[0m14:32:40.474056 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'C.CUSTOMER_STATUS'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:32:40.476226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f34cf47-70cd-4fc4-bd20-c4d0fb01e98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271A1D47200>]}
[0m14:32:40.476808 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.04s]
[0m14:32:40.477910 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:32:40.477910 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'C.CUSTOMER_STATUS'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:32:40.477910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:40.477910 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:32:40.477910 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:32:40.803666 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:32:40.803666 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:32:41.138791 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:32:41.138791 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:32:41.476570 [info ] [MainThread]: 
[0m14:32:41.476570 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m14:32:41.476570 [debug] [MainThread]: Command end result
[0m14:32:41.502836 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:32:41.502836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:32:41.512912 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:32:41.512912 [info ] [MainThread]: 
[0m14:32:41.514594 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:32:41.515463 [info ] [MainThread]: 
[0m14:32:41.516470 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier 'C.CUSTOMER_STATUS'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:32:41.516470 [info ] [MainThread]: 
[0m14:32:41.517569 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:32:41.518577 [debug] [MainThread]: Command `dbt run` failed at 14:32:41.518577 after 6.04 seconds
[0m14:32:41.518577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002719F247920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002719EE7A2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002719F5B7D10>]}
[0m14:32:41.519611 [debug] [MainThread]: Flushing usage events
[0m14:32:42.408693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:56.139737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3CA3A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3CA387D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3CA38770>]}


============================== 14:32:56.150082 | 94ce8762-b078-4c49-9a3b-7fde2682739c ==============================
[0m14:32:56.150082 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:32:56.150082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m crb_report.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:32:56.626948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94ce8762-b078-4c49-9a3b-7fde2682739c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3D5A2F90>]}
[0m14:32:56.687783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94ce8762-b078-4c49-9a3b-7fde2682739c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3E8B7170>]}
[0m14:32:56.689789 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:32:57.157437 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:32:57.319290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:32:57.320292 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:32:57.326290 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:32:57.350754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94ce8762-b078-4c49-9a3b-7fde2682739c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3CB8A660>]}
[0m14:32:57.410996 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:32:57.410996 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:32:57.456028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94ce8762-b078-4c49-9a3b-7fde2682739c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3EB4C6B0>]}
[0m14:32:57.456028 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:32:57.458765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94ce8762-b078-4c49-9a3b-7fde2682739c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3EBF8260>]}
[0m14:32:57.460773 [info ] [MainThread]: 
[0m14:32:57.460773 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:57.460773 [info ] [MainThread]: 
[0m14:32:57.460773 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:32:57.460773 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:32:57.567833 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:32:57.567833 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:32:57.568837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:58.868264 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.309 seconds
[0m14:32:58.884364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:32:58.895046 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:32:58.895046 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:32:58.895046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:59.858610 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.964 seconds
[0m14:32:59.862616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94ce8762-b078-4c49-9a3b-7fde2682739c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3EBFA150>]}
[0m14:32:59.864621 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:32:59.864621 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:32:59.864621 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:32:59.864621 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:32:59.877955 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:32:59.879332 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:32:59.908634 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:32:59.912768 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:32:59.913812 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.prod_sub_family,
        t.transaction_date,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
l.country,
        l.state,
l.city,
        SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY p.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m14:32:59.913812 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:33:00.804239 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffbe-3201-7e9a-000c-493e00023466
[0m14:33:00.804239 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 39 at position 8
invalid identifier 'P.PROD_SUB_FAMILY'
[0m14:33:00.820181 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 39 at position 8
  invalid identifier 'P.PROD_SUB_FAMILY'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:33:00.820181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94ce8762-b078-4c49-9a3b-7fde2682739c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3F2BB9E0>]}
[0m14:33:00.820181 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 0.96s]
[0m14:33:00.820181 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:33:00.820181 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 39 at position 8
  invalid identifier 'P.PROD_SUB_FAMILY'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:33:00.820181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:00.820181 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:33:00.820181 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:33:01.147758 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:33:01.147758 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:33:01.747507 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:33:01.748024 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:33:02.082653 [info ] [MainThread]: 
[0m14:33:02.083042 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m14:33:02.083042 [debug] [MainThread]: Command end result
[0m14:33:02.106750 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:33:02.106750 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:33:02.117521 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:33:02.117521 [info ] [MainThread]: 
[0m14:33:02.118958 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:33:02.120351 [info ] [MainThread]: 
[0m14:33:02.120351 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 39 at position 8
  invalid identifier 'P.PROD_SUB_FAMILY'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:33:02.121391 [info ] [MainThread]: 
[0m14:33:02.122311 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:33:02.123318 [debug] [MainThread]: Command `dbt run` failed at 14:33:02.123318 after 6.14 seconds
[0m14:33:02.123318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3CD45370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3C6AA810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B3C6ABC50>]}
[0m14:33:02.124350 [debug] [MainThread]: Flushing usage events
[0m14:33:03.326999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:51.944140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531FEB4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531FEB4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531FEB4590>]}


============================== 14:33:51.949341 | e9638fd5-9c8a-4de6-b7f2-81a6bd73181f ==============================
[0m14:33:51.949341 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:33:51.949341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m crb_report.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:33:52.428301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9638fd5-9c8a-4de6-b7f2-81a6bd73181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531D292810>]}
[0m14:33:52.482720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9638fd5-9c8a-4de6-b7f2-81a6bd73181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531FEFAE70>]}
[0m14:33:52.482720 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:33:52.979452 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:33:53.136582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:33:53.136582 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:33:53.136582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:33:53.173880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9638fd5-9c8a-4de6-b7f2-81a6bd73181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531F4264B0>]}
[0m14:33:53.229802 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:33:53.245490 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:33:53.276899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9638fd5-9c8a-4de6-b7f2-81a6bd73181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025321FE42F0>]}
[0m14:33:53.276899 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:33:53.276899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9638fd5-9c8a-4de6-b7f2-81a6bd73181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025320E0E960>]}
[0m14:33:53.276899 [info ] [MainThread]: 
[0m14:33:53.276899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:53.276899 [info ] [MainThread]: 
[0m14:33:53.276899 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:33:53.276899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:33:53.386485 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:33:53.386485 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:33:53.386485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:54.708381 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.330 seconds
[0m14:33:54.734318 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:33:54.740104 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:33:54.740104 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:33:54.740104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:55.743583 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.004 seconds
[0m14:33:55.743583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9638fd5-9c8a-4de6-b7f2-81a6bd73181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531FF24E30>]}
[0m14:33:55.759651 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:33:55.759651 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:33:55.759651 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:33:55.759651 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:33:55.759651 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:33:55.759651 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:33:55.787568 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:33:55.802798 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:33:55.802798 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.transaction_date,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        l.state,
        l.city,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY p.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m14:33:55.803786 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:33:56.762794 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffbf-3201-7d7b-000c-493e000226f6
[0m14:33:56.762794 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 40 at position 8
invalid identifier 'T.TRANSACTION_DATE'
[0m14:33:56.762794 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 40 at position 8
  invalid identifier 'T.TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:33:56.762794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9638fd5-9c8a-4de6-b7f2-81a6bd73181f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025322059AF0>]}
[0m14:33:56.762794 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.00s]
[0m14:33:56.762794 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:33:56.762794 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 40 at position 8
  invalid identifier 'T.TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:33:56.762794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:56.762794 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:33:56.762794 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:33:57.095823 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:33:57.095823 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:33:57.411919 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:33:57.411919 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:33:57.746268 [info ] [MainThread]: 
[0m14:33:57.746268 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m14:33:57.746268 [debug] [MainThread]: Command end result
[0m14:33:57.771753 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:33:57.774743 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:33:57.778781 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:33:57.778781 [info ] [MainThread]: 
[0m14:33:57.778781 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:33:57.778781 [info ] [MainThread]: 
[0m14:33:57.778781 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 40 at position 8
  invalid identifier 'T.TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:33:57.778781 [info ] [MainThread]: 
[0m14:33:57.778781 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:33:57.778781 [debug] [MainThread]: Command `dbt run` failed at 14:33:57.778781 after 6.00 seconds
[0m14:33:57.778781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025320D1E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025320D1C200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531FA1F860>]}
[0m14:33:57.778781 [debug] [MainThread]: Flushing usage events
[0m14:33:58.681988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:13.753002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E544CCD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E544CE690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E544CC3E0>]}


============================== 14:34:13.753002 | 2623ce5c-1926-4496-8239-9ba4366b3ba1 ==============================
[0m14:34:13.753002 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:34:13.753002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m crb_report.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:34:14.233609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2623ce5c-1926-4496-8239-9ba4366b3ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E551B7320>]}
[0m14:34:14.296840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2623ce5c-1926-4496-8239-9ba4366b3ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E53A16420>]}
[0m14:34:14.296840 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:34:14.769407 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:34:14.915040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:34:14.915040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:34:14.915040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:34:14.955831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2623ce5c-1926-4496-8239-9ba4366b3ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E564783E0>]}
[0m14:34:15.026948 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:34:15.030958 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:34:15.061589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2623ce5c-1926-4496-8239-9ba4366b3ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E564CEE70>]}
[0m14:34:15.061589 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:34:15.061589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2623ce5c-1926-4496-8239-9ba4366b3ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E551DFB60>]}
[0m14:34:15.066193 [info ] [MainThread]: 
[0m14:34:15.066193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:15.066193 [info ] [MainThread]: 
[0m14:34:15.066193 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:15.068422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:34:15.172530 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:34:15.172530 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:34:15.172530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:16.677813 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.501 seconds
[0m14:34:16.684000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:34:16.694810 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:34:16.694810 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:34:16.694810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:17.688319 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.993 seconds
[0m14:34:17.692367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2623ce5c-1926-4496-8239-9ba4366b3ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E55042030>]}
[0m14:34:17.696591 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:34:17.696591 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:34:17.696591 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:34:17.696591 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:34:17.707826 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:34:17.710131 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:34:17.728521 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:34:17.742291 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:34:17.742291 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.transaction_date,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        l.state,
        l.city,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY p.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m14:34:17.742291 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:34:18.739293 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc0-3201-7d7b-000c-493e000226fa
[0m14:34:18.739293 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 40 at position 8
invalid identifier 'T.TRANSACTION_DATE'
[0m14:34:18.742618 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 40 at position 8
  invalid identifier 'T.TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:34:18.745484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2623ce5c-1926-4496-8239-9ba4366b3ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E53984830>]}
[0m14:34:18.745484 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.05s]
[0m14:34:18.746574 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:34:18.747581 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 40 at position 8
  invalid identifier 'T.TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:34:18.748614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:18.748614 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:34:18.749887 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:34:19.074942 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:34:19.074942 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:34:19.424740 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:34:19.425406 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:34:19.748102 [info ] [MainThread]: 
[0m14:34:19.748102 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m14:34:19.748102 [debug] [MainThread]: Command end result
[0m14:34:19.780598 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:34:19.783594 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:34:19.790400 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:34:19.790400 [info ] [MainThread]: 
[0m14:34:19.792327 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:34:19.792327 [info ] [MainThread]: 
[0m14:34:19.794385 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 40 at position 8
  invalid identifier 'T.TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:34:19.795380 [info ] [MainThread]: 
[0m14:34:19.796393 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:34:19.797378 [debug] [MainThread]: Command `dbt run` failed at 14:34:19.797378 after 6.20 seconds
[0m14:34:19.797378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E54392870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E5523C860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E564AF590>]}
[0m14:34:19.798431 [debug] [MainThread]: Flushing usage events
[0m14:34:20.705319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:45.233927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020410243FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040F79C6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040FC0B890>]}


============================== 14:34:45.233927 | e0fffedd-9cbf-412a-aefb-f12a89425e53 ==============================
[0m14:34:45.233927 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:34:45.233927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m crb_report.sql', 'send_anonymous_usage_stats': 'True'}
[0m14:34:45.719675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0fffedd-9cbf-412a-aefb-f12a89425e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002041010A870>]}
[0m14:34:45.767408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0fffedd-9cbf-412a-aefb-f12a89425e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020411F6F9E0>]}
[0m14:34:45.767408 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:34:46.252806 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:34:46.403324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:34:46.403324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:34:46.411370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:34:46.437009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0fffedd-9cbf-412a-aefb-f12a89425e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204120BD760>]}
[0m14:34:46.503387 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:34:46.516866 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:34:46.532721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0fffedd-9cbf-412a-aefb-f12a89425e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020412406120>]}
[0m14:34:46.548765 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:34:46.548765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fffedd-9cbf-412a-aefb-f12a89425e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204120DB680>]}
[0m14:34:46.548765 [info ] [MainThread]: 
[0m14:34:46.548765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:46.548765 [info ] [MainThread]: 
[0m14:34:46.548765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:46.548765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:34:46.657543 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:34:46.657543 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:34:46.657543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:48.102831 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.448 seconds
[0m14:34:48.111813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:34:48.118580 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:34:48.118580 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:34:48.118580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:49.416598 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.297 seconds
[0m14:34:49.416598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fffedd-9cbf-412a-aefb-f12a89425e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002041283E3C0>]}
[0m14:34:49.429674 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:34:49.429674 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:34:49.429674 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:34:49.429674 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:34:49.429674 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:34:49.429674 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:34:49.473898 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:34:49.475897 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:34:49.476896 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        l.state,
        l.city,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY p.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m14:34:49.476896 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:34:50.421007 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc0-3201-7e57-000c-493e000262f2
[0m14:34:50.421007 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 8
invalid identifier 'L.STATE'
[0m14:34:50.431997 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'L.STATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:34:50.431997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fffedd-9cbf-412a-aefb-f12a89425e53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040F6E4530>]}
[0m14:34:50.431997 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.00s]
[0m14:34:50.431997 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:34:50.431997 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'L.STATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:34:50.431997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:50.431997 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:34:50.431997 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:34:50.755617 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:34:50.755617 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:34:51.095270 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:34:51.095270 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:34:51.423759 [info ] [MainThread]: 
[0m14:34:51.423759 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m14:34:51.423759 [debug] [MainThread]: Command end result
[0m14:34:51.441260 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:34:51.441260 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:34:51.461070 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:34:51.461070 [info ] [MainThread]: 
[0m14:34:51.461965 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:34:51.462972 [info ] [MainThread]: 
[0m14:34:51.462972 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'L.STATE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:34:51.464015 [info ] [MainThread]: 
[0m14:34:51.464015 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:34:51.464015 [debug] [MainThread]: Command `dbt run` failed at 14:34:51.464015 after 6.38 seconds
[0m14:34:51.464015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040FFDD610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040FB77620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002040FB76240>]}
[0m14:34:51.464015 [debug] [MainThread]: Flushing usage events
[0m14:34:52.326227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:04.188346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC6524DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC6524F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC6524F20>]}


============================== 14:35:04.188346 | b1dbacf0-387b-49c6-aad1-779f97f81f6f ==============================
[0m14:35:04.188346 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:35:04.188346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m crb_report.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:35:04.695634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1dbacf0-387b-49c6-aad1-779f97f81f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC6552BD0>]}
[0m14:35:04.760656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1dbacf0-387b-49c6-aad1-779f97f81f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC7091EB0>]}
[0m14:35:04.760656 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:35:05.238233 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:35:05.397064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:05.397064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:05.413107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:35:05.439617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1dbacf0-387b-49c6-aad1-779f97f81f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC834C590>]}
[0m14:35:05.503562 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:35:05.503562 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:35:05.535780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1dbacf0-387b-49c6-aad1-779f97f81f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC857C1D0>]}
[0m14:35:05.535780 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:35:05.535780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1dbacf0-387b-49c6-aad1-779f97f81f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC86B0CE0>]}
[0m14:35:05.551548 [info ] [MainThread]: 
[0m14:35:05.551548 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:05.551548 [info ] [MainThread]: 
[0m14:35:05.551548 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:35:05.551548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:35:05.661900 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:35:05.662899 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:35:05.662899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:07.078410 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.416 seconds
[0m14:35:07.087956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:35:07.103866 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:35:07.103866 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:35:07.103866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:08.091159 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.996 seconds
[0m14:35:08.107217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1dbacf0-387b-49c6-aad1-779f97f81f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC4206E10>]}
[0m14:35:08.107217 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:35:08.107217 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:35:08.107217 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:35:08.107217 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:35:08.123198 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:35:08.123198 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:35:08.158970 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:35:08.158970 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:35:08.158970 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        l.city,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY p.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m14:35:08.158970 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:35:09.153816 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc1-3201-7e57-000c-493e000262f6
[0m14:35:09.153816 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 8
invalid identifier 'L.CITY'
[0m14:35:09.160343 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'L.CITY'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:35:09.160343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1dbacf0-387b-49c6-aad1-779f97f81f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC59F4770>]}
[0m14:35:09.160343 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.05s]
[0m14:35:09.160343 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:35:09.160343 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'L.CITY'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:35:09.160343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:09.160343 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:35:09.160343 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:35:09.492828 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:35:09.492828 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:35:09.822718 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:35:09.822718 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:35:10.145086 [info ] [MainThread]: 
[0m14:35:10.161154 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m14:35:10.161154 [debug] [MainThread]: Command end result
[0m14:35:10.197992 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:35:10.197992 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:35:10.209178 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:35:10.210189 [info ] [MainThread]: 
[0m14:35:10.211110 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:35:10.211110 [info ] [MainThread]: 
[0m14:35:10.211110 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 45 at position 8
  invalid identifier 'L.CITY'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:35:10.211110 [info ] [MainThread]: 
[0m14:35:10.211110 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:35:10.211110 [debug] [MainThread]: Command `dbt run` failed at 14:35:10.211110 after 6.18 seconds
[0m14:35:10.217058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC6569820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC65531D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BC8D8ADE0>]}
[0m14:35:10.217058 [debug] [MainThread]: Flushing usage events
[0m14:35:11.329748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:35.042015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825C164AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028258A290A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BEFA570>]}


============================== 14:35:35.047201 | db257d8e-b767-4a9d-ba65-38edde9947bf ==============================
[0m14:35:35.047201 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:35:35.048298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m crb_report.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:35:35.543095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db257d8e-b767-4a9d-ba65-38edde9947bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825C164DA0>]}
[0m14:35:35.603141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db257d8e-b767-4a9d-ba65-38edde9947bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BED7890>]}
[0m14:35:35.604902 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:35:36.065828 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:35:36.214077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:36.214077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:36.214077 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:35:36.251682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db257d8e-b767-4a9d-ba65-38edde9947bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825E17F620>]}
[0m14:35:36.319797 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:35:36.319797 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:35:36.351770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db257d8e-b767-4a9d-ba65-38edde9947bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825E3157F0>]}
[0m14:35:36.351770 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:35:36.351770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db257d8e-b767-4a9d-ba65-38edde9947bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825E32FE00>]}
[0m14:35:36.351770 [info ] [MainThread]: 
[0m14:35:36.351770 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:36.351770 [info ] [MainThread]: 
[0m14:35:36.351770 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:35:36.367812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:35:36.475575 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:35:36.476575 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:35:36.476575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:37.945374 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.472 seconds
[0m14:35:37.945374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:35:37.963166 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:35:37.963166 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:35:37.965172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:38.948880 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.989 seconds
[0m14:35:38.964811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db257d8e-b767-4a9d-ba65-38edde9947bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825CEB6960>]}
[0m14:35:38.964811 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:35:38.964811 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:35:38.964811 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:35:38.964811 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:35:38.964811 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:35:38.980884 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:35:39.011786 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:35:39.014292 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:35:39.014292 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        l.region,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY p.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m14:35:39.015330 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:35:40.049360 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc1-3201-7e9a-000c-493e00023476
[0m14:35:40.049360 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 51 at position 36
invalid identifier 'P.TOTAL_REVENUE'
[0m14:35:40.049360 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 51 at position 36
  invalid identifier 'P.TOTAL_REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:35:40.049360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db257d8e-b767-4a9d-ba65-38edde9947bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825B644B00>]}
[0m14:35:40.065360 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.08s]
[0m14:35:40.065360 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:35:40.065360 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 51 at position 36
  invalid identifier 'P.TOTAL_REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:35:40.065360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:40.065360 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:35:40.065360 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:35:40.397353 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:35:40.399360 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:35:40.732925 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:35:40.732925 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:35:41.051945 [info ] [MainThread]: 
[0m14:35:41.051945 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m14:35:41.051945 [debug] [MainThread]: Command end result
[0m14:35:41.090579 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:35:41.090579 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:35:41.107071 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:35:41.107071 [info ] [MainThread]: 
[0m14:35:41.107071 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:35:41.107071 [info ] [MainThread]: 
[0m14:35:41.107071 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 51 at position 36
  invalid identifier 'P.TOTAL_REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:35:41.107071 [info ] [MainThread]: 
[0m14:35:41.107071 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:35:41.107071 [debug] [MainThread]: Command `dbt run` failed at 14:35:41.107071 after 6.24 seconds
[0m14:35:41.107071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825C030830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825CC8EFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825CF99D30>]}
[0m14:35:41.107071 [debug] [MainThread]: Flushing usage events
[0m14:35:41.974972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:59.322805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0A68F560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E07519EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0A9C36B0>]}


============================== 14:35:59.322805 | ffa739ec-a7a9-43ab-8c0e-de1225bd5c2e ==============================
[0m14:35:59.322805 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:35:59.322805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m crb_report.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:35:59.793185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffa739ec-a7a9-43ab-8c0e-de1225bd5c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0C8C4050>]}
[0m14:35:59.864341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffa739ec-a7a9-43ab-8c0e-de1225bd5c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0A865D30>]}
[0m14:35:59.866346 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:36:00.323445 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:36:00.479087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:36:00.479087 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:36:00.479087 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:36:00.511166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffa739ec-a7a9-43ab-8c0e-de1225bd5c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0B87B3B0>]}
[0m14:36:00.574514 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:36:00.590314 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:36:00.623169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffa739ec-a7a9-43ab-8c0e-de1225bd5c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0CBB57F0>]}
[0m14:36:00.623169 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:36:00.623169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffa739ec-a7a9-43ab-8c0e-de1225bd5c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0C9AFEC0>]}
[0m14:36:00.623169 [info ] [MainThread]: 
[0m14:36:00.623169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:00.623169 [info ] [MainThread]: 
[0m14:36:00.623169 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:36:00.623169 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:36:00.732352 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:36:00.732352 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:36:00.733352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:02.088520 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.355 seconds
[0m14:36:02.094534 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:36:02.101550 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:36:02.101550 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:36:02.101550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:03.044368 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.953 seconds
[0m14:36:03.060193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffa739ec-a7a9-43ab-8c0e-de1225bd5c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0B64EFF0>]}
[0m14:36:03.060193 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:36:03.060193 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:36:03.060193 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:36:03.060193 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:36:03.075907 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:36:03.075907 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:36:03.112143 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:36:03.116758 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:36:03.116758 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        l.region,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m14:36:03.116758 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:36:04.068945 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc2-3201-7d7b-000c-493e00022712
[0m14:36:04.068945 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 51 at position 36
invalid identifier 'T.TOTAL_REVENUE'
[0m14:36:04.068945 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 51 at position 36
  invalid identifier 'T.TOTAL_REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:36:04.078989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffa739ec-a7a9-43ab-8c0e-de1225bd5c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E09FC4BF0>]}
[0m14:36:04.078989 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.01s]
[0m14:36:04.078989 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:36:04.078989 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 51 at position 36
  invalid identifier 'T.TOTAL_REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:36:04.078989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:04.078989 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:36:04.078989 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:36:04.411639 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:36:04.411639 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:36:04.729893 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:36:04.729893 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:36:05.051306 [info ] [MainThread]: 
[0m14:36:05.051306 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m14:36:05.051306 [debug] [MainThread]: Command end result
[0m14:36:05.084657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:36:05.086656 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:36:05.087658 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:36:05.087658 [info ] [MainThread]: 
[0m14:36:05.087658 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:36:05.087658 [info ] [MainThread]: 
[0m14:36:05.087658 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 51 at position 36
  invalid identifier 'T.TOTAL_REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:36:05.087658 [info ] [MainThread]: 
[0m14:36:05.087658 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:36:05.097019 [debug] [MainThread]: Command `dbt run` failed at 14:36:05.097019 after 5.93 seconds
[0m14:36:05.098029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0A9EAED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E074B9A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E074BAE70>]}
[0m14:36:05.098029 [debug] [MainThread]: Flushing usage events
[0m14:36:05.962370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:43.696907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE3FC49E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE3FF8B5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE3E4AE2D0>]}


============================== 14:38:43.696907 | 86482005-dfdf-4ed8-89e4-fb6890e37369 ==============================
[0m14:38:43.696907 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:38:43.696907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m crb_report.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:38:44.190666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86482005-dfdf-4ed8-89e4-fb6890e37369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE406E5280>]}
[0m14:38:44.253840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86482005-dfdf-4ed8-89e4-fb6890e37369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4102AF30>]}
[0m14:38:44.255958 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:38:44.728532 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:38:44.873592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:38:44.873592 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:38:44.890383 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:38:44.912416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86482005-dfdf-4ed8-89e4-fb6890e37369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4258E270>]}
[0m14:38:44.989913 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:38:44.989913 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:38:45.026276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86482005-dfdf-4ed8-89e4-fb6890e37369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4278C2C0>]}
[0m14:38:45.026276 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:38:45.027276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86482005-dfdf-4ed8-89e4-fb6890e37369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE427F5FA0>]}
[0m14:38:45.028309 [info ] [MainThread]: 
[0m14:38:45.029309 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:45.030277 [info ] [MainThread]: 
[0m14:38:45.030277 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:38:45.031309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:38:45.138401 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:38:45.139402 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:38:45.139402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:46.538696 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.399 seconds
[0m14:38:46.541538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:38:46.556411 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:38:46.556411 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:38:46.556411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:47.542815 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.981 seconds
[0m14:38:47.542815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86482005-dfdf-4ed8-89e4-fb6890e37369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE427426C0>]}
[0m14:38:47.542815 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:38:47.542815 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:38:47.542815 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:38:47.542815 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:38:47.558501 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:38:47.558501 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:38:47.595010 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:38:47.595010 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:38:47.595010 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(t.revenue) OVER(PARTITION BY t.product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        l.region,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m14:38:47.595010 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:38:48.560292 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc4-3201-7db6-000c-493e000253d2
[0m14:38:48.562299 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 12
invalid identifier 'T.REVENUE'
[0m14:38:48.564305 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 25 at position 12
  invalid identifier 'T.REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:38:48.566311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86482005-dfdf-4ed8-89e4-fb6890e37369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE3FBB4740>]}
[0m14:38:48.566311 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.02s]
[0m14:38:48.566311 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:38:48.566311 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 25 at position 12
  invalid identifier 'T.REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:38:48.566311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:48.566311 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:38:48.566311 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:38:48.887823 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:38:48.887823 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:38:49.228497 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:38:49.228497 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:38:49.578247 [info ] [MainThread]: 
[0m14:38:49.578247 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m14:38:49.583365 [debug] [MainThread]: Command end result
[0m14:38:49.612873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:38:49.630067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:38:49.630067 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:38:49.630067 [info ] [MainThread]: 
[0m14:38:49.630067 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:38:49.630067 [info ] [MainThread]: 
[0m14:38:49.644190 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 25 at position 12
  invalid identifier 'T.REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:38:49.645073 [info ] [MainThread]: 
[0m14:38:49.645073 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:38:49.645073 [debug] [MainThread]: Command `dbt run` failed at 14:38:49.645073 after 6.11 seconds
[0m14:38:49.645073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE406C76E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE4144CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE427F71D0>]}
[0m14:38:49.645073 [debug] [MainThread]: Flushing usage events
[0m14:38:50.879163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:55.136834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E032CE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DD849E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E032C740>]}


============================== 14:40:55.150593 | 49973b85-d938-428b-82ce-f737ca50579c ==============================
[0m14:40:55.150593 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:40:55.150593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m crb_report', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:56.316945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49973b85-d938-428b-82ce-f737ca50579c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DD6D2AB0>]}
[0m14:40:56.376158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49973b85-d938-428b-82ce-f737ca50579c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DD784890>]}
[0m14:40:56.376158 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:40:56.993657 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:40:58.496351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:58.496351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:58.496351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:40:58.534921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49973b85-d938-428b-82ce-f737ca50579c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E20EFB60>]}
[0m14:40:58.605780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:40:58.608287 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:40:58.653367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49973b85-d938-428b-82ce-f737ca50579c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E2348B90>]}
[0m14:40:58.653367 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:40:58.653367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49973b85-d938-428b-82ce-f737ca50579c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DCD2B860>]}
[0m14:40:58.653367 [info ] [MainThread]: 
[0m14:40:58.653367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:58.653367 [info ] [MainThread]: 
[0m14:40:58.653367 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:40:58.653367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:41:01.680855 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:41:01.686407 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:41:01.686407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:03.102021 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.416 seconds
[0m14:41:03.116052 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:41:03.128059 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:41:03.128059 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:41:03.128059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:04.112948 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.986 seconds
[0m14:41:04.119105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49973b85-d938-428b-82ce-f737ca50579c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E2483320>]}
[0m14:41:04.119105 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:41:04.119105 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:41:04.119105 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:41:04.119105 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:41:04.135146 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:41:04.137047 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:41:04.166474 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:41:04.169440 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:41:04.170443 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
 
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
 
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(t.revenue) OVER(PARTITION BY t.product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
 
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        l.region,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)
 
SELECT * FROM crb
  );
[0m14:41:04.170443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:05.306393 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc7-3201-7db6-000c-493e000253e6
[0m14:41:05.306393 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 12
invalid identifier 'T.REVENUE'
[0m14:41:05.323033 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 25 at position 12
  invalid identifier 'T.REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:41:05.323033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49973b85-d938-428b-82ce-f737ca50579c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E213BEC0>]}
[0m14:41:05.323033 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.20s]
[0m14:41:05.323033 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:41:05.323033 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 25 at position 12
  invalid identifier 'T.REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:41:05.323033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:05.323033 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:41:05.323033 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:41:05.655947 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:41:05.655947 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:41:05.989240 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:41:05.989240 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:41:06.330793 [info ] [MainThread]: 
[0m14:41:06.330793 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.68 seconds (7.68s).
[0m14:41:06.330793 [debug] [MainThread]: Command end result
[0m14:41:06.349238 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:41:06.349238 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:41:06.368510 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:41:06.368510 [info ] [MainThread]: 
[0m14:41:06.369542 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:41:06.370510 [info ] [MainThread]: 
[0m14:41:06.370510 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 25 at position 12
  invalid identifier 'T.REVENUE'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:41:06.370510 [info ] [MainThread]: 
[0m14:41:06.370510 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:41:06.370510 [debug] [MainThread]: Command `dbt run` failed at 14:41:06.370510 after 11.44 seconds
[0m14:41:06.370510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E012FAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DFE6E840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5DFE6FD70>]}
[0m14:41:06.370510 [debug] [MainThread]: Flushing usage events
[0m14:41:07.638305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:48.335428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B03321490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B03032570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B03320BC0>]}


============================== 14:41:48.351325 | 729b65c5-641e-41e1-bb50-fae88a408954 ==============================
[0m14:41:48.351325 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:41:48.351325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m crb_report', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:41:48.833784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '729b65c5-641e-41e1-bb50-fae88a408954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B03323E30>]}
[0m14:41:48.890913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '729b65c5-641e-41e1-bb50-fae88a408954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B034C4C20>]}
[0m14:41:48.890913 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:41:49.355833 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:41:49.516703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:49.516703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:49.523413 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:41:49.541819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '729b65c5-641e-41e1-bb50-fae88a408954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B04122CC0>]}
[0m14:41:49.607192 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:41:49.623008 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:41:49.654791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '729b65c5-641e-41e1-bb50-fae88a408954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B05486240>]}
[0m14:41:49.654791 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:41:49.656802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '729b65c5-641e-41e1-bb50-fae88a408954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B04122A80>]}
[0m14:41:49.656802 [info ] [MainThread]: 
[0m14:41:49.656802 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:49.656802 [info ] [MainThread]: 
[0m14:41:49.656802 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:41:49.656802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:41:49.765287 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:41:49.765287 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:41:49.766287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:51.120899 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.355 seconds
[0m14:41:51.125118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:41:51.125118 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:41:51.125118 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:41:51.125118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:52.085530 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.952 seconds
[0m14:41:52.089869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '729b65c5-641e-41e1-bb50-fae88a408954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B040E05C0>]}
[0m14:41:52.095183 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:41:52.095183 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:41:52.095183 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:41:52.095183 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:41:52.095183 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:41:52.095183 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:41:52.127551 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:41:52.127551 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:41:52.127551 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    -- WITH customer_data AS (
--     SELECT
--         customer_id,
--         customer_name
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
 
-- product_data AS (
--     SELECT
--         product_id,
--         product_family,
--         product_sub_family,
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
-- ),
 
-- transaction_data AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month,
--         revenue,
--         SUM(t.revenue) OVER(PARTITION BY t.product_id) AS total_revenue,
--         LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
--         CASE
--             WHEN revenue > prev_revenue THEN 'Expansion'
--             WHEN revenue < prev_revenue THEN 'Contraction'
--             ELSE 'Stable'
--         END AS revenue_trend
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
 
-- crb AS (
--     SELECT
--         t.customer_id,
--         t.product_id,
--         p.product_family,
--         p.product_sub_family,
--         t.revenue,
--         t.prev_revenue,
--         t.revenue_trend,
--         l.region,
--         l.country,
--         l.region,
--         -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
--         -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
--         SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
--         SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
--         SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
--         DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
--         DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
--     FROM transaction_data t
--     LEFT JOIN customer_data c ON t.customer_id = c.customer_id
--     LEFT JOIN product_data p ON t.product_id = p.product_id
--     LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
-- )
 
-- SELECT * FROM crb


WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)

SELECT * FROM crb;
[0m14:41:52.142544 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:53.115226 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc7-3201-7e56-000c-493e000245fe
[0m14:41:53.115226 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 115 at position 17 unexpected ';'.
[0m14:41:53.129030 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 115 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:41:53.129030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '729b65c5-641e-41e1-bb50-fae88a408954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B027C48F0>]}
[0m14:41:53.129030 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.03s]
[0m14:41:53.129030 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:41:53.129030 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 115 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:41:53.129030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:53.129030 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:41:53.129030 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:41:53.470213 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:41:53.470213 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:41:53.794393 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:41:53.805035 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:41:54.132861 [info ] [MainThread]: 
[0m14:41:54.132861 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m14:41:54.132861 [debug] [MainThread]: Command end result
[0m14:41:54.166274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:41:54.167276 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:41:54.167276 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:41:54.167276 [info ] [MainThread]: 
[0m14:41:54.167276 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:41:54.167276 [info ] [MainThread]: 
[0m14:41:54.177887 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 115 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:41:54.178895 [info ] [MainThread]: 
[0m14:41:54.179814 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:41:54.179814 [debug] [MainThread]: Command `dbt run` failed at 14:41:54.179814 after 5.99 seconds
[0m14:41:54.182058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B027735C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B0355B830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B05462E40>]}
[0m14:41:54.182472 [debug] [MainThread]: Flushing usage events
[0m14:41:55.071767 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:42:02.938923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213138A4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213138A5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213138A4E90>]}


============================== 14:42:02.959660 | 9c8c8f68-995d-477c-bee8-76a5a9062c53 ==============================
[0m14:42:02.959660 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:42:02.959660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m crb_report', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:03.447204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c8c8f68-995d-477c-bee8-76a5a9062c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021312E163C0>]}
[0m14:42:03.504382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c8c8f68-995d-477c-bee8-76a5a9062c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213135E1DF0>]}
[0m14:42:03.504382 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:42:03.976273 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:42:04.138817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:42:04.138817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:42:04.155497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:42:04.177780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c8c8f68-995d-477c-bee8-76a5a9062c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213156DB440>]}
[0m14:42:04.256632 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:42:04.260603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:42:04.288351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c8c8f68-995d-477c-bee8-76a5a9062c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021315A27E90>]}
[0m14:42:04.288351 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:42:04.288351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c8c8f68-995d-477c-bee8-76a5a9062c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213142E2F60>]}
[0m14:42:04.288351 [info ] [MainThread]: 
[0m14:42:04.288351 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:42:04.288351 [info ] [MainThread]: 
[0m14:42:04.288351 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:42:04.288351 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:42:04.410815 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:42:04.411814 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:42:04.411814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:05.450038 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.051 seconds
[0m14:42:05.466102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:42:05.481834 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:42:05.481834 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:42:05.481834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:06.858934 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.380 seconds
[0m14:42:06.867232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c8c8f68-995d-477c-bee8-76a5a9062c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021315E55670>]}
[0m14:42:06.875037 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:42:06.875037 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:42:06.875037 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:42:06.875037 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:42:06.875037 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:42:06.875037 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:42:06.912616 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:42:06.912616 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:42:06.912616 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    -- WITH customer_data AS (
--     SELECT
--         customer_id,
--         customer_name
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
 
-- product_data AS (
--     SELECT
--         product_id,
--         product_family,
--         product_sub_family,
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
-- ),
 
-- transaction_data AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month,
--         revenue,
--         SUM(t.revenue) OVER(PARTITION BY t.product_id) AS total_revenue,
--         LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
--         CASE
--             WHEN revenue > prev_revenue THEN 'Expansion'
--             WHEN revenue < prev_revenue THEN 'Contraction'
--             ELSE 'Stable'
--         END AS revenue_trend
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
 
-- crb AS (
--     SELECT
--         t.customer_id,
--         t.product_id,
--         p.product_family,
--         p.product_sub_family,
--         t.revenue,
--         t.prev_revenue,
--         t.revenue_trend,
--         l.region,
--         l.country,
--         l.region,
--         -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
--         -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
--         SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
--         SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
--         SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
--         DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
--         DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
--     FROM transaction_data t
--     LEFT JOIN customer_data c ON t.customer_id = c.customer_id
--     LEFT JOIN product_data p ON t.product_id = p.product_id
--     LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
-- )
 
-- SELECT * FROM crb


WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
)

SELECT * FROM crb
  );
[0m14:42:06.912616 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:07.888414 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc8-3201-7db6-000c-493e000253f2
[0m14:42:07.888414 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 112 at position 75
invalid identifier 'L.LOCATION_ID'
[0m14:42:07.904494 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 112 at position 75
  invalid identifier 'L.LOCATION_ID'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:42:07.904494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c8c8f68-995d-477c-bee8-76a5a9062c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021315833CE0>]}
[0m14:42:07.904494 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.03s]
[0m14:42:07.904494 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:42:07.904494 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 112 at position 75
  invalid identifier 'L.LOCATION_ID'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:42:07.904494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:07.904494 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:42:07.904494 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:42:08.236565 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:42:08.236565 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:42:08.632651 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:42:08.638003 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:42:08.961690 [info ] [MainThread]: 
[0m14:42:08.961690 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m14:42:08.961690 [debug] [MainThread]: Command end result
[0m14:42:08.987078 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:42:08.989110 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:42:08.995675 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:42:08.995675 [info ] [MainThread]: 
[0m14:42:08.996669 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:42:08.997669 [info ] [MainThread]: 
[0m14:42:08.999124 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 112 at position 75
  invalid identifier 'L.LOCATION_ID'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:42:08.999124 [info ] [MainThread]: 
[0m14:42:08.999124 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:42:09.002655 [debug] [MainThread]: Command `dbt run` failed at 14:42:09.002655 after 6.21 seconds
[0m14:42:09.002655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021312E15F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021315653DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021315652D80>]}
[0m14:42:09.003695 [debug] [MainThread]: Flushing usage events
[0m14:42:09.970565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:24.630305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208077CE840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208077CE6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002080956F7A0>]}


============================== 14:43:24.630305 | 24ceb600-081c-4daa-858d-9c8ee11a18d7 ==============================
[0m14:43:24.630305 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:43:24.630305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m crb_report', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:43:25.125261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24ceb600-081c-4daa-858d-9c8ee11a18d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002080A7296A0>]}
[0m14:43:25.186078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24ceb600-081c-4daa-858d-9c8ee11a18d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020808F66450>]}
[0m14:43:25.186078 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:43:25.664486 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:43:25.820092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:43:25.820092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:43:25.836235 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:43:25.869218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ceb600-081c-4daa-858d-9c8ee11a18d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002080B8FC6B0>]}
[0m14:43:25.940665 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:43:25.940665 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:43:25.977127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ceb600-081c-4daa-858d-9c8ee11a18d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002080BAAC980>]}
[0m14:43:25.977127 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m14:43:25.977127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ceb600-081c-4daa-858d-9c8ee11a18d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002080BB16840>]}
[0m14:43:25.977127 [info ] [MainThread]: 
[0m14:43:25.977127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:25.977127 [info ] [MainThread]: 
[0m14:43:25.985963 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:43:25.986972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:43:26.087266 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:43:26.087266 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:43:26.087266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:27.470014 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.394 seconds
[0m14:43:27.488124 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:43:27.488124 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:43:27.488124 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:43:27.488124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:28.474849 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.978 seconds
[0m14:43:28.474849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ceb600-081c-4daa-858d-9c8ee11a18d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002080BE9D670>]}
[0m14:43:28.488662 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:43:28.488662 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:43:28.490168 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:43:28.490168 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:43:28.499174 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:43:28.500175 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:43:28.529578 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:43:28.531591 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:43:28.533598 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    -- WITH customer_data AS (
--     SELECT
--         customer_id,
--         customer_name
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
 
-- product_data AS (
--     SELECT
--         product_id,
--         product_family,
--         product_sub_family,
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
-- ),
 
-- transaction_data AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month,
--         revenue,
--         SUM(t.revenue) OVER(PARTITION BY t.product_id) AS total_revenue,
--         LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
--         CASE
--             WHEN revenue > prev_revenue THEN 'Expansion'
--             WHEN revenue < prev_revenue THEN 'Contraction'
--             ELSE 'Stable'
--         END AS revenue_trend
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
 
-- crb AS (
--     SELECT
--         t.customer_id,
--         t.product_id,
--         p.product_family,
--         p.product_sub_family,
--         t.revenue,
--         t.prev_revenue,
--         t.revenue_trend,
--         l.region,
--         l.country,
--         l.region,
--         -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
--         -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
--         SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
--         SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
--         SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
--         DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
--         DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
--     FROM transaction_data t
--     LEFT JOIN customer_data c ON t.customer_id = c.customer_id
--     LEFT JOIN product_data p ON t.product_id = p.product_id
--     LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
-- )
 
-- SELECT * FROM crb


WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
)

SELECT * FROM crb
  );
[0m14:43:28.533598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:43:30.502458 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc9-3201-7e56-000c-493e00024606
[0m14:43:30.502458 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002062 (42601): SQL compilation error:
Window function [SUM(T.REVENUE) OVER (PARTITION BY T.CUSTOMER_ID)] may not be nested inside another window function.
[0m14:43:30.502458 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  002062 (42601): SQL compilation error:
  Window function [SUM(T.REVENUE) OVER (PARTITION BY T.CUSTOMER_ID)] may not be nested inside another window function.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:43:30.502458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ceb600-081c-4daa-858d-9c8ee11a18d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020808ED4C50>]}
[0m14:43:30.502458 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 2.01s]
[0m14:43:30.502458 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:43:30.502458 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  002062 (42601): SQL compilation error:
  Window function [SUM(T.REVENUE) OVER (PARTITION BY T.CUSTOMER_ID)] may not be nested inside another window function.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:43:30.502458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:30.502458 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:43:30.502458 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:43:30.837324 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:43:30.837324 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:43:31.175334 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:43:31.175334 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:43:31.844158 [info ] [MainThread]: 
[0m14:43:31.847165 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m14:43:31.849133 [debug] [MainThread]: Command end result
[0m14:43:31.870478 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:43:31.873444 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:43:31.879443 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:43:31.879443 [info ] [MainThread]: 
[0m14:43:31.881530 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:43:31.882590 [info ] [MainThread]: 
[0m14:43:31.883538 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  002062 (42601): SQL compilation error:
  Window function [SUM(T.REVENUE) OVER (PARTITION BY T.CUSTOMER_ID)] may not be nested inside another window function.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:43:31.884439 [info ] [MainThread]: 
[0m14:43:31.884439 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:43:31.886238 [debug] [MainThread]: Command `dbt run` failed at 14:43:31.886238 after 7.42 seconds
[0m14:43:31.886238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208096772C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020809677620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020808ED6420>]}
[0m14:43:31.886238 [debug] [MainThread]: Flushing usage events
[0m14:43:32.810808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:57.457750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696BDF1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696B7A06B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696BDF39E0>]}


============================== 14:45:57.457750 | 7b8d7fe8-9df0-4280-8043-ddc83ed37321 ==============================
[0m14:45:57.457750 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:45:57.457750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m crb_report', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:57.938704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b8d7fe8-9df0-4280-8043-ddc83ed37321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696B2C9CD0>]}
[0m14:45:57.995728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b8d7fe8-9df0-4280-8043-ddc83ed37321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696C7F36E0>]}
[0m14:45:57.995728 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:45:58.482330 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:45:58.633482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:58.633482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:58.640127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:45:58.671967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b8d7fe8-9df0-4280-8043-ddc83ed37321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696B9989B0>]}
[0m14:45:58.740249 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:45:58.740249 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:45:58.769067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b8d7fe8-9df0-4280-8043-ddc83ed37321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696DFBBC80>]}
[0m14:45:58.769067 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m14:45:58.769067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8d7fe8-9df0-4280-8043-ddc83ed37321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696DDFFC20>]}
[0m14:45:58.769067 [info ] [MainThread]: 
[0m14:45:58.769067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:58.769067 [info ] [MainThread]: 
[0m14:45:58.769067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:45:58.769067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:45:58.884760 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:45:58.885760 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:45:58.885760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:00.270020 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.384 seconds
[0m14:46:00.270020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:46:00.285734 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:46:00.285734 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:46:00.285734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:01.259163 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.981 seconds
[0m14:46:01.277090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8d7fe8-9df0-4280-8043-ddc83ed37321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696DFBBD40>]}
[0m14:46:01.277090 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:46:01.277090 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:46:01.277090 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:46:01.277090 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:46:01.291370 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:46:01.291370 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:46:01.326625 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:46:01.326625 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:46:01.326625 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    -- WITH customer_data AS (
--     SELECT
--         customer_id,
--         customer_name
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
 
-- product_data AS (
--     SELECT
--         product_id,
--         product_family,
--         product_sub_family,
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
-- ),
 
-- transaction_data AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month,
--         revenue,
--         SUM(t.revenue) OVER(PARTITION BY t.product_id) AS total_revenue,
--         LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
--         CASE
--             WHEN revenue > prev_revenue THEN 'Expansion'
--             WHEN revenue < prev_revenue THEN 'Contraction'
--             ELSE 'Stable'
--         END AS revenue_trend
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
 
-- crb AS (
--     SELECT
--         t.customer_id,
--         t.product_id,
--         p.product_family,
--         p.product_sub_family,
--         t.revenue,
--         t.prev_revenue,
--         t.revenue_trend,
--         l.region,
--         l.country,
--         l.region,
--         -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
--         -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
--         SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
--         SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
--         SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
--         DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
--         DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
--     FROM transaction_data t
--     LEFT JOIN customer_data c ON t.customer_id = c.customer_id
--     LEFT JOIN product_data p ON t.product_id = p.product_id
--     LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
-- )
 
-- SELECT * FROM crb


WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS customer_revenue_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
)

SELECT * FROM crb
  );
[0m14:46:01.326625 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:46:02.610273 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffcc-3201-7db6-000c-493e000253f6
[0m14:46:02.610273 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
[0m14:46:02.610273 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:46:02.626208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b8d7fe8-9df0-4280-8043-ddc83ed37321', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696E413BF0>]}
[0m14:46:02.627244 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.33s]
[0m14:46:02.628207 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:46:02.628619 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:46:02.628619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:02.628619 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:46:02.628619 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:46:02.959510 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:46:02.959510 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:46:03.295617 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:46:03.295617 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:46:03.626287 [info ] [MainThread]: 
[0m14:46:03.627303 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.86 seconds (4.86s).
[0m14:46:03.629338 [debug] [MainThread]: Command end result
[0m14:46:03.663093 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:46:03.666093 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:46:03.666856 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:46:03.666856 [info ] [MainThread]: 
[0m14:46:03.666856 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:46:03.666856 [info ] [MainThread]: 
[0m14:46:03.666856 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:46:03.666856 [info ] [MainThread]: 
[0m14:46:03.676290 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:46:03.678305 [debug] [MainThread]: Command `dbt run` failed at 14:46:03.678305 after 6.39 seconds
[0m14:46:03.679297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696B1B4BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026969B8E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026969B8E900>]}
[0m14:46:03.679787 [debug] [MainThread]: Flushing usage events
[0m14:46:04.594514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:32.577514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840D9C02C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840D9C1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840D9C3D40>]}


============================== 14:49:32.582512 | c4834e5d-39ee-4d11-b764-2c3cc89dd83a ==============================
[0m14:49:32.582512 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:49:32.582512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile -m mart_revenue_lost_due_to_contraction', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:49:33.138396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4834e5d-39ee-4d11-b764-2c3cc89dd83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840D88EA20>]}
[0m14:49:33.202095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4834e5d-39ee-4d11-b764-2c3cc89dd83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840E50FCB0>]}
[0m14:49:33.203722 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:49:33.696748 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:49:33.858362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:33.858362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:33.863363 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:49:33.895513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4834e5d-39ee-4d11-b764-2c3cc89dd83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840D977650>]}
[0m14:49:33.969184 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:49:33.972343 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:49:34.002668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4834e5d-39ee-4d11-b764-2c3cc89dd83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840FB2A870>]}
[0m14:49:34.003670 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m14:49:34.004670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4834e5d-39ee-4d11-b764-2c3cc89dd83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840F93A5A0>]}
[0m14:49:34.005670 [info ] [MainThread]: 
[0m14:49:34.006587 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:34.006587 [info ] [MainThread]: 
[0m14:49:34.007594 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:49:34.012628 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:49:34.138494 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:49:34.139494 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:49:34.139494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:35.615946 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.477 seconds
[0m14:49:35.619915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4834e5d-39ee-4d11-b764-2c3cc89dd83a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840ADF3860>]}
[0m14:49:35.624739 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:49:35.624739 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction'
[0m14:49:35.625739 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:49:35.632739 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:49:35.633739 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:49:35.634741 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:49:35.635742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:35.635742 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:49:35.635742 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:49:35.959798 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction' was properly closed.
[0m14:49:35.960799 [debug] [MainThread]: Command end result
[0m14:49:35.982207 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:49:35.984175 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:49:35.991203 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:49:35.992172 [info ] [MainThread]: Compiled node 'mart_revenue_lost_due_to_contraction' is:
WITH transactional_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
)
SELECT 
    payment_month, 
    SUM(revenue) AS revenue_lost 
FROM transactional_data 
WHERE revenue_trend='Contraction' GROUP BY payment_month ORDER BY payment_month
[0m14:49:35.993174 [debug] [MainThread]: Command `dbt compile` succeeded at 14:49:35.993174 after 3.67 seconds
[0m14:49:35.994212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840D9C3D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840D9C1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840D9C04D0>]}
[0m14:49:35.994212 [debug] [MainThread]: Flushing usage events
[0m14:49:36.881654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:50.517941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D1EFDBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D12CA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D431F9B0>]}


============================== 14:49:50.517941 | 86078b85-5b2f-4e5f-95cd-23987c52e5e9 ==============================
[0m14:49:50.517941 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:49:50.517941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_revenue_lost_due_to_contraction', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:49:51.004350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86078b85-5b2f-4e5f-95cd-23987c52e5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D59B7050>]}
[0m14:49:51.053701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86078b85-5b2f-4e5f-95cd-23987c52e5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D417AED0>]}
[0m14:49:51.053701 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:49:51.546659 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:49:51.703705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:51.703705 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:51.703705 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:49:51.741594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86078b85-5b2f-4e5f-95cd-23987c52e5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D27C1F70>]}
[0m14:49:51.816692 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:49:51.820102 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:49:51.836771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86078b85-5b2f-4e5f-95cd-23987c52e5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D6C90740>]}
[0m14:49:51.851734 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m14:49:51.851734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86078b85-5b2f-4e5f-95cd-23987c52e5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D6AA3A70>]}
[0m14:49:51.851734 [info ] [MainThread]: 
[0m14:49:51.851734 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:51.851734 [info ] [MainThread]: 
[0m14:49:51.851734 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:49:51.851734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:49:51.958749 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:49:51.958749 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:49:51.958749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:53.365083 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.408 seconds
[0m14:49:53.372893 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:49:53.381157 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:49:53.381157 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:49:53.381157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:54.346644 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.963 seconds
[0m14:49:54.346644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86078b85-5b2f-4e5f-95cd-23987c52e5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D59B6990>]}
[0m14:49:54.362470 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:49:54.362470 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction  [RUN]
[0m14:49:54.362470 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction'
[0m14:49:54.362470 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:49:54.362470 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:49:54.362470 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:49:54.406815 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:49:54.406815 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:49:54.406815 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_revenue_lost_due_to_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction
         as
        (WITH transactional_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
)
SELECT 
    payment_month, 
    SUM(revenue) AS revenue_lost 
FROM transactional_data 
WHERE revenue_trend='Contraction' GROUP BY payment_month ORDER BY payment_month
        );
[0m14:49:54.406815 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:49:56.207280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.810 seconds
[0m14:49:56.239109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86078b85-5b2f-4e5f-95cd-23987c52e5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D41447D0>]}
[0m14:49:56.239109 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction  [[32mSUCCESS 1[0m in 1.88s]
[0m14:49:56.239109 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:49:56.239109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:56.239109 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:49:56.239109 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:49:56.555187 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:49:56.555187 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:49:56.876153 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction' was left open.
[0m14:49:56.890489 [debug] [MainThread]: On model.CRB_PROJECT.mart_revenue_lost_due_to_contraction: Close
[0m14:49:57.219099 [info ] [MainThread]: 
[0m14:49:57.221124 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m14:49:57.226770 [debug] [MainThread]: Command end result
[0m14:49:57.271307 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:49:57.276499 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:49:57.281938 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:49:57.281938 [info ] [MainThread]: 
[0m14:49:57.281938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:57.281938 [info ] [MainThread]: 
[0m14:49:57.281938 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:49:57.281938 [debug] [MainThread]: Command `dbt run` succeeded at 14:49:57.281938 after 6.93 seconds
[0m14:49:57.281938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D4AFF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D41A3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D431F9B0>]}
[0m14:49:57.281938 [debug] [MainThread]: Flushing usage events
[0m14:49:58.159638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:03.788497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202754D58E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202775A6CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202775A76B0>]}


============================== 14:51:03.788497 | a1744070-5759-43b6-81a5-2a17fa2a6688 ==============================
[0m14:51:03.788497 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:51:03.788497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_revenue_lost_due_to_contraction', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:04.278113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1744070-5759-43b6-81a5-2a17fa2a6688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020278D922A0>]}
[0m14:51:04.340144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1744070-5759-43b6-81a5-2a17fa2a6688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020274AC9AC0>]}
[0m14:51:04.340144 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:51:04.809430 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:51:04.967480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:04.967480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:04.978620 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:51:05.004943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1744070-5759-43b6-81a5-2a17fa2a6688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027A01AE70>]}
[0m14:51:05.076254 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:51:05.078761 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:51:05.110235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1744070-5759-43b6-81a5-2a17fa2a6688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027A373D40>]}
[0m14:51:05.110235 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m14:51:05.110235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1744070-5759-43b6-81a5-2a17fa2a6688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027A185220>]}
[0m14:51:05.110235 [info ] [MainThread]: 
[0m14:51:05.115122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:05.115122 [info ] [MainThread]: 
[0m14:51:05.115122 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:51:05.115122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:51:05.219041 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:51:05.219041 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:51:05.219041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:06.860577 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.645 seconds
[0m14:51:06.876766 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:51:06.889136 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:51:06.889136 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:51:06.889136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:07.877177 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.988 seconds
[0m14:51:07.887899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1744070-5759-43b6-81a5-2a17fa2a6688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027A373FE0>]}
[0m14:51:07.887899 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:51:07.887899 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction  [RUN]
[0m14:51:07.896398 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction'
[0m14:51:07.896398 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:51:07.896398 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:51:07.896398 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:51:07.930781 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:51:07.930781 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:51:07.930781 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_revenue_lost_due_to_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction
         as
        (WITH transactional_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
)
SELECT 
    customer_id,
    product_id,
    payment_month, 
    SUM(revenue) AS revenue_lost 
FROM transactional_data 
WHERE revenue_trend='Contraction' GROUP BY payment_month ORDER BY payment_month
        );
[0m14:51:07.930781 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:51:08.933240 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffd1-3201-7d7b-000c-493e00022732
[0m14:51:08.933240 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 19 at position 4
'TRANSACTIONAL_DATA.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
[0m14:51:08.933240 [debug] [Thread-1 (]: Database Error in model mart_revenue_lost_due_to_contraction (models\mart\mart_revenue_lost_due_to_contraction.sql)
  001104 (42601): SQL compilation error: error line 19 at position 4
  'TRANSACTIONAL_DATA.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_revenue_lost_due_to_contraction.sql
[0m14:51:08.933240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1744070-5759-43b6-81a5-2a17fa2a6688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002027A93BA40>]}
[0m14:51:08.933240 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction  [[31mERROR[0m in 1.04s]
[0m14:51:08.933240 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:51:08.933240 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction' to be skipped because of status 'error'.  Reason: Database Error in model mart_revenue_lost_due_to_contraction (models\mart\mart_revenue_lost_due_to_contraction.sql)
  001104 (42601): SQL compilation error: error line 19 at position 4
  'TRANSACTIONAL_DATA.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_revenue_lost_due_to_contraction.sql.
[0m14:51:08.933240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:08.933240 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:51:08.933240 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:51:09.274016 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:51:09.274016 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:51:09.612686 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction' was left open.
[0m14:51:09.612686 [debug] [MainThread]: On model.CRB_PROJECT.mart_revenue_lost_due_to_contraction: Close
[0m14:51:09.951295 [info ] [MainThread]: 
[0m14:51:09.951295 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m14:51:09.951295 [debug] [MainThread]: Command end result
[0m14:51:09.999390 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:51:09.999390 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:51:09.999390 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:51:09.999390 [info ] [MainThread]: 
[0m14:51:09.999390 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:51:09.999390 [info ] [MainThread]: 
[0m14:51:09.999390 [error] [MainThread]:   Database Error in model mart_revenue_lost_due_to_contraction (models\mart\mart_revenue_lost_due_to_contraction.sql)
  001104 (42601): SQL compilation error: error line 19 at position 4
  'TRANSACTIONAL_DATA.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_revenue_lost_due_to_contraction.sql
[0m14:51:09.999390 [info ] [MainThread]: 
[0m14:51:09.999390 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:51:09.999390 [debug] [MainThread]: Command `dbt run` failed at 14:51:09.999390 after 6.39 seconds
[0m14:51:09.999390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020277A4B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202775DB350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202775D93D0>]}
[0m14:51:10.014524 [debug] [MainThread]: Flushing usage events
[0m14:51:10.939735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:56.606950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A41694CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A41695070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A41694230>]}


============================== 14:51:56.606950 | 903b8f86-5990-4c92-8dd0-72ada2b02b70 ==============================
[0m14:51:56.606950 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:51:56.606950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_revenue_lost_due_to_contraction', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:57.095942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '903b8f86-5990-4c92-8dd0-72ada2b02b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A3EA626F0>]}
[0m14:51:57.145264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '903b8f86-5990-4c92-8dd0-72ada2b02b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A3DF18DA0>]}
[0m14:51:57.161938 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:51:57.645531 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:51:57.812555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:57.812555 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:57.812555 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:51:57.850759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '903b8f86-5990-4c92-8dd0-72ada2b02b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A422F9700>]}
[0m14:51:57.925534 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:51:57.928960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:51:57.959860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '903b8f86-5990-4c92-8dd0-72ada2b02b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A4367CB90>]}
[0m14:51:57.959860 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m14:51:57.959860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '903b8f86-5990-4c92-8dd0-72ada2b02b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A434AF6B0>]}
[0m14:51:57.959860 [info ] [MainThread]: 
[0m14:51:57.959860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:57.959860 [info ] [MainThread]: 
[0m14:51:57.959860 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:51:57.959860 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:51:58.071732 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:51:58.071732 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:51:58.071732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:59.364667 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.297 seconds
[0m14:51:59.378789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:51:59.402185 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:51:59.403182 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:51:59.403182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:00.367722 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.973 seconds
[0m14:52:00.367722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '903b8f86-5990-4c92-8dd0-72ada2b02b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A43C86AB0>]}
[0m14:52:00.383734 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:52:00.383734 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction  [RUN]
[0m14:52:00.383734 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction'
[0m14:52:00.383734 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:52:00.383734 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:52:00.383734 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:52:00.434398 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:52:00.438421 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:52:00.438421 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_revenue_lost_due_to_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction
         as
        (WITH transactional_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
)
SELECT 
    payment_month, 
    SUM(revenue) AS revenue_lost 
FROM transactional_data 
WHERE revenue_trend='Contraction' GROUP BY payment_month ORDER BY payment_month
        );
[0m14:52:00.438421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:52:01.976784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.549 seconds
[0m14:52:02.011710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '903b8f86-5990-4c92-8dd0-72ada2b02b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A3EA61610>]}
[0m14:52:02.011710 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction  [[32mSUCCESS 1[0m in 1.63s]
[0m14:52:02.011710 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:52:02.011710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:02.011710 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:52:02.011710 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:52:02.328575 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:52:02.328575 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:52:02.667802 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction' was left open.
[0m14:52:02.667802 [debug] [MainThread]: On model.CRB_PROJECT.mart_revenue_lost_due_to_contraction: Close
[0m14:52:03.002017 [info ] [MainThread]: 
[0m14:52:03.002017 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m14:52:03.002017 [debug] [MainThread]: Command end result
[0m14:52:03.023632 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:52:03.023632 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:52:03.037963 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:52:03.038969 [info ] [MainThread]: 
[0m14:52:03.039966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:03.040710 [info ] [MainThread]: 
[0m14:52:03.041458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:03.042606 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:03.042606 after 6.59 seconds
[0m14:52:03.043645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A437FF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A42214530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A41F0B230>]}
[0m14:52:03.043645 [debug] [MainThread]: Flushing usage events
[0m14:52:04.499606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:43.804431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A608C5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A635F60C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A635F5010>]}


============================== 14:55:43.818449 | d7400f70-21c5-46e0-8907-e654854d9a45 ==============================
[0m14:55:43.818449 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:55:43.818449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_revenue_lost_due_to_contraction', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:55:44.796396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7400f70-21c5-46e0-8907-e654854d9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A64067CB0>]}
[0m14:55:44.855045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7400f70-21c5-46e0-8907-e654854d9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A643FA210>]}
[0m14:55:44.855045 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:55:45.455685 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:55:45.625916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:45.625916 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:45.639170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:55:45.661317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7400f70-21c5-46e0-8907-e654854d9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A642E9580>]}
[0m14:55:45.739108 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:55:45.754848 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:55:45.786421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7400f70-21c5-46e0-8907-e654854d9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A6585F560>]}
[0m14:55:45.786421 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m14:55:45.786421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7400f70-21c5-46e0-8907-e654854d9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A656B00B0>]}
[0m14:55:45.786421 [info ] [MainThread]: 
[0m14:55:45.786421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:45.786421 [info ] [MainThread]: 
[0m14:55:45.786421 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:55:45.786421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:55:48.904956 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:55:48.904956 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:55:48.904956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:50.451115 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.551 seconds
[0m14:55:50.466883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:55:50.466883 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:55:50.466883 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:55:50.482818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:51.501678 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.030 seconds
[0m14:55:51.517353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7400f70-21c5-46e0-8907-e654854d9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A6444E510>]}
[0m14:55:51.517353 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:55:51.517353 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction  [RUN]
[0m14:55:51.517353 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction'
[0m14:55:51.517353 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:55:51.531500 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:55:51.531500 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:55:51.561981 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:55:51.561981 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m14:55:51.561981 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_revenue_lost_due_to_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction
         as
        (WITH transactional_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
)
SELECT 
    payment_month, 
    SUM(revenue) AS revenue_lost 
FROM transactional_data 
WHERE revenue_trend='Contraction' GROUP BY payment_month ORDER BY payment_month
        );
[0m14:55:51.561981 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:55:53.108756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.550 seconds
[0m14:55:53.156896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7400f70-21c5-46e0-8907-e654854d9a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A658CB680>]}
[0m14:55:53.156896 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_revenue_lost_due_to_contraction  [[32mSUCCESS 1[0m in 1.64s]
[0m14:55:53.156896 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m14:55:53.156896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:53.156896 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:55:53.156896 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:55:53.492765 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:55:53.492765 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:55:53.815235 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction' was left open.
[0m14:55:53.831767 [debug] [MainThread]: On model.CRB_PROJECT.mart_revenue_lost_due_to_contraction: Close
[0m14:55:54.165437 [info ] [MainThread]: 
[0m14:55:54.165437 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m14:55:54.165437 [debug] [MainThread]: Command end result
[0m14:55:54.204617 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:55:54.207640 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:55:54.214111 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:55:54.214111 [info ] [MainThread]: 
[0m14:55:54.216131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:54.217119 [info ] [MainThread]: 
[0m14:55:54.218127 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:55:54.219152 [debug] [MainThread]: Command `dbt run` succeeded at 14:55:54.219152 after 10.58 seconds
[0m14:55:54.219152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A6302A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A62AC4F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A62AC54F0>]}
[0m14:55:54.220118 [debug] [MainThread]: Flushing usage events
[0m14:55:55.132920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:08.000666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638B1A2D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638B532570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638A7CF140>]}


============================== 14:57:08.007452 | bec318f9-1971-4205-a703-a4d29df9fc8c ==============================
[0m14:57:08.007452 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:57:08.007452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m crb_report', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:57:08.486742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bec318f9-1971-4205-a703-a4d29df9fc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638C519850>]}
[0m14:57:08.550561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bec318f9-1971-4205-a703-a4d29df9fc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638B83D9A0>]}
[0m14:57:08.550561 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:57:09.042137 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:57:09.183855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:57:09.183855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:57:09.194984 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m14:57:09.223980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bec318f9-1971-4205-a703-a4d29df9fc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638D8D1FD0>]}
[0m14:57:09.288221 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:57:09.288221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:57:09.320062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bec318f9-1971-4205-a703-a4d29df9fc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638D89C890>]}
[0m14:57:09.320062 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m14:57:09.320062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bec318f9-1971-4205-a703-a4d29df9fc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638DA1B230>]}
[0m14:57:09.320062 [info ] [MainThread]: 
[0m14:57:09.320062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:09.336152 [info ] [MainThread]: 
[0m14:57:09.336152 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:57:09.336152 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m14:57:09.440368 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m14:57:09.440368 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m14:57:09.441368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:10.790337 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.349 seconds
[0m14:57:10.792029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m14:57:10.808054 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m14:57:10.809053 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m14:57:10.809053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:11.757436 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.963 seconds
[0m14:57:11.773193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bec318f9-1971-4205-a703-a4d29df9fc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638DA1AEA0>]}
[0m14:57:11.773193 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m14:57:11.773193 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m14:57:11.773193 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m14:57:11.773193 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m14:57:11.792802 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m14:57:11.794454 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m14:57:11.824718 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m14:57:11.825242 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m14:57:11.825242 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    -- WITH customer_data AS (
--     SELECT
--         customer_id,
--         customer_name
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
 
-- product_data AS (
--     SELECT
--         product_id,
--         product_family,
--         product_sub_family,
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
-- ),
 
-- transaction_data AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month,
--         revenue,
--         SUM(t.revenue) OVER(PARTITION BY t.product_id) AS total_revenue,
--         LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
--         CASE
--             WHEN revenue > prev_revenue THEN 'Expansion'
--             WHEN revenue < prev_revenue THEN 'Contraction'
--             ELSE 'Stable'
--         END AS revenue_trend
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
 
-- crb AS (
--     SELECT
--         t.customer_id,
--         t.product_id,
--         p.product_family,
--         p.product_sub_family,
--         t.revenue,
--         t.prev_revenue,
--         t.revenue_trend,
--         l.region,
--         l.country,
--         l.region,
--         -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
--         -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
--         SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
--         SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
--         SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
--         DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
--         DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
--     FROM transaction_data t
--     LEFT JOIN customer_data c ON t.customer_id = c.customer_id
--     LEFT JOIN product_data p ON t.product_id = p.product_id
--     LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
-- )
 
-- SELECT * FROM crb


WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS customer_revenue_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
)

SELECT * FROM crb
  );
[0m14:57:11.825242 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:12.993517 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffd7-3201-7d7b-000c-493e0002273e
[0m14:57:12.993517 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
[0m14:57:13.010247 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:57:13.010247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bec318f9-1971-4205-a703-a4d29df9fc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638DF9D670>]}
[0m14:57:13.010247 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.24s]
[0m14:57:13.010247 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m14:57:13.010247 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m14:57:13.010247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:13.010247 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m14:57:13.010247 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m14:57:13.343963 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m14:57:13.343963 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m14:57:13.677896 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m14:57:13.677896 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m14:57:13.994915 [info ] [MainThread]: 
[0m14:57:13.994915 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m14:57:14.011530 [debug] [MainThread]: Command end result
[0m14:57:14.033110 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m14:57:14.033110 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m14:57:14.045591 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m14:57:14.045591 [info ] [MainThread]: 
[0m14:57:14.046595 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:57:14.047646 [info ] [MainThread]: 
[0m14:57:14.048594 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m14:57:14.049359 [info ] [MainThread]: 
[0m14:57:14.049976 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:57:14.052062 [debug] [MainThread]: Command `dbt run` failed at 14:57:14.050985 after 6.22 seconds
[0m14:57:14.052062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638B6831A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026388F27620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026388F275C0>]}
[0m14:57:14.053003 [debug] [MainThread]: Flushing usage events
[0m14:57:15.191853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:39.968830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C951094F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C951094C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9510941A0>]}


============================== 15:02:39.984526 | c6951c29-a92e-40ec-aa3d-408d3b7e0ffa ==============================
[0m15:02:39.984526 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:02:39.984526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_new_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:02:40.469401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6951c29-a92e-40ec-aa3d-408d3b7e0ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C951B0ACF0>]}
[0m15:02:40.532828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6951c29-a92e-40ec-aa3d-408d3b7e0ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C951A37D70>]}
[0m15:02:40.532828 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:02:41.002745 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:02:41.161587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:41.161587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:41.161587 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:02:41.203610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6951c29-a92e-40ec-aa3d-408d3b7e0ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95306FAD0>]}
[0m15:02:41.268626 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:02:41.268626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:02:41.300543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6951c29-a92e-40ec-aa3d-408d3b7e0ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95322B980>]}
[0m15:02:41.300543 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:02:41.300543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6951c29-a92e-40ec-aa3d-408d3b7e0ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C951DD0FB0>]}
[0m15:02:41.300543 [info ] [MainThread]: 
[0m15:02:41.300543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:41.300543 [info ] [MainThread]: 
[0m15:02:41.300543 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:02:41.316299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:02:41.419991 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:02:41.419991 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:02:41.419991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:43.209154 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.784 seconds
[0m15:02:43.213433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:02:43.225246 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:02:43.225246 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:02:43.225246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:44.215401 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.987 seconds
[0m15:02:44.215401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6951c29-a92e-40ec-aa3d-408d3b7e0ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95322BF80>]}
[0m15:02:44.215401 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_customers
[0m15:02:44.215401 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_customers ................. [RUN]
[0m15:02:44.215401 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_customers'
[0m15:02:44.215401 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_customers
[0m15:02:44.229391 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_customers"
[0m15:02:44.229391 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_customers
[0m15:02:44.273274 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_customers"
[0m15:02:44.277265 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_customers"
[0m15:02:44.277265 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_customers
         as
        (-- WITH customers AS (
--     SELECT customer_id, customer_name, company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- first_payment AS (
--     SELECT customer_id, MIN(payment_month)::DATE AS first_payment_date
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- ),
-- new_customers AS (
--     SELECT c.customer_id, c.customer_name, c.company, fp.first_payment_date
--     FROM customers c
--     JOIN first_payment fp ON c.customer_id = fp.customer_id
--     WHERE fp.first_payment_date >= DATEADD(day, -365, CURRENT_DATE)
-- )
-- SELECT * FROM new_customers



WITH first_purchase AS (
    SELECT customer_id, MIN(payment_month) AS first_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
),
last_purchase AS (
    SELECT customer_id, MAX(payment_month) AS last_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
)
SELECT
    t.payment_month,
    COUNT(DISTINCT CASE WHEN f.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
    COUNT(DISTINCT CASE WHEN l.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
FROM stg_transactions t
LEFT JOIN first_purchase f ON t.customer_id = f.customer_id
LEFT JOIN last_purchase l ON t.customer_id = l.customer_id
GROUP BY t.payment_month
ORDER BY t.payment_month
        );
[0m15:02:44.278265 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:02:45.636520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.372 seconds
[0m15:02:45.668363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6951c29-a92e-40ec-aa3d-408d3b7e0ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C94E461A90>]}
[0m15:02:45.668363 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_new_customers ............ [[32mSUCCESS 1[0m in 1.45s]
[0m15:02:45.668363 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_customers
[0m15:02:45.668363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:45.668363 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:02:45.668363 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:02:46.013390 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:02:46.015396 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:02:46.331708 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_customers' was left open.
[0m15:02:46.331708 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_customers: Close
[0m15:02:46.671029 [info ] [MainThread]: 
[0m15:02:46.671029 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m15:02:46.671029 [debug] [MainThread]: Command end result
[0m15:02:46.699343 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:02:46.701350 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:02:46.707368 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:02:46.708084 [info ] [MainThread]: 
[0m15:02:46.708667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:46.708667 [info ] [MainThread]: 
[0m15:02:46.708667 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:02:46.708667 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:46.708667 after 6.90 seconds
[0m15:02:46.708667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C951AE3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9510DB170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C951094560>]}
[0m15:02:46.708667 [debug] [MainThread]: Flushing usage events
[0m15:02:47.625986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:42.574867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025108E90B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025108BFA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025108E92390>]}


============================== 15:07:42.588291 | 1971df8e-0586-4c37-a089-e55cd25c827f ==============================
[0m15:07:42.588291 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:07:42.588291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_new_customers', 'send_anonymous_usage_stats': 'True'}
[0m15:07:43.279556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1971df8e-0586-4c37-a089-e55cd25c827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025106232AE0>]}
[0m15:07:43.330563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1971df8e-0586-4c37-a089-e55cd25c827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025109C081D0>]}
[0m15:07:43.330563 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:07:43.832816 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:07:43.989662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:43.991702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:43.991702 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:07:44.022285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1971df8e-0586-4c37-a089-e55cd25c827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002510AD1B440>]}
[0m15:07:44.097935 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:07:44.101948 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:07:44.142016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1971df8e-0586-4c37-a089-e55cd25c827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002510B06BCB0>]}
[0m15:07:44.142016 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:07:44.142016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1971df8e-0586-4c37-a089-e55cd25c827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002510AD185F0>]}
[0m15:07:44.142016 [info ] [MainThread]: 
[0m15:07:44.146795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:44.146795 [info ] [MainThread]: 
[0m15:07:44.146795 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:07:44.146795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:07:44.262696 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:07:44.264702 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:07:44.264702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:45.823509 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.569 seconds
[0m15:07:45.839207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:07:45.839207 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:07:45.839207 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:07:45.839207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:46.839231 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.989 seconds
[0m15:07:46.843249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1971df8e-0586-4c37-a089-e55cd25c827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002510B06BE90>]}
[0m15:07:46.849260 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_customers
[0m15:07:46.849260 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_customers ................. [RUN]
[0m15:07:46.851264 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_customers'
[0m15:07:46.851264 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_customers
[0m15:07:46.859030 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_customers"
[0m15:07:46.861034 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_customers
[0m15:07:46.893338 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_customers"
[0m15:07:46.893338 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_customers"
[0m15:07:46.893338 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_customers
         as
        (-- WITH customers AS (
--     SELECT customer_id, customer_name, company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- first_payment AS (
--     SELECT customer_id, MIN(payment_month)::DATE AS first_payment_date
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- ),
-- new_customers AS (
--     SELECT c.customer_id, c.customer_name, c.company, fp.first_payment_date
--     FROM customers c
--     JOIN first_payment fp ON c.customer_id = fp.customer_id
--     WHERE fp.first_payment_date >= DATEADD(day, -365, CURRENT_DATE)
-- )
-- SELECT * FROM new_customers



WITH purchases AS (
    SELECT customer_id,
    MIN(payment_month) AS first_purchase_month,
    MAX(payment_month) AS last_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
)
SELECT
    t.payment_month,
    COUNT(DISTINCT CASE WHEN f.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
    COUNT(DISTINCT CASE WHEN f.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
FROM stg_transactions t
LEFT JOIN purchases p ON t.customer_id = p.customer_id
GROUP BY t.payment_month
ORDER BY t.payment_month
        );
[0m15:07:46.893338 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:07:47.916805 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe1-3201-7eb6-000c-493e0002703e
[0m15:07:47.918812 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 31 at position 29
invalid identifier 'F.FIRST_PURCHASE_MONTH'
[0m15:07:47.926585 [debug] [Thread-1 (]: Database Error in model mart_new_customers (models\mart\mart_new_customers.sql)
  000904 (42000): SQL compilation error: error line 31 at position 29
  invalid identifier 'F.FIRST_PURCHASE_MONTH'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_customers.sql
[0m15:07:47.928591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1971df8e-0586-4c37-a089-e55cd25c827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025108334740>]}
[0m15:07:47.930597 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_new_customers ........ [[31mERROR[0m in 1.08s]
[0m15:07:47.930597 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_customers
[0m15:07:47.930597 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_new_customers (models\mart\mart_new_customers.sql)
  000904 (42000): SQL compilation error: error line 31 at position 29
  invalid identifier 'F.FIRST_PURCHASE_MONTH'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_customers.sql.
[0m15:07:47.930597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:47.930597 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:07:47.936281 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:07:48.263504 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:07:48.263504 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:07:48.596185 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_customers' was left open.
[0m15:07:48.596185 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_customers: Close
[0m15:07:48.925151 [info ] [MainThread]: 
[0m15:07:48.925151 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.78 seconds (4.78s).
[0m15:07:48.925151 [debug] [MainThread]: Command end result
[0m15:07:48.962580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:07:48.964576 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:07:48.967577 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:07:48.967577 [info ] [MainThread]: 
[0m15:07:48.967577 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:07:48.967577 [info ] [MainThread]: 
[0m15:07:48.967577 [error] [MainThread]:   Database Error in model mart_new_customers (models\mart\mart_new_customers.sql)
  000904 (42000): SQL compilation error: error line 31 at position 29
  invalid identifier 'F.FIRST_PURCHASE_MONTH'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_customers.sql
[0m15:07:48.967577 [info ] [MainThread]: 
[0m15:07:48.975599 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:07:48.976146 [debug] [MainThread]: Command `dbt run` failed at 15:07:48.976146 after 6.57 seconds
[0m15:07:48.978442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002510899AA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025108998500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025108998560>]}
[0m15:07:48.978442 [debug] [MainThread]: Flushing usage events
[0m15:07:49.845183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:08:51.433531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6DA5748F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6DA574980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6DA574710>]}


============================== 15:08:51.447642 | de5dd2ef-6be3-4780-873c-c649e8f98e45 ==============================
[0m15:08:51.447642 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:08:51.447642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_new_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:08:51.938714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de5dd2ef-6be3-4780-873c-c649e8f98e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6DA241D90>]}
[0m15:08:52.004999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de5dd2ef-6be3-4780-873c-c649e8f98e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D79A7650>]}
[0m15:08:52.005663 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:08:52.503632 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:08:52.667158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:52.667158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:52.672714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:08:52.694012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de5dd2ef-6be3-4780-873c-c649e8f98e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6DC3C3FB0>]}
[0m15:08:52.778665 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:08:52.781665 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:08:52.813825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de5dd2ef-6be3-4780-873c-c649e8f98e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6DC75BE00>]}
[0m15:08:52.813825 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:08:52.813825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de5dd2ef-6be3-4780-873c-c649e8f98e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6DC3C3380>]}
[0m15:08:52.813825 [info ] [MainThread]: 
[0m15:08:52.818604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:08:52.819651 [info ] [MainThread]: 
[0m15:08:52.819651 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:08:52.821657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:08:52.923714 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:08:52.923714 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:08:52.923714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:54.207742 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.286 seconds
[0m15:08:54.220037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:08:54.224286 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:08:54.224286 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:08:54.224286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:55.157297 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.938 seconds
[0m15:08:55.172990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de5dd2ef-6be3-4780-873c-c649e8f98e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6D9F68380>]}
[0m15:08:55.172990 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_customers
[0m15:08:55.172990 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_customers ................. [RUN]
[0m15:08:55.172990 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_customers'
[0m15:08:55.172990 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_customers
[0m15:08:55.194720 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_customers"
[0m15:08:55.196751 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_customers
[0m15:08:55.225193 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_customers"
[0m15:08:55.225193 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_customers"
[0m15:08:55.225193 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_customers
         as
        (-- WITH customers AS (
--     SELECT customer_id, customer_name, company
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- first_payment AS (
--     SELECT customer_id, MIN(payment_month)::DATE AS first_payment_date
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- ),
-- new_customers AS (
--     SELECT c.customer_id, c.customer_name, c.company, fp.first_payment_date
--     FROM customers c
--     JOIN first_payment fp ON c.customer_id = fp.customer_id
--     WHERE fp.first_payment_date >= DATEADD(day, -365, CURRENT_DATE)
-- )
-- SELECT * FROM new_customers



WITH purchases AS (
    SELECT customer_id,
    MIN(payment_month) AS first_purchase_month,
    MAX(payment_month) AS last_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
)
SELECT
    t.payment_month,
    COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
    COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
FROM stg_transactions t
LEFT JOIN purchases p ON t.customer_id = p.customer_id
GROUP BY t.payment_month
ORDER BY t.payment_month
        );
[0m15:08:55.225193 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:56.780851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.561 seconds
[0m15:08:56.812144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de5dd2ef-6be3-4780-873c-c649e8f98e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6DCD0BB00>]}
[0m15:08:56.812144 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_new_customers ............ [[32mSUCCESS 1[0m in 1.64s]
[0m15:08:56.812144 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_customers
[0m15:08:56.812144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:56.812144 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:08:56.812144 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:08:57.133957 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:08:57.133957 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:08:57.461595 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_customers' was left open.
[0m15:08:57.461595 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_customers: Close
[0m15:08:57.776906 [info ] [MainThread]: 
[0m15:08:57.776906 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.96 seconds (4.96s).
[0m15:08:57.776906 [debug] [MainThread]: Command end result
[0m15:08:57.817331 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:08:57.817331 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:08:57.828959 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:08:57.828959 [info ] [MainThread]: 
[0m15:08:57.828959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:57.836697 [info ] [MainThread]: 
[0m15:08:57.836697 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:08:57.836697 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:57.836697 after 6.56 seconds
[0m15:08:57.836697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6DAFAD640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6DC75BE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6DC59FB90>]}
[0m15:08:57.839032 [debug] [MainThread]: Flushing usage events
[0m15:08:58.729152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:50.216149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021460640530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021462AE35C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002145D387290>]}


============================== 15:18:50.216149 | 0d3eb45f-2374-426d-9e24-822c0f8d6632 ==============================
[0m15:18:50.216149 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:18:50.216149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m crb_report', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:50.634259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d3eb45f-2374-426d-9e24-822c0f8d6632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146254AED0>]}
[0m15:18:50.697757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d3eb45f-2374-426d-9e24-822c0f8d6632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021463CE0200>]}
[0m15:18:50.697757 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:18:51.285864 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:18:51.459726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:51.461758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:51.507920 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:18:51.543217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d3eb45f-2374-426d-9e24-822c0f8d6632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021463E73290>]}
[0m15:18:51.623542 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:18:51.638213 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:18:51.654881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d3eb45f-2374-426d-9e24-822c0f8d6632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021465292210>]}
[0m15:18:51.668549 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:18:51.669558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d3eb45f-2374-426d-9e24-822c0f8d6632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214650AB230>]}
[0m15:18:51.670589 [info ] [MainThread]: 
[0m15:18:51.671591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:51.671591 [info ] [MainThread]: 
[0m15:18:51.672872 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:51.673934 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:18:51.773931 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:18:51.773931 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:18:51.773931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:53.225384 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.456 seconds
[0m15:18:53.238858 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:18:53.248085 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:18:53.248085 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:18:53.248085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:54.211406 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.970 seconds
[0m15:18:54.224183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d3eb45f-2374-426d-9e24-822c0f8d6632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146530BD10>]}
[0m15:18:54.228914 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:18:54.228914 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:18:54.229912 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:18:54.229912 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:18:54.240002 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:18:54.240970 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:18:54.260376 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:18:54.274129 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:18:54.275152 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    -- WITH customer_data AS (
--     SELECT
--         customer_id,
--         customer_name
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
 
-- product_data AS (
--     SELECT
--         product_id,
--         product_family,
--         product_sub_family,
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
-- ),
 
-- transaction_data AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month,
--         revenue,
--         SUM(t.revenue) OVER(PARTITION BY t.product_id) AS total_revenue,
--         LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
--         CASE
--             WHEN revenue > prev_revenue THEN 'Expansion'
--             WHEN revenue < prev_revenue THEN 'Contraction'
--             ELSE 'Stable'
--         END AS revenue_trend
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
 
-- crb AS (
--     SELECT
--         t.customer_id,
--         t.product_id,
--         p.product_family,
--         p.product_sub_family,
--         t.revenue,
--         t.prev_revenue,
--         t.revenue_trend,
--         l.region,
--         l.country,
--         l.region,
--         -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
--         -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
--         SUM(CASE WHEN revenue_trend = 'Expansion' THEN revenue ELSE 0 END) OVER () AS net_nrr,
--         SUM(CASE WHEN revenue_trend IN ('Expansion', 'Stable') THEN revenue ELSE 0 END) OVER () AS gross_nrr,
--         SUM(CASE WHEN revenue_trend = 'Contraction' THEN revenue ELSE 0 END) OVER (PARTITION BY YEAR(payment_month)) AS revenue_lost,
--         DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
--         DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY customer_id) DESC) AS customer_rank
--     FROM transaction_data t
--     LEFT JOIN customer_data c ON t.customer_id = c.customer_id
--     LEFT JOIN product_data p ON t.product_id = p.product_id
--     LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
-- )
 
-- SELECT * FROM crb


WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS customer_revenue_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
)

SELECT * FROM crb
  );
[0m15:18:54.275152 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:55.422743 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffec-3201-7d7b-000c-493e00022762
[0m15:18:55.422743 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
[0m15:18:55.422743 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:18:55.422743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d3eb45f-2374-426d-9e24-822c0f8d6632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021462514980>]}
[0m15:18:55.422743 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.19s]
[0m15:18:55.422743 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:18:55.422743 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m15:18:55.422743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:55.422743 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:18:55.422743 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:18:55.758862 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:18:55.759866 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:18:56.074948 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:18:56.074948 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:18:56.406203 [info ] [MainThread]: 
[0m15:18:56.406203 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m15:18:56.406203 [debug] [MainThread]: Command end result
[0m15:18:56.428211 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:18:56.428211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:18:56.428211 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:18:56.440467 [info ] [MainThread]: 
[0m15:18:56.442590 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:18:56.443825 [info ] [MainThread]: 
[0m15:18:56.444674 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [IFF(T.REVENUE_TREND = 'Expansion', T.REVENUE, CAST(0 AS NUMBER(10,2)))] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:18:56.445682 [info ] [MainThread]: 
[0m15:18:56.445682 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:18:56.447185 [debug] [MainThread]: Command `dbt run` failed at 15:18:56.447185 after 6.40 seconds
[0m15:18:56.447806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021462434EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021462F2BAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021462F2B800>]}
[0m15:18:56.447806 [debug] [MainThread]: Flushing usage events
[0m15:18:57.747265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:21.809021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025269FFCC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526990A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025269FFE0C0>]}


============================== 15:21:21.809021 | 93897991-fbd0-4ec1-ad49-1646f26eadb9 ==============================
[0m15:21:21.809021 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:21:21.809021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m crb_report', 'send_anonymous_usage_stats': 'True'}
[0m15:21:22.234058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93897991-fbd0-4ec1-ad49-1646f26eadb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252673F2A50>]}
[0m15:21:22.296974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93897991-fbd0-4ec1-ad49-1646f26eadb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526ABCEFF0>]}
[0m15:21:22.296974 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:21:22.806293 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:21:22.966259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:22.966259 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:22.966259 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:21:23.003146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93897991-fbd0-4ec1-ad49-1646f26eadb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526AE9C590>]}
[0m15:21:23.068869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:21:23.068869 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:21:23.100185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93897991-fbd0-4ec1-ad49-1646f26eadb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526C099040>]}
[0m15:21:23.100185 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:21:23.100185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93897991-fbd0-4ec1-ad49-1646f26eadb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252676D4E60>]}
[0m15:21:23.100185 [info ] [MainThread]: 
[0m15:21:23.106896 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:23.106896 [info ] [MainThread]: 
[0m15:21:23.106896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:21:23.106896 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:21:23.218852 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:21:23.219819 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:21:23.219819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:24.554716 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.342 seconds
[0m15:21:24.569958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:21:24.571361 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:21:24.571361 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:21:24.571361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:25.534637 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.958 seconds
[0m15:21:25.550516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93897991-fbd0-4ec1-ad49-1646f26eadb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526C098860>]}
[0m15:21:25.550516 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:21:25.550516 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:21:25.550516 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:21:25.550516 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:21:25.566239 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:21:25.566239 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:21:25.606471 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:21:25.609980 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:21:25.609980 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS customer_revenue_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
)

SELECT * FROM crb
  );
[0m15:21:25.610990 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:26.525060 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffef-3201-7e9a-000c-493e00023516
[0m15:21:26.525060 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[T.CUSTOMER_ID] is not a valid group by expression
[0m15:21:26.525060 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [T.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:21:26.540849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93897991-fbd0-4ec1-ad49-1646f26eadb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526AEBB110>]}
[0m15:21:26.540849 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 0.97s]
[0m15:21:26.540849 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:21:26.540849 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [T.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m15:21:26.540849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:26.540849 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:21:26.540849 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:21:26.864495 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:21:26.864495 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:21:27.213954 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:21:27.221944 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:21:27.555626 [info ] [MainThread]: 
[0m15:21:27.555626 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m15:21:27.571504 [debug] [MainThread]: Command end result
[0m15:21:27.593663 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:21:27.593663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:21:27.593663 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:21:27.593663 [info ] [MainThread]: 
[0m15:21:27.593663 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:21:27.604794 [info ] [MainThread]: 
[0m15:21:27.604794 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [T.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:21:27.605801 [info ] [MainThread]: 
[0m15:21:27.606801 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:21:27.607613 [debug] [MainThread]: Command `dbt run` failed at 15:21:27.607613 after 5.96 seconds
[0m15:21:27.607613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526990A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025269B6F530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252694510D0>]}
[0m15:21:27.607613 [debug] [MainThread]: Flushing usage events
[0m15:21:28.725212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:29.595540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CDF245C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CDF24410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CDF240E0>]}


============================== 15:23:29.604657 | 974a22ed-5fdb-4bb3-bfe4-90752566f20b ==============================
[0m15:23:29.604657 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:23:29.604657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m crb_report', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:23:30.012108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '974a22ed-5fdb-4bb3-bfe4-90752566f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CEA3ACF0>]}
[0m15:23:30.079214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '974a22ed-5fdb-4bb3-bfe4-90752566f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CDB67DA0>]}
[0m15:23:30.081253 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:23:30.543675 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:23:30.692267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:30.692267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:30.707962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:23:30.730113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '974a22ed-5fdb-4bb3-bfe4-90752566f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CEC49F70>]}
[0m15:23:30.797113 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:23:30.797113 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:23:30.828735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '974a22ed-5fdb-4bb3-bfe4-90752566f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CFF650D0>]}
[0m15:23:30.828735 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:23:30.828735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '974a22ed-5fdb-4bb3-bfe4-90752566f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CDF077A0>]}
[0m15:23:30.828735 [info ] [MainThread]: 
[0m15:23:30.835739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:30.835739 [info ] [MainThread]: 
[0m15:23:30.835739 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:30.835739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:23:30.937235 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:23:30.937235 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:23:30.937235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:32.424740 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.499 seconds
[0m15:23:32.440700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:23:32.440700 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:23:32.440700 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:23:32.440700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:33.411315 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.971 seconds
[0m15:23:33.427339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '974a22ed-5fdb-4bb3-bfe4-90752566f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CFEB2FC0>]}
[0m15:23:33.427339 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:23:33.427339 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:23:33.427339 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:23:33.427339 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:23:33.447158 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:23:33.449164 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:23:33.467404 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:23:33.479711 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:23:33.479711 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS customer_revenue_rank
    FROM transaction_data t
    JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
)

SELECT * FROM crb
  );
[0m15:23:33.479711 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:34.504807 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff1-3201-7eb6-000c-493e0002706e
[0m15:23:34.504807 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[SYS_VW.CUSTOMER_ID_0] is not a valid group by expression
[0m15:23:34.508818 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [SYS_VW.CUSTOMER_ID_0] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:23:34.511322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '974a22ed-5fdb-4bb3-bfe4-90752566f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CDF698B0>]}
[0m15:23:34.511322 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.08s]
[0m15:23:34.511322 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:23:34.511322 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [SYS_VW.CUSTOMER_ID_0] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m15:23:34.511322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:34.511322 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:23:34.511322 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:23:34.844325 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:23:34.844325 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:23:35.174627 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:23:35.174627 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:23:35.515409 [info ] [MainThread]: 
[0m15:23:35.515409 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.68 seconds (4.68s).
[0m15:23:35.515409 [debug] [MainThread]: Command end result
[0m15:23:35.546793 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:23:35.552249 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:23:35.558306 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:23:35.558306 [info ] [MainThread]: 
[0m15:23:35.560907 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:23:35.560907 [info ] [MainThread]: 
[0m15:23:35.560907 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [SYS_VW.CUSTOMER_ID_0] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:23:35.560907 [info ] [MainThread]: 
[0m15:23:35.560907 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:23:35.564758 [debug] [MainThread]: Command `dbt run` failed at 15:23:35.564758 after 6.13 seconds
[0m15:23:35.564758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CEB55010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CCFBF980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CEC7CC80>]}
[0m15:23:35.564758 [debug] [MainThread]: Flushing usage events
[0m15:23:36.855539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:50.968065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B03833860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B031E2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B03830380>]}


============================== 15:23:50.976188 | 0ab5e74e-b368-48e4-811e-1015fc3c1ef6 ==============================
[0m15:23:50.976188 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:23:50.976188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m crb_report', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:51.416324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ab5e74e-b368-48e4-811e-1015fc3c1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B02D6A300>]}
[0m15:23:51.468481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ab5e74e-b368-48e4-811e-1015fc3c1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B04602660>]}
[0m15:23:51.468481 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:23:51.955942 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:23:52.111474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:52.113479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:52.118126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:23:52.139887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ab5e74e-b368-48e4-811e-1015fc3c1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B0470B320>]}
[0m15:23:52.220657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:23:52.224670 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:23:52.244316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ab5e74e-b368-48e4-811e-1015fc3c1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B0588CAA0>]}
[0m15:23:52.244316 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:23:52.248074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ab5e74e-b368-48e4-811e-1015fc3c1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B058EDDF0>]}
[0m15:23:52.248074 [info ] [MainThread]: 
[0m15:23:52.250167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:52.250167 [info ] [MainThread]: 
[0m15:23:52.250167 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:52.250167 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:23:52.351250 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:23:52.352567 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:23:52.352567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:54.082984 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.730 seconds
[0m15:23:54.106726 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:23:54.130540 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:23:54.130540 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:23:54.130540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:55.217877 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.084 seconds
[0m15:23:55.231855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ab5e74e-b368-48e4-811e-1015fc3c1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B04602720>]}
[0m15:23:55.235743 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:23:55.235743 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:23:55.235743 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:23:55.235743 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:23:55.246040 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:23:55.247788 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:23:55.272795 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:23:55.281306 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:23:55.281306 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS customer_revenue_rank
    FROM transaction_data t
    JOIN customer_data c ON t.customer_id = c.customer_id
    JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
)

SELECT * FROM crb
  );
[0m15:23:55.281306 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:56.305813 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff1-3201-7d7b-000c-493e00022776
[0m15:23:56.305813 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[SYS_VW.CUSTOMER_ID_0] is not a valid group by expression
[0m15:23:56.305813 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [SYS_VW.CUSTOMER_ID_0] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:23:56.320900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab5e74e-b368-48e4-811e-1015fc3c1ef6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B05F8D670>]}
[0m15:23:56.320900 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.07s]
[0m15:23:56.322392 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:23:56.322392 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [SYS_VW.CUSTOMER_ID_0] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m15:23:56.322392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:56.322392 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:23:56.322392 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:23:56.661873 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:23:56.663881 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:23:57.006105 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:23:57.008143 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:23:57.324737 [info ] [MainThread]: 
[0m15:23:57.324737 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.07 seconds (5.07s).
[0m15:23:57.324737 [debug] [MainThread]: Command end result
[0m15:23:57.363359 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:23:57.366421 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:23:57.368454 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:23:57.368454 [info ] [MainThread]: 
[0m15:23:57.372889 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:23:57.374899 [info ] [MainThread]: 
[0m15:23:57.375905 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [SYS_VW.CUSTOMER_ID_0] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:23:57.375905 [info ] [MainThread]: 
[0m15:23:57.376906 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:23:57.377907 [debug] [MainThread]: Command `dbt run` failed at 15:23:57.377907 after 6.57 seconds
[0m15:23:57.377907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B0321D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B0357ABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B036D56D0>]}
[0m15:23:57.378942 [debug] [MainThread]: Flushing usage events
[0m15:23:58.256654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:17.473609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BC47B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BCBD7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BCBD4E60>]}


============================== 15:26:17.473609 | f18d78ca-d780-46d7-87db-31e27dd63e30 ==============================
[0m15:26:17.473609 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:26:17.473609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m crb_report', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:18.447475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f18d78ca-d780-46d7-87db-31e27dd63e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BE98AC60>]}
[0m15:26:18.509926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f18d78ca-d780-46d7-87db-31e27dd63e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD7B0470>]}
[0m15:26:18.509926 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:26:19.078374 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:26:19.235811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:19.235811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:19.241830 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:26:19.273717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f18d78ca-d780-46d7-87db-31e27dd63e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BEA3A120>]}
[0m15:26:19.330508 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:26:19.364374 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:26:19.396787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f18d78ca-d780-46d7-87db-31e27dd63e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BEBEF470>]}
[0m15:26:19.396787 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:26:19.399372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f18d78ca-d780-46d7-87db-31e27dd63e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BE9F2F60>]}
[0m15:26:19.399372 [info ] [MainThread]: 
[0m15:26:19.401462 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:19.401462 [info ] [MainThread]: 
[0m15:26:19.401462 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:26:19.401462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:26:22.414207 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:26:22.414207 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:26:22.414207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:23.809412 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.391 seconds
[0m15:26:23.809412 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:26:23.818256 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:26:23.818256 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:26:23.818256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:24.810837 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.993 seconds
[0m15:26:24.810837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f18d78ca-d780-46d7-87db-31e27dd63e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BED65C40>]}
[0m15:26:24.826720 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:26:24.826720 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:26:24.826720 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:26:24.826720 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:26:24.836871 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:26:24.836871 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:26:24.854985 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:26:24.870743 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:26:24.870743 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS customer_revenue_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
)

SELECT * FROM crb
  );
[0m15:26:24.871740 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:26:26.000909 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff4-3201-7e9a-000c-493e0002351e
[0m15:26:26.000909 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[T.CUSTOMER_ID] is not a valid group by expression
[0m15:26:26.017050 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [T.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:26:26.017050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18d78ca-d780-46d7-87db-31e27dd63e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BF35E300>]}
[0m15:26:26.017050 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.19s]
[0m15:26:26.017050 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:26:26.017050 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [T.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m15:26:26.017050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:26.017050 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:26:26.017050 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:26:26.351319 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:26:26.351319 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:26:26.669997 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:26:26.669997 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:26:27.010557 [info ] [MainThread]: 
[0m15:26:27.010557 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m15:26:27.010557 [debug] [MainThread]: Command end result
[0m15:26:27.048156 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:26:27.051075 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:26:27.057199 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:26:27.058201 [info ] [MainThread]: 
[0m15:26:27.058201 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:26:27.059197 [info ] [MainThread]: 
[0m15:26:27.060200 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [T.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:26:27.061122 [info ] [MainThread]: 
[0m15:26:27.062200 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:26:27.062200 [debug] [MainThread]: Command `dbt run` failed at 15:26:27.062200 after 9.76 seconds
[0m15:26:27.062200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BA76DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BD8458B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236BC0E8FE0>]}
[0m15:26:27.062200 [debug] [MainThread]: Flushing usage events
[0m15:26:28.318628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:00.875887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC88B54B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC88B54A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC88B548C0>]}


============================== 15:27:00.889741 | fd2c7bd8-8a6e-4822-8e5b-f88dc13bdbd2 ==============================
[0m15:27:00.889741 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:27:00.889741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m crb_report', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:27:01.385144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd2c7bd8-8a6e-4822-8e5b-f88dc13bdbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC897A4B00>]}
[0m15:27:01.449834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd2c7bd8-8a6e-4822-8e5b-f88dc13bdbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC880B9D30>]}
[0m15:27:01.451832 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:27:01.936531 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:27:02.084914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:27:02.084914 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:27:02.084914 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:27:02.127565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd2c7bd8-8a6e-4822-8e5b-f88dc13bdbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC88B56CF0>]}
[0m15:27:02.190337 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:27:02.190337 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:27:02.221963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd2c7bd8-8a6e-4822-8e5b-f88dc13bdbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8ABACAD0>]}
[0m15:27:02.221963 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:27:02.221963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd2c7bd8-8a6e-4822-8e5b-f88dc13bdbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8988ADB0>]}
[0m15:27:02.221963 [info ] [MainThread]: 
[0m15:27:02.221963 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:02.221963 [info ] [MainThread]: 
[0m15:27:02.221963 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:27:02.237705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:27:02.340921 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:27:02.342004 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:27:02.342004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:03.770011 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.437 seconds
[0m15:27:03.785876 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:27:03.787415 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:27:03.787415 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:27:03.787415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:04.760607 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.965 seconds
[0m15:27:04.761465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd2c7bd8-8a6e-4822-8e5b-f88dc13bdbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8ABAC290>]}
[0m15:27:04.761465 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:27:04.761465 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:27:04.761465 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:27:04.761465 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:27:04.777106 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:27:04.777106 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:27:04.812557 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:27:04.813902 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:27:04.813902 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS customer_revenue_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
)

SELECT * FROM crb
  );
[0m15:27:04.813902 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:27:05.761799 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff5-3201-7d7b-000c-493e0002277a
[0m15:27:05.761799 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 41 at position 8
invalid identifier 'L.REGION'
[0m15:27:05.761799 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 41 at position 8
  invalid identifier 'L.REGION'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:27:05.761799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd2c7bd8-8a6e-4822-8e5b-f88dc13bdbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8A9107A0>]}
[0m15:27:05.775909 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.00s]
[0m15:27:05.775909 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:27:05.775909 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 41 at position 8
  invalid identifier 'L.REGION'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m15:27:05.775909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:05.775909 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:27:05.775909 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:27:06.105416 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:27:06.105416 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:27:06.427310 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:27:06.427777 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:27:06.746461 [info ] [MainThread]: 
[0m15:27:06.746461 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m15:27:06.746461 [debug] [MainThread]: Command end result
[0m15:27:06.783134 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:27:06.783134 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:27:06.794730 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:27:06.795741 [info ] [MainThread]: 
[0m15:27:06.797658 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:27:06.797658 [info ] [MainThread]: 
[0m15:27:06.800034 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 41 at position 8
  invalid identifier 'L.REGION'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:27:06.801033 [info ] [MainThread]: 
[0m15:27:06.802031 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:27:06.803030 [debug] [MainThread]: Command `dbt run` failed at 15:27:06.803030 after 6.08 seconds
[0m15:27:06.803631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC896DCB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC88B7D760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC88B7D370>]}
[0m15:27:06.803631 [debug] [MainThread]: Flushing usage events
[0m15:27:07.663084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:22.829351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C294F680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C1BC6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C2B78320>]}


============================== 15:27:22.838898 | 176f7d3a-1068-4c23-8f01-087536d8a817 ==============================
[0m15:27:22.838898 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:27:22.838898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m crb_report', 'send_anonymous_usage_stats': 'True'}
[0m15:27:23.326781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '176f7d3a-1068-4c23-8f01-087536d8a817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C3AB4D70>]}
[0m15:27:23.388355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '176f7d3a-1068-4c23-8f01-087536d8a817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C28BF470>]}
[0m15:27:23.390405 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:27:23.869485 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:27:24.007639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:27:24.007639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:27:24.023444 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:27:24.045248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '176f7d3a-1068-4c23-8f01-087536d8a817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C4BFCF20>]}
[0m15:27:24.112586 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:27:24.128715 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:27:24.144357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '176f7d3a-1068-4c23-8f01-087536d8a817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C4C18FB0>]}
[0m15:27:24.144357 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:27:24.160483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '176f7d3a-1068-4c23-8f01-087536d8a817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C4B92F60>]}
[0m15:27:24.160483 [info ] [MainThread]: 
[0m15:27:24.160483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:24.160483 [info ] [MainThread]: 
[0m15:27:24.164039 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:27:24.164039 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:27:24.272037 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:27:24.272037 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:27:24.272037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:25.707755 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.438 seconds
[0m15:27:25.707755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:27:25.723678 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:27:25.723678 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:27:25.723678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:26.694536 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.970 seconds
[0m15:27:26.694536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '176f7d3a-1068-4c23-8f01-087536d8a817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C5270440>]}
[0m15:27:26.694536 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:27:26.694536 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:27:26.694536 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:27:26.694536 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:27:26.709760 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:27:26.709760 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:27:26.733174 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:27:26.749431 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:27:26.750423 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS customer_revenue_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
)

SELECT * FROM crb
  );
[0m15:27:26.750423 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:27:28.732465 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff5-3201-7e57-000c-493e00026396
[0m15:27:28.732465 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[T.CUSTOMER_ID] is not a valid group by expression
[0m15:27:28.734516 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [T.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:27:28.734516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '176f7d3a-1068-4c23-8f01-087536d8a817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C39F8620>]}
[0m15:27:28.734516 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 2.04s]
[0m15:27:28.734516 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:27:28.734516 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [T.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m15:27:28.734516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:28.734516 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:27:28.734516 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:27:29.060381 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:27:29.060381 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:27:29.400805 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:27:29.400805 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:27:29.719695 [info ] [MainThread]: 
[0m15:27:29.735425 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.56 seconds (5.56s).
[0m15:27:29.735425 [debug] [MainThread]: Command end result
[0m15:27:29.757981 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:27:29.757981 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:27:29.757981 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:27:29.757981 [info ] [MainThread]: 
[0m15:27:29.757981 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:27:29.767870 [info ] [MainThread]: 
[0m15:27:29.768909 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [T.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:27:29.770102 [info ] [MainThread]: 
[0m15:27:29.770102 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:27:29.771138 [debug] [MainThread]: Command `dbt run` failed at 15:27:29.771138 after 7.10 seconds
[0m15:27:29.772455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C1BC6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C2793EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C2791880>]}
[0m15:27:29.772802 [debug] [MainThread]: Flushing usage events
[0m15:27:30.669236 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:21.490956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19D283A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19A5C58E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19D61F260>]}


============================== 15:29:21.490956 | b4b6a1f4-9df3-44a5-a8f6-62022d9c446b ==============================
[0m15:29:21.490956 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:29:21.490956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m crb_report', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:21.979720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4b6a1f4-9df3-44a5-a8f6-62022d9c446b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19AF128A0>]}
[0m15:29:22.046622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4b6a1f4-9df3-44a5-a8f6-62022d9c446b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19D4F6240>]}
[0m15:29:22.046622 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:29:22.530672 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:29:22.680953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:22.680953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:22.697670 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:29:22.719679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4b6a1f4-9df3-44a5-a8f6-62022d9c446b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19E507D70>]}
[0m15:29:22.799780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:29:22.802813 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:29:22.830769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4b6a1f4-9df3-44a5-a8f6-62022d9c446b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19FCD62A0>]}
[0m15:29:22.830769 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:29:22.830769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b6a1f4-9df3-44a5-a8f6-62022d9c446b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19CFC0FB0>]}
[0m15:29:22.830769 [info ] [MainThread]: 
[0m15:29:22.830769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:22.830769 [info ] [MainThread]: 
[0m15:29:22.830769 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:29:22.830769 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:29:22.930798 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:29:22.930798 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:29:22.930798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:24.332481 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.400 seconds
[0m15:29:24.345970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:29:24.356656 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:29:24.358662 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:29:24.358662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:25.334094 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.985 seconds
[0m15:29:25.347775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4b6a1f4-9df3-44a5-a8f6-62022d9c446b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19F963320>]}
[0m15:29:25.347775 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:29:25.347775 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:29:25.347775 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:29:25.347775 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:29:25.347775 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:29:25.363762 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:29:25.383666 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:29:25.383666 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:29:25.398671 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue
)

SELECT * FROM crb;
[0m15:29:25.399370 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:26.336918 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff7-3201-7e56-000c-493e0002465a
[0m15:29:26.336918 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 67 at position 17 unexpected ';'.
[0m15:29:26.336918 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 67 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:29:26.336918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4b6a1f4-9df3-44a5-a8f6-62022d9c446b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19F9623C0>]}
[0m15:29:26.336918 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 0.99s]
[0m15:29:26.336918 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:29:26.336918 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 67 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m15:29:26.351807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:26.351807 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:29:26.351807 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:29:26.677542 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:29:26.677542 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:29:27.001589 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:29:27.009299 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:29:27.341640 [info ] [MainThread]: 
[0m15:29:27.343663 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m15:29:27.349270 [debug] [MainThread]: Command end result
[0m15:29:27.378693 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:29:27.379726 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:29:27.387770 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:29:27.387770 [info ] [MainThread]: 
[0m15:29:27.388769 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:29:27.389772 [info ] [MainThread]: 
[0m15:29:27.390781 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 67 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:29:27.390781 [info ] [MainThread]: 
[0m15:29:27.390781 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:29:27.390781 [debug] [MainThread]: Command `dbt run` failed at 15:29:27.390781 after 6.07 seconds
[0m15:29:27.395147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19D7855E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F197DC7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19B90D5E0>]}
[0m15:29:27.395147 [debug] [MainThread]: Flushing usage events
[0m15:29:28.269616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:35.581574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBCEAB5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBCEAADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBCEA9F40>]}


============================== 15:29:35.588342 | 4a0351e1-4867-40a0-86dc-2c98e4771ca2 ==============================
[0m15:29:35.588342 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:29:35.588342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m crb_report', 'send_anonymous_usage_stats': 'True'}
[0m15:29:36.112712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a0351e1-4867-40a0-86dc-2c98e4771ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBD935010>]}
[0m15:29:36.181835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a0351e1-4867-40a0-86dc-2c98e4771ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBCEA9EB0>]}
[0m15:29:36.181835 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:29:36.672995 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:29:36.834433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:36.834433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:36.834433 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:29:36.866887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a0351e1-4867-40a0-86dc-2c98e4771ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBF79FEF0>]}
[0m15:29:36.944181 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:29:36.948186 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:29:36.980590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a0351e1-4867-40a0-86dc-2c98e4771ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBFB062A0>]}
[0m15:29:36.980590 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:29:36.981591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a0351e1-4867-40a0-86dc-2c98e4771ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBF7DF560>]}
[0m15:29:36.982590 [info ] [MainThread]: 
[0m15:29:36.983590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:36.984590 [info ] [MainThread]: 
[0m15:29:36.985590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:29:36.986443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:29:37.078830 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:29:37.078830 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:29:37.078830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:38.223142 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.136 seconds
[0m15:29:38.225151 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:29:38.235077 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:29:38.235077 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:29:38.235077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:39.204914 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.966 seconds
[0m15:29:39.210442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a0351e1-4867-40a0-86dc-2c98e4771ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBFF9F620>]}
[0m15:29:39.217539 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:29:39.218548 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:29:39.219550 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:29:39.219550 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:29:39.229990 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:29:39.230416 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:29:39.248415 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:29:39.264244 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:29:39.265249 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.location_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue
)

SELECT * FROM crb
  );
[0m15:29:39.265249 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:40.196833 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff7-3201-7eb6-000c-493e00027082
[0m15:29:40.198849 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 53 at position 75
invalid identifier 'L.LOCATION_ID'
[0m15:29:40.204293 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 53 at position 75
  invalid identifier 'L.LOCATION_ID'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:29:40.207605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a0351e1-4867-40a0-86dc-2c98e4771ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBCE147A0>]}
[0m15:29:40.209078 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 0.99s]
[0m15:29:40.209078 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:29:40.209078 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 53 at position 75
  invalid identifier 'L.LOCATION_ID'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m15:29:40.209078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:40.209078 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:29:40.209078 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:29:40.532199 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:29:40.532199 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:29:40.866739 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:29:40.866739 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:29:41.182754 [info ] [MainThread]: 
[0m15:29:41.182754 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m15:29:41.182754 [debug] [MainThread]: Command end result
[0m15:29:41.220759 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:29:41.233850 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:29:41.241775 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:29:41.241775 [info ] [MainThread]: 
[0m15:29:41.242776 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:29:41.243803 [info ] [MainThread]: 
[0m15:29:41.243803 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 53 at position 75
  invalid identifier 'L.LOCATION_ID'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:29:41.243803 [info ] [MainThread]: 
[0m15:29:41.243803 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:29:41.243803 [debug] [MainThread]: Command `dbt run` failed at 15:29:41.243803 after 5.84 seconds
[0m15:29:41.243803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBD673FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBE337FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CBF79ECC0>]}
[0m15:29:41.243803 [debug] [MainThread]: Flushing usage events
[0m15:29:42.150091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:11.748334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E45FB99D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E471F6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E49157200>]}


============================== 15:30:11.748334 | 4c251be9-6e37-43df-950e-615dc6bb4069 ==============================
[0m15:30:11.748334 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:30:11.748334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m crb_report', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:30:12.228037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c251be9-6e37-43df-950e-615dc6bb4069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4955DB20>]}
[0m15:30:12.291689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c251be9-6e37-43df-950e-615dc6bb4069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4A28FAD0>]}
[0m15:30:12.291689 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:30:12.771497 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:30:12.913825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:30:12.913825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:30:12.929584 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:30:12.960799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c251be9-6e37-43df-950e-615dc6bb4069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4B4A00B0>]}
[0m15:30:13.029777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:30:13.030745 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:30:13.062188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c251be9-6e37-43df-950e-615dc6bb4069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4B5551F0>]}
[0m15:30:13.062188 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:30:13.062188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c251be9-6e37-43df-950e-615dc6bb4069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4B32C2C0>]}
[0m15:30:13.062188 [info ] [MainThread]: 
[0m15:30:13.062188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:30:13.062188 [info ] [MainThread]: 
[0m15:30:13.062188 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:30:13.062188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:30:13.171883 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:30:13.171883 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:30:13.172880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:14.529971 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.372 seconds
[0m15:30:14.554971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:30:14.563978 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:30:14.563978 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:30:14.564978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:15.520803 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.969 seconds
[0m15:30:15.536833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c251be9-6e37-43df-950e-615dc6bb4069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4A07CE30>]}
[0m15:30:15.536833 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:30:15.536833 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:30:15.536833 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:30:15.536833 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:30:15.552781 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:30:15.554898 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:30:15.585748 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:30:15.588748 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:30:15.588748 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue
)

SELECT * FROM crb
  );
[0m15:30:15.588748 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:30:16.541273 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff8-3201-7e56-000c-493e00024662
[0m15:30:16.541273 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[EXTRACT(year from T.PAYMENT_MONTH)] is not a valid group by expression
[0m15:30:16.541273 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [EXTRACT(year from T.PAYMENT_MONTH)] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:30:16.541273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c251be9-6e37-43df-950e-615dc6bb4069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E489E4740>]}
[0m15:30:16.541273 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.00s]
[0m15:30:16.541273 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:30:16.555137 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [EXTRACT(year from T.PAYMENT_MONTH)] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m15:30:16.555137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:16.555137 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:30:16.555137 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:30:16.876192 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:30:16.876192 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:30:17.218475 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:30:17.218475 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:30:17.556392 [info ] [MainThread]: 
[0m15:30:17.556392 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m15:30:17.563401 [debug] [MainThread]: Command end result
[0m15:30:17.585673 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:30:17.588671 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:30:17.590490 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:30:17.590490 [info ] [MainThread]: 
[0m15:30:17.590490 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:30:17.590490 [info ] [MainThread]: 
[0m15:30:17.590490 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [EXTRACT(year from T.PAYMENT_MONTH)] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:30:17.590490 [info ] [MainThread]: 
[0m15:30:17.590490 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:30:17.590490 [debug] [MainThread]: Command `dbt run` failed at 15:30:17.590490 after 6.01 seconds
[0m15:30:17.590490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E48F483E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E490482F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E49407710>]}
[0m15:30:17.601391 [debug] [MainThread]: Flushing usage events
[0m15:30:18.836305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:13.094622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650EA2C5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650EA2C2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650EA2DEE0>]}


============================== 15:31:13.094622 | a3b4c68b-b633-437a-a002-4b69685acc12 ==============================
[0m15:31:13.094622 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:31:13.094622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m crb_report', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:31:13.597769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3b4c68b-b633-437a-a002-4b69685acc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650BDCECC0>]}
[0m15:31:13.657983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3b4c68b-b633-437a-a002-4b69685acc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650DE09310>]}
[0m15:31:13.657983 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:31:14.156683 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:31:14.308536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:14.308536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:14.325408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:31:14.347245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3b4c68b-b633-437a-a002-4b69685acc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651084C530>]}
[0m15:31:14.427992 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:31:14.431243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:31:14.463991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3b4c68b-b633-437a-a002-4b69685acc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026510B9EA50>]}
[0m15:31:14.464371 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:31:14.465239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3b4c68b-b633-437a-a002-4b69685acc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026510820950>]}
[0m15:31:14.466363 [info ] [MainThread]: 
[0m15:31:14.467347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:31:14.467347 [info ] [MainThread]: 
[0m15:31:14.468386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:31:14.469381 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:31:14.569276 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:31:14.570275 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:31:14.570275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:15.987273 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.417 seconds
[0m15:31:15.990803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:31:15.990803 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:31:15.990803 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:31:15.990803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:16.958725 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.962 seconds
[0m15:31:16.979497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3b4c68b-b633-437a-a002-4b69685acc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265110321E0>]}
[0m15:31:16.984496 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:31:16.985495 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:31:16.986497 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:31:16.986497 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:31:16.994965 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:31:16.996003 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:31:17.015153 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:31:17.027176 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:31:17.029234 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        -- SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        -- SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        -- SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue
)

SELECT * FROM crb
  );
[0m15:31:17.029930 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:31:18.036763 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff9-3201-7db6-000c-493e00025486
[0m15:31:18.036763 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[SUM(T.REVENUE) OVER (PARTITION BY T.CUSTOMER_ID)] is not a valid group by expression
[0m15:31:18.040776 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [SUM(T.REVENUE) OVER (PARTITION BY T.CUSTOMER_ID)] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:31:18.042782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3b4c68b-b633-437a-a002-4b69685acc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026510FE5910>]}
[0m15:31:18.044898 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PROJECT_SCHEMA.crb_report ................. [[31mERROR[0m in 1.06s]
[0m15:31:18.045988 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:31:18.045988 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [SUM(T.REVENUE) OVER (PARTITION BY T.CUSTOMER_ID)] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m15:31:18.045988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:18.045988 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:31:18.045988 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:31:18.373196 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:31:18.373196 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:31:18.717165 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:31:18.717165 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:31:19.047119 [info ] [MainThread]: 
[0m15:31:19.047119 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m15:31:19.047119 [debug] [MainThread]: Command end result
[0m15:31:19.075371 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:31:19.082396 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:31:19.085357 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:31:19.085357 [info ] [MainThread]: 
[0m15:31:19.085357 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:31:19.085357 [info ] [MainThread]: 
[0m15:31:19.085357 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000979 (42601): SQL compilation error:
  [SUM(T.REVENUE) OVER (PARTITION BY T.CUSTOMER_ID)] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m15:31:19.085357 [info ] [MainThread]: 
[0m15:31:19.085357 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:31:19.085357 [debug] [MainThread]: Command `dbt run` failed at 15:31:19.085357 after 6.16 seconds
[0m15:31:19.085357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650E677530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650BEE9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650E6D2600>]}
[0m15:31:19.085357 [debug] [MainThread]: Flushing usage events
[0m15:31:19.980993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:43.593626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261377B7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261377B6960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261377B6240>]}


============================== 15:31:43.598657 | a29bf6df-be42-4868-83f9-71f741b9a780 ==============================
[0m15:31:43.598657 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:31:43.599627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m crb_report', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:31:44.087382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a29bf6df-be42-4868-83f9-71f741b9a780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026137B34B00>]}
[0m15:31:44.140014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a29bf6df-be42-4868-83f9-71f741b9a780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002613830C050>]}
[0m15:31:44.140014 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:31:44.618401 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:31:44.772132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:44.772132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:44.788573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:31:44.810455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a29bf6df-be42-4868-83f9-71f741b9a780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026139740800>]}
[0m15:31:44.892121 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:31:44.892121 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:31:44.931312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a29bf6df-be42-4868-83f9-71f741b9a780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026139ADBD10>]}
[0m15:31:44.932339 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:31:44.932339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a29bf6df-be42-4868-83f9-71f741b9a780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002613734F620>]}
[0m15:31:44.934335 [info ] [MainThread]: 
[0m15:31:44.934335 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:31:44.935311 [info ] [MainThread]: 
[0m15:31:44.936312 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:31:44.937294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:31:45.038940 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:31:45.038940 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:31:45.038940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:46.549883 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.521 seconds
[0m15:31:46.565833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:31:46.581618 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:31:46.581618 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:31:46.581618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:47.583572 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.007 seconds
[0m15:31:47.590929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a29bf6df-be42-4868-83f9-71f741b9a780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026139743290>]}
[0m15:31:47.590929 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:31:47.599225 [info ] [Thread-1 (]: 1 of 1 START sql view model PROJECT_SCHEMA.crb_report .......................... [RUN]
[0m15:31:47.599225 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:31:47.599225 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:31:47.599225 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:31:47.599225 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:31:47.641387 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:31:47.641387 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:31:47.641387 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace   view PROJECT_DB.PROJECT_SCHEMA.crb_report
  
   as (
    WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        -- SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        -- SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        -- SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        -- DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        -- DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue
)

SELECT * FROM crb
  );
[0m15:31:47.641387 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:31:48.747905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.100 seconds
[0m15:31:48.759259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a29bf6df-be42-4868-83f9-71f741b9a780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026134C918B0>]}
[0m15:31:48.774764 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PROJECT_SCHEMA.crb_report ..................... [[32mSUCCESS 1[0m in 1.16s]
[0m15:31:48.775886 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:31:48.775886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:48.775886 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:31:48.775886 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:31:49.088504 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:31:49.103119 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:31:49.444794 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:31:49.444794 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:31:49.781815 [info ] [MainThread]: 
[0m15:31:49.781815 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m15:31:49.781815 [debug] [MainThread]: Command end result
[0m15:31:49.804568 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:31:49.804568 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:31:49.816240 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:31:49.816240 [info ] [MainThread]: 
[0m15:31:49.818268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:31:49.818268 [info ] [MainThread]: 
[0m15:31:49.820279 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:31:49.820279 [debug] [MainThread]: Command `dbt run` succeeded at 15:31:49.820279 after 6.39 seconds
[0m15:31:49.820279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261372DF560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026135628530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002613568D400>]}
[0m15:31:49.820279 [debug] [MainThread]: Flushing usage events
[0m15:31:50.746170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:02.476407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F3F0D2D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F3C8199D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F3D149400>]}


============================== 15:33:02.476407 | 8fecae29-86da-4c11-8dd7-cce16d58b7ee ==============================
[0m15:33:02.476407 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:33:02.492097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m crb_report', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:33:02.978187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fecae29-86da-4c11-8dd7-cce16d58b7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F3C962960>]}
[0m15:33:03.033739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fecae29-86da-4c11-8dd7-cce16d58b7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F402CCCE0>]}
[0m15:33:03.033739 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:33:03.512211 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:33:03.667544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:03.667544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:03.684314 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:33:03.706721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fecae29-86da-4c11-8dd7-cce16d58b7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F413D7080>]}
[0m15:33:03.785395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:33:03.788427 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:33:03.815945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fecae29-86da-4c11-8dd7-cce16d58b7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F4158D610>]}
[0m15:33:03.815945 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:33:03.815945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fecae29-86da-4c11-8dd7-cce16d58b7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F402AB680>]}
[0m15:33:03.815945 [info ] [MainThread]: 
[0m15:33:03.815945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:03.815945 [info ] [MainThread]: 
[0m15:33:03.815945 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:03.815945 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:33:03.930223 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:33:03.930223 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:33:03.931221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:05.471806 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.541 seconds
[0m15:33:05.478800 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:33:05.478800 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:33:05.478800 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:33:05.478800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:06.474152 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.986 seconds
[0m15:33:06.474152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fecae29-86da-4c11-8dd7-cce16d58b7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F3C9F37A0>]}
[0m15:33:06.474152 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m15:33:06.474152 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.crb_report ......................... [RUN]
[0m15:33:06.474152 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m15:33:06.474152 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m15:33:06.489289 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m15:33:06.489289 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m15:33:06.511209 [debug] [Thread-1 (]:  adapter: Dropping relation "PROJECT_DB"."PROJECT_SCHEMA"."CRB_REPORT" because it is a view and target relation PROJECT_DB.PROJECT_SCHEMA.crb_report is of type table.
[0m15:33:06.522081 [debug] [Thread-1 (]: Applying DROP to: "PROJECT_DB"."PROJECT_SCHEMA"."CRB_REPORT"
[0m15:33:06.522081 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:33:06.522081 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
drop view if exists "PROJECT_DB"."PROJECT_SCHEMA"."CRB_REPORT" cascade
[0m15:33:06.522081 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:33:07.523601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.995 seconds
[0m15:33:07.554491 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m15:33:07.554491 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m15:33:07.554491 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.crb_report
         as
        (WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        -- SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        -- SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        -- SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        -- DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        -- DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue
)

SELECT * FROM crb
        );
[0m15:33:08.866835 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.305 seconds
[0m15:33:08.882928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fecae29-86da-4c11-8dd7-cce16d58b7ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F3C961910>]}
[0m15:33:08.882928 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.crb_report .................... [[32mSUCCESS 1[0m in 2.41s]
[0m15:33:08.882928 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m15:33:08.882928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:08.882928 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:33:08.882928 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:33:09.219063 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:33:09.236091 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:33:09.556872 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m15:33:09.556872 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m15:33:09.890898 [info ] [MainThread]: 
[0m15:33:09.890898 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m15:33:09.890898 [debug] [MainThread]: Command end result
[0m15:33:09.912514 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:33:09.912514 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:33:09.923937 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:33:09.923937 [info ] [MainThread]: 
[0m15:33:09.924935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:09.925964 [info ] [MainThread]: 
[0m15:33:09.926971 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:33:09.927971 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:09.927971 after 7.61 seconds
[0m15:33:09.927971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F3F0FF380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F3E988380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010F41357F20>]}
[0m15:33:09.928996 [debug] [MainThread]: Flushing usage events
[0m15:33:11.192509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:43:22.439924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DCF0B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DCF0A420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DB42E7B0>]}


============================== 15:43:22.439924 | 95e3084e-b4d7-47c4-b37a-42253813d709 ==============================
[0m15:43:22.439924 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:43:22.455692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile -m mart_fiscal_year', 'send_anonymous_usage_stats': 'True'}
[0m15:43:23.410937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95e3084e-b4d7-47c4-b37a-42253813d709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DF437410>]}
[0m15:43:23.478581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95e3084e-b4d7-47c4-b37a-42253813d709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DC71F980>]}
[0m15:43:23.478581 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:43:24.071340 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:43:24.215540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:43:24.215540 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:43:24.231477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:43:24.253058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95e3084e-b4d7-47c4-b37a-42253813d709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DF4FFC50>]}
[0m15:43:24.318476 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:43:24.340376 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:43:24.374661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95e3084e-b4d7-47c4-b37a-42253813d709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DF865EE0>]}
[0m15:43:24.374661 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m15:43:24.375627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e3084e-b4d7-47c4-b37a-42253813d709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DE09F620>]}
[0m15:43:24.376670 [info ] [MainThread]: 
[0m15:43:24.377667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:43:24.378634 [info ] [MainThread]: 
[0m15:43:24.378634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:43:24.384596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:43:27.389356 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:43:27.389356 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:43:27.389356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:28.880454 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.494 seconds
[0m15:43:28.880454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e3084e-b4d7-47c4-b37a-42253813d709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DD666750>]}
[0m15:43:28.880454 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_fiscal_year
[0m15:43:28.880454 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_fiscal_year'
[0m15:43:28.880454 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_fiscal_year
[0m15:43:28.896210 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_fiscal_year"
[0m15:43:28.896210 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_fiscal_year
[0m15:43:28.896210 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_fiscal_year
[0m15:43:28.896210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:28.896210 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:43:28.896210 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:43:29.221587 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_fiscal_year' was properly closed.
[0m15:43:29.221587 [debug] [MainThread]: Command end result
[0m15:43:29.253796 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:43:29.253796 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:43:29.253796 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:43:29.253796 [info ] [MainThread]: Compiled node 'mart_fiscal_year' is:
WITH newlogos AS (
    SELECT 
        EXTRACT(YEAR FROM TO_DATE(payment_month,'YYYY-MM-DD')) AS fiscal_year,
        COUNT(DISTINCT customer_id) AS new_logos 
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions 
)
SELECT * FROM newlogos GROUP BY fiscal_year ORDER BY fiscal_year
[0m15:43:29.268478 [debug] [MainThread]: Command `dbt compile` succeeded at 15:43:29.268478 after 7.09 seconds
[0m15:43:29.268478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DCF0B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DC4DFA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5DA023170>]}
[0m15:43:29.268478 [debug] [MainThread]: Flushing usage events
[0m15:43:30.499405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:43:41.475391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B495C90200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B495477260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B495C908C0>]}


============================== 15:43:41.475391 | e4826f41-4a4f-4d02-a132-01071e38e502 ==============================
[0m15:43:41.475391 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:43:41.475391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_fiscal_year', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:43:41.965019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4826f41-4a4f-4d02-a132-01071e38e502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B496665F70>]}
[0m15:43:42.027892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4826f41-4a4f-4d02-a132-01071e38e502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B495640740>]}
[0m15:43:42.028892 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:43:42.500757 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:43:42.648334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:43:42.648334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:43:42.648334 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:43:42.687564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4826f41-4a4f-4d02-a132-01071e38e502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B497AEC500>]}
[0m15:43:42.753282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:43:42.753282 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:43:42.793718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4826f41-4a4f-4d02-a132-01071e38e502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B497C73350>]}
[0m15:43:42.793718 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m15:43:42.793718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4826f41-4a4f-4d02-a132-01071e38e502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4969A60C0>]}
[0m15:43:42.793718 [info ] [MainThread]: 
[0m15:43:42.793718 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:43:42.793718 [info ] [MainThread]: 
[0m15:43:42.793718 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:43:42.801138 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:43:42.904423 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:43:42.904423 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:43:42.904423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:44.317044 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.418 seconds
[0m15:43:44.317044 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:43:44.337379 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:43:44.337379 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:43:44.337379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:45.319069 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.980 seconds
[0m15:43:45.319069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4826f41-4a4f-4d02-a132-01071e38e502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B497C9BE00>]}
[0m15:43:45.319069 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_fiscal_year
[0m15:43:45.319069 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_fiscal_year ................... [RUN]
[0m15:43:45.319069 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_fiscal_year'
[0m15:43:45.319069 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_fiscal_year
[0m15:43:45.336923 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_fiscal_year"
[0m15:43:45.338744 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_fiscal_year
[0m15:43:45.356351 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_fiscal_year"
[0m15:43:45.356351 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_fiscal_year"
[0m15:43:45.356351 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_fiscal_year: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_fiscal_year"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_fiscal_year
         as
        (WITH newlogos AS (
    SELECT 
        EXTRACT(YEAR FROM TO_DATE(payment_month,'YYYY-MM-DD')) AS fiscal_year,
        COUNT(DISTINCT customer_id) AS new_logos 
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions 
)
SELECT * FROM newlogos GROUP BY fiscal_year ORDER BY fiscal_year
        );
[0m15:43:45.356351 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:43:46.463337 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0005-3201-7eb6-000c-493e000270ce
[0m15:43:46.463337 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 5 at position 26
too many arguments for function [TO_DATE(STG_TRANSACTIONS.PAYMENT_MONTH, 'YYYY-MM-DD')] expected 1, got 2
[0m15:43:46.479499 [debug] [Thread-1 (]: Database Error in model mart_fiscal_year (models\mart\mart_fiscal_year.sql)
  000939 (22023): SQL compilation error: error line 5 at position 26
  too many arguments for function [TO_DATE(STG_TRANSACTIONS.PAYMENT_MONTH, 'YYYY-MM-DD')] expected 1, got 2
  compiled code at target\run\CRB_PROJECT\models\mart\mart_fiscal_year.sql
[0m15:43:46.479499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4826f41-4a4f-4d02-a132-01071e38e502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4983F7BF0>]}
[0m15:43:46.479499 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_fiscal_year .......... [[31mERROR[0m in 1.16s]
[0m15:43:46.479499 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_fiscal_year
[0m15:43:46.479499 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_fiscal_year' to be skipped because of status 'error'.  Reason: Database Error in model mart_fiscal_year (models\mart\mart_fiscal_year.sql)
  000939 (22023): SQL compilation error: error line 5 at position 26
  too many arguments for function [TO_DATE(STG_TRANSACTIONS.PAYMENT_MONTH, 'YYYY-MM-DD')] expected 1, got 2
  compiled code at target\run\CRB_PROJECT\models\mart\mart_fiscal_year.sql.
[0m15:43:46.479499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:46.479499 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:43:46.479499 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:43:46.807425 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:43:46.807425 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:43:47.131462 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_fiscal_year' was left open.
[0m15:43:47.131462 [debug] [MainThread]: On model.CRB_PROJECT.mart_fiscal_year: Close
[0m15:43:47.453479 [info ] [MainThread]: 
[0m15:43:47.469252 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m15:43:47.471492 [debug] [MainThread]: Command end result
[0m15:43:47.508301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:43:47.508301 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:43:47.520514 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:43:47.520514 [info ] [MainThread]: 
[0m15:43:47.520514 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:43:47.520514 [info ] [MainThread]: 
[0m15:43:47.523332 [error] [MainThread]:   Database Error in model mart_fiscal_year (models\mart\mart_fiscal_year.sql)
  000939 (22023): SQL compilation error: error line 5 at position 26
  too many arguments for function [TO_DATE(STG_TRANSACTIONS.PAYMENT_MONTH, 'YYYY-MM-DD')] expected 1, got 2
  compiled code at target\run\CRB_PROJECT\models\mart\mart_fiscal_year.sql
[0m15:43:47.524213 [info ] [MainThread]: 
[0m15:43:47.524867 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:43:47.524867 [debug] [MainThread]: Command `dbt run` failed at 15:43:47.524867 after 6.20 seconds
[0m15:43:47.524867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B497CD5DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B493A2E630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B493A2E6C0>]}
[0m15:43:47.524867 [debug] [MainThread]: Flushing usage events
[0m15:43:48.400458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:03.324291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A02E2DD3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A02E2DF200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A02E2DE600>]}


============================== 15:44:03.324291 | b823c92d-d7d0-432d-a9a7-ef7e110229b8 ==============================
[0m15:44:03.324291 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:44:03.324291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_fiscal_year', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:03.808069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b823c92d-d7d0-432d-a9a7-ef7e110229b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A02F409790>]}
[0m15:44:03.874297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b823c92d-d7d0-432d-a9a7-ef7e110229b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A02F49FB60>]}
[0m15:44:03.874297 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:44:04.359765 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:44:04.526862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:04.526862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:04.526862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:44:04.567366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b823c92d-d7d0-432d-a9a7-ef7e110229b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A02F502F00>]}
[0m15:44:04.641334 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:44:04.641334 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:44:04.679109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b823c92d-d7d0-432d-a9a7-ef7e110229b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A030927830>]}
[0m15:44:04.682719 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m15:44:04.682719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b823c92d-d7d0-432d-a9a7-ef7e110229b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0305DABD0>]}
[0m15:44:04.682719 [info ] [MainThread]: 
[0m15:44:04.682719 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:44:04.682719 [info ] [MainThread]: 
[0m15:44:04.682719 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:44:04.682719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:44:04.798615 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:44:04.798615 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:44:04.798615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:06.143858 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.345 seconds
[0m15:44:06.149669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:44:06.165817 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:44:06.165817 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:44:06.165817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:07.147891 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.984 seconds
[0m15:44:07.147891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b823c92d-d7d0-432d-a9a7-ef7e110229b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A030D831D0>]}
[0m15:44:07.147891 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_fiscal_year
[0m15:44:07.147891 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_fiscal_year ................... [RUN]
[0m15:44:07.163683 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_fiscal_year'
[0m15:44:07.163683 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_fiscal_year
[0m15:44:07.169700 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_fiscal_year"
[0m15:44:07.171706 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_fiscal_year
[0m15:44:07.197390 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_fiscal_year"
[0m15:44:07.197390 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_fiscal_year"
[0m15:44:07.197390 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_fiscal_year: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_fiscal_year"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_fiscal_year
         as
        (WITH newlogos AS (
    SELECT 
        EXTRACT(YEAR FROM TO_DATE(payment_month)) AS fiscal_year,
        COUNT(DISTINCT customer_id) AS new_logos 
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions 
)
SELECT * FROM newlogos GROUP BY fiscal_year ORDER BY fiscal_year
        );
[0m15:44:07.197390 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:44:08.150533 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0006-3201-7e56-000c-493e00024692
[0m15:44:08.150533 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[STG_TRANSACTIONS.PAYMENT_MONTH] is not a valid group by expression
[0m15:44:08.166511 [debug] [Thread-1 (]: Database Error in model mart_fiscal_year (models\mart\mart_fiscal_year.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTIONS.PAYMENT_MONTH] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_fiscal_year.sql
[0m15:44:08.166511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b823c92d-d7d0-432d-a9a7-ef7e110229b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A030EEEDE0>]}
[0m15:44:08.166511 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_fiscal_year .......... [[31mERROR[0m in 1.00s]
[0m15:44:08.166511 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_fiscal_year
[0m15:44:08.166511 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_fiscal_year' to be skipped because of status 'error'.  Reason: Database Error in model mart_fiscal_year (models\mart\mart_fiscal_year.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTIONS.PAYMENT_MONTH] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_fiscal_year.sql.
[0m15:44:08.166511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:08.166511 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:44:08.166511 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:44:08.505803 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:44:08.505803 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:44:08.844258 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_fiscal_year' was left open.
[0m15:44:08.844258 [debug] [MainThread]: On model.CRB_PROJECT.mart_fiscal_year: Close
[0m15:44:09.170024 [info ] [MainThread]: 
[0m15:44:09.170024 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m15:44:09.170024 [debug] [MainThread]: Command end result
[0m15:44:09.214135 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:44:09.214135 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:44:09.222617 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:44:09.222617 [info ] [MainThread]: 
[0m15:44:09.222617 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:44:09.222617 [info ] [MainThread]: 
[0m15:44:09.222617 [error] [MainThread]:   Database Error in model mart_fiscal_year (models\mart\mart_fiscal_year.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTIONS.PAYMENT_MONTH] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_fiscal_year.sql
[0m15:44:09.222617 [info ] [MainThread]: 
[0m15:44:09.222617 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:44:09.222617 [debug] [MainThread]: Command `dbt run` failed at 15:44:09.222617 after 6.06 seconds
[0m15:44:09.222617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A02F17B380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A02F44CBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A02E2AA660>]}
[0m15:44:09.222617 [debug] [MainThread]: Flushing usage events
[0m15:44:10.124205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:20.329685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B72D4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B706A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B72D46B0>]}


============================== 15:45:20.329685 | d1c8a6cd-46a4-4c8b-9085-2ab3ccbb9604 ==============================
[0m15:45:20.329685 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:45:20.329685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_fiscal_year', 'send_anonymous_usage_stats': 'True'}
[0m15:45:20.816056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1c8a6cd-46a4-4c8b-9085-2ab3ccbb9604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B7F39790>]}
[0m15:45:20.885390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1c8a6cd-46a4-4c8b-9085-2ab3ccbb9604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B7C8FC20>]}
[0m15:45:20.887395 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:45:21.367049 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:45:21.526755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:45:21.526755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:45:21.532772 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:45:21.560731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1c8a6cd-46a4-4c8b-9085-2ab3ccbb9604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B7F3BE60>]}
[0m15:45:21.618991 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:45:21.635103 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:45:21.666550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1c8a6cd-46a4-4c8b-9085-2ab3ccbb9604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B946FEC0>]}
[0m15:45:21.666550 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m15:45:21.668883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1c8a6cd-46a4-4c8b-9085-2ab3ccbb9604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B9117EC0>]}
[0m15:45:21.668883 [info ] [MainThread]: 
[0m15:45:21.670889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:21.670889 [info ] [MainThread]: 
[0m15:45:21.670889 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:21.670889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:45:21.779259 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:45:21.779259 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:45:21.779259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:23.205368 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.440 seconds
[0m15:45:23.230634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:45:23.241145 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:45:23.241145 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:45:23.241145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:24.223787 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.992 seconds
[0m15:45:24.239688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1c8a6cd-46a4-4c8b-9085-2ab3ccbb9604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B94DF9E0>]}
[0m15:45:24.255875 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_fiscal_year
[0m15:45:24.255875 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_fiscal_year ................... [RUN]
[0m15:45:24.255875 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_fiscal_year'
[0m15:45:24.255875 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_fiscal_year
[0m15:45:24.271729 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_fiscal_year"
[0m15:45:24.288586 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_fiscal_year
[0m15:45:24.321557 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_fiscal_year"
[0m15:45:24.323555 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_fiscal_year"
[0m15:45:24.323555 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_fiscal_year: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_fiscal_year"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_fiscal_year
         as
        (WITH newlogos AS (
    SELECT 
        EXTRACT(YEAR FROM TO_DATE(payment_month)) AS fiscal_year,
        COUNT(DISTINCT customer_id) AS new_logos 
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY fiscal_year
)
SELECT * FROM newlogos 
ORDER BY fiscal_year;
[0m15:45:24.324555 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:25.259345 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0007-3201-7e56-000c-493e00024696
[0m15:45:25.259345 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 20 unexpected ';'.
[0m15:45:25.259345 [debug] [Thread-1 (]: Database Error in model mart_fiscal_year (models\mart\mart_fiscal_year.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 20 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_fiscal_year.sql
[0m15:45:25.259345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c8a6cd-46a4-4c8b-9085-2ab3ccbb9604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B67A4950>]}
[0m15:45:25.259345 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_fiscal_year .......... [[31mERROR[0m in 1.00s]
[0m15:45:25.259345 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_fiscal_year
[0m15:45:25.259345 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_fiscal_year' to be skipped because of status 'error'.  Reason: Database Error in model mart_fiscal_year (models\mart\mart_fiscal_year.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 20 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_fiscal_year.sql.
[0m15:45:25.259345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:25.259345 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:45:25.274988 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:45:25.587915 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:45:25.587915 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:45:25.919163 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_fiscal_year' was left open.
[0m15:45:25.919163 [debug] [MainThread]: On model.CRB_PROJECT.mart_fiscal_year: Close
[0m15:45:26.233335 [info ] [MainThread]: 
[0m15:45:26.233335 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m15:45:26.233335 [debug] [MainThread]: Command end result
[0m15:45:26.257262 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:45:26.257262 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:45:26.278875 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:45:26.278875 [info ] [MainThread]: 
[0m15:45:26.278875 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:45:26.280933 [info ] [MainThread]: 
[0m15:45:26.280933 [error] [MainThread]:   Database Error in model mart_fiscal_year (models\mart\mart_fiscal_year.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 20 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_fiscal_year.sql
[0m15:45:26.280933 [info ] [MainThread]: 
[0m15:45:26.280933 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:45:26.280933 [debug] [MainThread]: Command `dbt run` failed at 15:45:26.280933 after 6.12 seconds
[0m15:45:26.280933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B9377590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B7B5B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0B7E4CFB0>]}
[0m15:45:26.280933 [debug] [MainThread]: Flushing usage events
[0m15:45:27.555399 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:34.947565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022338F004D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022338F01D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022338F036B0>]}


============================== 15:45:34.947565 | bd2c0099-40ee-449a-b376-8e1052929980 ==============================
[0m15:45:34.947565 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:45:34.947565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_fiscal_year', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:45:35.430700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd2c0099-40ee-449a-b376-8e1052929980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223390A77A0>]}
[0m15:45:35.494275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd2c0099-40ee-449a-b376-8e1052929980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022339C27CE0>]}
[0m15:45:35.494275 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:45:35.968590 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:45:36.122881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:45:36.122881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:45:36.127886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:45:36.154133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd2c0099-40ee-449a-b376-8e1052929980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022339CAF350>]}
[0m15:45:36.216411 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:45:36.216411 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:45:36.249132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd2c0099-40ee-449a-b376-8e1052929980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233B0DBFE0>]}
[0m15:45:36.263884 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m15:45:36.263884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd2c0099-40ee-449a-b376-8e1052929980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022338ED49E0>]}
[0m15:45:36.263884 [info ] [MainThread]: 
[0m15:45:36.263884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:36.263884 [info ] [MainThread]: 
[0m15:45:36.263884 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:45:36.263884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:45:36.373284 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:45:36.373284 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:45:36.374287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:37.425498 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.057 seconds
[0m15:45:37.441219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:45:37.451654 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:45:37.451654 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:45:37.451654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:38.834973 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.378 seconds
[0m15:45:38.836983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd2c0099-40ee-449a-b376-8e1052929980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233B4788C0>]}
[0m15:45:38.836983 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_fiscal_year
[0m15:45:38.836983 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_fiscal_year ................... [RUN]
[0m15:45:38.836983 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_fiscal_year'
[0m15:45:38.836983 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_fiscal_year
[0m15:45:38.849040 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_fiscal_year"
[0m15:45:38.854100 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_fiscal_year
[0m15:45:38.871853 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_fiscal_year"
[0m15:45:38.885780 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_fiscal_year"
[0m15:45:38.885780 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_fiscal_year: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_fiscal_year"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_fiscal_year
         as
        (WITH newlogos AS (
    SELECT 
        EXTRACT(YEAR FROM TO_DATE(payment_month)) AS fiscal_year,
        COUNT(DISTINCT customer_id) AS new_logos 
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY fiscal_year
)
SELECT * FROM newlogos 
ORDER BY fiscal_year
        );
[0m15:45:38.885780 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:40.774617 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.894 seconds
[0m15:45:40.790363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd2c0099-40ee-449a-b376-8e1052929980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223362B18E0>]}
[0m15:45:40.790363 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_fiscal_year .............. [[32mSUCCESS 1[0m in 1.95s]
[0m15:45:40.790363 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_fiscal_year
[0m15:45:40.806042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:40.806042 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:45:40.806042 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:45:41.131332 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:45:41.131332 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:45:41.470043 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_fiscal_year' was left open.
[0m15:45:41.470043 [debug] [MainThread]: On model.CRB_PROJECT.mart_fiscal_year: Close
[0m15:45:41.792438 [info ] [MainThread]: 
[0m15:45:41.792438 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m15:45:41.792438 [debug] [MainThread]: Command end result
[0m15:45:41.823251 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:45:41.825678 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:45:41.829645 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:45:41.829645 [info ] [MainThread]: 
[0m15:45:41.829645 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:45:41.829645 [info ] [MainThread]: 
[0m15:45:41.829645 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:45:41.829645 [debug] [MainThread]: Command `dbt run` succeeded at 15:45:41.829645 after 7.04 seconds
[0m15:45:41.829645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022338D031A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022336CAE690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233990FD40>]}
[0m15:45:41.829645 [debug] [MainThread]: Flushing usage events
[0m15:45:42.716059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:12.694131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCB08D040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCB08FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCB08C3B0>]}


============================== 15:49:12.694131 | 887dc715-281e-469e-a2f3-244dd1fdf047 ==============================
[0m15:49:12.694131 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:49:12.694131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_new_and_churned_customers.sql', 'send_anonymous_usage_stats': 'True'}
[0m15:49:13.195156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '887dc715-281e-469e-a2f3-244dd1fdf047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCB08E780>]}
[0m15:49:13.258351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '887dc715-281e-469e-a2f3-244dd1fdf047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCB0AE300>]}
[0m15:49:13.258351 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:49:13.750309 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:49:13.912507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:49:13.912507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:49:13.912507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:49:13.950319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '887dc715-281e-469e-a2f3-244dd1fdf047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCBCD9730>]}
[0m15:49:14.015749 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:49:14.015749 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:49:14.057966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '887dc715-281e-469e-a2f3-244dd1fdf047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCD1FEDE0>]}
[0m15:49:14.057966 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m15:49:14.057966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '887dc715-281e-469e-a2f3-244dd1fdf047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCAF2C860>]}
[0m15:49:14.062995 [info ] [MainThread]: 
[0m15:49:14.062995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:14.062995 [info ] [MainThread]: 
[0m15:49:14.062995 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:49:14.062995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:49:14.170425 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:49:14.171426 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:49:14.171426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:15.514291 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.356 seconds
[0m15:49:15.534029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:49:15.534029 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:49:15.534029 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:49:15.534029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:16.503864 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.967 seconds
[0m15:49:16.512580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '887dc715-281e-469e-a2f3-244dd1fdf047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCD1FC890>]}
[0m15:49:16.520484 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:49:16.520484 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m15:49:16.521510 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m15:49:16.522516 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:49:16.529516 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:49:16.530485 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:49:16.557601 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:49:16.557601 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:49:16.557601 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (WITH purchases AS (
    SELECT customer_id,
    MIN(payment_month) AS first_purchase_month,
    MAX(payment_month) AS last_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
)
SELECT
    EXTRACT(YEAR FROM TO_DATE(t.payment_month)) AS Payment_Month,
    COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
    COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
FROM stg_transactions t
LEFT JOIN purchases p ON t.customer_id = p.customer_id
GROUP BY t.payment_month
ORDER BY t.payment_month
        );
[0m15:49:16.557601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:18.871241 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.307 seconds
[0m15:49:18.893325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '887dc715-281e-469e-a2f3-244dd1fdf047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BC8441850>]}
[0m15:49:18.895072 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[32mSUCCESS 1[0m in 2.37s]
[0m15:49:18.895072 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:49:18.895072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:18.895072 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:49:18.895072 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:49:19.219631 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:49:19.223326 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:49:19.558818 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m15:49:19.560844 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m15:49:19.886360 [info ] [MainThread]: 
[0m15:49:19.886360 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m15:49:19.898277 [debug] [MainThread]: Command end result
[0m15:49:19.921834 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:49:19.923843 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:49:19.926842 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:49:19.926842 [info ] [MainThread]: 
[0m15:49:19.926842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:19.926842 [info ] [MainThread]: 
[0m15:49:19.926842 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:49:19.926842 [debug] [MainThread]: Command `dbt run` succeeded at 15:49:19.926842 after 7.40 seconds
[0m15:49:19.926842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCAF5AA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCA5D9C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BCA5DBDA0>]}
[0m15:49:19.926842 [debug] [MainThread]: Flushing usage events
[0m15:49:21.162149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:23.080611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3B946CD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3B6711820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3B82959A0>]}


============================== 15:52:23.094092 | 9df718a2-8ded-46e8-8980-14c5e87cf059 ==============================
[0m15:52:23.094092 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:52:23.094092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_new_and_churned_customers.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:23.578701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9df718a2-8ded-46e8-8980-14c5e87cf059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3BA0A9790>]}
[0m15:52:23.642259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9df718a2-8ded-46e8-8980-14c5e87cf059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3BA127C20>]}
[0m15:52:23.642259 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:52:24.126874 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:52:24.269826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:24.269826 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:24.285700 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:52:24.306523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9df718a2-8ded-46e8-8980-14c5e87cf059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3BB3F76E0>]}
[0m15:52:24.389008 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:52:24.393020 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:52:24.425050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9df718a2-8ded-46e8-8980-14c5e87cf059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3B7126E40>]}
[0m15:52:24.425050 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m15:52:24.426030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9df718a2-8ded-46e8-8980-14c5e87cf059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3B9018950>]}
[0m15:52:24.428068 [info ] [MainThread]: 
[0m15:52:24.428068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:52:24.429058 [info ] [MainThread]: 
[0m15:52:24.430068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:52:24.430847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:52:24.523060 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:52:24.523060 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:52:24.523060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:25.924055 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.396 seconds
[0m15:52:25.924055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:52:25.939217 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:52:25.939217 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:52:25.939217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:26.962005 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.019 seconds
[0m15:52:26.969210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9df718a2-8ded-46e8-8980-14c5e87cf059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3BB5D6D80>]}
[0m15:52:26.971751 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:52:26.971751 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m15:52:26.977858 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m15:52:26.977858 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:52:26.981105 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:52:26.981105 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:52:27.018039 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:52:27.020045 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:52:27.022050 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (WITH purchases AS (
    SELECT customer_id,
    MIN(payment_month) AS first_purchase_month,
    MAX(payment_month) AS last_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
)
SELECT
    EXTRACT(MONTH,YEAR FROM TO_DATE(t.payment_month)) AS Payment_Month,
    COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
    COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
FROM stg_transactions t
LEFT JOIN purchases p ON t.customer_id = p.customer_id
GROUP BY t.payment_month
ORDER BY t.payment_month
        );
[0m15:52:27.022050 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:52:28.013347 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb000e-3201-7e57-000c-493e000264a2
[0m15:52:28.013347 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 23 unexpected 'FROM'.
syntax error line 11 at position 35 unexpected '('.
syntax error line 11 at position 52 unexpected ')'.
[0m15:52:28.013347 [debug] [Thread-1 (]: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 23 unexpected 'FROM'.
  syntax error line 11 at position 35 unexpected '('.
  syntax error line 11 at position 52 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m15:52:28.029024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9df718a2-8ded-46e8-8980-14c5e87cf059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3BBBCEDE0>]}
[0m15:52:28.029024 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[31mERROR[0m in 1.05s]
[0m15:52:28.029024 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:52:28.029024 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_new_and_churned_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 23 unexpected 'FROM'.
  syntax error line 11 at position 35 unexpected '('.
  syntax error line 11 at position 52 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql.
[0m15:52:28.029024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:28.029024 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:52:28.029024 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:52:28.353238 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:52:28.353238 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:52:28.693845 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m15:52:28.693845 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m15:52:29.032800 [info ] [MainThread]: 
[0m15:52:29.032800 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m15:52:29.032800 [debug] [MainThread]: Command end result
[0m15:52:29.063613 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:52:29.065356 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:52:29.065356 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:52:29.065356 [info ] [MainThread]: 
[0m15:52:29.065356 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:52:29.065356 [info ] [MainThread]: 
[0m15:52:29.065356 [error] [MainThread]:   Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 23 unexpected 'FROM'.
  syntax error line 11 at position 35 unexpected '('.
  syntax error line 11 at position 52 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m15:52:29.065356 [info ] [MainThread]: 
[0m15:52:29.076783 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:52:29.078800 [debug] [MainThread]: Command `dbt run` failed at 15:52:29.078800 after 6.16 seconds
[0m15:52:29.079747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3B840F380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3B8DF2DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3B8DF3860>]}
[0m15:52:29.079747 [debug] [MainThread]: Flushing usage events
[0m15:52:30.310932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:55.156030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E31184050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E31184B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E31184800>]}


============================== 15:52:55.156030 | 49190e9b-5220-4c36-b199-21f09322611c ==============================
[0m15:52:55.156030 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:52:55.156030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_new_and_churned_customers.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:55.642254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49190e9b-5220-4c36-b199-21f09322611c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E31EB20F0>]}
[0m15:52:55.703810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49190e9b-5220-4c36-b199-21f09322611c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E30848DA0>]}
[0m15:52:55.703810 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:52:56.176201 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:52:56.337678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:56.337678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:56.337678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:52:56.375580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49190e9b-5220-4c36-b199-21f09322611c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E32F0A630>]}
[0m15:52:56.446664 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:52:56.450664 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:52:56.481821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49190e9b-5220-4c36-b199-21f09322611c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3330FB00>]}
[0m15:52:56.482822 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m15:52:56.483820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49190e9b-5220-4c36-b199-21f09322611c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E33307860>]}
[0m15:52:56.484847 [info ] [MainThread]: 
[0m15:52:56.485846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:52:56.486821 [info ] [MainThread]: 
[0m15:52:56.487401 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:52:56.487401 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:52:56.588057 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:52:56.588057 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:52:56.588057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:57.950849 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.361 seconds
[0m15:52:57.956603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:52:57.968383 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:52:57.968383 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:52:57.968383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:58.929110 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.969 seconds
[0m15:52:58.929110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49190e9b-5220-4c36-b199-21f09322611c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E311CA2A0>]}
[0m15:52:58.945177 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:52:58.945177 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m15:52:58.945177 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m15:52:58.945177 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:52:58.951776 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:52:58.951776 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:52:58.990509 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:52:58.990509 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:52:58.990509 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (WITH purchases AS (
    SELECT customer_id,
    MIN(payment_month) AS first_purchase_month,
    MAX(payment_month) AS last_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
)
SELECT
    EXTRACT(MONTH FROM TO_DATE(t.payment_month)) AS Payment_Month,
    COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
    COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
FROM stg_transactions t
LEFT JOIN purchases p ON t.customer_id = p.customer_id
GROUP BY t.payment_month
ORDER BY t.payment_month
        );
[0m15:52:58.990509 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:53:00.632072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.638 seconds
[0m15:53:00.655907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49190e9b-5220-4c36-b199-21f09322611c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2E551700>]}
[0m15:53:00.655907 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[32mSUCCESS 1[0m in 1.71s]
[0m15:53:00.655907 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:53:00.655907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:00.655907 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:53:00.655907 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:53:00.990032 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:53:00.990032 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:53:01.310487 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m15:53:01.310487 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m15:53:01.643474 [info ] [MainThread]: 
[0m15:53:01.643474 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m15:53:01.643474 [debug] [MainThread]: Command end result
[0m15:53:01.665097 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:53:01.665097 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:53:01.680873 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:53:01.681335 [info ] [MainThread]: 
[0m15:53:01.681942 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:01.682860 [info ] [MainThread]: 
[0m15:53:01.683930 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:53:01.684890 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:01.684890 after 6.69 seconds
[0m15:53:01.685932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E30B79100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E31D9B230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E31167350>]}
[0m15:53:01.685932 [debug] [MainThread]: Flushing usage events
[0m15:53:02.594070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:03.267212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B094051820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0961D3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0961D33B0>]}


============================== 15:54:03.267212 | 03533257-ab9d-4b71-9f19-0fcf727fe1e9 ==============================
[0m15:54:03.267212 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:54:03.267212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_new_and_churned_customers.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:54:03.777045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03533257-ab9d-4b71-9f19-0fcf727fe1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B097A39790>]}
[0m15:54:03.838245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03533257-ab9d-4b71-9f19-0fcf727fe1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B097B004A0>]}
[0m15:54:03.838245 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:54:04.321132 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:54:04.472246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:54:04.472246 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:54:04.488933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m15:54:04.521737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03533257-ab9d-4b71-9f19-0fcf727fe1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B097B32060>]}
[0m15:54:04.588573 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:54:04.594123 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:54:04.625486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03533257-ab9d-4b71-9f19-0fcf727fe1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B098F560C0>]}
[0m15:54:04.625486 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m15:54:04.625486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03533257-ab9d-4b71-9f19-0fcf727fe1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B098C09DF0>]}
[0m15:54:04.630346 [info ] [MainThread]: 
[0m15:54:04.630346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:54:04.630346 [info ] [MainThread]: 
[0m15:54:04.630346 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:54:04.630346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m15:54:04.737174 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m15:54:04.738209 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m15:54:04.738209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:06.141622 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.404 seconds
[0m15:54:06.143631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m15:54:06.153406 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m15:54:06.153406 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m15:54:06.153406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:07.134710 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.988 seconds
[0m15:54:07.150894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03533257-ab9d-4b71-9f19-0fcf727fe1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B096DC6E40>]}
[0m15:54:07.150894 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:54:07.166534 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m15:54:07.166534 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m15:54:07.166534 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:54:07.166534 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:54:07.166534 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:54:07.210161 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:54:07.210161 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m15:54:07.210161 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (WITH purchases AS (
    SELECT customer_id,
    MIN(payment_month) AS first_purchase_month,
    MAX(payment_month) AS last_purchase_month
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY customer_id
)
SELECT
    t.payment_month,
    COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
    COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
FROM stg_transactions t
LEFT JOIN purchases p ON t.customer_id = p.customer_id
GROUP BY t.payment_month
ORDER BY t.payment_month
        );
[0m15:54:07.210161 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:54:08.639781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.430 seconds
[0m15:54:08.655591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03533257-ab9d-4b71-9f19-0fcf727fe1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0962247D0>]}
[0m15:54:08.655591 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[32mSUCCESS 1[0m in 1.49s]
[0m15:54:08.671354 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m15:54:08.671354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:08.671354 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m15:54:08.671354 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m15:54:08.987970 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m15:54:08.987970 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m15:54:09.327405 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m15:54:09.327405 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m15:54:09.662290 [info ] [MainThread]: 
[0m15:54:09.662290 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m15:54:09.677171 [debug] [MainThread]: Command end result
[0m15:54:09.703226 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m15:54:09.705207 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m15:54:09.712053 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m15:54:09.713165 [info ] [MainThread]: 
[0m15:54:09.714179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:54:09.715179 [info ] [MainThread]: 
[0m15:54:09.715827 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:54:09.716303 [debug] [MainThread]: Command `dbt run` succeeded at 15:54:09.716303 after 6.61 seconds
[0m15:54:09.716303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0968BD6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0968BE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0968BF800>]}
[0m15:54:09.716303 [debug] [MainThread]: Flushing usage events
[0m15:54:10.629841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:19.296630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001671826D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016717F43860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001671826FB30>]}


============================== 16:24:19.296630 | 1b2c3422-6921-471a-9b20-89a6f950cdaa ==============================
[0m16:24:19.296630 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:24:19.311625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'send_anonymous_usage_stats': 'True'}
[0m16:24:20.984899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b2c3422-6921-471a-9b20-89a6f950cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016718E2B1D0>]}
[0m16:24:21.050630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b2c3422-6921-471a-9b20-89a6f950cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016718CD89B0>]}
[0m16:24:21.051557 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:24:21.681048 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:24:21.847875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:21.847875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:21.847875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:24:21.894961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b2c3422-6921-471a-9b20-89a6f950cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001671A13FC50>]}
[0m16:24:21.964743 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:24:21.981344 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:24:22.031338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b2c3422-6921-471a-9b20-89a6f950cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001671A34A030>]}
[0m16:24:22.031338 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:24:22.031338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b2c3422-6921-471a-9b20-89a6f950cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001671A13FEC0>]}
[0m16:24:22.031338 [info ] [MainThread]: 
[0m16:24:22.031338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:22.031338 [info ] [MainThread]: 
[0m16:24:22.031338 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:24:22.042538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:24:25.792961 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:24:25.792961 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:24:25.792961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:27.640668 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.848 seconds
[0m16:24:27.642675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB, now create_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m16:24:27.644681 [debug] [ThreadPool]: Creating schema "database: "PROJECT_DB"
schema: "PROJECT_SCHEMA_mart"
"
[0m16:24:27.644681 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m16:24:27.644681 [debug] [ThreadPool]: On create_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "create_PROJECT_DB_PROJECT_SCHEMA_mart"} */
create schema if not exists PROJECT_DB.PROJECT_SCHEMA_mart
[0m16:24:27.878605 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.233 seconds
[0m16:24:27.889217 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m16:24:27.898224 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m16:24:27.898224 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m16:24:27.899224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:28.996941 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb002e-3201-7db6-000c-493e000255aa
[0m16:24:28.997911 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:24:28.997911 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:24:28.998939 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:24:28.998939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m16:24:29.001912 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m16:24:29.001912 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m16:24:29.194432 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb002e-3201-7eb6-000c-493e000271be
[0m16:24:29.194432 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:24:29.199178 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:24:29.199178 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:24:29.199178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m16:24:29.201184 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m16:24:29.201184 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m16:24:29.410815 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.208 seconds
[0m16:24:29.410815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b2c3422-6921-471a-9b20-89a6f950cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001671A48BA40>]}
[0m16:24:29.422753 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:24:29.423729 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m16:24:29.424695 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m16:24:29.424695 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:24:29.427470 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:24:29.427470 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:24:29.462774 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:24:29.462774 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:24:29.462774 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
       PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        transaction_date < CURRENT_DATE - INTERVAL '30 days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    p.product_id,
    p.churned_customers,
    COUNT(cs.product_id_2) AS cross_sell_opportunities
FROM
    product_churn p
LEFT JOIN
    cross_sell cs
ON
    p.product_id = cs.product_id_1
GROUP BY
    p.product_id, p.churned_customers
ORDER BY
    p.product_id;
[0m16:24:29.462774 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:24:30.462665 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb002e-3201-7e57-000c-493e000264c2
[0m16:24:30.462665 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 49 at position 16 unexpected ';'.
[0m16:24:30.479483 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 49 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m16:24:30.489360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b2c3422-6921-471a-9b20-89a6f950cdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016717714C80>]}
[0m16:24:30.490368 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.06s]
[0m16:24:30.490745 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:24:30.491784 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 49 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m16:24:30.493751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:30.493751 [debug] [MainThread]: Connection 'create_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m16:24:30.493751 [debug] [MainThread]: On create_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m16:24:30.813009 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m16:24:30.813009 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m16:24:31.140911 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m16:24:31.140911 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m16:24:31.475107 [info ] [MainThread]: 
[0m16:24:31.475107 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m16:24:31.475107 [debug] [MainThread]: Command end result
[0m16:24:31.496571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:24:31.517123 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:24:31.525746 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:24:31.525746 [info ] [MainThread]: 
[0m16:24:31.526759 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:24:31.527779 [info ] [MainThread]: 
[0m16:24:31.528754 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 49 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m16:24:31.528754 [info ] [MainThread]: 
[0m16:24:31.530155 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:24:31.530155 [debug] [MainThread]: Command `dbt run` failed at 16:24:31.530155 after 12.43 seconds
[0m16:24:31.530155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016717177980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016717BF24B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016717BF38C0>]}
[0m16:24:31.530155 [debug] [MainThread]: Flushing usage events
[0m16:24:32.843948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:46.819212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017027A3FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017026E367B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017027A3F590>]}


============================== 16:24:46.819212 | 9175b75a-4dd8-4a68-8c72-fc7025283689 ==============================
[0m16:24:46.819212 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:24:46.819212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:47.779451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9175b75a-4dd8-4a68-8c72-fc7025283689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170286CCB00>]}
[0m16:24:47.837468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9175b75a-4dd8-4a68-8c72-fc7025283689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017027CF4A40>]}
[0m16:24:47.837468 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:24:48.434301 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:24:48.587585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:48.587585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:48.587585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:24:48.624637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9175b75a-4dd8-4a68-8c72-fc7025283689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170297A6270>]}
[0m16:24:48.692071 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:24:48.692071 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:24:48.723898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9175b75a-4dd8-4a68-8c72-fc7025283689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017029BAB5C0>]}
[0m16:24:48.723898 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:24:48.723898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9175b75a-4dd8-4a68-8c72-fc7025283689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170297A49B0>]}
[0m16:24:48.723898 [info ] [MainThread]: 
[0m16:24:48.723898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:48.739535 [info ] [MainThread]: 
[0m16:24:48.739535 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:24:48.739535 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:24:50.067840 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:24:50.067840 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:24:50.069846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:51.452894 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.388 seconds
[0m16:24:51.463893 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m16:24:51.468668 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m16:24:51.468668 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m16:24:51.468668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:52.414214 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb002e-3201-7eb6-000c-493e000271c2
[0m16:24:52.414214 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:24:52.416231 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:24:52.418247 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:24:52.418247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m16:24:52.424027 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m16:24:52.424027 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m16:24:52.617448 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.192 seconds
[0m16:24:52.623514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m16:24:52.631219 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m16:24:52.633236 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m16:24:52.810498 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb002e-3201-7e9a-000c-493e000236ce
[0m16:24:52.810498 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:24:52.810498 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:24:52.810498 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:24:52.810498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9175b75a-4dd8-4a68-8c72-fc7025283689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017029BA8980>]}
[0m16:24:52.826333 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:24:52.826333 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m16:24:52.826333 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m16:24:52.826333 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:24:52.835885 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:24:52.837891 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:24:52.869689 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:24:52.869689 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:24:52.869689 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        transaction_date
    FROM
        transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        transaction_date < CURRENT_DATE - INTERVAL '1 year'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    p.product_id,
    p.churned_customers,
    COUNT(cs.product_id_2) AS cross_sell_opportunities
FROM
    product_churn p
LEFT JOIN
    cross_sell cs
ON
    p.product_id = cs.product_id_1
GROUP BY
    p.product_id, p.churned_customers
ORDER BY
    p.product_id
        );
[0m16:24:52.869689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:24:53.842391 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb002e-3201-7e9a-000c-493e000236d2
[0m16:24:53.844386 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'TRANSACTIONS' does not exist or not authorized.
[0m16:24:53.846340 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m16:24:53.846340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9175b75a-4dd8-4a68-8c72-fc7025283689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001702985BAD0>]}
[0m16:24:53.846340 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.02s]
[0m16:24:53.862122 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:24:53.862122 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m16:24:53.862122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:53.862122 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m16:24:53.862122 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m16:24:54.197694 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m16:24:54.197694 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m16:24:54.524774 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m16:24:54.524774 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m16:24:54.846427 [info ] [MainThread]: 
[0m16:24:54.846427 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.11 seconds (6.11s).
[0m16:24:54.846427 [debug] [MainThread]: Command end result
[0m16:24:54.873602 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:24:54.875653 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:24:54.881603 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:24:54.882333 [info ] [MainThread]: 
[0m16:24:54.883418 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:24:54.883418 [info ] [MainThread]: 
[0m16:24:54.884418 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m16:24:54.885409 [info ] [MainThread]: 
[0m16:24:54.885409 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:24:54.885409 [debug] [MainThread]: Command `dbt run` failed at 16:24:54.885409 after 8.23 seconds
[0m16:24:54.888711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017027548650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001702754A9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001702754B0B0>]}
[0m16:24:54.888711 [debug] [MainThread]: Flushing usage events
[0m16:24:55.787582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:35.377365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BD37B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BD3790D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BD378500>]}


============================== 16:25:35.377365 | 2cae3557-4ff2-4069-8fdb-fe764443e635 ==============================
[0m16:25:35.377365 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:25:35.383958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:25:35.869341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cae3557-4ff2-4069-8fdb-fe764443e635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BE3F05C0>]}
[0m16:25:35.921659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cae3557-4ff2-4069-8fdb-fe764443e635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BCC48CE0>]}
[0m16:25:35.921659 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:25:36.403930 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:25:36.555844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:36.571844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:36.572351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:25:36.608263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cae3557-4ff2-4069-8fdb-fe764443e635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BCCD33E0>]}
[0m16:25:36.677309 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:25:36.681859 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:25:36.705156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cae3557-4ff2-4069-8fdb-fe764443e635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BF9A5370>]}
[0m16:25:36.705156 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:25:36.705156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cae3557-4ff2-4069-8fdb-fe764443e635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BF67BE60>]}
[0m16:25:36.705156 [info ] [MainThread]: 
[0m16:25:36.705156 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:36.705156 [info ] [MainThread]: 
[0m16:25:36.705156 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:25:36.705156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:25:36.822649 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:25:36.822649 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:25:36.822649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:38.172973 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.348 seconds
[0m16:25:38.179339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m16:25:38.188371 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m16:25:38.188371 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m16:25:38.189372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:39.129621 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.947 seconds
[0m16:25:39.129621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m16:25:39.129621 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m16:25:39.129621 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m16:25:39.322549 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb002f-3201-7eb6-000c-493e000271c6
[0m16:25:39.322549 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:25:39.322549 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:25:39.322549 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:25:39.322549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m16:25:39.322549 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m16:25:39.322549 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m16:25:39.516162 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb002f-3201-7d7b-000c-493e0002289e
[0m16:25:39.516162 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m16:25:39.516162 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m16:25:39.516162 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:25:39.516162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cae3557-4ff2-4069-8fdb-fe764443e635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BE4ABB00>]}
[0m16:25:39.516162 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:25:39.531799 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m16:25:39.531799 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m16:25:39.531799 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:25:39.531799 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:25:39.531799 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:25:39.560415 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:25:39.575506 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:25:39.575506 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        transaction_date
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        transaction_date < CURRENT_DATE - INTERVAL '1 year'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    p.product_id,
    p.churned_customers,
    COUNT(cs.product_id_2) AS cross_sell_opportunities
FROM
    product_churn p
LEFT JOIN
    cross_sell cs
ON
    p.product_id = cs.product_id_1
GROUP BY
    p.product_id, p.churned_customers
ORDER BY
    p.product_id
        );
[0m16:25:39.575506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:25:40.460376 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb002f-3201-7db6-000c-493e000255b6
[0m16:25:40.460376 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'PROJECT_DB.PROJECT_SCHEMA_STAGE' does not exist or not authorized.
[0m16:25:40.460376 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  002003 (02000): SQL compilation error:
  Schema 'PROJECT_DB.PROJECT_SCHEMA_STAGE' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m16:25:40.460376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cae3557-4ff2-4069-8fdb-fe764443e635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BCD24740>]}
[0m16:25:40.460376 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 0.93s]
[0m16:25:40.460376 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:25:40.476208 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  002003 (02000): SQL compilation error:
  Schema 'PROJECT_DB.PROJECT_SCHEMA_STAGE' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m16:25:40.476208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:40.476208 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m16:25:40.476208 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m16:25:40.820528 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m16:25:40.822716 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m16:25:41.161362 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m16:25:41.161362 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m16:25:41.505937 [info ] [MainThread]: 
[0m16:25:41.505937 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m16:25:41.512112 [debug] [MainThread]: Command end result
[0m16:25:41.549422 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:25:41.549422 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:25:41.557686 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:25:41.560296 [info ] [MainThread]: 
[0m16:25:41.561810 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:25:41.562728 [info ] [MainThread]: 
[0m16:25:41.562728 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  002003 (02000): SQL compilation error:
  Schema 'PROJECT_DB.PROJECT_SCHEMA_STAGE' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m16:25:41.562728 [info ] [MainThread]: 
[0m16:25:41.562728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:25:41.567778 [debug] [MainThread]: Command `dbt run` failed at 16:25:41.567778 after 6.35 seconds
[0m16:25:41.568817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BF81F3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BE4E8B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229BD378500>]}
[0m16:25:41.568817 [debug] [MainThread]: Flushing usage events
[0m16:25:43.043152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:32.370783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148AE4CE3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148AFC69DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148AE28D160>]}


============================== 16:26:32.370783 | 83245d3f-1cad-45cb-87d4-ab1ccd15706b ==============================
[0m16:26:32.370783 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:26:32.370783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:26:32.902057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83245d3f-1cad-45cb-87d4-ab1ccd15706b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148B2486810>]}
[0m16:26:32.976516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83245d3f-1cad-45cb-87d4-ab1ccd15706b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148B0939EE0>]}
[0m16:26:32.978083 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:26:33.458231 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:26:33.632797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:33.634807 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:33.640579 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:26:33.671607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83245d3f-1cad-45cb-87d4-ab1ccd15706b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148B0704230>]}
[0m16:26:33.748269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:26:33.752285 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:26:33.785896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83245d3f-1cad-45cb-87d4-ab1ccd15706b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148B28864B0>]}
[0m16:26:33.785896 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:26:33.787903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83245d3f-1cad-45cb-87d4-ab1ccd15706b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148AE439C70>]}
[0m16:26:33.787903 [info ] [MainThread]: 
[0m16:26:33.789914 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:26:33.789914 [info ] [MainThread]: 
[0m16:26:33.789914 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:26:33.793744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:26:33.910625 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:26:33.910625 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:26:33.910625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:35.238073 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.326 seconds
[0m16:26:35.239813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m16:26:35.247270 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m16:26:35.247270 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m16:26:35.247270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:36.226913 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.980 seconds
[0m16:26:36.226913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83245d3f-1cad-45cb-87d4-ab1ccd15706b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148B2867BC0>]}
[0m16:26:36.242578 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:26:36.242578 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn .. [RUN]
[0m16:26:36.242578 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m16:26:36.242578 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:26:36.253600 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:26:36.253600 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:26:36.290706 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:26:36.292713 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:26:36.294723 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        transaction_date
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        transaction_date < CURRENT_DATE - INTERVAL '1 year'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    p.product_id,
    p.churned_customers,
    COUNT(cs.product_id_2) AS cross_sell_opportunities
FROM
    product_churn p
LEFT JOIN
    cross_sell cs
ON
    p.product_id = cs.product_id_1
GROUP BY
    p.product_id, p.churned_customers
ORDER BY
    p.product_id
        );
[0m16:26:36.294723 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:26:37.270659 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0030-3201-7eb6-000c-493e000271ca
[0m16:26:37.272663 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'TRANSACTION_DATE'
[0m16:26:37.276673 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m16:26:37.278418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83245d3f-1cad-45cb-87d4-ab1ccd15706b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148B27BC170>]}
[0m16:26:37.278418 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.03s]
[0m16:26:37.278418 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:26:37.278418 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m16:26:37.278418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:37.278418 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m16:26:37.278418 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m16:26:37.604656 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m16:26:37.604656 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m16:26:37.931036 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m16:26:37.931036 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m16:26:38.256917 [info ] [MainThread]: 
[0m16:26:38.256917 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m16:26:38.257919 [debug] [MainThread]: Command end result
[0m16:26:38.272689 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:26:38.285228 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:26:38.293164 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:26:38.293164 [info ] [MainThread]: 
[0m16:26:38.294168 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:26:38.294168 [info ] [MainThread]: 
[0m16:26:38.294168 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'TRANSACTION_DATE'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m16:26:38.294168 [info ] [MainThread]: 
[0m16:26:38.294168 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:26:38.294168 [debug] [MainThread]: Command `dbt run` failed at 16:26:38.294168 after 6.09 seconds
[0m16:26:38.299553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148B0704EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148AFC69DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148B251CFE0>]}
[0m16:26:38.299553 [debug] [MainThread]: Flushing usage events
[0m16:26:39.230074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:01.199039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F941BBD4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F941BBC530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93F6FFC80>]}


============================== 16:27:01.204037 | 0d8dc004-ac3e-410c-b427-148cab64976c ==============================
[0m16:27:01.204037 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:27:01.205040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:27:01.687239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d8dc004-ac3e-410c-b427-148cab64976c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F941A863F0>]}
[0m16:27:01.745709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d8dc004-ac3e-410c-b427-148cab64976c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F941DD84A0>]}
[0m16:27:01.745709 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:27:02.222867 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:27:02.377862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:27:02.377862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:27:02.383619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:27:02.408998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d8dc004-ac3e-410c-b427-148cab64976c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9439B2630>]}
[0m16:27:02.474448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:27:02.486302 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:27:02.520821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d8dc004-ac3e-410c-b427-148cab64976c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F943D4FFE0>]}
[0m16:27:02.521821 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:27:02.521821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d8dc004-ac3e-410c-b427-148cab64976c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F943D26CC0>]}
[0m16:27:02.523821 [info ] [MainThread]: 
[0m16:27:02.524528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:27:02.524891 [info ] [MainThread]: 
[0m16:27:02.525894 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:27:02.526976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:27:02.624765 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:27:02.624765 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:27:02.624765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:04.052031 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.424 seconds
[0m16:27:04.054964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m16:27:04.067832 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m16:27:04.067832 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m16:27:04.067832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:05.023864 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.959 seconds
[0m16:27:05.023864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d8dc004-ac3e-410c-b427-148cab64976c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9439B3290>]}
[0m16:27:05.039789 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:27:05.039789 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn .. [RUN]
[0m16:27:05.039789 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m16:27:05.039789 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:27:05.039789 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:27:05.039789 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:27:05.077359 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:27:05.077359 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:27:05.085473 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '1 year'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    p.product_id,
    p.churned_customers,
    COUNT(cs.product_id_2) AS cross_sell_opportunities
FROM
    product_churn p
LEFT JOIN
    cross_sell cs
ON
    p.product_id = cs.product_id_1
GROUP BY
    p.product_id, p.churned_customers
ORDER BY
    p.product_id
        );
[0m16:27:05.085473 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:27:07.287126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.205 seconds
[0m16:27:07.302858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8dc004-ac3e-410c-b427-148cab64976c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93EF618B0>]}
[0m16:27:07.302858 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 2.26s]
[0m16:27:07.302858 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:27:07.302858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:07.302858 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m16:27:07.302858 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m16:27:07.643088 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m16:27:07.643088 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m16:27:07.966612 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m16:27:07.967615 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m16:27:08.284551 [info ] [MainThread]: 
[0m16:27:08.284551 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.76 seconds (5.76s).
[0m16:27:08.284551 [debug] [MainThread]: Command end result
[0m16:27:08.318727 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:27:08.318727 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:27:08.318727 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:27:08.318727 [info ] [MainThread]: 
[0m16:27:08.318727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:27:08.331876 [info ] [MainThread]: 
[0m16:27:08.331876 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:27:08.331876 [debug] [MainThread]: Command `dbt run` succeeded at 16:27:08.331876 after 7.30 seconds
[0m16:27:08.331876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9416FBC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F941907920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F943973E60>]}
[0m16:27:08.331876 [debug] [MainThread]: Flushing usage events
[0m16:27:09.226193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:48.149708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6B9B26DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6B9AC9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6BA329D60>]}


============================== 16:31:48.156101 | 4769d22b-3762-475b-b043-114601ae1883 ==============================
[0m16:31:48.156101 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:31:48.156101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:31:48.635357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4769d22b-3762-475b-b043-114601ae1883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6BB04C530>]}
[0m16:31:48.684847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4769d22b-3762-475b-b043-114601ae1883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6BA241E50>]}
[0m16:31:48.699007 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:31:49.172782 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:31:49.326978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:49.326978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:49.330989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:31:49.361385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4769d22b-3762-475b-b043-114601ae1883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6BCBFAC00>]}
[0m16:31:49.426054 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:31:49.426054 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:31:49.457393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4769d22b-3762-475b-b043-114601ae1883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6BCF460C0>]}
[0m16:31:49.457393 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:31:49.457393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4769d22b-3762-475b-b043-114601ae1883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6BBAC8EC0>]}
[0m16:31:49.457393 [info ] [MainThread]: 
[0m16:31:49.457393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:49.457393 [info ] [MainThread]: 
[0m16:31:49.457393 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:31:49.457393 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:31:49.575797 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:31:49.575797 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:31:49.576561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:50.902787 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.341 seconds
[0m16:31:50.918934 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m16:31:50.934636 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m16:31:50.934636 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m16:31:50.934636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:51.889083 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.959 seconds
[0m16:31:51.889083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4769d22b-3762-475b-b043-114601ae1883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6BCFC3F50>]}
[0m16:31:51.889083 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:31:51.889083 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn .. [RUN]
[0m16:31:51.904754 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m16:31:51.904754 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:31:51.904754 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:31:51.904754 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:31:51.930351 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:31:51.947554 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:31:51.947554 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    p.product_id,
    p.churned_customers,
    COUNT(cs.product_id_2) AS cross_sell_opportunities
FROM
    product_churn p
LEFT JOIN
    cross_sell cs
ON
    p.product_id = cs.product_id_1
GROUP BY
    p.product_id, p.churned_customers
ORDER BY
    p.product_id
        );
[0m16:31:51.948552 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:31:54.008500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.075 seconds
[0m16:31:54.040256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4769d22b-3762-475b-b043-114601ae1883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6B8191490>]}
[0m16:31:54.040256 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 2.14s]
[0m16:31:54.040256 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:31:54.040256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:54.040256 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m16:31:54.040256 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m16:31:54.378536 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m16:31:54.378536 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m16:31:54.703025 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m16:31:54.703025 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m16:31:55.042340 [info ] [MainThread]: 
[0m16:31:55.042340 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m16:31:55.042340 [debug] [MainThread]: Command end result
[0m16:31:55.070255 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:31:55.070255 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:31:55.080867 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:31:55.080867 [info ] [MainThread]: 
[0m16:31:55.081991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:55.083031 [info ] [MainThread]: 
[0m16:31:55.084035 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:31:55.084983 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:55.084983 after 7.10 seconds
[0m16:31:55.084983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6B9B623C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6BADA7FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6BADA75F0>]}
[0m16:31:55.084983 [debug] [MainThread]: Flushing usage events
[0m16:31:56.321637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:43.556042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288A9C74740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288A9C74980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288A9C756D0>]}


============================== 16:37:43.566680 | 18032a09-4cc7-4fed-b94a-4e62f9a938be ==============================
[0m16:37:43.566680 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:37:43.566680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m16:37:44.056883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18032a09-4cc7-4fed-b94a-4e62f9a938be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288A9E84D70>]}
[0m16:37:44.122448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18032a09-4cc7-4fed-b94a-4e62f9a938be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AA64FBC0>]}
[0m16:37:44.122448 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:37:44.618795 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:37:44.766652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:44.766652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:44.782306 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:37:44.814523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18032a09-4cc7-4fed-b94a-4e62f9a938be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288ABA9C2F0>]}
[0m16:37:44.880775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:37:44.880775 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:37:44.912683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18032a09-4cc7-4fed-b94a-4e62f9a938be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288ABE0F1A0>]}
[0m16:37:44.912683 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:37:44.912683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18032a09-4cc7-4fed-b94a-4e62f9a938be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288ABC27E60>]}
[0m16:37:44.912683 [info ] [MainThread]: 
[0m16:37:44.912683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:44.912683 [info ] [MainThread]: 
[0m16:37:44.928762 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:37:44.934055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m16:37:45.030905 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m16:37:45.030905 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m16:37:45.030905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:47.316568 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 2.278 seconds
[0m16:37:47.320588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18032a09-4cc7-4fed-b94a-4e62f9a938be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC398860>]}
[0m16:37:47.327385 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m16:37:47.327385 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m16:37:47.327385 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m16:37:47.327385 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m16:37:47.327385 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m16:37:47.327385 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m16:37:47.327385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:47.327385 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m16:37:47.327385 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m16:37:47.677722 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was properly closed.
[0m16:37:47.680732 [debug] [MainThread]: Command end result
[0m16:37:47.714722 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:37:47.714722 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:37:47.730730 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:37:47.730730 [info ] [MainThread]: Compiled node 'mart_nrr_grr' is:
-- WITH revenues AS (
--     SELECT 
--         SUM(revenue) AS total_revenue,
--         SUM(CASE WHEN revenue_type=1 THEN revenue ELSE 0 END) AS recurring_revenue,
--         SUM(CASE WHEN revenue_type=0 THEN revenue ELSE 0 END) AS reoccuring_revenue,
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY payment_month
-- )
-- SELECT
--     r.customer_id,
--     r.total_revenue,
--     (recurring_revenue-reoccuring_revenue) /AS grr,
WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
)
SELECT
    n.customer_id,
    n.payment_month,
    n.recurring_revenue,
    n.previous_recurring_revenue,
    (n.recurring_revenue / n.previous_recurring_revenue) * 100 AS nrr,
    m.grr
FROM
    nrr_calculation n
JOIN
    monthly_revenue m
ON
    n.customer_id = m.customer_id AND n.payment_month = m.payment_month
ORDER BY
    n.customer_id, n.payment_month;
[0m16:37:47.730730 [debug] [MainThread]: Command `dbt compile` succeeded at 16:37:47.730730 after 4.36 seconds
[0m16:37:47.730730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288ABE07FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AA6D85C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288ABA37F50>]}
[0m16:37:47.730730 [debug] [MainThread]: Flushing usage events
[0m16:37:49.024559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:58.760608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C44747A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C4474710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C4474590>]}


============================== 16:37:58.760608 | 59c84066-b270-4cd7-baf6-b3a1b595ac82 ==============================
[0m16:37:58.760608 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:37:58.760608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:37:59.242699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59c84066-b270-4cd7-baf6-b3a1b595ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C4474590>]}
[0m16:37:59.308841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59c84066-b270-4cd7-baf6-b3a1b595ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C5020470>]}
[0m16:37:59.308841 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:37:59.776543 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:37:59.938432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:59.938432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:59.938432 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:37:59.963546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59c84066-b270-4cd7-baf6-b3a1b595ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C62A8530>]}
[0m16:38:00.029220 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:38:00.044974 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:38:00.078368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59c84066-b270-4cd7-baf6-b3a1b595ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C65FC2C0>]}
[0m16:38:00.080381 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:38:00.080381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59c84066-b270-4cd7-baf6-b3a1b595ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C65D44D0>]}
[0m16:38:00.080381 [info ] [MainThread]: 
[0m16:38:00.080381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:00.080381 [info ] [MainThread]: 
[0m16:38:00.080381 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:38:00.080381 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:38:00.188032 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:38:00.188032 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:38:00.189034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:01.631825 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.454 seconds
[0m16:38:01.648252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m16:38:01.648252 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m16:38:01.648252 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m16:38:01.648252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:02.657712 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.997 seconds
[0m16:38:02.657712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59c84066-b270-4cd7-baf6-b3a1b595ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C65FFB90>]}
[0m16:38:02.657712 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m16:38:02.657712 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_nrr_grr ....................... [RUN]
[0m16:38:02.657712 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m16:38:02.657712 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m16:38:02.673579 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m16:38:02.673579 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m16:38:02.699799 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m16:38:02.714145 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m16:38:02.714604 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_nrr_grr
         as
        (-- WITH revenues AS (
--     SELECT 
--         SUM(revenue) AS total_revenue,
--         SUM(CASE WHEN revenue_type=1 THEN revenue ELSE 0 END) AS recurring_revenue,
--         SUM(CASE WHEN revenue_type=0 THEN revenue ELSE 0 END) AS reoccuring_revenue,
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY payment_month
-- )
-- SELECT
--     r.customer_id,
--     r.total_revenue,
--     (recurring_revenue-reoccuring_revenue) /AS grr,
WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
)
SELECT
    n.customer_id,
    n.payment_month,
    n.recurring_revenue,
    n.previous_recurring_revenue,
    (n.recurring_revenue / n.previous_recurring_revenue) * 100 AS nrr,
    m.grr
FROM
    nrr_calculation n
JOIN
    monthly_revenue m
ON
    n.customer_id = m.customer_id AND n.payment_month = m.payment_month
ORDER BY
    n.customer_id, n.payment_month;
[0m16:38:02.714604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:38:03.715433 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb003c-3201-7e57-000c-493e00026502
[0m16:38:03.715785 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 61 at position 34 unexpected ';'.
[0m16:38:03.722018 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 34 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m16:38:03.725400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59c84066-b270-4cd7-baf6-b3a1b595ac82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C3944530>]}
[0m16:38:03.726411 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_nrr_grr .............. [[31mERROR[0m in 1.07s]
[0m16:38:03.728053 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m16:38:03.728053 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 34 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql.
[0m16:38:03.731053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:03.731053 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m16:38:03.731053 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m16:38:04.065841 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m16:38:04.065841 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m16:38:04.408528 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m16:38:04.409529 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m16:38:04.746129 [info ] [MainThread]: 
[0m16:38:04.746129 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m16:38:04.746129 [debug] [MainThread]: Command end result
[0m16:38:04.767714 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:38:04.784342 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:38:04.789381 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:38:04.789381 [info ] [MainThread]: 
[0m16:38:04.789381 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:38:04.789381 [info ] [MainThread]: 
[0m16:38:04.789381 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 61 at position 34 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m16:38:04.789381 [info ] [MainThread]: 
[0m16:38:04.789381 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:38:04.789381 [debug] [MainThread]: Command `dbt run` failed at 16:38:04.789381 after 6.19 seconds
[0m16:38:04.789381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C449C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C511CBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8C6CE6DB0>]}
[0m16:38:04.789381 [debug] [MainThread]: Flushing usage events
[0m16:38:05.741741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:13.440569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022891F10230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022891F13DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022891F10C20>]}


============================== 16:38:13.440569 | 384f8b5d-c33f-4412-ad2e-12f567a93f3a ==============================
[0m16:38:13.440569 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:38:13.452402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:38:13.945278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '384f8b5d-c33f-4412-ad2e-12f567a93f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022891F8ACF0>]}
[0m16:38:14.002794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '384f8b5d-c33f-4412-ad2e-12f567a93f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022891449D30>]}
[0m16:38:14.002794 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:38:14.470554 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:38:14.625009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:14.625009 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:14.625009 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:38:14.660468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '384f8b5d-c33f-4412-ad2e-12f567a93f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022893DCFC50>]}
[0m16:38:14.726305 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:38:14.726305 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:38:14.758018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '384f8b5d-c33f-4412-ad2e-12f567a93f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002289415C0B0>]}
[0m16:38:14.758018 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:38:14.758018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '384f8b5d-c33f-4412-ad2e-12f567a93f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022893DCCE60>]}
[0m16:38:14.758018 [info ] [MainThread]: 
[0m16:38:14.767615 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:14.767615 [info ] [MainThread]: 
[0m16:38:14.767615 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:38:14.767615 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:38:14.872238 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:38:14.872238 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:38:14.873238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:16.354863 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.482 seconds
[0m16:38:16.354863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m16:38:16.354863 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m16:38:16.370798 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m16:38:16.370798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:17.362438 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.996 seconds
[0m16:38:17.374698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '384f8b5d-c33f-4412-ad2e-12f567a93f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022894134A40>]}
[0m16:38:17.374698 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m16:38:17.374698 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_nrr_grr ....................... [RUN]
[0m16:38:17.374698 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m16:38:17.374698 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m16:38:17.390772 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m16:38:17.391783 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m16:38:17.413212 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m16:38:17.413212 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m16:38:17.413212 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_nrr_grr
         as
        (-- WITH revenues AS (
--     SELECT 
--         SUM(revenue) AS total_revenue,
--         SUM(CASE WHEN revenue_type=1 THEN revenue ELSE 0 END) AS recurring_revenue,
--         SUM(CASE WHEN revenue_type=0 THEN revenue ELSE 0 END) AS reoccuring_revenue,
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY payment_month
-- )
-- SELECT
--     r.customer_id,
--     r.total_revenue,
--     (recurring_revenue-reoccuring_revenue) /AS grr,
WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
)
SELECT
    n.customer_id,
    n.payment_month,
    n.recurring_revenue,
    n.previous_recurring_revenue,
    (n.recurring_revenue / n.previous_recurring_revenue) * 100 AS nrr,
    m.grr
FROM
    nrr_calculation n
JOIN
    monthly_revenue m
ON
    n.customer_id = m.customer_id AND n.payment_month = m.payment_month
ORDER BY
    n.customer_id, n.payment_month
        );
[0m16:38:17.413212 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:38:18.965895 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb003c-3201-7e9a-000c-493e00023706
[0m16:38:18.965895 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100051 (22012): Division by zero
[0m16:38:18.965895 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  100051 (22012): Division by zero
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m16:38:18.965895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '384f8b5d-c33f-4412-ad2e-12f567a93f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228913B4740>]}
[0m16:38:18.977672 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_nrr_grr .............. [[31mERROR[0m in 1.59s]
[0m16:38:18.977672 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m16:38:18.977672 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  100051 (22012): Division by zero
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql.
[0m16:38:18.977672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:18.977672 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m16:38:18.977672 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m16:38:19.309043 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m16:38:19.309043 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m16:38:19.672000 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m16:38:19.672000 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m16:38:20.013913 [info ] [MainThread]: 
[0m16:38:20.013913 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m16:38:20.013913 [debug] [MainThread]: Command end result
[0m16:38:20.046064 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:38:20.048065 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:38:20.053504 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:38:20.053504 [info ] [MainThread]: 
[0m16:38:20.053504 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:38:20.053504 [info ] [MainThread]: 
[0m16:38:20.053504 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  100051 (22012): Division by zero
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m16:38:20.053504 [info ] [MainThread]: 
[0m16:38:20.053504 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:38:20.053504 [debug] [MainThread]: Command `dbt run` failed at 16:38:20.053504 after 6.77 seconds
[0m16:38:20.053504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228918C25A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022891F10C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022891F115B0>]}
[0m16:38:20.053504 [debug] [MainThread]: Flushing usage events
[0m16:38:20.998721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:43.943601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002828FFB4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002828FFB54C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002828FFB4920>]}


============================== 16:39:43.943601 | a1aeb760-3c17-45e2-8ffb-47d7fca33149 ==============================
[0m16:39:43.943601 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:39:43.943601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:39:44.867381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1aeb760-3c17-45e2-8ffb-47d7fca33149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282909F2CF0>]}
[0m16:39:44.931162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1aeb760-3c17-45e2-8ffb-47d7fca33149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002828F430EF0>]}
[0m16:39:44.931162 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:39:45.497903 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:39:45.664441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:45.664441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:45.670459 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:39:45.685523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1aeb760-3c17-45e2-8ffb-47d7fca33149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028291DDC530>]}
[0m16:39:45.766916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:39:45.782973 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:39:45.814712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1aeb760-3c17-45e2-8ffb-47d7fca33149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002829217FCE0>]}
[0m16:39:45.814712 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:39:45.814712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1aeb760-3c17-45e2-8ffb-47d7fca33149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002829214D370>]}
[0m16:39:45.814712 [info ] [MainThread]: 
[0m16:39:45.814712 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:39:45.820033 [info ] [MainThread]: 
[0m16:39:45.820033 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:39:45.820033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:39:48.851608 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:39:48.851608 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:39:48.851608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:50.274687 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.429 seconds
[0m16:39:50.290795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m16:39:50.306852 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m16:39:50.306852 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m16:39:50.306852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:51.295091 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.989 seconds
[0m16:39:51.295091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1aeb760-3c17-45e2-8ffb-47d7fca33149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002829217FE00>]}
[0m16:39:51.310812 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m16:39:51.310812 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_nrr_grr ....................... [RUN]
[0m16:39:51.310812 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m16:39:51.310812 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m16:39:51.310812 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m16:39:51.310812 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m16:39:51.341179 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m16:39:51.358215 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m16:39:51.358215 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_nrr_grr
         as
        (WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
)
SELECT
    n.customer_id,
    n.payment_month,
    n.recurring_revenue,
    n.previous_recurring_revenue,
    CASE 
        WHEN n.previous_recurring_revenue = 0 THEN 0
        ELSE (n.recurring_revenue / n.previous_recurring_revenue) * 100
    END AS nrr,
    m.grr
FROM
    nrr_calculation n
JOIN
    monthly_revenue m
ON
    n.customer_id = m.customer_id AND n.payment_month = m.payment_month
ORDER BY
    n.customer_id, n.payment_month;
[0m16:39:51.359216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:39:52.523315 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb003d-3201-7e57-000c-493e0002650a
[0m16:39:52.523989 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 52 at position 34 unexpected ';'.
[0m16:39:52.523989 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 34 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m16:39:52.540424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1aeb760-3c17-45e2-8ffb-47d7fca33149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002828F484740>]}
[0m16:39:52.540424 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_nrr_grr .............. [[31mERROR[0m in 1.21s]
[0m16:39:52.540424 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m16:39:52.540424 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 34 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql.
[0m16:39:52.540424 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:52.540424 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m16:39:52.540424 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m16:39:52.866620 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m16:39:52.882531 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m16:39:53.220326 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m16:39:53.220326 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m16:39:53.560529 [info ] [MainThread]: 
[0m16:39:53.560529 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.74 seconds (7.74s).
[0m16:39:53.560529 [debug] [MainThread]: Command end result
[0m16:39:53.594612 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:39:53.596911 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:39:53.599645 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:39:53.599645 [info ] [MainThread]: 
[0m16:39:53.599645 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:39:53.599645 [info ] [MainThread]: 
[0m16:39:53.599645 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 34 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m16:39:53.599645 [info ] [MainThread]: 
[0m16:39:53.599645 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:39:53.608251 [debug] [MainThread]: Command `dbt run` failed at 16:39:53.608251 after 9.84 seconds
[0m16:39:53.609261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002828DD7E210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028290D22ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028290D23F80>]}
[0m16:39:53.609903 [debug] [MainThread]: Flushing usage events
[0m16:39:54.883842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:02.302910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F387B7CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F35F95850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F38197590>]}


============================== 16:40:02.318666 | 7a2053af-25ce-4a82-bbd9-035e322f5fcf ==============================
[0m16:40:02.318666 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:40:02.318666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:40:02.788926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a2053af-25ce-4a82-bbd9-035e322f5fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F399E99A0>]}
[0m16:40:02.852683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a2053af-25ce-4a82-bbd9-035e322f5fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F38140FE0>]}
[0m16:40:02.852683 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:40:03.338893 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:40:03.481419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:03.481419 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:03.497486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:40:03.518580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a2053af-25ce-4a82-bbd9-035e322f5fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F3ABB3440>]}
[0m16:40:03.586213 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:40:03.586213 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:40:03.618636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a2053af-25ce-4a82-bbd9-035e322f5fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F39ADF290>]}
[0m16:40:03.618636 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:40:03.618636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a2053af-25ce-4a82-bbd9-035e322f5fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F3AF06840>]}
[0m16:40:03.634720 [info ] [MainThread]: 
[0m16:40:03.635335 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:40:03.635335 [info ] [MainThread]: 
[0m16:40:03.636374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:40:03.637758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:40:03.741398 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:40:03.741398 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:40:03.741398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:05.238256 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.500 seconds
[0m16:40:05.238256 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m16:40:05.257412 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m16:40:05.258412 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m16:40:05.258412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:06.269016 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.010 seconds
[0m16:40:06.273804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a2053af-25ce-4a82-bbd9-035e322f5fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F36123890>]}
[0m16:40:06.278823 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m16:40:06.278823 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_nrr_grr ....................... [RUN]
[0m16:40:06.279823 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m16:40:06.279823 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m16:40:06.287874 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m16:40:06.289264 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m16:40:06.303994 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m16:40:06.321590 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m16:40:06.321590 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_nrr_grr
         as
        (WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
)
SELECT
    n.customer_id,
    n.payment_month,
    n.recurring_revenue,
    n.previous_recurring_revenue,
    CASE 
        WHEN n.previous_recurring_revenue = 0 THEN 0
        ELSE (n.recurring_revenue / n.previous_recurring_revenue) * 100
    END AS nrr,
    m.grr
FROM
    nrr_calculation n
JOIN
    monthly_revenue m
ON
    n.customer_id = m.customer_id AND n.payment_month = m.payment_month
ORDER BY
    n.customer_id, n.payment_month
        );
[0m16:40:06.321590 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:07.921315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.601 seconds
[0m16:40:07.937404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a2053af-25ce-4a82-bbd9-035e322f5fcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F36091A00>]}
[0m16:40:07.946181 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_nrr_grr .................. [[32mSUCCESS 1[0m in 1.66s]
[0m16:40:07.946181 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m16:40:07.946181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:07.946181 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m16:40:07.946181 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m16:40:08.281564 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m16:40:08.281564 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m16:40:08.617260 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m16:40:08.617260 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m16:40:08.954416 [info ] [MainThread]: 
[0m16:40:08.954905 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m16:40:08.955912 [debug] [MainThread]: Command end result
[0m16:40:08.979278 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:40:08.979278 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:40:08.979278 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:40:08.979278 [info ] [MainThread]: 
[0m16:40:08.979278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:08.990288 [info ] [MainThread]: 
[0m16:40:08.991298 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:40:08.993299 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:08.993299 after 6.84 seconds
[0m16:40:08.993299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F363E77D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F384888C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F38488380>]}
[0m16:40:08.994299 [debug] [MainThread]: Flushing usage events
[0m16:40:09.887161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:39.878025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285CC7C1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285CF467860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285CF467BF0>]}


============================== 16:55:39.889369 | e6a9838a-cb78-4614-8143-34bebee8fbd6 ==============================
[0m16:55:39.889369 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:55:39.889369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:55:40.821970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6a9838a-cb78-4614-8143-34bebee8fbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285CF645BE0>]}
[0m16:55:40.881855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6a9838a-cb78-4614-8143-34bebee8fbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285CFF127E0>]}
[0m16:55:40.881855 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:55:41.483494 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:55:41.650198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:41.650198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:41.650198 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:55:41.685811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6a9838a-cb78-4614-8143-34bebee8fbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D0232DE0>]}
[0m16:55:41.751648 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:55:41.767450 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:55:41.808648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6a9838a-cb78-4614-8143-34bebee8fbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D165A0F0>]}
[0m16:55:41.808648 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:55:41.808648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6a9838a-cb78-4614-8143-34bebee8fbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D01FC860>]}
[0m16:55:41.808648 [info ] [MainThread]: 
[0m16:55:41.813348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:41.813348 [info ] [MainThread]: 
[0m16:55:41.813348 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:41.815087 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:55:44.930508 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:55:44.934565 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:55:44.934565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:46.399500 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.465 seconds
[0m16:55:46.401511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m16:55:46.409568 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m16:55:46.409568 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m16:55:46.409568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:47.431412 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.015 seconds
[0m16:55:47.431412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6a9838a-cb78-4614-8143-34bebee8fbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285CEBE6E40>]}
[0m16:55:47.431412 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:55:47.431412 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn .. [RUN]
[0m16:55:47.431412 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m16:55:47.431412 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:55:47.451098 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:55:47.451098 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:55:47.476557 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:55:47.476557 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:55:47.476557 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
-- product_churn_lm AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- product_churn_l3m AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '90 Days'
--     GROUP BY
--         product_id
-- ),
-- product_churn_ltm AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '1 year'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- )
-- SELECT
--     p.product_id,
--     p.churned_customers,
--     COUNT(cs.product_id_2) AS cross_sell_opportunities
-- FROM
--     product_churn p
-- LEFT JOIN
--     cross_sell cs
-- ON
--     p.product_id = cs.product_id_1
-- GROUP BY
--     p.product_id, p.churned_customers
-- ORDER BY
--     p.product_id





WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
product_churn_lm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
product_churn_l3m AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '90 Days'
    GROUP BY
        product_id
),
product_churn_ltm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '1 year'
    GROUP BY
        product_id
),
cross_sell_lm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
),
cross_sell_l3m AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '90 Days'
),
cross_sell_ltm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '1 year'
)
SELECT
    p.product_id,
    p.churned_customers,
    COUNT(cs_lm.product_id_2) AS cross_sell_opportunities_lm,
    COUNT(cs_l3m.product_id_2) AS cross_sell_opportunities_l3m,
    COUNT(cs_ltm.product_id_2) AS cross_sell_opportunities_ltm
FROM
    product_churn_lm p
LEFT JOIN
    cross_sell_lm cs_lm
ON
    p.product_id = cs_lm.product_id_1
LEFT JOIN
    cross_sell_l3m cs_l3m
ON
    p.product_id = cs_l3m.product_id_1
LEFT JOIN
    cross_sell_ltm cs_ltm
ON
    p.product_id = cs_ltm.product_id_1
GROUP BY
    p.product_id, p.churned_customers
ORDER BY
    p.product_id;
[0m16:55:47.476557 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:48.623569 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb004d-3201-7d7b-000c-493e00022902
[0m16:55:48.623569 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 186 at position 16 unexpected ';'.
[0m16:55:48.639525 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 186 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m16:55:48.639525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a9838a-cb78-4614-8143-34bebee8fbd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D1BE4290>]}
[0m16:55:48.639525 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.21s]
[0m16:55:48.639525 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:55:48.639525 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 186 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m16:55:48.639525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:48.639525 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m16:55:48.639525 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m16:55:48.983688 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m16:55:48.983688 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m16:55:49.325399 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m16:55:49.325399 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m16:55:49.655065 [info ] [MainThread]: 
[0m16:55:49.655065 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.84 seconds (7.84s).
[0m16:55:49.655065 [debug] [MainThread]: Command end result
[0m16:55:49.682251 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:55:49.685543 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:55:49.688577 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:55:49.688577 [info ] [MainThread]: 
[0m16:55:49.688577 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:55:49.693355 [info ] [MainThread]: 
[0m16:55:49.694377 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 186 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m16:55:49.695362 [info ] [MainThread]: 
[0m16:55:49.696363 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:55:49.697361 [debug] [MainThread]: Command `dbt run` failed at 16:55:49.697361 after 9.99 seconds
[0m16:55:49.697361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285CF14F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285D163FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285CC7C1700>]}
[0m16:55:49.698361 [debug] [MainThread]: Flushing usage events
[0m16:55:50.805679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:01.333750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013841DC8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383F5614F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013841DCA570>]}


============================== 16:56:01.349540 | 13ed1727-f70c-4e87-b4ea-4dae76322761 ==============================
[0m16:56:01.349540 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:56:01.349540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'send_anonymous_usage_stats': 'True'}
[0m16:56:01.834414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13ed1727-f70c-4e87-b4ea-4dae76322761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013842187950>]}
[0m16:56:01.904889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13ed1727-f70c-4e87-b4ea-4dae76322761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013842FF8B30>]}
[0m16:56:01.906894 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:56:02.384670 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:56:02.527986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:56:02.527986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:56:02.543679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m16:56:02.574430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13ed1727-f70c-4e87-b4ea-4dae76322761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138440E2480>]}
[0m16:56:02.639351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:56:02.639351 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:56:02.670866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13ed1727-f70c-4e87-b4ea-4dae76322761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013844483110>]}
[0m16:56:02.670866 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m16:56:02.686505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ed1727-f70c-4e87-b4ea-4dae76322761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138422977A0>]}
[0m16:56:02.686505 [info ] [MainThread]: 
[0m16:56:02.688306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:02.688306 [info ] [MainThread]: 
[0m16:56:02.688306 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:56:02.690345 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m16:56:02.794539 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m16:56:02.794539 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m16:56:02.794539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:04.166697 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.373 seconds
[0m16:56:04.173871 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m16:56:04.178509 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m16:56:04.178509 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m16:56:04.178509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:05.213080 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.033 seconds
[0m16:56:05.222960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ed1727-f70c-4e87-b4ea-4dae76322761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013844387140>]}
[0m16:56:05.228662 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:56:05.228662 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn .. [RUN]
[0m16:56:05.228662 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m16:56:05.228662 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:56:05.228662 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:56:05.228662 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:56:05.282496 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:56:05.287505 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m16:56:05.288505 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
-- product_churn_lm AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- product_churn_l3m AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '90 Days'
--     GROUP BY
--         product_id
-- ),
-- product_churn_ltm AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '1 year'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- )
-- SELECT
--     p.product_id,
--     p.churned_customers,
--     COUNT(cs.product_id_2) AS cross_sell_opportunities
-- FROM
--     product_churn p
-- LEFT JOIN
--     cross_sell cs
-- ON
--     p.product_id = cs.product_id_1
-- GROUP BY
--     p.product_id, p.churned_customers
-- ORDER BY
--     p.product_id





WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
product_churn_lm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
product_churn_l3m AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '90 Days'
    GROUP BY
        product_id
),
product_churn_ltm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '1 year'
    GROUP BY
        product_id
),
cross_sell_lm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
),
cross_sell_l3m AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '90 Days'
),
cross_sell_ltm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '1 year'
)
SELECT
    p.product_id,
    p.churned_customers,
    COUNT(cs_lm.product_id_2) AS cross_sell_opportunities_lm,
    COUNT(cs_l3m.product_id_2) AS cross_sell_opportunities_l3m,
    COUNT(cs_ltm.product_id_2) AS cross_sell_opportunities_ltm
FROM
    product_churn_lm p
LEFT JOIN
    cross_sell_lm cs_lm
ON
    p.product_id = cs_lm.product_id_1
LEFT JOIN
    cross_sell_l3m cs_l3m
ON
    p.product_id = cs_l3m.product_id_1
LEFT JOIN
    cross_sell_ltm cs_ltm
ON
    p.product_id = cs_ltm.product_id_1
GROUP BY
    p.product_id, p.churned_customers
ORDER BY
    p.product_id
        );
[0m16:56:05.288505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:07.077603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.803 seconds
[0m16:56:07.118609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13ed1727-f70c-4e87-b4ea-4dae76322761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383F665400>]}
[0m16:56:07.118609 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 1.89s]
[0m16:56:07.118609 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m16:56:07.118609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:07.118609 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m16:56:07.118609 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m16:56:07.450647 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m16:56:07.450647 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m16:56:07.802987 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m16:56:07.802987 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m16:56:08.145350 [info ] [MainThread]: 
[0m16:56:08.145350 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m16:56:08.153146 [debug] [MainThread]: Command end result
[0m16:56:08.173844 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m16:56:08.181306 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m16:56:08.183922 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m16:56:08.183922 [info ] [MainThread]: 
[0m16:56:08.183922 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:56:08.183922 [info ] [MainThread]: 
[0m16:56:08.183922 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:56:08.183922 [debug] [MainThread]: Command `dbt run` succeeded at 16:56:08.183922 after 7.01 seconds
[0m16:56:08.183922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013841710E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013841710440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013841711A90>]}
[0m16:56:08.183922 [debug] [MainThread]: Flushing usage events
[0m16:56:09.513564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:31.458275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C473F740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C473FE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C473FE60>]}


============================== 17:00:31.463307 | 25ea1f04-d809-411b-9e41-a01f0fbb1123 ==============================
[0m17:00:31.463307 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:00:31.464275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'send_anonymous_usage_stats': 'True'}
[0m17:00:31.979185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25ea1f04-d809-411b-9e41-a01f0fbb1123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C5859790>]}
[0m17:00:32.043464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25ea1f04-d809-411b-9e41-a01f0fbb1123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C59222D0>]}
[0m17:00:32.043464 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:00:32.534866 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:00:32.706005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:32.706005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:32.710027 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:00:32.741712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25ea1f04-d809-411b-9e41-a01f0fbb1123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C6B97F80>]}
[0m17:00:32.815718 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:00:32.819717 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:00:32.841797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25ea1f04-d809-411b-9e41-a01f0fbb1123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C6D83F20>]}
[0m17:00:32.853357 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:00:32.853357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ea1f04-d809-411b-9e41-a01f0fbb1123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C6D7A840>]}
[0m17:00:32.853357 [info ] [MainThread]: 
[0m17:00:32.853357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:00:32.853357 [info ] [MainThread]: 
[0m17:00:32.857390 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:00:32.857390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:00:32.959320 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:00:32.959320 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:00:32.959320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:34.274289 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.303 seconds
[0m17:00:34.274289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:00:34.294087 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:00:34.294087 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:00:34.294087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:35.287191 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.993 seconds
[0m17:00:35.291219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ea1f04-d809-411b-9e41-a01f0fbb1123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C6D40920>]}
[0m17:00:35.291219 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:00:35.291219 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn .. [RUN]
[0m17:00:35.291219 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m17:00:35.291219 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:00:35.308417 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m17:00:35.309356 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:00:35.328494 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m17:00:35.344719 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m17:00:35.344719 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
product_churn_lm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
product_churn_l3m AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '90 Days'
    GROUP BY
        product_id
),
product_churn_ltm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '1 year'
    GROUP BY
        product_id
),
cross_sell_lm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
),
cross_sell_l3m AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '90 Days'
),
cross_sell_ltm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '1 year'
)
SELECT
    p.product_id,
    p.churned_customers,
    COUNT(cs_lm.product_id_2) AS cross_sell_opportunities_lm,
    COUNT(cs_l3m.product_id_2) AS cross_sell_opportunities_l3m,
    COUNT(cs_ltm.product_id_2) AS cross_sell_opportunities_ltm
FROM
    product_churn_ltm p
LEFT JOIN
    cross_sell_lm cs_lm
ON
    p.product_id = cs_lm.product_id_1
LEFT JOIN
    cross_sell_l3m cs_l3m
ON
    p.product_id = cs_l3m.product_id_1
LEFT JOIN
    cross_sell_ltm cs_ltm
ON
    p.product_id = cs_ltm.product_id_1
GROUP BY
    p.product_id, p.churned_customers
ORDER BY
    p.product_id
        );
[0m17:00:35.344719 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:00:36.762327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.423 seconds
[0m17:00:36.793538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ea1f04-d809-411b-9e41-a01f0fbb1123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C1FA1880>]}
[0m17:00:36.793538 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 1.50s]
[0m17:00:36.793538 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:00:36.793538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:36.793538 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:00:36.793538 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:00:37.128660 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:00:37.128660 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:00:37.446824 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m17:00:37.446824 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m17:00:37.780464 [info ] [MainThread]: 
[0m17:00:37.780464 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m17:00:37.780464 [debug] [MainThread]: Command end result
[0m17:00:37.815932 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:00:37.819968 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:00:37.821968 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:00:37.821968 [info ] [MainThread]: 
[0m17:00:37.821968 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:37.821968 [info ] [MainThread]: 
[0m17:00:37.821968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:00:37.830138 [debug] [MainThread]: Command `dbt run` succeeded at 17:00:37.830138 after 6.55 seconds
[0m17:00:37.831167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C2033770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C69DF0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8C6978200>]}
[0m17:00:37.832149 [debug] [MainThread]: Flushing usage events
[0m17:00:39.081811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:43.671065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677E6EF5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677C94E9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677C94EA20>]}


============================== 17:03:43.687073 | 6c08abe7-171b-46a3-bfe7-7843a8048d00 ==============================
[0m17:03:43.687073 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:03:43.687073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m crb_report', 'send_anonymous_usage_stats': 'True'}
[0m17:03:44.172216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c08abe7-171b-46a3-bfe7-7843a8048d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677F992360>]}
[0m17:03:44.235884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c08abe7-171b-46a3-bfe7-7843a8048d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677DC6A270>]}
[0m17:03:44.235884 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:03:44.706388 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:03:44.865422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:44.865422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:44.865422 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:03:44.900043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c08abe7-171b-46a3-bfe7-7843a8048d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677FA197C0>]}
[0m17:03:44.967124 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:03:44.967124 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:03:44.998608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c08abe7-171b-46a3-bfe7-7843a8048d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677FA9B080>]}
[0m17:03:44.998608 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:03:44.998608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c08abe7-171b-46a3-bfe7-7843a8048d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677FDC0CE0>]}
[0m17:03:44.998608 [info ] [MainThread]: 
[0m17:03:44.998608 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:44.998608 [info ] [MainThread]: 
[0m17:03:44.998608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:44.998608 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:03:45.116182 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:03:45.117181 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:03:45.117181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:46.453726 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.348 seconds
[0m17:03:46.469517 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:03:46.489463 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:03:46.489463 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:03:46.489463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:47.520135 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.031 seconds
[0m17:03:47.522975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c08abe7-171b-46a3-bfe7-7843a8048d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677FD36F60>]}
[0m17:03:47.522975 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m17:03:47.522975 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.crb_report ......................... [RUN]
[0m17:03:47.522975 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m17:03:47.522975 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m17:03:47.536009 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m17:03:47.536009 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m17:03:47.570983 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m17:03:47.570983 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m17:03:47.570983 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.crb_report
         as
        (WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
customer_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
),
product_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
),
new_and_churned_customers AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
),
crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        cr.revenue_rank AS customer_rank,
        pr.revenue_rank AS product_rank,    
        nc.new_customers,
        nc.churned_customers,
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        -- SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        -- SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        -- SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        -- DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        -- DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
    LEFT JOIN customer_ranks cr ON t.customer_id = cr.customer_id
    LEFT JOIN product_ranks pr ON t.product_id = pr.product_id
    LEFT JOIN new_and_churned_customers nc ON t.customer_id = nc.customer_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue
)

SELECT * FROM crb
        );
[0m17:03:47.570983 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:03:48.553032 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0055-3201-7e57-000c-493e0002658e
[0m17:03:48.553032 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 68 at position 62
invalid identifier 'NC.CUSTOMER_ID'
[0m17:03:48.553032 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 68 at position 62
  invalid identifier 'NC.CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m17:03:48.568780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c08abe7-171b-46a3-bfe7-7843a8048d00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677E054980>]}
[0m17:03:48.568780 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.crb_report ................ [[31mERROR[0m in 1.03s]
[0m17:03:48.568780 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m17:03:48.568780 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 68 at position 62
  invalid identifier 'NC.CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m17:03:48.577485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:48.577485 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:03:48.577485 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:03:48.913582 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:03:48.913582 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:03:49.248656 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m17:03:49.248656 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m17:03:49.590633 [info ] [MainThread]: 
[0m17:03:49.590633 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m17:03:49.590633 [debug] [MainThread]: Command end result
[0m17:03:49.622111 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:03:49.623487 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:03:49.623487 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:03:49.623487 [info ] [MainThread]: 
[0m17:03:49.623487 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:03:49.623487 [info ] [MainThread]: 
[0m17:03:49.623487 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  000904 (42000): SQL compilation error: error line 68 at position 62
  invalid identifier 'NC.CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m17:03:49.623487 [info ] [MainThread]: 
[0m17:03:49.623487 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:03:49.623487 [debug] [MainThread]: Command `dbt run` failed at 17:03:49.623487 after 6.11 seconds
[0m17:03:49.623487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677C036D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677BFE38F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677EB67AD0>]}
[0m17:03:49.623487 [debug] [MainThread]: Flushing usage events
[0m17:03:50.955765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:29.316645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD96ED1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD96ED0A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD96ED1460>]}


============================== 17:05:29.316645 | aebe2687-431e-4d4d-8947-eaafb73d169b ==============================
[0m17:05:29.316645 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:05:29.316645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m crb_report', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:05:29.801459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aebe2687-431e-4d4d-8947-eaafb73d169b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD97B396A0>]}
[0m17:05:29.864869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aebe2687-431e-4d4d-8947-eaafb73d169b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD97BCF8C0>]}
[0m17:05:29.864869 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:05:30.320313 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:05:30.480126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:05:30.480126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:05:30.493573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:05:30.511272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aebe2687-431e-4d4d-8947-eaafb73d169b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD98E73F80>]}
[0m17:05:30.589040 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:05:30.589040 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:05:30.622957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aebe2687-431e-4d4d-8947-eaafb73d169b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9905FFB0>]}
[0m17:05:30.622957 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:05:30.622957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aebe2687-431e-4d4d-8947-eaafb73d169b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD98C87D40>]}
[0m17:05:30.622957 [info ] [MainThread]: 
[0m17:05:30.622957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:30.622957 [info ] [MainThread]: 
[0m17:05:30.622957 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:05:30.622957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:05:30.734043 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:05:30.734043 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:05:30.734043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:32.075625 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.341 seconds
[0m17:05:32.098110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:05:32.120880 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:05:32.120880 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:05:32.120880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:33.156913 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.043 seconds
[0m17:05:33.184252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aebe2687-431e-4d4d-8947-eaafb73d169b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD97C32720>]}
[0m17:05:33.188570 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m17:05:33.188570 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.crb_report ......................... [RUN]
[0m17:05:33.188570 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m17:05:33.188570 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m17:05:33.188570 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m17:05:33.188570 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m17:05:33.225074 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m17:05:33.225074 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m17:05:33.225074 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.crb_report
         as
        (WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
customer_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
),
product_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
),

crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        cr.revenue_rank AS customer_rank,
        pr.revenue_rank AS product_rank,    
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        -- SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        -- SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        -- SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        -- DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        -- DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
    LEFT JOIN customer_ranks cr ON t.customer_id = cr.customer_id
    LEFT JOIN product_ranks pr ON t.product_id = pr.product_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue
)

SELECT * FROM crb
        );
[0m17:05:33.225074 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:05:34.240587 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0057-3201-7d7b-000c-493e0002293e
[0m17:05:34.240587 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 0 at position -1
'SYS_VW.REVENUE_RANK_1' in select clause is neither an aggregate nor in the group by clause.
[0m17:05:34.256413 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  001104 (42601): SQL compilation error: error line 0 at position -1
  'SYS_VW.REVENUE_RANK_1' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m17:05:34.256413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aebe2687-431e-4d4d-8947-eaafb73d169b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD98C5BA70>]}
[0m17:05:34.256413 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.crb_report ................ [[31mERROR[0m in 1.07s]
[0m17:05:34.256413 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m17:05:34.256413 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  001104 (42601): SQL compilation error: error line 0 at position -1
  'SYS_VW.REVENUE_RANK_1' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m17:05:34.256413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:34.256413 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:05:34.256413 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:05:34.598115 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:05:34.598115 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:05:34.934801 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m17:05:34.934801 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m17:05:35.275203 [info ] [MainThread]: 
[0m17:05:35.275203 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m17:05:35.275203 [debug] [MainThread]: Command end result
[0m17:05:35.302832 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:05:35.304834 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:05:35.310209 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:05:35.310209 [info ] [MainThread]: 
[0m17:05:35.310209 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:05:35.310209 [info ] [MainThread]: 
[0m17:05:35.310209 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  001104 (42601): SQL compilation error: error line 0 at position -1
  'SYS_VW.REVENUE_RANK_1' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m17:05:35.310209 [info ] [MainThread]: 
[0m17:05:35.310209 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:05:35.310209 [debug] [MainThread]: Command `dbt run` failed at 17:05:35.310209 after 6.16 seconds
[0m17:05:35.310209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9372C5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD96BA0A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD969A8C20>]}
[0m17:05:35.310209 [debug] [MainThread]: Flushing usage events
[0m17:05:36.224611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:18.596721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A70C980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A38A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A70DE20>]}


============================== 17:06:18.596721 | 1cbd9dd1-f502-49c7-8f45-64a300d2b191 ==============================
[0m17:06:18.596721 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:06:18.596721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m crb_report', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:19.087199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cbd9dd1-f502-49c7-8f45-64a300d2b191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93C4157C0>]}
[0m17:06:19.153677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cbd9dd1-f502-49c7-8f45-64a300d2b191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93B3BD0D0>]}
[0m17:06:19.153677 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:06:19.633966 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:06:19.803827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:19.804293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:19.804293 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:06:19.839267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cbd9dd1-f502-49c7-8f45-64a300d2b191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93C667E00>]}
[0m17:06:19.903994 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:06:19.903994 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:06:19.945380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cbd9dd1-f502-49c7-8f45-64a300d2b191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93C852D80>]}
[0m17:06:19.945380 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:06:19.946483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cbd9dd1-f502-49c7-8f45-64a300d2b191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93C44AF60>]}
[0m17:06:19.948482 [info ] [MainThread]: 
[0m17:06:19.948482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:19.949485 [info ] [MainThread]: 
[0m17:06:19.950455 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:06:19.951455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:06:20.055397 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:06:20.055397 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:06:20.055397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:21.359190 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.303 seconds
[0m17:06:21.365748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:06:21.372176 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:06:21.372176 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:06:21.372176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:22.402214 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.024 seconds
[0m17:06:22.406240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cbd9dd1-f502-49c7-8f45-64a300d2b191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A70D550>]}
[0m17:06:22.416755 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m17:06:22.416755 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.crb_report ......................... [RUN]
[0m17:06:22.416755 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m17:06:22.416755 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m17:06:22.427328 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m17:06:22.428339 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m17:06:22.457265 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m17:06:22.457265 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m17:06:22.457265 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.crb_report
         as
        (WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
customer_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
),
product_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
),

crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        cr.revenue_rank AS customer_rank,
        pr.revenue_rank AS product_rank,    
        -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
        -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
        -- SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
        -- SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
        -- SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
        -- DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
        -- DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
    LEFT JOIN customer_ranks cr ON t.customer_id = cr.customer_id
    LEFT JOIN product_ranks pr ON t.product_id = pr.product_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue
)

SELECT * FROM crb
        );
[0m17:06:22.457265 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:06:23.419164 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0058-3201-7d7b-000c-493e00022946
[0m17:06:23.421175 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 0 at position -1
'SYS_VW.REVENUE_RANK_1' in select clause is neither an aggregate nor in the group by clause.
[0m17:06:23.426846 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  001104 (42601): SQL compilation error: error line 0 at position -1
  'SYS_VW.REVENUE_RANK_1' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m17:06:23.430865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cbd9dd1-f502-49c7-8f45-64a300d2b191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E939BC47D0>]}
[0m17:06:23.432871 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.crb_report ................ [[31mERROR[0m in 1.01s]
[0m17:06:23.432871 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m17:06:23.434879 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  001104 (42601): SQL compilation error: error line 0 at position -1
  'SYS_VW.REVENUE_RANK_1' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m17:06:23.434879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:23.434879 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:06:23.434879 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:06:23.751816 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:06:23.751816 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:06:24.091952 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m17:06:24.091952 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m17:06:24.408907 [info ] [MainThread]: 
[0m17:06:24.408907 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m17:06:24.424283 [debug] [MainThread]: Command end result
[0m17:06:24.447605 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:06:24.447605 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:06:24.455496 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:06:24.455496 [info ] [MainThread]: 
[0m17:06:24.457504 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:06:24.458373 [info ] [MainThread]: 
[0m17:06:24.459382 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  001104 (42601): SQL compilation error: error line 0 at position -1
  'SYS_VW.REVENUE_RANK_1' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m17:06:24.460381 [info ] [MainThread]: 
[0m17:06:24.461381 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:06:24.462381 [debug] [MainThread]: Command `dbt run` failed at 17:06:24.462381 after 6.02 seconds
[0m17:06:24.462381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E937DD1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93837FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A0D9EE0>]}
[0m17:06:24.463382 [debug] [MainThread]: Flushing usage events
[0m17:06:25.711754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:14.006170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D62039E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D62AD5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D62AD49E0>]}


============================== 17:09:14.006170 | 2487dbe0-7810-4b9a-8e1e-1fd1de5e6aaa ==============================
[0m17:09:14.006170 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:09:14.006170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:09:14.488570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2487dbe0-7810-4b9a-8e1e-1fd1de5e6aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D634B7950>]}
[0m17:09:14.540654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2487dbe0-7810-4b9a-8e1e-1fd1de5e6aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D5FEA2AE0>]}
[0m17:09:14.540654 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:09:15.026815 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:09:15.184303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:15.184303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:15.189983 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:09:15.213992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2487dbe0-7810-4b9a-8e1e-1fd1de5e6aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D64911070>]}
[0m17:09:15.289873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:09:15.289873 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:09:15.309881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2487dbe0-7810-4b9a-8e1e-1fd1de5e6aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D64CB3380>]}
[0m17:09:15.325841 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:09:15.325841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2487dbe0-7810-4b9a-8e1e-1fd1de5e6aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D648D3080>]}
[0m17:09:15.327849 [info ] [MainThread]: 
[0m17:09:15.327849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:15.327849 [info ] [MainThread]: 
[0m17:09:15.327849 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:09:15.327849 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:09:15.432049 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:09:15.433049 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:09:15.433049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:16.848153 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.428 seconds
[0m17:09:16.864812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:09:16.880751 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:09:16.880751 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:09:16.880751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:17.870911 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.997 seconds
[0m17:09:17.894533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2487dbe0-7810-4b9a-8e1e-1fd1de5e6aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D64CB0920>]}
[0m17:09:17.902872 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:09:17.902872 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn .. [RUN]
[0m17:09:17.902872 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m17:09:17.902872 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:09:17.913434 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m17:09:17.915440 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:09:17.933294 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m17:09:17.951146 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m17:09:17.951146 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
-- product_churn_lm AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- product_churn_l3m AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '90 Days'
--     GROUP BY
--         product_id
-- ),
-- product_churn_ltm AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '1 year'
--     GROUP BY
--         product_id
-- ),
-- cross_sell_lm AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
--         AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
-- ),
-- cross_sell_l3m AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
--         AND ct1.payment_month >= CURRENT_DATE - INTERVAL '90 Days'
-- ),
-- cross_sell_ltm AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
--         AND ct1.payment_month >= CURRENT_DATE - INTERVAL '1 year'
-- )
-- SELECT
--     p.product_id,
--     p.churned_customers,
--     COUNT(cs_lm.product_id_2) AS cross_sell_opportunities_lm,
--     COUNT(cs_l3m.product_id_2) AS cross_sell_opportunities_l3m,
--     COUNT(cs_ltm.product_id_2) AS cross_sell_opportunities_ltm
-- FROM
--     product_churn_ltm p
-- LEFT JOIN
--     cross_sell_lm cs_lm
-- ON
--     p.product_id = cs_lm.product_id_1
-- LEFT JOIN
--     cross_sell_l3m cs_l3m
-- ON
--     p.product_id = cs_l3m.product_id_1
-- LEFT JOIN
--     cross_sell_ltm cs_ltm
-- ON
--     p.product_id = cs_ltm.product_id_1
-- GROUP BY
--     p.product_id, p.churned_customers
-- ORDER BY
--     p.product_id




WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
product_churn_lm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
product_churn_l3m AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_l3m
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '90 Days'
    GROUP BY
        product_id
),
product_churn_ltm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_ltm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '1 year'
    GROUP BY
        product_id
),
cross_sell_lm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
),
cross_sell_l3m AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '90 Days'
),
cross_sell_ltm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '1 year'
)
SELECT
    p.product_id,
    p.churned_customers_lm,
    p3m.churned_customers_l3m,
    p12m.churned_customers_ltm,
    COUNT(cs_lm.product_id_2) AS cross_sell_opportunities_lm,
    COUNT(cs_l3m.product_id_2) AS cross_sell_opportunities_l3m,
    COUNT(cs_ltm.product_id_2) AS cross_sell_opportunities_ltm
FROM
    product_churn_lm p
LEFT JOIN
    product_churn_l3m p3m
ON
    p.product_id = p3m.product_id
LEFT JOIN
    product_churn_ltm p12m
ON
    p.product_id = p12m.product_id
LEFT JOIN
    cross_sell_lm cs_lm
ON
    p.product_id = cs_lm.product_id_1
LEFT JOIN
    cross_sell_l3m cs_l3m
ON
    p.product_id = cs_l3m.product_id_1
LEFT JOIN
    cross_sell_ltm cs_ltm
ON
    p.product_id = cs_ltm.product_id_1
GROUP BY
    p.product_id, p.churned_customers_lm, p3m.churned_customers_l3m, p12m.churned_customers_ltm
ORDER BY
    p.product_id;
[0m17:09:17.952144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:09:18.897039 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb005b-3201-7e57-000c-493e0002659e
[0m17:09:18.897039 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 236 at position 16 unexpected ';'.
[0m17:09:18.906605 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 236 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m17:09:18.906605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2487dbe0-7810-4b9a-8e1e-1fd1de5e6aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D64F01A60>]}
[0m17:09:18.906605 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.00s]
[0m17:09:18.917606 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:09:18.917606 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 236 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m17:09:18.917606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:18.922393 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:09:18.922393 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:09:19.249011 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:09:19.249011 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:09:19.584995 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m17:09:19.584995 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m17:09:19.926388 [info ] [MainThread]: 
[0m17:09:19.926388 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m17:09:19.933813 [debug] [MainThread]: Command end result
[0m17:09:19.969561 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:09:19.971571 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:09:19.971571 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:09:19.971571 [info ] [MainThread]: 
[0m17:09:19.971571 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:09:19.971571 [info ] [MainThread]: 
[0m17:09:19.971571 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 236 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m17:09:19.983246 [info ] [MainThread]: 
[0m17:09:19.984084 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:09:19.984084 [debug] [MainThread]: Command `dbt run` failed at 17:09:19.984084 after 6.14 seconds
[0m17:09:19.986868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D62AD4E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D62AD5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D62AD4CB0>]}
[0m17:09:19.986868 [debug] [MainThread]: Flushing usage events
[0m17:09:21.279828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:14.825495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022689D10290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022689D10500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022689D107A0>]}


============================== 17:11:14.825495 | 4d0b0f6d-44af-43df-aaa3-59f326b9b0c7 ==============================
[0m17:11:14.825495 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:11:14.825495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'send_anonymous_usage_stats': 'True'}
[0m17:11:15.787894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d0b0f6d-44af-43df-aaa3-59f326b9b0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268A93FD10>]}
[0m17:11:15.845559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d0b0f6d-44af-43df-aaa3-59f326b9b0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268BB16DB0>]}
[0m17:11:15.845559 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:11:16.426182 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:11:16.583429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:16.583429 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:16.583429 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:11:16.617932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d0b0f6d-44af-43df-aaa3-59f326b9b0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268BBF7DA0>]}
[0m17:11:16.694016 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:11:16.708061 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:11:16.729424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d0b0f6d-44af-43df-aaa3-59f326b9b0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268BBB0770>]}
[0m17:11:16.729424 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:11:16.729424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d0b0f6d-44af-43df-aaa3-59f326b9b0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268BB70950>]}
[0m17:11:16.729424 [info ] [MainThread]: 
[0m17:11:16.729424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:16.729424 [info ] [MainThread]: 
[0m17:11:16.745210 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:11:16.745210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:11:19.857184 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:11:19.857184 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:11:19.857184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:21.277983 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.420 seconds
[0m17:11:21.277983 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:11:21.277983 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:11:21.293684 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:11:21.293684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:22.217467 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.925 seconds
[0m17:11:22.217467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d0b0f6d-44af-43df-aaa3-59f326b9b0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268BD508F0>]}
[0m17:11:22.217467 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:11:22.217467 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn .. [RUN]
[0m17:11:22.217467 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m17:11:22.217467 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:11:22.237405 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m17:11:22.239411 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:11:22.271668 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m17:11:22.272274 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m17:11:22.272274 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
-- product_churn_lm AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- product_churn_l3m AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '90 Days'
--     GROUP BY
--         product_id
-- ),
-- product_churn_ltm AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '1 year'
--     GROUP BY
--         product_id
-- ),
-- cross_sell_lm AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
--         AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
-- ),
-- cross_sell_l3m AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
--         AND ct1.payment_month >= CURRENT_DATE - INTERVAL '90 Days'
-- ),
-- cross_sell_ltm AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
--         AND ct1.payment_month >= CURRENT_DATE - INTERVAL '1 year'
-- )
-- SELECT
--     p.product_id,
--     p.churned_customers,
--     COUNT(cs_lm.product_id_2) AS cross_sell_opportunities_lm,
--     COUNT(cs_l3m.product_id_2) AS cross_sell_opportunities_l3m,
--     COUNT(cs_ltm.product_id_2) AS cross_sell_opportunities_ltm
-- FROM
--     product_churn_ltm p
-- LEFT JOIN
--     cross_sell_lm cs_lm
-- ON
--     p.product_id = cs_lm.product_id_1
-- LEFT JOIN
--     cross_sell_l3m cs_l3m
-- ON
--     p.product_id = cs_l3m.product_id_1
-- LEFT JOIN
--     cross_sell_ltm cs_ltm
-- ON
--     p.product_id = cs_ltm.product_id_1
-- GROUP BY
--     p.product_id, p.churned_customers
-- ORDER BY
--     p.product_id




WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
product_churn_lm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
product_churn_l3m AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_l3m
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '90 Days'
    GROUP BY
        product_id
),
product_churn_ltm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_ltm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '1 year'
    GROUP BY
        product_id
),
cross_sell_lm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
),
cross_sell_l3m AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '90 Days'
),
cross_sell_ltm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '1 year'
)
SELECT
    p.product_id,
    p.churned_customers_lm,
    p3m.churned_customers_l3m,
    p12m.churned_customers_ltm,
    COUNT(cs_lm.product_id_2) AS cross_sell_opportunities_lm,
    COUNT(cs_l3m.product_id_2) AS cross_sell_opportunities_l3m,
    COUNT(cs_ltm.product_id_2) AS cross_sell_opportunities_ltm
FROM
    product_churn_lm p
LEFT JOIN
    product_churn_l3m p3m
ON
    p.product_id = p3m.product_id
LEFT JOIN
    product_churn_ltm p12m
ON
    p.product_id = p12m.product_id
LEFT JOIN
    cross_sell_lm cs_lm
ON
    p.product_id = cs_lm.product_id_1
LEFT JOIN
    cross_sell_l3m cs_l3m
ON
    p.product_id = cs_l3m.product_id_1
LEFT JOIN
    cross_sell_ltm cs_ltm
ON
    p.product_id = cs_ltm.product_id_1
GROUP BY
    p.product_id, p.churned_customers_lm, p3m.churned_customers_l3m, p12m.churned_customers_ltm
ORDER BY
    p.product_id
        );
[0m17:11:22.272274 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:11:24.073642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.809 seconds
[0m17:11:24.112786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d0b0f6d-44af-43df-aaa3-59f326b9b0c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268BBDEC60>]}
[0m17:11:24.114792 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 1.89s]
[0m17:11:24.114792 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m17:11:24.114792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:24.114792 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:11:24.114792 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:11:24.496912 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:11:24.496912 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:11:24.835160 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m17:11:24.835160 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m17:11:25.179677 [info ] [MainThread]: 
[0m17:11:25.179677 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.45 seconds (8.45s).
[0m17:11:25.179677 [debug] [MainThread]: Command end result
[0m17:11:25.193775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:11:25.193775 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:11:25.213809 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:11:25.213809 [info ] [MainThread]: 
[0m17:11:25.213809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:25.213809 [info ] [MainThread]: 
[0m17:11:25.213809 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:11:25.213809 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:25.213809 after 10.56 seconds
[0m17:11:25.213809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226893DDC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022687AAE720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022687AAE750>]}
[0m17:11:25.213809 [debug] [MainThread]: Flushing usage events
[0m17:11:26.392355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:48.077863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025184C82D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002518507B860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025184C82EA0>]}


============================== 17:15:48.078875 | 5cc29a74-b428-4781-b78d-f679f35fc8fb ==============================
[0m17:15:48.078875 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:15:48.078875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m crb_report', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:48.502814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cc29a74-b428-4781-b78d-f679f35fc8fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251864FCD70>]}
[0m17:15:48.550830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cc29a74-b428-4781-b78d-f679f35fc8fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025186251A00>]}
[0m17:15:48.566692 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:15:49.050236 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:15:49.212952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:49.212952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:49.217228 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:15:49.238270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cc29a74-b428-4781-b78d-f679f35fc8fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002518768BE30>]}
[0m17:15:49.320684 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:15:49.320684 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:15:49.336746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cc29a74-b428-4781-b78d-f679f35fc8fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251879F0230>]}
[0m17:15:49.336746 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:15:49.336746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc29a74-b428-4781-b78d-f679f35fc8fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251879B6CC0>]}
[0m17:15:49.336746 [info ] [MainThread]: 
[0m17:15:49.351470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:49.352475 [info ] [MainThread]: 
[0m17:15:49.352475 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:15:49.352475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:15:49.454424 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:15:49.455477 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:15:49.455477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:50.802921 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.347 seconds
[0m17:15:50.808935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:15:50.818694 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:15:50.818694 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:15:50.818694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:51.765349 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.951 seconds
[0m17:15:51.774742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc29a74-b428-4781-b78d-f679f35fc8fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002518768B290>]}
[0m17:15:51.774742 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m17:15:51.774742 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.crb_report ......................... [RUN]
[0m17:15:51.774742 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m17:15:51.781015 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m17:15:51.781015 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m17:15:51.781015 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m17:15:51.811018 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m17:15:51.825310 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m17:15:51.825310 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.crb_report
         as
        (-- WITH customer_data AS (
--     SELECT
--         customer_id,
--         customer_name
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- product_data AS (
--     SELECT
--         product_id,
--         product_family,
--         product_sub_family
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
-- ),
-- transaction_data AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month,
--         revenue,
--         SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
--         LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
--         CASE
--             WHEN revenue > prev_revenue THEN 'Expansion'
--             WHEN revenue < prev_revenue THEN 'Contraction'
--             ELSE 'Stable'
--         END AS revenue_trend
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
-- customer_ranks AS (
--     SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
-- ),
-- product_ranks AS (
--     SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
-- ),

-- crb AS (
--     SELECT
--         t.customer_id,
--         t.product_id,
--         p.product_family,
--         p.product_sub_family,
--         t.revenue,
--         t.prev_revenue,
--         t.revenue_trend,
--         l.region,
--         l.country,
--         cr.revenue_rank AS customer_rank,
--         pr.revenue_rank AS product_rank,    
--         -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
--         -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
--         -- SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
--         -- SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
--         -- SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
--         -- DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
--         -- DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
--     FROM transaction_data t
--     LEFT JOIN customer_data c ON t.customer_id = c.customer_id
--     LEFT JOIN product_data p ON t.product_id = p.product_id
--     LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
--     LEFT JOIN customer_ranks cr ON t.customer_id = cr.customer_id
--     LEFT JOIN product_ranks pr ON t.product_id = pr.product_id
--     GROUP BY 
--         t.customer_id, 
--         t.product_id, 
--         p.product_family, 
--         p.product_sub_family, 
--         t.revenue, 
--         t.prev_revenue, 
--         t.revenue_trend, 
--         l.region, 
--         l.country, 
--         t.total_revenue
-- )

-- SELECT * FROM crb




WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
customer_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
),
product_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
),

crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        cr.revenue_rank AS customer_rank,
        pr.revenue_rank AS product_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
    LEFT JOIN customer_ranks cr ON t.customer_id = cr.customer_id
    LEFT JOIN product_ranks pr ON t.product_id = pr.product_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue,
        cr.revenue_rank,
        pr.revenue_rank
)

SELECT * FROM crb;
[0m17:15:51.825310 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:15:52.937350 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0061-3201-7d7b-000c-493e00022a5a
[0m17:15:52.937350 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 151 at position 17 unexpected ';'.
[0m17:15:52.957540 [debug] [Thread-1 (]: Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 151 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m17:15:52.959549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc29a74-b428-4781-b78d-f679f35fc8fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025184CA4AA0>]}
[0m17:15:52.959549 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.crb_report ................ [[31mERROR[0m in 1.18s]
[0m17:15:52.959549 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m17:15:52.959549 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.crb_report' to be skipped because of status 'error'.  Reason: Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 151 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql.
[0m17:15:52.959549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:52.959549 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:15:52.959549 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:15:53.328192 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:15:53.328192 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:15:53.660932 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m17:15:53.660932 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m17:15:54.005098 [info ] [MainThread]: 
[0m17:15:54.005098 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m17:15:54.005098 [debug] [MainThread]: Command end result
[0m17:15:54.033548 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:15:54.033548 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:15:54.042577 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:15:54.044585 [info ] [MainThread]: 
[0m17:15:54.044585 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:15:54.044585 [info ] [MainThread]: 
[0m17:15:54.046593 [error] [MainThread]:   Database Error in model crb_report (models\reporting\crb_report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 151 at position 17 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\crb_report.sql
[0m17:15:54.046593 [info ] [MainThread]: 
[0m17:15:54.046593 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:15:54.046593 [debug] [MainThread]: Command `dbt run` failed at 17:15:54.046593 after 6.14 seconds
[0m17:15:54.050749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251850EBFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251856C2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251856C36B0>]}
[0m17:15:54.050749 [debug] [MainThread]: Flushing usage events
[0m17:15:54.952126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:03.294617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D564AD0290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56483A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D564AD1CD0>]}


============================== 17:16:03.294617 | 9757c4ff-f283-4bb5-bbf4-c0b813fbedc7 ==============================
[0m17:16:03.294617 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:16:03.294617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m crb_report', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:03.727147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9757c4ff-f283-4bb5-bbf4-c0b813fbedc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D564AE9C10>]}
[0m17:16:03.780140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9757c4ff-f283-4bb5-bbf4-c0b813fbedc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D566767D40>]}
[0m17:16:03.780140 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:16:04.284915 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:16:04.450803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:04.451803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:04.456421 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:16:04.487580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9757c4ff-f283-4bb5-bbf4-c0b813fbedc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5668B0770>]}
[0m17:16:04.552328 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:16:04.552328 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:16:04.583948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9757c4ff-f283-4bb5-bbf4-c0b813fbedc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5668F85F0>]}
[0m17:16:04.583948 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:16:04.583948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9757c4ff-f283-4bb5-bbf4-c0b813fbedc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56673C9E0>]}
[0m17:16:04.583948 [info ] [MainThread]: 
[0m17:16:04.583948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:04.583948 [info ] [MainThread]: 
[0m17:16:04.583948 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:16:04.583948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:16:04.693396 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:16:04.693396 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:16:04.694398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:06.016114 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.325 seconds
[0m17:16:06.027216 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:16:06.035728 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:16:06.036728 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:16:06.037533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:06.984151 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.954 seconds
[0m17:16:06.984151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9757c4ff-f283-4bb5-bbf4-c0b813fbedc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5668DD4F0>]}
[0m17:16:06.999865 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m17:16:06.999865 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.crb_report ......................... [RUN]
[0m17:16:06.999865 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m17:16:06.999865 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m17:16:07.011246 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m17:16:07.011246 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m17:16:07.038985 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m17:16:07.038985 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m17:16:07.038985 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.crb_report
         as
        (-- WITH customer_data AS (
--     SELECT
--         customer_id,
--         customer_name
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
-- ),
-- product_data AS (
--     SELECT
--         product_id,
--         product_family,
--         product_sub_family
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
-- ),
-- transaction_data AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month,
--         revenue,
--         SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
--         LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
--         CASE
--             WHEN revenue > prev_revenue THEN 'Expansion'
--             WHEN revenue < prev_revenue THEN 'Contraction'
--             ELSE 'Stable'
--         END AS revenue_trend
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
-- ),
-- customer_ranks AS (
--     SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
-- ),
-- product_ranks AS (
--     SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
-- ),

-- crb AS (
--     SELECT
--         t.customer_id,
--         t.product_id,
--         p.product_family,
--         p.product_sub_family,
--         t.revenue,
--         t.prev_revenue,
--         t.revenue_trend,
--         l.region,
--         l.country,
--         cr.revenue_rank AS customer_rank,
--         pr.revenue_rank AS product_rank,    
--         -- SUM(CASE WHEN customer_status = 'New' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS new_customers,
--         -- SUM(CASE WHEN customer_status = 'Churned' THEN 1 ELSE 0 END) OVER (PARTITION BY YEAR(transaction_date)) AS churned_customers,
--         -- SUM(CASE WHEN t.revenue_trend = 'Expansion' THEN t.revenue ELSE 0 END) OVER () AS net_nrr,
--         -- SUM(CASE WHEN t.revenue_trend IN ('Expansion', 'Stable') THEN t.revenue ELSE 0 END) OVER () AS gross_nrr,
--         -- SUM(CASE WHEN t.revenue_trend = 'Contraction' THEN t.revenue ELSE 0 END) OVER (PARTITION BY YEAR(t.payment_month)) AS revenue_lost,
--         -- DENSE_RANK() OVER (ORDER BY t.total_revenue DESC) AS product_rank,
--         -- DENSE_RANK() OVER (ORDER BY SUM(t.revenue) OVER (PARTITION BY t.customer_id) DESC) AS customer_rank
--     FROM transaction_data t
--     LEFT JOIN customer_data c ON t.customer_id = c.customer_id
--     LEFT JOIN product_data p ON t.product_id = p.product_id
--     LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
--     LEFT JOIN customer_ranks cr ON t.customer_id = cr.customer_id
--     LEFT JOIN product_ranks pr ON t.product_id = pr.product_id
--     GROUP BY 
--         t.customer_id, 
--         t.product_id, 
--         p.product_family, 
--         p.product_sub_family, 
--         t.revenue, 
--         t.prev_revenue, 
--         t.revenue_trend, 
--         l.region, 
--         l.country, 
--         t.total_revenue
-- )

-- SELECT * FROM crb




WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue > prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
            ELSE 'Stable'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
),
customer_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_customers
),
product_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA.mart_rank_products
),

crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        cr.revenue_rank AS customer_rank,
        pr.revenue_rank AS product_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA.stg_locations l ON t.customer_id = l.customer_id
    LEFT JOIN customer_ranks cr ON t.customer_id = cr.customer_id
    LEFT JOIN product_ranks pr ON t.product_id = pr.product_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue,
        cr.revenue_rank,
        pr.revenue_rank
)

SELECT * FROM crb
        );
[0m17:16:07.038985 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:16:09.111622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.062 seconds
[0m17:16:09.136721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9757c4ff-f283-4bb5-bbf4-c0b813fbedc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D561E717F0>]}
[0m17:16:09.136721 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.crb_report .................... [[32mSUCCESS 1[0m in 2.13s]
[0m17:16:09.136721 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m17:16:09.136721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:09.136721 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:16:09.136721 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:16:09.461344 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:16:09.461344 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:16:09.804529 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m17:16:09.804529 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m17:16:10.137919 [info ] [MainThread]: 
[0m17:16:10.137919 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m17:16:10.138950 [debug] [MainThread]: Command end result
[0m17:16:10.162207 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:16:10.164578 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:16:10.170675 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:16:10.170675 [info ] [MainThread]: 
[0m17:16:10.170675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:10.170675 [info ] [MainThread]: 
[0m17:16:10.170675 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:16:10.174898 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:10.174898 after 7.05 seconds
[0m17:16:10.175927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D562808530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56286EA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D56286E900>]}
[0m17:16:10.176907 [debug] [MainThread]: Flushing usage events
[0m17:16:11.096170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:22.949290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767ED9A180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767C2828A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767ED9A1E0>]}


============================== 17:49:22.949290 | 9cafef39-a412-4e81-85ea-10a661fd110b ==============================
[0m17:49:22.949290 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:49:22.949290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:49:24.173911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cafef39-a412-4e81-85ea-10a661fd110b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767EEEABD0>]}
[0m17:49:24.240610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cafef39-a412-4e81-85ea-10a661fd110b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767FA5FEC0>]}
[0m17:49:24.240610 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:49:24.841332 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:49:25.006844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:25.007902 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:25.007902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:49:25.042007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cafef39-a412-4e81-85ea-10a661fd110b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767FC42450>]}
[0m17:49:25.115092 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:49:25.133644 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:49:25.183542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cafef39-a412-4e81-85ea-10a661fd110b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002760110A030>]}
[0m17:49:25.186342 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:49:25.186342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cafef39-a412-4e81-85ea-10a661fd110b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767FEEEA20>]}
[0m17:49:25.186342 [info ] [MainThread]: 
[0m17:49:25.186342 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:25.190067 [info ] [MainThread]: 
[0m17:49:25.190067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:49:25.190067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:49:28.699009 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:49:28.699009 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:49:28.699009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:30.169087 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.471 seconds
[0m17:49:30.184828 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:49:30.200553 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:49:30.200553 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:49:30.200553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:31.220357 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.022 seconds
[0m17:49:31.232894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cafef39-a412-4e81-85ea-10a661fd110b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767F8BAF00>]}
[0m17:49:31.236496 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:49:31.236496 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m17:49:31.236496 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m17:49:31.236496 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:49:31.236496 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:49:31.236496 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:49:31.282515 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:49:31.282515 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:49:31.282515 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (-- WITH purchases AS (
--     SELECT customer_id,
--     MIN(payment_month) AS first_purchase_month,
--     MAX(payment_month) AS last_purchase_month
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- )
-- SELECT
--     t.payment_month,
--     COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--     COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
-- FROM stg_transactions t
-- LEFT JOIN purchases p ON t.customer_id = p.customer_id
-- GROUP BY t.payment_month
-- ORDER BY t.payment_month





WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
)
SELECT
    CURRENT_DATE AS report_date,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
FROM
    new_and_churned_customers;
[0m17:49:31.282515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:32.415301 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0083-3201-7e56-000c-493e00024796
[0m17:49:32.415301 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 54 at position 29 unexpected ';'.
[0m17:49:32.435250 [debug] [Thread-1 (]: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m17:49:32.435250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cafef39-a412-4e81-85ea-10a661fd110b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767E3847D0>]}
[0m17:49:32.435250 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[31mERROR[0m in 1.20s]
[0m17:49:32.435250 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:49:32.435250 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_new_and_churned_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql.
[0m17:49:32.435250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:32.435250 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:49:32.435250 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:49:32.768695 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:49:32.770699 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:49:33.082781 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m17:49:33.095344 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m17:49:33.432888 [info ] [MainThread]: 
[0m17:49:33.433914 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.24 seconds (8.24s).
[0m17:49:33.436849 [debug] [MainThread]: Command end result
[0m17:49:33.475109 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:49:33.477122 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:49:33.484747 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:49:33.484747 [info ] [MainThread]: 
[0m17:49:33.485740 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:49:33.486773 [info ] [MainThread]: 
[0m17:49:33.487739 [error] [MainThread]:   Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 54 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m17:49:33.487739 [info ] [MainThread]: 
[0m17:49:33.488738 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:49:33.489581 [debug] [MainThread]: Command `dbt run` failed at 17:49:33.489581 after 10.73 seconds
[0m17:49:33.489581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767CB2DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767EA0A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767EA0BC20>]}
[0m17:49:33.489581 [debug] [MainThread]: Flushing usage events
[0m17:49:34.418805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:42.993406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911F341D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911F3403E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911F343E60>]}


============================== 17:49:42.993406 | be9c419e-4b55-4c2f-948c-bbc1b0650c51 ==============================
[0m17:49:42.993406 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:49:42.993406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:49:43.511037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be9c419e-4b55-4c2f-948c-bbc1b0650c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019120023AD0>]}
[0m17:49:43.562915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be9c419e-4b55-4c2f-948c-bbc1b0650c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911EDEF3B0>]}
[0m17:49:43.562915 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:49:44.042616 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:49:44.208232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:44.208232 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:44.214250 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:49:44.244391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be9c419e-4b55-4c2f-948c-bbc1b0650c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001912115F8C0>]}
[0m17:49:44.308484 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:49:44.308484 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:49:44.339966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be9c419e-4b55-4c2f-948c-bbc1b0650c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191214B3140>]}
[0m17:49:44.339966 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:49:44.339966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be9c419e-4b55-4c2f-948c-bbc1b0650c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911F3158B0>]}
[0m17:49:44.339966 [info ] [MainThread]: 
[0m17:49:44.354480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:44.354480 [info ] [MainThread]: 
[0m17:49:44.354480 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:49:44.355988 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:49:44.462555 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:49:44.462555 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:49:44.462555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:45.915269 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.457 seconds
[0m17:49:45.924982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:49:45.924982 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:49:45.924982 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:49:45.924982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:46.836065 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.907 seconds
[0m17:49:46.845057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be9c419e-4b55-4c2f-948c-bbc1b0650c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191213B6030>]}
[0m17:49:46.845057 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:49:46.845057 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m17:49:46.845057 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m17:49:46.845057 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:49:46.863989 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:49:46.864987 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:49:46.895863 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:49:46.896683 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:49:46.896683 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (-- WITH purchases AS (
--     SELECT customer_id,
--     MIN(payment_month) AS first_purchase_month,
--     MAX(payment_month) AS last_purchase_month
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- )
-- SELECT
--     t.payment_month,
--     COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--     COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
-- FROM stg_transactions t
-- LEFT JOIN purchases p ON t.customer_id = p.customer_id
-- GROUP BY t.payment_month
-- ORDER BY t.payment_month





WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
)
SELECT
    CURRENT_DATE AS report_date,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
FROM
    new_and_churned_customers
        );
[0m17:49:46.896683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:48.784039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.896 seconds
[0m17:49:48.815429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be9c419e-4b55-4c2f-948c-bbc1b0650c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911C6F16A0>]}
[0m17:49:48.815429 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[32mSUCCESS 1[0m in 1.97s]
[0m17:49:48.815429 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:49:48.815429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:48.815429 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:49:48.815429 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:49:49.147629 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:49:49.149634 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:49:49.477424 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m17:49:49.477424 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m17:49:49.798497 [info ] [MainThread]: 
[0m17:49:49.798497 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m17:49:49.798497 [debug] [MainThread]: Command end result
[0m17:49:49.823199 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:49:49.823199 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:49:49.838320 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:49:49.838320 [info ] [MainThread]: 
[0m17:49:49.838320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:49.838320 [info ] [MainThread]: 
[0m17:49:49.838320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:49:49.838320 [debug] [MainThread]: Command `dbt run` succeeded at 17:49:49.838320 after 7.01 seconds
[0m17:49:49.838320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911F384DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911EE7FD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001911EE7F890>]}
[0m17:49:49.838320 [debug] [MainThread]: Flushing usage events
[0m17:49:50.743004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:15.834909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018590A110D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018590A10500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185902CE240>]}


============================== 17:51:15.838918 | c5198b8c-0ccf-47d0-a39b-14cc819d4bbc ==============================
[0m17:51:15.838918 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:51:15.838918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:16.320925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5198b8c-0ccf-47d0-a39b-14cc819d4bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859046C320>]}
[0m17:51:16.384241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5198b8c-0ccf-47d0-a39b-14cc819d4bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001858FE904D0>]}
[0m17:51:16.384241 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:51:16.884740 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:51:17.051735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:51:17.051735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:51:17.057505 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:51:17.087565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5198b8c-0ccf-47d0-a39b-14cc819d4bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185928A2480>]}
[0m17:51:17.152593 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:51:17.152593 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:51:17.185279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5198b8c-0ccf-47d0-a39b-14cc819d4bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018592C39FA0>]}
[0m17:51:17.185279 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:51:17.185279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5198b8c-0ccf-47d0-a39b-14cc819d4bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018592C40230>]}
[0m17:51:17.185279 [info ] [MainThread]: 
[0m17:51:17.185279 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:17.200050 [info ] [MainThread]: 
[0m17:51:17.200050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:51:17.200050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:51:17.303371 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:51:17.303371 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:51:17.303371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:18.686006 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.378 seconds
[0m17:51:18.692252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:51:18.701259 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:51:18.701259 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:51:18.702259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:19.635297 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.933 seconds
[0m17:51:19.635297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5198b8c-0ccf-47d0-a39b-14cc819d4bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018592A9EB40>]}
[0m17:51:19.635297 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:51:19.635297 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m17:51:19.635297 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m17:51:19.635297 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:51:19.655028 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:51:19.657169 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:51:19.689441 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:51:19.691405 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:51:19.692436 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (-- WITH purchases AS (
--     SELECT customer_id,
--     MIN(payment_month) AS first_purchase_month,
--     MAX(payment_month) AS last_purchase_month
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- )
-- SELECT
--     t.payment_month,
--     COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--     COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
-- FROM stg_transactions t
-- LEFT JOIN purchases p ON t.customer_id = p.customer_id
-- GROUP BY t.payment_month
-- ORDER BY t.payment_month





WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
)
SELECT
    CURRENT_DATE AS report_date,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
FROM
    new_and_churned_customers
        );
[0m17:51:19.692436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:20.638485 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0085-3201-7d7b-000c-493e00022b52
[0m17:51:20.638485 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 44 at position 18
invalid identifier 'PAYMENT_MONTH'
[0m17:51:20.638485 [debug] [Thread-1 (]: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  000904 (42000): SQL compilation error: error line 44 at position 18
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m17:51:20.638485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5198b8c-0ccf-47d0-a39b-14cc819d4bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001858FEB4920>]}
[0m17:51:20.638485 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[31mERROR[0m in 1.00s]
[0m17:51:20.638485 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:51:20.638485 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_new_and_churned_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  000904 (42000): SQL compilation error: error line 44 at position 18
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql.
[0m17:51:20.654198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:20.654198 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:51:20.654198 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:51:20.964820 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:51:20.964820 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:51:21.297638 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m17:51:21.299644 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m17:51:21.611757 [info ] [MainThread]: 
[0m17:51:21.611757 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m17:51:21.627559 [debug] [MainThread]: Command end result
[0m17:51:21.676329 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:51:21.676329 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:51:21.687019 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:51:21.687019 [info ] [MainThread]: 
[0m17:51:21.687019 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:51:21.689235 [info ] [MainThread]: 
[0m17:51:21.690240 [error] [MainThread]:   Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  000904 (42000): SQL compilation error: error line 44 at position 18
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m17:51:21.690977 [info ] [MainThread]: 
[0m17:51:21.690977 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:51:21.690977 [debug] [MainThread]: Command `dbt run` failed at 17:51:21.690977 after 6.03 seconds
[0m17:51:21.694010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001858CE27B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018590519EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018590518380>]}
[0m17:51:21.694010 [debug] [MainThread]: Flushing usage events
[0m17:51:22.646268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:51.731106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029065134D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029065134200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029065134260>]}


============================== 17:51:51.740520 | 5acd8450-b8ee-4e09-b248-aba1f17348f1 ==============================
[0m17:51:51.740520 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:51:51.740520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:52.231338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5acd8450-b8ee-4e09-b248-aba1f17348f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029064C9FE60>]}
[0m17:51:52.298207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5acd8450-b8ee-4e09-b248-aba1f17348f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029065C91070>]}
[0m17:51:52.298207 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:51:52.779354 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:51:52.952881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:51:52.954888 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:51:52.956394 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:51:53.027815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5acd8450-b8ee-4e09-b248-aba1f17348f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290641FE270>]}
[0m17:51:53.113375 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:51:53.117204 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:51:53.148697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5acd8450-b8ee-4e09-b248-aba1f17348f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290672D3110>]}
[0m17:51:53.148697 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:51:53.149698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5acd8450-b8ee-4e09-b248-aba1f17348f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029065E9E330>]}
[0m17:51:53.150697 [info ] [MainThread]: 
[0m17:51:53.151695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:53.152697 [info ] [MainThread]: 
[0m17:51:53.152697 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:51:53.154213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:51:53.259864 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:51:53.259864 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:51:53.259864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:54.612615 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.352 seconds
[0m17:51:54.639772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:51:54.674716 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:51:54.675716 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:51:54.676716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:55.640121 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.963 seconds
[0m17:51:55.645166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5acd8450-b8ee-4e09-b248-aba1f17348f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290672D08F0>]}
[0m17:51:55.649847 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:51:55.649847 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m17:51:55.650845 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m17:51:55.651851 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:51:55.658933 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:51:55.660898 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:51:55.679594 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:51:55.692963 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:51:55.692963 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (-- WITH purchases AS (
--     SELECT customer_id,
--     MIN(payment_month) AS first_purchase_month,
--     MAX(payment_month) AS last_purchase_month
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- )
-- SELECT
--     t.payment_month,
--     COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--     COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
-- FROM stg_transactions t
-- LEFT JOIN purchases p ON t.customer_id = p.customer_id
-- GROUP BY t.payment_month
-- ORDER BY t.payment_month





WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
)
SELECT
    CURRENT_DATE AS report_date,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
FROM
    new_and_churned_customers
        );
[0m17:51:55.692963 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:56.592629 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0085-3201-7e57-000c-493e00026776
[0m17:51:56.592629 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[T.PAYMENT_MONTH] is not a valid group by expression
[0m17:51:56.592629 [debug] [Thread-1 (]: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  000979 (42601): SQL compilation error:
  [T.PAYMENT_MONTH] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m17:51:56.592629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5acd8450-b8ee-4e09-b248-aba1f17348f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029064614950>]}
[0m17:51:56.608398 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[31mERROR[0m in 0.94s]
[0m17:51:56.608398 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:51:56.608398 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_new_and_churned_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  000979 (42601): SQL compilation error:
  [T.PAYMENT_MONTH] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql.
[0m17:51:56.608398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:56.608398 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:51:56.608398 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:51:56.936428 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:51:56.936428 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:51:57.255421 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m17:51:57.255421 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m17:51:57.581546 [info ] [MainThread]: 
[0m17:51:57.581546 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m17:51:57.581546 [debug] [MainThread]: Command end result
[0m17:51:57.616487 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:51:57.617520 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:51:57.617520 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:51:57.617520 [info ] [MainThread]: 
[0m17:51:57.626200 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:51:57.627218 [info ] [MainThread]: 
[0m17:51:57.628220 [error] [MainThread]:   Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  000979 (42601): SQL compilation error:
  [T.PAYMENT_MONTH] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m17:51:57.628220 [info ] [MainThread]: 
[0m17:51:57.629239 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:51:57.630206 [debug] [MainThread]: Command `dbt run` failed at 17:51:57.630206 after 6.06 seconds
[0m17:51:57.631239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029065D9B920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029064C69B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029065134950>]}
[0m17:51:57.631239 [debug] [MainThread]: Flushing usage events
[0m17:51:58.572453 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:14.078049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2EE98920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2EE9A420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2EE9A3C0>]}


============================== 17:52:14.078049 | 65923214-7c05-4d78-8fb3-0a48e41f818f ==============================
[0m17:52:14.078049 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:52:14.078049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:14.556897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65923214-7c05-4d78-8fb3-0a48e41f818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC30D3A990>]}
[0m17:52:14.629399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65923214-7c05-4d78-8fb3-0a48e41f818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2E8DB5C0>]}
[0m17:52:14.629399 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:52:15.091059 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:52:15.253094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:52:15.253094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:52:15.253094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:52:15.278989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65923214-7c05-4d78-8fb3-0a48e41f818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC30DE8B30>]}
[0m17:52:15.359492 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:52:15.359492 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:52:15.390837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65923214-7c05-4d78-8fb3-0a48e41f818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC31143F50>]}
[0m17:52:15.390837 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:52:15.390837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65923214-7c05-4d78-8fb3-0a48e41f818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC30D9FEC0>]}
[0m17:52:15.390837 [info ] [MainThread]: 
[0m17:52:15.390837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:15.390837 [info ] [MainThread]: 
[0m17:52:15.390837 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:52:15.390837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:52:15.504195 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:52:15.505195 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:52:15.505195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:16.910140 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.404 seconds
[0m17:52:16.915685 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:52:16.919845 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:52:16.919845 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:52:16.919845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:17.890990 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.978 seconds
[0m17:52:17.906855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65923214-7c05-4d78-8fb3-0a48e41f818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC30DEB290>]}
[0m17:52:17.906855 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:52:17.906855 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m17:52:17.906855 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m17:52:17.906855 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:52:17.922944 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:52:17.922944 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:52:17.948327 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:52:17.964131 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:52:17.965121 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (-- WITH purchases AS (
--     SELECT customer_id,
--     MIN(payment_month) AS first_purchase_month,
--     MAX(payment_month) AS last_purchase_month
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- )
-- SELECT
--     t.payment_month,
--     COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--     COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
-- FROM stg_transactions t
-- LEFT JOIN purchases p ON t.customer_id = p.customer_id
-- GROUP BY t.payment_month
-- ORDER BY t.payment_month





WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
)
SELECT
    CURRENT_DATE AS report_date,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
FROM
    new_and_churned_customers
        );
[0m17:52:17.965121 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:52:18.893975 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0086-3201-7d7b-000c-493e00022b5a
[0m17:52:18.893975 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[T.PAYMENT_MONTH] is not a valid group by expression
[0m17:52:18.909811 [debug] [Thread-1 (]: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  000979 (42601): SQL compilation error:
  [T.PAYMENT_MONTH] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m17:52:18.909811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65923214-7c05-4d78-8fb3-0a48e41f818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2E4749E0>]}
[0m17:52:18.909811 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[31mERROR[0m in 1.00s]
[0m17:52:18.909811 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:52:18.909811 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_new_and_churned_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  000979 (42601): SQL compilation error:
  [T.PAYMENT_MONTH] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql.
[0m17:52:18.925716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:18.925716 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:52:18.925716 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:52:19.252591 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:52:19.252591 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:52:19.574192 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m17:52:19.574192 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m17:52:19.898796 [info ] [MainThread]: 
[0m17:52:19.898796 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m17:52:19.898796 [debug] [MainThread]: Command end result
[0m17:52:19.934829 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:52:19.938337 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:52:19.944344 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:52:19.944344 [info ] [MainThread]: 
[0m17:52:19.945347 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:52:19.946345 [info ] [MainThread]: 
[0m17:52:19.947344 [error] [MainThread]:   Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  000979 (42601): SQL compilation error:
  [T.PAYMENT_MONTH] is not a valid group by expression
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m17:52:19.947344 [info ] [MainThread]: 
[0m17:52:19.948344 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:52:19.949831 [debug] [MainThread]: Command `dbt run` failed at 17:52:19.949831 after 6.03 seconds
[0m17:52:19.949831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2E50BF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2E509EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2E50B380>]}
[0m17:52:19.949831 [debug] [MainThread]: Flushing usage events
[0m17:52:20.847096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:55:13.186401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF9FE9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFD32ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFD0CD100>]}


============================== 17:55:13.202347 | c3959415-5985-4a99-867d-6d9a5c9d2dd2 ==============================
[0m17:55:13.202347 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:55:13.202347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:55:14.149280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3959415-5985-4a99-867d-6d9a5c9d2dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFD591A90>]}
[0m17:55:14.210348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3959415-5985-4a99-867d-6d9a5c9d2dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFE2F2FF0>]}
[0m17:55:14.211347 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:55:14.819070 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:55:14.977275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:14.977275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:14.977275 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:55:15.015254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3959415-5985-4a99-867d-6d9a5c9d2dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFE373EC0>]}
[0m17:55:15.075551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:55:15.105068 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:55:15.131205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3959415-5985-4a99-867d-6d9a5c9d2dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFF7301D0>]}
[0m17:55:15.134902 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:55:15.134902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3959415-5985-4a99-867d-6d9a5c9d2dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFF724410>]}
[0m17:55:15.136944 [info ] [MainThread]: 
[0m17:55:15.136944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:15.136944 [info ] [MainThread]: 
[0m17:55:15.136944 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:55:15.136944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:55:18.256919 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:55:18.256919 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:55:18.256919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:19.670777 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.414 seconds
[0m17:55:19.670777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:55:19.686606 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:55:19.686606 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:55:19.688612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:20.625572 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.941 seconds
[0m17:55:20.643443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3959415-5985-4a99-867d-6d9a5c9d2dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFE372D80>]}
[0m17:55:20.647453 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:55:20.647453 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m17:55:20.649458 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m17:55:20.649458 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:55:20.657986 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:55:20.659522 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:55:20.691868 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:55:20.693873 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:55:20.694976 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (-- WITH purchases AS (
--     SELECT customer_id,
--     MIN(payment_month) AS first_purchase_month,
--     MAX(payment_month) AS last_purchase_month
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- )
-- SELECT
--     t.payment_month,
--     COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--     COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
-- FROM stg_transactions t
-- LEFT JOIN purchases p ON t.customer_id = p.customer_id
-- GROUP BY t.payment_month
-- ORDER BY t.payment_month




-- WITH purchases AS (
--     SELECT 
--         customer_id,
--         MIN(payment_month) AS first_purchase_month,
--         MAX(payment_month) AS last_purchase_month
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY 
--         customer_id
-- ),
-- new_and_churned_customers AS (
--     SELECT
--         t.payment_month,
--         COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--         COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     LEFT JOIN 
--         purchases p ON t.customer_id = p.customer_id
-- )
-- SELECT
--     CURRENT_DATE AS report_date,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
-- FROM
--     new_and_churned_customers

WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
)
SELECT
    CURRENT_DATE AS report_date,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
FROM
    new_and_churned_customers;
[0m17:55:20.695983 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:21.789101 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0089-3201-7e57-000c-493e0002677e
[0m17:55:21.789101 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 84 at position 29 unexpected ';'.
[0m17:55:21.807617 [debug] [Thread-1 (]: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 84 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m17:55:21.809622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3959415-5985-4a99-867d-6d9a5c9d2dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFCA34B90>]}
[0m17:55:21.809622 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[31mERROR[0m in 1.16s]
[0m17:55:21.809622 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:55:21.809622 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_new_and_churned_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 84 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql.
[0m17:55:21.809622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:21.809622 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:55:21.809622 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:55:22.122890 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:55:22.122890 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:55:22.454090 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m17:55:22.454090 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m17:55:22.794038 [info ] [MainThread]: 
[0m17:55:22.794038 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.66 seconds (7.66s).
[0m17:55:22.794038 [debug] [MainThread]: Command end result
[0m17:55:22.823172 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:55:22.831366 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:55:22.837490 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:55:22.837490 [info ] [MainThread]: 
[0m17:55:22.837490 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:55:22.837490 [info ] [MainThread]: 
[0m17:55:22.837490 [error] [MainThread]:   Database Error in model mart_new_and_churned_customers (models\mart\mart_new_and_churned_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 84 at position 29 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_new_and_churned_customers.sql
[0m17:55:22.843837 [info ] [MainThread]: 
[0m17:55:22.843837 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:55:22.845842 [debug] [MainThread]: Command `dbt run` failed at 17:55:22.845842 after 9.84 seconds
[0m17:55:22.845842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFD45E030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFCF162A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFE10C860>]}
[0m17:55:22.845842 [debug] [MainThread]: Flushing usage events
[0m17:55:23.751418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:55:30.774081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C01D31820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C01E57C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C01E54170>]}


============================== 17:55:30.779554 | 53a3a1cf-7cbb-424e-b5cb-4e5da895d337 ==============================
[0m17:55:30.779554 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:55:30.779554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:55:31.264649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53a3a1cf-7cbb-424e-b5cb-4e5da895d337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C0455E630>]}
[0m17:55:31.322070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53a3a1cf-7cbb-424e-b5cb-4e5da895d337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C056E7D70>]}
[0m17:55:31.322070 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:55:31.815839 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:55:31.980664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:31.980664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:31.980664 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:55:32.020108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53a3a1cf-7cbb-424e-b5cb-4e5da895d337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C0684AFC0>]}
[0m17:55:32.090166 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:55:32.093721 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:55:32.127590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53a3a1cf-7cbb-424e-b5cb-4e5da895d337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C06BB06B0>]}
[0m17:55:32.127590 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:55:32.127590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a3a1cf-7cbb-424e-b5cb-4e5da895d337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C0684AC60>]}
[0m17:55:32.127590 [info ] [MainThread]: 
[0m17:55:32.127590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:32.127590 [info ] [MainThread]: 
[0m17:55:32.133817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:55:32.133817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:55:32.240348 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:55:32.240348 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:55:32.240348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:33.254826 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.020 seconds
[0m17:55:33.270856 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:55:33.270856 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:55:33.270856 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:55:33.270856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:34.467118 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.194 seconds
[0m17:55:34.467118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a3a1cf-7cbb-424e-b5cb-4e5da895d337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C04BD6AB0>]}
[0m17:55:34.483947 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:55:34.483947 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m17:55:34.483947 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m17:55:34.483947 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:55:34.496162 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:55:34.497160 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:55:34.531437 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:55:34.534419 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:55:34.535449 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (-- WITH purchases AS (
--     SELECT customer_id,
--     MIN(payment_month) AS first_purchase_month,
--     MAX(payment_month) AS last_purchase_month
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- )
-- SELECT
--     t.payment_month,
--     COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--     COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
-- FROM stg_transactions t
-- LEFT JOIN purchases p ON t.customer_id = p.customer_id
-- GROUP BY t.payment_month
-- ORDER BY t.payment_month




-- WITH purchases AS (
--     SELECT 
--         customer_id,
--         MIN(payment_month) AS first_purchase_month,
--         MAX(payment_month) AS last_purchase_month
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY 
--         customer_id
-- ),
-- new_and_churned_customers AS (
--     SELECT
--         t.payment_month,
--         COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--         COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     LEFT JOIN 
--         purchases p ON t.customer_id = p.customer_id
-- )
-- SELECT
--     CURRENT_DATE AS report_date,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
-- FROM
--     new_and_churned_customers

WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
)
SELECT
    CURRENT_DATE AS report_date,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
FROM
    new_and_churned_customers
        );
[0m17:55:34.535449 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:35.877149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.355 seconds
[0m17:55:35.913958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a3a1cf-7cbb-424e-b5cb-4e5da895d337', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C03ED4740>]}
[0m17:55:35.913958 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[32mSUCCESS 1[0m in 1.43s]
[0m17:55:35.913958 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:55:35.913958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:35.913958 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:55:35.913958 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:55:36.257198 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:55:36.257198 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:55:36.575485 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m17:55:36.575485 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m17:55:36.925775 [info ] [MainThread]: 
[0m17:55:36.930812 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.79 seconds (4.79s).
[0m17:55:36.937216 [debug] [MainThread]: Command end result
[0m17:55:36.964146 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:55:36.967143 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:55:36.973361 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:55:36.973361 [info ] [MainThread]: 
[0m17:55:36.973361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:36.973361 [info ] [MainThread]: 
[0m17:55:36.977816 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:55:36.979825 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:36.979825 after 6.37 seconds
[0m17:55:36.980823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C01D31820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C048BF770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C048BDEB0>]}
[0m17:55:36.980823 [debug] [MainThread]: Flushing usage events
[0m17:55:37.895668 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:37.565201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1868B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1809CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1844A060>]}


============================== 17:58:37.565201 | 09b3a4e9-8bff-49de-ab7b-e85d8ff2f437 ==============================
[0m17:58:37.565201 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:58:37.565201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:58:38.050811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09b3a4e9-8bff-49de-ab7b-e85d8ff2f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B17E7A2D0>]}
[0m17:58:38.114324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09b3a4e9-8bff-49de-ab7b-e85d8ff2f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B19619A60>]}
[0m17:58:38.114324 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:58:38.599276 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:58:38.743841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:38.743841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:38.758388 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:58:38.780295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09b3a4e9-8bff-49de-ab7b-e85d8ff2f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B197CE3C0>]}
[0m17:58:38.858208 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:58:38.860170 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:58:38.891918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09b3a4e9-8bff-49de-ab7b-e85d8ff2f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1AB48350>]}
[0m17:58:38.891918 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:58:38.891918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09b3a4e9-8bff-49de-ab7b-e85d8ff2f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1AB3B890>]}
[0m17:58:38.891918 [info ] [MainThread]: 
[0m17:58:38.891918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:38.891918 [info ] [MainThread]: 
[0m17:58:38.891918 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:58:38.891918 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:58:39.002662 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:58:39.003664 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:58:39.003664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:40.425236 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.426 seconds
[0m17:58:40.435988 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:58:40.441007 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:58:40.441007 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:58:40.446692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:41.397333 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.964 seconds
[0m17:58:41.416059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09b3a4e9-8bff-49de-ab7b-e85d8ff2f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B196E2D80>]}
[0m17:58:41.416059 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:58:41.416059 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m17:58:41.416059 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m17:58:41.416059 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:58:41.430857 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:58:41.432555 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:58:41.463506 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:58:41.465538 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:58:41.466540 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (-- WITH purchases AS (
--     SELECT customer_id,
--     MIN(payment_month) AS first_purchase_month,
--     MAX(payment_month) AS last_purchase_month
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- )
-- SELECT
--     t.payment_month,
--     COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--     COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
-- FROM stg_transactions t
-- LEFT JOIN purchases p ON t.customer_id = p.customer_id
-- GROUP BY t.payment_month
-- ORDER BY t.payment_month




-- WITH purchases AS (
--     SELECT 
--         customer_id,
--         MIN(payment_month) AS first_purchase_month,
--         MAX(payment_month) AS last_purchase_month
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY 
--         customer_id
-- ),
-- new_and_churned_customers AS (
--     SELECT
--         t.payment_month,
--         COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--         COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     LEFT JOIN 
--         purchases p ON t.customer_id = p.customer_id
-- )
-- SELECT
--     CURRENT_DATE AS report_date,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
-- FROM
--     new_and_churned_customers

WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
)
SELECT
    CURRENT_DATE AS report_date,
    SUM(CASE WHEN payment_month >= payment_month - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
    SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
FROM
    new_and_churned_customers
        );
[0m17:58:41.466540 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:43.093786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.633 seconds
[0m17:58:43.109799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b3a4e9-8bff-49de-ab7b-e85d8ff2f437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B15CE1700>]}
[0m17:58:43.125682 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[32mSUCCESS 1[0m in 1.69s]
[0m17:58:43.125682 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:58:43.125682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:43.125682 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:58:43.125682 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:58:43.452702 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:58:43.452702 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:58:43.778784 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m17:58:43.790408 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m17:58:44.097058 [info ] [MainThread]: 
[0m17:58:44.113059 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m17:58:44.113059 [debug] [MainThread]: Command end result
[0m17:58:44.136781 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:58:44.138814 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:58:44.144782 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:58:44.144782 [info ] [MainThread]: 
[0m17:58:44.145815 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:44.146824 [info ] [MainThread]: 
[0m17:58:44.147839 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:58:44.148245 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:44.148245 after 6.74 seconds
[0m17:58:44.148245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B186AF200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B186ADA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B186AE360>]}
[0m17:58:44.148245 [debug] [MainThread]: Flushing usage events
[0m17:58:45.062841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:53.364857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA82223F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA7B775F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA82222A0>]}


============================== 17:59:53.364857 | 428fd971-55ff-4e2c-be7d-f1707d7ad021 ==============================
[0m17:59:53.364857 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:59:53.364857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:59:53.854204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '428fd971-55ff-4e2c-be7d-f1707d7ad021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA99BA210>]}
[0m17:59:53.914940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '428fd971-55ff-4e2c-be7d-f1707d7ad021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA9CD58E0>]}
[0m17:59:53.914940 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:59:54.402776 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:59:54.559081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:54.559081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:54.575510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m17:59:54.602824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '428fd971-55ff-4e2c-be7d-f1707d7ad021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAB0220F0>]}
[0m17:59:54.667626 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:59:54.667626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:59:54.699139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '428fd971-55ff-4e2c-be7d-f1707d7ad021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAC4AFE60>]}
[0m17:59:54.699139 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m17:59:54.699139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '428fd971-55ff-4e2c-be7d-f1707d7ad021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAAE07EC0>]}
[0m17:59:54.699139 [info ] [MainThread]: 
[0m17:59:54.712959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:54.712959 [info ] [MainThread]: 
[0m17:59:54.714966 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:59:54.714966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m17:59:54.819208 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m17:59:54.819208 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m17:59:54.820208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:56.204810 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.385 seconds
[0m17:59:56.210831 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m17:59:56.216945 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m17:59:56.216945 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m17:59:56.216945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:57.172213 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.949 seconds
[0m17:59:57.176082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '428fd971-55ff-4e2c-be7d-f1707d7ad021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAC5D2C90>]}
[0m17:59:57.176082 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:59:57.176082 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m17:59:57.176082 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m17:59:57.176082 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:59:57.192718 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:59:57.194777 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:59:57.223250 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:59:57.223250 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m17:59:57.223250 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (-- WITH purchases AS (
--     SELECT customer_id,
--     MIN(payment_month) AS first_purchase_month,
--     MAX(payment_month) AS last_purchase_month
--     FROM PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY customer_id
-- )
-- SELECT
--     t.payment_month,
--     COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--     COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
-- FROM stg_transactions t
-- LEFT JOIN purchases p ON t.customer_id = p.customer_id
-- GROUP BY t.payment_month
-- ORDER BY t.payment_month




-- WITH purchases AS (
--     SELECT 
--         customer_id,
--         MIN(payment_month) AS first_purchase_month,
--         MAX(payment_month) AS last_purchase_month
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions
--     GROUP BY 
--         customer_id
-- ),
-- new_and_churned_customers AS (
--     SELECT
--         t.payment_month,
--         COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--         COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
--     LEFT JOIN 
--         purchases p ON t.customer_id = p.customer_id
-- )
-- SELECT
--     CURRENT_DATE AS report_date,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
--     SUM(CASE WHEN payment_month >= CURRENT_DATE - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
-- FROM
--     new_and_churned_customers

WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
)
SELECT
    CURRENT_DATE AS report_date,
    SUM(CASE WHEN payment_month >= payment_month - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
    SUM(CASE WHEN payment_month >= payment_month - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
    SUM(CASE WHEN payment_month >= payment_month - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
    SUM(CASE WHEN payment_month >= payment_month - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
    SUM(CASE WHEN payment_month >= payment_month - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
    SUM(CASE WHEN payment_month >= payment_month - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
FROM
    new_and_churned_customers
        );
[0m17:59:57.223250 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:58.617411 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.394 seconds
[0m17:59:58.648477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '428fd971-55ff-4e2c-be7d-f1707d7ad021', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAC222960>]}
[0m17:59:58.648477 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[32mSUCCESS 1[0m in 1.47s]
[0m17:59:58.648477 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m17:59:58.648477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:58.648477 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m17:59:58.648477 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m17:59:58.981745 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m17:59:58.981745 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m17:59:59.306259 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m17:59:59.306259 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m17:59:59.624933 [info ] [MainThread]: 
[0m17:59:59.624933 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m17:59:59.624933 [debug] [MainThread]: Command end result
[0m17:59:59.647041 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m17:59:59.647041 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m17:59:59.663420 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m17:59:59.663420 [info ] [MainThread]: 
[0m17:59:59.665226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:59.667241 [info ] [MainThread]: 
[0m17:59:59.667241 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:59:59.668232 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:59.668232 after 6.46 seconds
[0m17:59:59.669234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA9F883B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA98D0E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA98D1EB0>]}
[0m17:59:59.669234 [debug] [MainThread]: Flushing usage events
[0m18:00:00.557105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:53.229580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CEC2FF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CEC2E960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CEC2F770>]}


============================== 18:15:53.241706 | c5cc3dc6-886e-4550-95c2-f6a3655200e7 ==============================
[0m18:15:53.241706 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:15:53.241706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:15:54.265825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5cc3dc6-886e-4550-95c2-f6a3655200e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CE6363F0>]}
[0m18:15:54.332142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5cc3dc6-886e-4550-95c2-f6a3655200e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CFE50470>]}
[0m18:15:54.334108 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:15:54.904782 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:15:55.071072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:55.071072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:55.077088 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:15:55.101426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5cc3dc6-886e-4550-95c2-f6a3655200e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D10FF590>]}
[0m18:15:55.175264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:15:55.191086 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:15:55.220491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5cc3dc6-886e-4550-95c2-f6a3655200e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D12AFE00>]}
[0m18:15:55.220491 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:15:55.220491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5cc3dc6-886e-4550-95c2-f6a3655200e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CFE24F50>]}
[0m18:15:55.220491 [info ] [MainThread]: 
[0m18:15:55.220491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:55.220491 [info ] [MainThread]: 
[0m18:15:55.220491 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:15:55.220491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:15:58.233705 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:15:58.235713 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:15:58.235713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:59.755853 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.527 seconds
[0m18:15:59.768144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m18:15:59.771837 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m18:15:59.771837 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m18:15:59.771837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:00.706906 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.930 seconds
[0m18:16:00.711551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5cc3dc6-886e-4550-95c2-f6a3655200e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D0ED3E60>]}
[0m18:16:00.727731 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:16:00.727731 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m18:16:00.727731 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m18:16:00.743778 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:16:00.751820 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m18:16:00.753825 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:16:00.780106 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m18:16:00.780106 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m18:16:00.780106 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
)
SELECT
    -- CURRENT_DATE AS report_date,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
    *
FROM
    new_and_churned_customers
        );
[0m18:16:00.780106 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:16:02.313144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.527 seconds
[0m18:16:02.344160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5cc3dc6-886e-4550-95c2-f6a3655200e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D0ED1880>]}
[0m18:16:02.344160 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[32mSUCCESS 1[0m in 1.60s]
[0m18:16:02.344160 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:16:02.344160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:02.344160 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:16:02.344160 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:16:02.671613 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m18:16:02.671613 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m18:16:03.006671 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m18:16:03.006671 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m18:16:03.350654 [info ] [MainThread]: 
[0m18:16:03.351652 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.13 seconds (8.13s).
[0m18:16:03.352684 [debug] [MainThread]: Command end result
[0m18:16:03.376741 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:16:03.376741 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:16:03.385970 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:16:03.386971 [info ] [MainThread]: 
[0m18:16:03.388003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:03.388003 [info ] [MainThread]: 
[0m18:16:03.388971 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:16:03.389969 [debug] [MainThread]: Command `dbt run` succeeded at 18:16:03.389969 after 10.40 seconds
[0m18:16:03.390971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CCC5DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CCE9E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CCE9E2A0>]}
[0m18:16:03.391389 [debug] [MainThread]: Flushing usage events
[0m18:16:04.620657 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:09.540721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA62218B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA39C1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA44BE750>]}


============================== 18:17:09.556463 | 2bbf8b76-c210-4780-af93-a160ad5d94fa ==============================
[0m18:17:09.556463 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:17:09.556463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:10.057272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bbf8b76-c210-4780-af93-a160ad5d94fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA7444B00>]}
[0m18:17:10.121379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bbf8b76-c210-4780-af93-a160ad5d94fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA738A5A0>]}
[0m18:17:10.121379 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:17:10.596347 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:17:10.770745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:10.770745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:10.775880 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:17:10.801020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bbf8b76-c210-4780-af93-a160ad5d94fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA85AF8C0>]}
[0m18:17:10.878955 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:17:10.881833 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:17:10.912723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bbf8b76-c210-4780-af93-a160ad5d94fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA8914560>]}
[0m18:17:10.912723 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:17:10.912723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bbf8b76-c210-4780-af93-a160ad5d94fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA858FAA0>]}
[0m18:17:10.912723 [info ] [MainThread]: 
[0m18:17:10.912723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:10.912723 [info ] [MainThread]: 
[0m18:17:10.912723 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:17:10.912723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:17:11.028347 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:17:11.028347 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:17:11.028347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:12.504764 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.490 seconds
[0m18:17:12.520446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA'
[0m18:17:12.520446 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA"
[0m18:17:12.520446 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA"} */
show objects in PROJECT_DB.PROJECT_SCHEMA limit 10000;
[0m18:17:12.536221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:13.524034 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.988 seconds
[0m18:17:13.528366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bbf8b76-c210-4780-af93-a160ad5d94fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA7107D40>]}
[0m18:17:13.528366 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:17:13.528366 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA.mart_new_and_churned_customers ..... [RUN]
[0m18:17:13.528366 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m18:17:13.528366 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:17:13.543843 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m18:17:13.544840 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:17:13.577530 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m18:17:13.579531 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m18:17:13.579531 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA.mart_new_and_churned_customers
         as
        (WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
)
SELECT
    -- CURRENT_DATE AS report_date,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '30 Days' THEN new_customers ELSE 0 END) AS new_customers_lm,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '90 Days' THEN new_customers ELSE 0 END) AS new_customers_l3m,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '1 year' THEN new_customers ELSE 0 END) AS new_customers_ltm,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '30 Days' THEN churned_customers ELSE 0 END) AS churned_customers_lm,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '90 Days' THEN churned_customers ELSE 0 END) AS churned_customers_l3m,
    -- SUM(CASE WHEN payment_month >= payment_month - INTERVAL '1 year' THEN churned_customers ELSE 0 END) AS churned_customers_ltm
    *
FROM
    new_and_churned_customers
ORDER BY
    payment_month
        );
[0m18:17:13.580531 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:17:14.858785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.280 seconds
[0m18:17:14.878574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bbf8b76-c210-4780-af93-a160ad5d94fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA3AC1BE0>]}
[0m18:17:14.878574 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA.mart_new_and_churned_customers  [[32mSUCCESS 1[0m in 1.35s]
[0m18:17:14.878574 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:17:14.878574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:14.878574 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:17:14.878574 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:17:15.202161 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA' was left open.
[0m18:17:15.202161 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA: Close
[0m18:17:15.531902 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m18:17:15.531902 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m18:17:15.855372 [info ] [MainThread]: 
[0m18:17:15.855372 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m18:17:15.855372 [debug] [MainThread]: Command end result
[0m18:17:15.878515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:17:15.878515 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:17:15.890361 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:17:15.890361 [info ] [MainThread]: 
[0m18:17:15.890361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:15.890361 [info ] [MainThread]: 
[0m18:17:15.890361 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:17:15.890361 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:15.890361 after 6.51 seconds
[0m18:17:15.890361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA62218B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA624F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FA5BA2A80>]}
[0m18:17:15.890361 [debug] [MainThread]: Flushing usage events
[0m18:17:17.140758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:08.246607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF2E0C740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF2B1A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF2E0C2F0>]}


============================== 18:28:08.259742 | 35fe8ebb-3ef4-48bf-9485-ee120c3e6fbc ==============================
[0m18:28:08.259742 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:28:08.261803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:28:09.221823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35fe8ebb-3ef4-48bf-9485-ee120c3e6fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF3B7F3E0>]}
[0m18:28:09.288335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35fe8ebb-3ef4-48bf-9485-ee120c3e6fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF3B9EF90>]}
[0m18:28:09.288335 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:28:09.872352 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:28:10.039051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:28:10.039051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:28:10.045169 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:28:10.074127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35fe8ebb-3ef4-48bf-9485-ee120c3e6fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF4DB0710>]}
[0m18:28:10.150357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:28:10.162171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:28:10.195996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35fe8ebb-3ef4-48bf-9485-ee120c3e6fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF4F7FB00>]}
[0m18:28:10.195996 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:28:10.195996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35fe8ebb-3ef4-48bf-9485-ee120c3e6fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF4C12F60>]}
[0m18:28:10.195996 [info ] [MainThread]: 
[0m18:28:10.195996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:10.195996 [info ] [MainThread]: 
[0m18:28:10.202472 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:28:10.202472 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:28:13.343338 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:28:13.343338 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:28:13.343338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:14.784695 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.440 seconds
[0m18:28:14.789994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB, now create_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:28:14.791951 [debug] [ThreadPool]: Creating schema "database: "PROJECT_DB"
schema: "PROJECT_SCHEMA_stage"
"
[0m18:28:14.803301 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:28:14.804502 [debug] [ThreadPool]: On create_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "create_PROJECT_DB_PROJECT_SCHEMA_stage"} */
create schema if not exists PROJECT_DB.PROJECT_SCHEMA_stage
[0m18:28:15.008729 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.207 seconds
[0m18:28:15.008729 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:28:15.024882 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:28:15.024882 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:28:15.024882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:16.157637 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00aa-3201-7e57-000c-493e000267ba
[0m18:28:16.157637 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:28:16.157637 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:28:16.157637 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:28:16.157637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:28:16.157637 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:28:16.157637 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:28:16.356855 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.188 seconds
[0m18:28:16.356855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:28:16.356855 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:28:16.356855 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:28:16.532298 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.173 seconds
[0m18:28:16.532298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35fe8ebb-3ef4-48bf-9485-ee120c3e6fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF4F7EF60>]}
[0m18:28:16.548013 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_customers
[0m18:28:16.548013 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_stage.stg_customers ................ [RUN]
[0m18:28:16.548013 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_customers'
[0m18:28:16.554220 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_customers
[0m18:28:16.562251 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_customers"
[0m18:28:16.565144 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_customers
[0m18:28:16.595710 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_customers"
[0m18:28:16.595710 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_customers"
[0m18:28:16.595710 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_stage.stg_customers
         as
        (SELECT
    customer_id,
    REPLACE(REGEXP_REPLACE(customername, '\\(.*?\\)', ''),',','') AS customer_name,
    company
FROM PROJECT_DB.STAGE.CUSTOMERS_DATA
WHERE customer_id IS NOT NULL
        );
[0m18:28:16.595710 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:28:18.344630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.747 seconds
[0m18:28:18.370927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fe8ebb-3ef4-48bf-9485-ee120c3e6fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF01B1A30>]}
[0m18:28:18.370927 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_stage.stg_customers ........... [[32mSUCCESS 1[0m in 1.82s]
[0m18:28:18.372058 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_customers
[0m18:28:18.374064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:18.374064 [debug] [MainThread]: Connection 'create_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:28:18.374064 [debug] [MainThread]: On create_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:28:18.690483 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m18:28:18.690483 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m18:28:19.016220 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_customers' was left open.
[0m18:28:19.033016 [debug] [MainThread]: On model.CRB_PROJECT.stg_customers: Close
[0m18:28:19.366538 [info ] [MainThread]: 
[0m18:28:19.366538 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.16 seconds (9.16s).
[0m18:28:19.366538 [debug] [MainThread]: Command end result
[0m18:28:19.406379 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:28:19.408367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:28:19.414705 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:28:19.416740 [info ] [MainThread]: 
[0m18:28:19.417713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:28:19.417713 [info ] [MainThread]: 
[0m18:28:19.418750 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:28:19.419750 [debug] [MainThread]: Command `dbt run` succeeded at 18:28:19.419750 after 11.35 seconds
[0m18:28:19.420767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF286C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF2CD6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCF297F470>]}
[0m18:28:19.420767 [debug] [MainThread]: Flushing usage events
[0m18:28:20.751260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:54.106939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C568E2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C598F3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5995DC40>]}


============================== 18:28:54.106939 | 287f5beb-d94e-47b8-a08f-da8a9a4a84f6 ==============================
[0m18:28:54.106939 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:28:54.122729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_locations', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:28:54.594288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '287f5beb-d94e-47b8-a08f-da8a9a4a84f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5A194B00>]}
[0m18:28:54.657975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '287f5beb-d94e-47b8-a08f-da8a9a4a84f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C59F277D0>]}
[0m18:28:54.657975 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:28:55.142827 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:28:55.301816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:28:55.301816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:28:55.317669 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:28:55.339311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '287f5beb-d94e-47b8-a08f-da8a9a4a84f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5BE3FCB0>]}
[0m18:28:55.401160 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:28:55.417249 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:28:55.449168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '287f5beb-d94e-47b8-a08f-da8a9a4a84f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5BF9B5F0>]}
[0m18:28:55.449168 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:28:55.449168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '287f5beb-d94e-47b8-a08f-da8a9a4a84f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5BE3EDB0>]}
[0m18:28:55.449168 [info ] [MainThread]: 
[0m18:28:55.455547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:55.455547 [info ] [MainThread]: 
[0m18:28:55.455547 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:28:55.455547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:28:55.562582 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:28:55.562582 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:28:55.562582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:56.881779 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.320 seconds
[0m18:28:56.889659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:28:56.889659 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:28:56.889659 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:28:56.889659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:57.861279 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00aa-3201-7e56-000c-493e00024862
[0m18:28:57.861279 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:28:57.877261 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:28:57.877261 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:28:57.877261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:28:57.883067 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:28:57.883067 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:28:58.074748 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.186 seconds
[0m18:28:58.074748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:28:58.074748 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:28:58.074748 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:28:58.263774 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.186 seconds
[0m18:28:58.270860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '287f5beb-d94e-47b8-a08f-da8a9a4a84f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5BE1C680>]}
[0m18:28:58.270860 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_locations
[0m18:28:58.270860 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_stage.stg_locations ................ [RUN]
[0m18:28:58.270860 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_locations'
[0m18:28:58.270860 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_locations
[0m18:28:58.286517 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_locations"
[0m18:28:58.286517 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_locations
[0m18:28:58.321084 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_locations"
[0m18:28:58.321084 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_locations"
[0m18:28:58.321084 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_locations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_locations"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_stage.stg_locations
         as
        (SELECT
    * 
FROM PROJECT_DB.STAGE.LOCATIONS_DATA
WHERE 
    customer_id 
IS 
    NOT NULL
        );
[0m18:28:58.321084 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:28:59.962907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.651 seconds
[0m18:28:59.995193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287f5beb-d94e-47b8-a08f-da8a9a4a84f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C5BE3EC60>]}
[0m18:28:59.995193 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_stage.stg_locations ........... [[32mSUCCESS 1[0m in 1.72s]
[0m18:28:59.995193 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_locations
[0m18:28:59.995193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:59.995193 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:28:59.995193 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:29:00.321074 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m18:29:00.321074 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m18:29:00.641074 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_locations' was left open.
[0m18:29:00.641074 [debug] [MainThread]: On model.CRB_PROJECT.stg_locations: Close
[0m18:29:00.966018 [info ] [MainThread]: 
[0m18:29:00.976390 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m18:29:00.976390 [debug] [MainThread]: Command end result
[0m18:29:01.000867 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:29:01.004181 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:29:01.011498 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:29:01.011498 [info ] [MainThread]: 
[0m18:29:01.011498 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:29:01.011498 [info ] [MainThread]: 
[0m18:29:01.011498 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:29:01.011498 [debug] [MainThread]: Command `dbt run` succeeded at 18:29:01.011498 after 7.06 seconds
[0m18:29:01.011498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C59A78530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C599CF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C59921640>]}
[0m18:29:01.011498 [debug] [MainThread]: Flushing usage events
[0m18:29:01.969710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:29:13.044487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A565F7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A565CB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A565D700>]}


============================== 18:29:13.050171 | b7b31bd0-afe8-4f48-815a-20ecc9a8627e ==============================
[0m18:29:13.050171 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:29:13.050171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_products', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:29:13.536335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b31bd0-afe8-4f48-815a-20ecc9a8627e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A2A77740>]}
[0m18:29:13.583547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b31bd0-afe8-4f48-815a-20ecc9a8627e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A519FA10>]}
[0m18:29:13.583547 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:29:14.069171 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:29:14.227794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:29:14.227794 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:29:14.227794 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:29:14.269277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7b31bd0-afe8-4f48-815a-20ecc9a8627e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A61AB020>]}
[0m18:29:14.334698 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:29:14.343759 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:29:14.366236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7b31bd0-afe8-4f48-815a-20ecc9a8627e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A77F7E00>]}
[0m18:29:14.366236 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:29:14.366236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b31bd0-afe8-4f48-815a-20ecc9a8627e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A749CFE0>]}
[0m18:29:14.380913 [info ] [MainThread]: 
[0m18:29:14.380913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:14.381917 [info ] [MainThread]: 
[0m18:29:14.381917 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:29:14.381917 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:29:14.487490 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:29:14.488489 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:29:14.488489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:15.862376 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.376 seconds
[0m18:29:15.878555 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:29:15.916433 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:29:15.916433 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:29:15.918443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:16.851310 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00ab-3201-7e56-000c-493e0002486a
[0m18:29:16.851310 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:29:16.851310 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:29:16.851310 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:29:16.851310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:29:16.851310 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:29:16.851310 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:29:17.041218 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.188 seconds
[0m18:29:17.041218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:29:17.041218 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:29:17.041218 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:29:17.233069 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.186 seconds
[0m18:29:17.233069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b31bd0-afe8-4f48-815a-20ecc9a8627e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A7CB1070>]}
[0m18:29:17.233069 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_products
[0m18:29:17.249464 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_stage.stg_products ................. [RUN]
[0m18:29:17.249847 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_products'
[0m18:29:17.249847 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_products
[0m18:29:17.260695 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_products"
[0m18:29:17.261662 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_products
[0m18:29:17.292984 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_products"
[0m18:29:17.294845 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_products"
[0m18:29:17.295853 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_stage.stg_products
         as
        (SELECT 
    *
FROM PROJECT_DB.STAGE.PRODUCTS_DATA
        );
[0m18:29:17.295853 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:29:18.801368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.517 seconds
[0m18:29:18.833921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b31bd0-afe8-4f48-815a-20ecc9a8627e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A2A11B20>]}
[0m18:29:18.833921 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_stage.stg_products ............ [[32mSUCCESS 1[0m in 1.58s]
[0m18:29:18.833921 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_products
[0m18:29:18.833921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:18.833921 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:29:18.833921 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:29:19.167335 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m18:29:19.167335 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m18:29:19.486130 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_products' was left open.
[0m18:29:19.486130 [debug] [MainThread]: On model.CRB_PROJECT.stg_products: Close
[0m18:29:19.808604 [info ] [MainThread]: 
[0m18:29:19.808604 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m18:29:19.808604 [debug] [MainThread]: Command end result
[0m18:29:19.841374 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:29:19.845650 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:29:19.849691 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:29:19.849691 [info ] [MainThread]: 
[0m18:29:19.849691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:29:19.849691 [info ] [MainThread]: 
[0m18:29:19.849691 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:29:19.849691 [debug] [MainThread]: Command `dbt run` succeeded at 18:29:19.849691 after 6.97 seconds
[0m18:29:19.849691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A2AA3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A605AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217A7701670>]}
[0m18:29:19.849691 [debug] [MainThread]: Flushing usage events
[0m18:29:21.134135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:29:32.238335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D93D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D93C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D93CD70>]}


============================== 18:29:32.246780 | 435acbd2-ef15-4f0a-8159-8334d3c85710 ==============================
[0m18:29:32.246780 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:29:32.246780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_transactions', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:29:32.726346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '435acbd2-ef15-4f0a-8159-8334d3c85710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134E727EC0>]}
[0m18:29:32.787306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '435acbd2-ef15-4f0a-8159-8334d3c85710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134E6C7C80>]}
[0m18:29:32.787306 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:29:33.266874 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:29:33.425693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:29:33.425693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:29:33.425693 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:29:33.457033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '435acbd2-ef15-4f0a-8159-8334d3c85710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134CE2AFC0>]}
[0m18:29:33.522021 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:29:33.537746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:29:33.569438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '435acbd2-ef15-4f0a-8159-8334d3c85710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134FB840E0>]}
[0m18:29:33.569438 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:29:33.569438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435acbd2-ef15-4f0a-8159-8334d3c85710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134F7F2F60>]}
[0m18:29:33.569438 [info ] [MainThread]: 
[0m18:29:33.569438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:33.569438 [info ] [MainThread]: 
[0m18:29:33.569438 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:29:33.569438 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:29:33.679923 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:29:33.680923 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:29:33.680923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:35.053104 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.373 seconds
[0m18:29:35.060630 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m18:29:35.070185 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:29:35.070185 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:29:35.072192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:35.968109 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.896 seconds
[0m18:29:35.968109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:29:35.968109 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:29:35.968109 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:29:36.174983 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00ab-3201-7e57-000c-493e00026816
[0m18:29:36.174983 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:29:36.174983 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:29:36.174983 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:29:36.174983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:29:36.174983 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:29:36.174983 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:29:36.372881 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.192 seconds
[0m18:29:36.372881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435acbd2-ef15-4f0a-8159-8334d3c85710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134F77C440>]}
[0m18:29:36.372881 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.stg_transactions
[0m18:29:36.372881 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_stage.stg_transactions ............. [RUN]
[0m18:29:36.372881 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.stg_transactions'
[0m18:29:36.372881 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.stg_transactions
[0m18:29:36.388933 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.stg_transactions"
[0m18:29:36.388933 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.stg_transactions
[0m18:29:36.425358 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.stg_transactions"
[0m18:29:36.425358 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.stg_transactions"
[0m18:29:36.425358 [debug] [Thread-1 (]: On model.CRB_PROJECT.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.stg_transactions"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
         as
        (SELECT
    * 
FROM PROJECT_DB.STAGE.TRANSACTIONS_DATA
WHERE
    customer_id 
IS 
    NOT NULL
        );
[0m18:29:36.425358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:29:38.094374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.663 seconds
[0m18:29:38.117463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435acbd2-ef15-4f0a-8159-8334d3c85710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134ACF18E0>]}
[0m18:29:38.118468 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_stage.stg_transactions ........ [[32mSUCCESS 1[0m in 1.74s]
[0m18:29:38.118468 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.stg_transactions
[0m18:29:38.118468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:38.118468 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:29:38.118468 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:29:38.450934 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m18:29:38.450934 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m18:29:38.762858 [debug] [MainThread]: Connection 'model.CRB_PROJECT.stg_transactions' was left open.
[0m18:29:38.762858 [debug] [MainThread]: On model.CRB_PROJECT.stg_transactions: Close
[0m18:29:39.095652 [info ] [MainThread]: 
[0m18:29:39.095652 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m18:29:39.095652 [debug] [MainThread]: Command end result
[0m18:29:39.118316 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:29:39.118316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:29:39.132675 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:29:39.132675 [info ] [MainThread]: 
[0m18:29:39.132675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:29:39.132675 [info ] [MainThread]: 
[0m18:29:39.132675 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:29:39.132675 [debug] [MainThread]: Command `dbt run` succeeded at 18:29:39.132675 after 7.06 seconds
[0m18:29:39.132675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D73F470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134AD83560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134FAA6240>]}
[0m18:29:39.132675 [debug] [MainThread]: Flushing usage events
[0m18:29:40.020772 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:01.750606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5895DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F586CA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5895CD70>]}


============================== 18:31:01.750606 | f1212a08-f6eb-458c-9594-68733dbb4730 ==============================
[0m18:31:01.750606 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:31:01.750606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_fiscal_year', 'send_anonymous_usage_stats': 'True'}
[0m18:31:02.280760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1212a08-f6eb-458c-9594-68733dbb4730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F596B42C0>]}
[0m18:31:02.342370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1212a08-f6eb-458c-9594-68733dbb4730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5895CCE0>]}
[0m18:31:02.342370 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:31:02.807096 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:31:02.993499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:02.993499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:03.001098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:31:03.032644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1212a08-f6eb-458c-9594-68733dbb4730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5A974530>]}
[0m18:31:03.109112 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:31:03.110119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:31:03.141596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1212a08-f6eb-458c-9594-68733dbb4730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5AB70590>]}
[0m18:31:03.141596 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:31:03.141596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1212a08-f6eb-458c-9594-68733dbb4730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5A819EB0>]}
[0m18:31:03.141596 [info ] [MainThread]: 
[0m18:31:03.141596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:03.141596 [info ] [MainThread]: 
[0m18:31:03.141596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:31:03.141596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:31:03.261673 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:31:03.261673 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:31:03.261673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:04.637646 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.384 seconds
[0m18:31:04.653563 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:31:04.653563 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:31:04.653563 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:31:04.653563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:05.656238 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00ad-3201-7d7b-000c-493e00022c16
[0m18:31:05.656238 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:31:05.656238 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:31:05.656238 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:31:05.656238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:31:05.656238 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:31:05.656238 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:31:05.863823 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.197 seconds
[0m18:31:05.869875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:31:05.875077 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:31:05.877093 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:31:06.062437 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.197 seconds
[0m18:31:06.078123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1212a08-f6eb-458c-9594-68733dbb4730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5AB73DD0>]}
[0m18:31:06.078123 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_fiscal_year
[0m18:31:06.078123 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_fiscal_year .............. [RUN]
[0m18:31:06.078123 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_fiscal_year'
[0m18:31:06.078123 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_fiscal_year
[0m18:31:06.093171 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_fiscal_year"
[0m18:31:06.094177 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_fiscal_year
[0m18:31:06.114693 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_fiscal_year"
[0m18:31:06.114693 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_fiscal_year"
[0m18:31:06.114693 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_fiscal_year: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_fiscal_year"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_fiscal_year
         as
        (WITH newlogos AS (
    SELECT 
        EXTRACT(YEAR FROM TO_DATE(payment_month)) AS fiscal_year,
        COUNT(DISTINCT customer_id) AS new_logos 
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY fiscal_year
)
SELECT * FROM newlogos 
ORDER BY fiscal_year
        );
[0m18:31:06.114693 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:07.548572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.421 seconds
[0m18:31:07.560144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1212a08-f6eb-458c-9594-68733dbb4730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F55D11A90>]}
[0m18:31:07.560144 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_fiscal_year ......... [[32mSUCCESS 1[0m in 1.48s]
[0m18:31:07.560144 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_fiscal_year
[0m18:31:07.575844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:07.575844 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:31:07.575844 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:31:07.906573 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:31:07.906573 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:31:08.239324 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_fiscal_year' was left open.
[0m18:31:08.239324 [debug] [MainThread]: On model.CRB_PROJECT.mart_fiscal_year: Close
[0m18:31:08.586986 [info ] [MainThread]: 
[0m18:31:08.587362 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m18:31:08.587362 [debug] [MainThread]: Command end result
[0m18:31:08.633503 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:31:08.636584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:31:08.639377 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:31:08.639377 [info ] [MainThread]: 
[0m18:31:08.639377 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:08.639377 [info ] [MainThread]: 
[0m18:31:08.639377 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:31:08.639377 [debug] [MainThread]: Command `dbt run` succeeded at 18:31:08.639377 after 7.06 seconds
[0m18:31:08.639377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5882AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F54D01280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F5670E6F0>]}
[0m18:31:08.639377 [debug] [MainThread]: Flushing usage events
[0m18:31:09.534815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:42.958986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9122B830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9122A180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9122B590>]}


============================== 18:31:42.964512 | 46f8ee76-e723-4d70-adf1-406aaf74a4d2 ==============================
[0m18:31:42.964512 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:31:42.966518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_rank_customers', 'send_anonymous_usage_stats': 'True'}
[0m18:31:43.466316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46f8ee76-e723-4d70-adf1-406aaf74a4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9203FF50>]}
[0m18:31:43.514365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46f8ee76-e723-4d70-adf1-406aaf74a4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B91CFDD00>]}
[0m18:31:43.514365 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:31:44.000047 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:31:44.168881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:44.168881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:44.174639 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:31:44.203848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46f8ee76-e723-4d70-adf1-406aaf74a4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B92163A40>]}
[0m18:31:44.268536 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:31:44.268536 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:31:44.300015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46f8ee76-e723-4d70-adf1-406aaf74a4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B934E4F80>]}
[0m18:31:44.300015 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:31:44.309437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f8ee76-e723-4d70-adf1-406aaf74a4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B934D04A0>]}
[0m18:31:44.309437 [info ] [MainThread]: 
[0m18:31:44.309437 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:44.309437 [info ] [MainThread]: 
[0m18:31:44.309437 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:31:44.309437 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:31:44.418304 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:31:44.418304 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:31:44.418304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:45.729432 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.324 seconds
[0m18:31:45.745233 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m18:31:45.745233 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:31:45.745233 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:31:45.745233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:46.731570 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.984 seconds
[0m18:31:46.743671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:31:46.745678 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:31:46.745678 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:31:46.955153 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.216 seconds
[0m18:31:46.955153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:31:46.955153 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:31:46.955153 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:31:47.155243 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00ad-3201-7d7b-000c-493e00022c3a
[0m18:31:47.155243 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:31:47.155243 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:31:47.155243 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:31:47.170891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f8ee76-e723-4d70-adf1-406aaf74a4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B93388680>]}
[0m18:31:47.170891 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m18:31:47.170891 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_rank_customers ........... [RUN]
[0m18:31:47.170891 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m18:31:47.170891 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m18:31:47.188801 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m18:31:47.190806 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m18:31:47.221321 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m18:31:47.222322 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m18:31:47.222322 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_customers
         as
        (WITH customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company
    FROM stg_customers c 
),
total_revenue AS (
    SELECT
        t.customer_id,
        SUM(t.revenue) AS total_revenue,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS revenue_rank
    FROM stg_transactions t
    JOIN customers c ON t.customer_id = c.customer_id
    GROUP BY t.customer_id
)

SELECT * 
FROM total_revenue
ORDER BY revenue_rank
        );
[0m18:31:47.222322 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:48.222613 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00ad-3201-7d7b-000c-493e00022c3e
[0m18:31:48.222613 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STG_CUSTOMERS' does not exist or not authorized.
[0m18:31:48.238007 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m18:31:48.238007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46f8ee76-e723-4d70-adf1-406aaf74a4d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B921AEC60>]}
[0m18:31:48.238007 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_rank_customers .. [[31mERROR[0m in 1.07s]
[0m18:31:48.238007 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m18:31:48.238007 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m18:31:48.238007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:48.238007 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:31:48.238007 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:31:48.563650 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m18:31:48.563650 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m18:31:48.906523 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m18:31:48.906523 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m18:31:49.219572 [info ] [MainThread]: 
[0m18:31:49.219572 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m18:31:49.219572 [debug] [MainThread]: Command end result
[0m18:31:49.257883 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:31:49.260330 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:31:49.267470 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:31:49.267470 [info ] [MainThread]: 
[0m18:31:49.267470 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:31:49.267470 [info ] [MainThread]: 
[0m18:31:49.267470 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_CUSTOMERS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m18:31:49.267470 [info ] [MainThread]: 
[0m18:31:49.267470 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:31:49.267470 [debug] [MainThread]: Command `dbt run` failed at 18:31:49.267470 after 6.48 seconds
[0m18:31:49.267470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B920BCD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B8F0FE690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B8F0FE750>]}
[0m18:31:49.273581 [debug] [MainThread]: Flushing usage events
[0m18:31:50.548302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:13.950283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019154B9D3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001915753D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019156D6F440>]}


============================== 18:32:13.950283 | cddafc5a-bdcf-48e6-af44-6e6c1ea824d5 ==============================
[0m18:32:13.950283 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:32:13.963005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_rank_customers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:32:14.433327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cddafc5a-bdcf-48e6-af44-6e6c1ea824d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191583017F0>]}
[0m18:32:14.505577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cddafc5a-bdcf-48e6-af44-6e6c1ea824d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019157FA8830>]}
[0m18:32:14.505577 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:32:14.968571 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:32:15.127771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:15.127771 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:15.127771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:32:15.168231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cddafc5a-bdcf-48e6-af44-6e6c1ea824d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019159409B80>]}
[0m18:32:15.233336 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:32:15.233336 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:32:15.265503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cddafc5a-bdcf-48e6-af44-6e6c1ea824d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191593C3140>]}
[0m18:32:15.265503 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:32:15.276593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cddafc5a-bdcf-48e6-af44-6e6c1ea824d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191593EF7A0>]}
[0m18:32:15.276593 [info ] [MainThread]: 
[0m18:32:15.276593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:15.276593 [info ] [MainThread]: 
[0m18:32:15.276593 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:32:15.281162 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:32:15.387225 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:32:15.387225 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:32:15.388225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:16.797377 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.410 seconds
[0m18:32:16.801028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:32:16.801028 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:32:16.801028 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:32:16.801028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:17.780741 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00ae-3201-7db6-000c-493e000257b2
[0m18:32:17.780741 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:32:17.780741 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:32:17.780741 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:32:17.780741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:32:17.796808 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:32:17.796808 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:32:17.995294 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.202 seconds
[0m18:32:17.995294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:32:17.995294 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:32:17.995294 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:32:18.185818 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.191 seconds
[0m18:32:18.201716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cddafc5a-bdcf-48e6-af44-6e6c1ea824d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191549739E0>]}
[0m18:32:18.201716 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m18:32:18.201716 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_rank_customers ........... [RUN]
[0m18:32:18.201716 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m18:32:18.201716 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m18:32:18.217747 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m18:32:18.217747 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m18:32:18.252694 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m18:32:18.252694 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m18:32:18.252694 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_customers
         as
        (WITH customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_customers c
),
total_revenue AS (
    SELECT
        t.customer_id,
        SUM(t.revenue) AS total_revenue,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS revenue_rank
    FROM stg_transactions t
    JOIN customers c ON t.customer_id = c.customer_id
    GROUP BY t.customer_id
)

SELECT * 
FROM total_revenue
ORDER BY revenue_rank
        );
[0m18:32:18.257615 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:32:19.225117 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00ae-3201-7e57-000c-493e00026892
[0m18:32:19.225117 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STG_TRANSACTIONS' does not exist or not authorized.
[0m18:32:19.225117 [debug] [Thread-1 (]: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m18:32:19.238881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cddafc5a-bdcf-48e6-af44-6e6c1ea824d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191569E4710>]}
[0m18:32:19.238881 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_rank_customers .. [[31mERROR[0m in 1.02s]
[0m18:32:19.238881 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m18:32:19.238881 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql.
[0m18:32:19.238881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:19.238881 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:32:19.238881 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:32:19.563345 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:32:19.563345 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:32:19.883261 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m18:32:19.883261 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m18:32:20.210257 [info ] [MainThread]: 
[0m18:32:20.210257 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m18:32:20.210257 [debug] [MainThread]: Command end result
[0m18:32:20.245814 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:32:20.245814 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:32:20.254192 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:32:20.254192 [info ] [MainThread]: 
[0m18:32:20.255455 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:32:20.256440 [info ] [MainThread]: 
[0m18:32:20.257477 [error] [MainThread]:   Database Error in model mart_rank_customers (models\mart\mart_rank_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_TRANSACTIONS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_customers.sql
[0m18:32:20.258468 [info ] [MainThread]: 
[0m18:32:20.259439 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:32:20.260163 [debug] [MainThread]: Command `dbt run` failed at 18:32:20.260163 after 6.46 seconds
[0m18:32:20.260163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019157116480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019156AC0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191565F8B60>]}
[0m18:32:20.260163 [debug] [MainThread]: Flushing usage events
[0m18:32:21.180912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:57.013224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A3342120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A5B52570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A61A4170>]}


============================== 18:32:57.025519 | fe6b7b9e-acd1-4316-8322-fa816c7166e8 ==============================
[0m18:32:57.025519 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:32:57.026485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_rank_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:32:57.511291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe6b7b9e-acd1-4316-8322-fa816c7166e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A3572930>]}
[0m18:32:57.573315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe6b7b9e-acd1-4316-8322-fa816c7166e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A6EFD1C0>]}
[0m18:32:57.575044 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:32:58.052188 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:32:58.223825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:58.223825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:58.229837 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:32:58.258855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe6b7b9e-acd1-4316-8322-fa816c7166e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A801C6B0>]}
[0m18:32:58.325601 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:32:58.325601 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:32:58.364136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe6b7b9e-acd1-4316-8322-fa816c7166e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A83980B0>]}
[0m18:32:58.364136 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:32:58.364136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6b7b9e-acd1-4316-8322-fa816c7166e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A61A49E0>]}
[0m18:32:58.364136 [info ] [MainThread]: 
[0m18:32:58.368996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:58.368996 [info ] [MainThread]: 
[0m18:32:58.368996 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:32:58.368996 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:32:58.476482 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:32:58.476482 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:32:58.476482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:59.931492 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.458 seconds
[0m18:32:59.946018 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:32:59.962439 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:32:59.962439 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:32:59.962439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:00.870708 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00ae-3201-7db6-000c-493e000257b6
[0m18:33:00.870708 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:33:00.870708 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:33:00.870708 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:33:00.870708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:33:00.870708 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:33:00.870708 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:33:01.059522 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.187 seconds
[0m18:33:01.059522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:33:01.073246 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:33:01.073246 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:33:01.276277 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.202 seconds
[0m18:33:01.278279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe6b7b9e-acd1-4316-8322-fa816c7166e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A6ED6FF0>]}
[0m18:33:01.282744 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_customers
[0m18:33:01.283746 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_rank_customers ........... [RUN]
[0m18:33:01.283746 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_customers'
[0m18:33:01.284746 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_customers
[0m18:33:01.291745 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_customers"
[0m18:33:01.292746 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_customers
[0m18:33:01.316963 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_customers"
[0m18:33:01.316963 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_customers"
[0m18:33:01.316963 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_customers
         as
        (WITH customers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        c.company
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_customers c
),
total_revenue AS (
    SELECT
        t.customer_id,
        SUM(t.revenue) AS total_revenue,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS revenue_rank
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    JOIN customers c ON t.customer_id = c.customer_id
    GROUP BY t.customer_id
)

SELECT * 
FROM total_revenue
ORDER BY revenue_rank
        );
[0m18:33:01.328958 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:33:02.662587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.349 seconds
[0m18:33:02.698356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe6b7b9e-acd1-4316-8322-fa816c7166e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A35718B0>]}
[0m18:33:02.698356 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_rank_customers ...... [[32mSUCCESS 1[0m in 1.41s]
[0m18:33:02.698356 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_customers
[0m18:33:02.698356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:02.698356 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:33:02.698356 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:33:03.023342 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m18:33:03.023342 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m18:33:03.365218 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_customers' was left open.
[0m18:33:03.365218 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_customers: Close
[0m18:33:03.681909 [info ] [MainThread]: 
[0m18:33:03.681909 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m18:33:03.681909 [debug] [MainThread]: Command end result
[0m18:33:03.719764 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:33:03.719764 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:33:03.724469 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:33:03.724469 [info ] [MainThread]: 
[0m18:33:03.724469 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:33:03.730474 [info ] [MainThread]: 
[0m18:33:03.730474 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:33:03.731483 [debug] [MainThread]: Command `dbt run` succeeded at 18:33:03.731483 after 6.88 seconds
[0m18:33:03.732482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A8862E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A3342120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176A8A739B0>]}
[0m18:33:03.732482 [debug] [MainThread]: Flushing usage events
[0m18:33:04.615864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:33:27.011935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D689CD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D5D9F260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D689FAD0>]}


============================== 18:33:27.021859 | 6209587a-2f80-4863-b4cd-925befab6a45 ==============================
[0m18:33:27.021859 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:33:27.022689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_rank_products', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:33:27.539209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6209587a-2f80-4863-b4cd-925befab6a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D7544FB0>]}
[0m18:33:27.615567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6209587a-2f80-4863-b4cd-925befab6a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D75EEAE0>]}
[0m18:33:27.617572 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:33:28.103323 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:33:28.255907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:33:28.255907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:33:28.272616 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:33:28.294144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6209587a-2f80-4863-b4cd-925befab6a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D7693140>]}
[0m18:33:28.372490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:33:28.372490 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:33:28.403123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6209587a-2f80-4863-b4cd-925befab6a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D8A04620>]}
[0m18:33:28.403123 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:33:28.403123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6209587a-2f80-4863-b4cd-925befab6a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D7413740>]}
[0m18:33:28.403123 [info ] [MainThread]: 
[0m18:33:28.403123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:28.403123 [info ] [MainThread]: 
[0m18:33:28.403123 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:33:28.403123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:33:28.506973 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:33:28.506973 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:33:28.506973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:29.869937 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.352 seconds
[0m18:33:29.869937 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:33:29.885810 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:33:29.885810 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:33:29.885810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:30.861370 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00af-3201-7e57-000c-493e000268d2
[0m18:33:30.861370 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:33:30.861370 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:33:30.861370 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:33:30.861370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:33:30.861370 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:33:30.861370 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:33:31.052531 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.197 seconds
[0m18:33:31.070127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:33:31.070127 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:33:31.070127 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:33:31.273650 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.201 seconds
[0m18:33:31.281733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6209587a-2f80-4863-b4cd-925befab6a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D75A13D0>]}
[0m18:33:31.281733 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_products
[0m18:33:31.281733 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_rank_products ............ [RUN]
[0m18:33:31.281733 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_products'
[0m18:33:31.281733 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_products
[0m18:33:31.299149 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_products"
[0m18:33:31.299149 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_products
[0m18:33:31.328189 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_products"
[0m18:33:31.328189 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_products"
[0m18:33:31.328189 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_products
         as
        (WITH products AS (
    SELECT
        p.product_id,
        p.product_family, 
        p.product_sub_family,
    FROM stg_products p
),
total_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS revenue_rank
    FROM stg_transactions t
    JOIN products p ON t.product_id = p.product_id
    GROUP BY t.product_id
)

SELECT * 
FROM total_revenue
ORDER BY revenue_rank
        );
[0m18:33:31.328189 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:33:32.275590 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00af-3201-7e57-000c-493e000268d6
[0m18:33:32.277343 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STG_PRODUCTS' does not exist or not authorized.
[0m18:33:32.287472 [debug] [Thread-1 (]: Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_PRODUCTS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql
[0m18:33:32.293417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6209587a-2f80-4863-b4cd-925befab6a45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D5D44890>]}
[0m18:33:32.293417 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_rank_products ... [[31mERROR[0m in 1.01s]
[0m18:33:32.293417 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_products
[0m18:33:32.293417 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_rank_products' to be skipped because of status 'error'.  Reason: Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_PRODUCTS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql.
[0m18:33:32.298799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:32.298799 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:33:32.298799 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:33:32.634675 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:33:32.634675 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:33:32.960664 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_products' was left open.
[0m18:33:32.960664 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_products: Close
[0m18:33:33.277502 [info ] [MainThread]: 
[0m18:33:33.277502 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m18:33:33.277502 [debug] [MainThread]: Command end result
[0m18:33:33.315869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:33:33.319007 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:33:33.324617 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:33:33.324617 [info ] [MainThread]: 
[0m18:33:33.327102 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:33:33.328133 [info ] [MainThread]: 
[0m18:33:33.329128 [error] [MainThread]:   Database Error in model mart_rank_products (models\mart\mart_rank_products.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_PRODUCTS' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_rank_products.sql
[0m18:33:33.330112 [info ] [MainThread]: 
[0m18:33:33.331111 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:33:33.332111 [debug] [MainThread]: Command `dbt run` failed at 18:33:33.332111 after 6.49 seconds
[0m18:33:33.333115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D64B6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D64B7E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180D64B5700>]}
[0m18:33:33.333115 [debug] [MainThread]: Flushing usage events
[0m18:33:34.201731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:18.507472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E9FC0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E9C62570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E9FC13A0>]}


============================== 18:34:18.523304 | 73444409-4a9b-48e4-9f3a-a6c7dd5351bb ==============================
[0m18:34:18.523304 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:34:18.523304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_rank_products', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:18.992251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73444409-4a9b-48e4-9f3a-a6c7dd5351bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EAD30620>]}
[0m18:34:19.055400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73444409-4a9b-48e4-9f3a-a6c7dd5351bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EAD7EF90>]}
[0m18:34:19.055400 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:34:19.524336 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:34:19.682622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:19.682622 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:19.682622 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:34:19.707758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73444409-4a9b-48e4-9f3a-a6c7dd5351bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EAE66ED0>]}
[0m18:34:19.774273 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:34:19.790443 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:34:19.822070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73444409-4a9b-48e4-9f3a-a6c7dd5351bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EC18E4E0>]}
[0m18:34:19.822070 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:34:19.822070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73444409-4a9b-48e4-9f3a-a6c7dd5351bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231EA1A49E0>]}
[0m18:34:19.822070 [info ] [MainThread]: 
[0m18:34:19.822070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:19.822070 [info ] [MainThread]: 
[0m18:34:19.822070 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:34:19.822070 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:34:19.933664 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:34:19.933664 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:34:19.934664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:21.303986 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.381 seconds
[0m18:34:21.335887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m18:34:21.353595 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:34:21.353595 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:34:21.355600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:22.275935 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.923 seconds
[0m18:34:22.275935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:34:22.275935 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:34:22.275935 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:34:22.459510 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b0-3201-7e56-000c-493e0002493e
[0m18:34:22.459510 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:34:22.459510 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:34:22.459510 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:34:22.459510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:34:22.474917 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:34:22.474917 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:34:22.667495 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.194 seconds
[0m18:34:22.667495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73444409-4a9b-48e4-9f3a-a6c7dd5351bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E73F3800>]}
[0m18:34:22.683319 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_rank_products
[0m18:34:22.683319 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_rank_products ............ [RUN]
[0m18:34:22.683319 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_rank_products'
[0m18:34:22.683319 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_rank_products
[0m18:34:22.683319 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_rank_products"
[0m18:34:22.683319 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_rank_products
[0m18:34:22.727396 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_rank_products"
[0m18:34:22.729390 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_rank_products"
[0m18:34:22.729390 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_rank_products"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_products
         as
        (WITH products AS (
    SELECT
        p.product_id,
        p.product_family, 
        p.product_sub_family,
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_products p
),
total_revenue AS (
    SELECT
        t.product_id,
        SUM(t.revenue) AS total_revenue,
        RANK() OVER(ORDER BY SUM(t.revenue) DESC) AS revenue_rank
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    JOIN products p ON t.product_id = p.product_id
    GROUP BY t.product_id
)

SELECT * 
FROM total_revenue
ORDER BY revenue_rank
        );
[0m18:34:22.730388 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:24.283651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.558 seconds
[0m18:34:24.320630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73444409-4a9b-48e4-9f3a-a6c7dd5351bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E7361A00>]}
[0m18:34:24.320630 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_rank_products ....... [[32mSUCCESS 1[0m in 1.64s]
[0m18:34:24.320630 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_rank_products
[0m18:34:24.320630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:24.320630 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:34:24.320630 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:34:24.657604 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:34:24.657604 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:34:24.977545 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_rank_products' was left open.
[0m18:34:24.977545 [debug] [MainThread]: On model.CRB_PROJECT.mart_rank_products: Close
[0m18:34:25.306416 [info ] [MainThread]: 
[0m18:34:25.306416 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m18:34:25.306416 [debug] [MainThread]: Command end result
[0m18:34:25.363104 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:34:25.363104 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:34:25.363104 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:34:25.363104 [info ] [MainThread]: 
[0m18:34:25.363104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:25.378091 [info ] [MainThread]: 
[0m18:34:25.378941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:34:25.379615 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:25.379615 after 7.02 seconds
[0m18:34:25.379615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E7AA1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E9384FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231E9E8AB40>]}
[0m18:34:25.379615 [debug] [MainThread]: Flushing usage events
[0m18:34:26.274515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:13.651030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B30B99A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B30B8B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B30B8B00>]}


============================== 18:35:13.651030 | 38c3edaa-a12a-4d90-ab07-7145e0284119 ==============================
[0m18:35:13.651030 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:35:13.651030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_revenue_lost_due_to_contraction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:35:14.140196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38c3edaa-a12a-4d90-ab07-7145e0284119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B0952960>]}
[0m18:35:14.203465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38c3edaa-a12a-4d90-ab07-7145e0284119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B2BE7740>]}
[0m18:35:14.203465 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:35:14.688737 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:35:14.859870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:14.859870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:14.861873 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:35:14.895581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38c3edaa-a12a-4d90-ab07-7145e0284119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B5386270>]}
[0m18:35:14.962014 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:35:14.962014 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:35:14.993380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38c3edaa-a12a-4d90-ab07-7145e0284119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B561AEA0>]}
[0m18:35:14.993380 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:35:14.993380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38c3edaa-a12a-4d90-ab07-7145e0284119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B129E6F0>]}
[0m18:35:14.993380 [info ] [MainThread]: 
[0m18:35:14.993380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:14.993380 [info ] [MainThread]: 
[0m18:35:14.993380 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:35:14.993380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:35:15.111692 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:35:15.111692 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:35:15.111692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:16.495713 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.392 seconds
[0m18:35:16.515702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m18:35:16.515702 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:35:16.515702 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:35:16.515702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:17.469436 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.951 seconds
[0m18:35:17.469436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:35:17.469436 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:35:17.469436 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:35:17.676279 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b1-3201-7db6-000c-493e000257fa
[0m18:35:17.676279 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:35:17.676279 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:35:17.676279 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:35:17.676279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:35:17.692262 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:35:17.692262 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:35:17.905936 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.210 seconds
[0m18:35:17.909971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38c3edaa-a12a-4d90-ab07-7145e0284119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B42FD1F0>]}
[0m18:35:17.909971 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m18:35:17.909971 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_revenue_lost_due_to_contraction  [RUN]
[0m18:35:17.909971 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction'
[0m18:35:17.909971 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m18:35:17.925847 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m18:35:17.927673 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m18:35:17.958107 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m18:35:17.960107 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"
[0m18:35:17.960107 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_revenue_lost_due_to_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_revenue_lost_due_to_contraction"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_revenue_lost_due_to_contraction
         as
        (WITH transactional_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue >= prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
)
SELECT 
    payment_month, 
    SUM(revenue) AS revenue_lost 
FROM transactional_data 
WHERE revenue_trend='Contraction' GROUP BY payment_month ORDER BY payment_month
        );
[0m18:35:17.961108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:19.294020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.339 seconds
[0m18:35:19.322818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38c3edaa-a12a-4d90-ab07-7145e0284119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B0951970>]}
[0m18:35:19.322818 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_revenue_lost_due_to_contraction  [[32mSUCCESS 1[0m in 1.41s]
[0m18:35:19.324109 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_revenue_lost_due_to_contraction
[0m18:35:19.325153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:19.326150 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:35:19.326150 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:35:19.639193 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:35:19.639193 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:35:19.976016 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_revenue_lost_due_to_contraction' was left open.
[0m18:35:19.976016 [debug] [MainThread]: On model.CRB_PROJECT.mart_revenue_lost_due_to_contraction: Close
[0m18:35:20.295119 [info ] [MainThread]: 
[0m18:35:20.307213 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m18:35:20.307213 [debug] [MainThread]: Command end result
[0m18:35:20.335737 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:35:20.337699 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:35:20.339162 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:35:20.339162 [info ] [MainThread]: 
[0m18:35:20.339162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:20.339162 [info ] [MainThread]: 
[0m18:35:20.339162 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:35:20.339162 [debug] [MainThread]: Command `dbt run` succeeded at 18:35:20.339162 after 6.86 seconds
[0m18:35:20.339162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B2A32AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161AFFAAED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161B347E0F0>]}
[0m18:35:20.339162 [debug] [MainThread]: Flushing usage events
[0m18:35:21.236434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:36:40.581283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BA3FA120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BD782570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BD8481A0>]}


============================== 18:36:40.581283 | e0fd3027-0a1b-4121-af60-5e0738dfb826 ==============================
[0m18:36:40.581283 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:36:40.581283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m18:36:41.081548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0fd3027-0a1b-4121-af60-5e0738dfb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BDAF9E80>]}
[0m18:36:41.145277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0fd3027-0a1b-4121-af60-5e0738dfb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BE7E4410>]}
[0m18:36:41.147284 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:36:41.614951 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:36:41.773944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:41.773944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:41.773944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:36:41.800245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0fd3027-0a1b-4121-af60-5e0738dfb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BFA402F0>]}
[0m18:36:41.879484 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:36:41.879484 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:36:41.913748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0fd3027-0a1b-4121-af60-5e0738dfb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BFB12120>]}
[0m18:36:41.913748 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:36:41.913748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fd3027-0a1b-4121-af60-5e0738dfb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BDAFA210>]}
[0m18:36:41.913748 [info ] [MainThread]: 
[0m18:36:41.913748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:36:41.913748 [info ] [MainThread]: 
[0m18:36:41.913748 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:36:41.913748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:36:42.025272 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:36:42.025272 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:36:42.025272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:43.453505 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.431 seconds
[0m18:36:43.453505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:36:43.464846 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:36:43.464846 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:36:43.464846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:44.412133 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b2-3201-7e56-000c-493e0002498a
[0m18:36:44.412133 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:36:44.412133 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:36:44.412133 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:36:44.412133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:36:44.412133 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:36:44.412133 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:36:44.613290 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.203 seconds
[0m18:36:44.629083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:36:44.644905 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:36:44.644905 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:36:44.836567 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.201 seconds
[0m18:36:44.855663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fd3027-0a1b-4121-af60-5e0738dfb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BDADFF80>]}
[0m18:36:44.855663 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m18:36:44.855663 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_nrr_grr .................. [RUN]
[0m18:36:44.855663 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m18:36:44.855663 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m18:36:44.868181 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m18:36:44.868181 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m18:36:44.903145 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m18:36:44.903145 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m18:36:44.903145 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
         as
        (WITH revenues AS (
    SELECT 
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        payment_month
),
monthly_revenue AS (
    SELECT
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
)
SELECT
    n.customer_id,
    n.payment_month,
    n.recurring_revenue,
    n.previous_recurring_revenue,
    CASE 
        WHEN n.previous_recurring_revenue = 0 THEN 0
        ELSE (n.recurring_revenue / n.previous_recurring_revenue) * 100
    END AS nrr,
    m.grr
FROM
    nrr_calculation n
JOIN
    monthly_revenue m
ON
    n.customer_id = m.customer_id AND n.payment_month = m.payment_month
ORDER BY
    n.customer_id, n.payment_month
        );
[0m18:36:44.903145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:36:45.807077 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00b2-3201-7db6-000c-493e00025836
[0m18:36:45.807077 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 28 at position 50
invalid identifier 'CUSTOMER_ID'
[0m18:36:45.807077 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 28 at position 50
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m18:36:45.823209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0fd3027-0a1b-4121-af60-5e0738dfb826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BCF84E30>]}
[0m18:36:45.823209 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_nrr_grr ......... [[31mERROR[0m in 0.95s]
[0m18:36:45.823209 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m18:36:45.823209 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 28 at position 50
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql.
[0m18:36:45.823209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:45.823209 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:36:45.823209 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:36:46.148822 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:36:46.148822 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:36:46.467476 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m18:36:46.467476 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m18:36:46.795195 [info ] [MainThread]: 
[0m18:36:46.795195 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m18:36:46.795195 [debug] [MainThread]: Command end result
[0m18:36:46.825204 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:36:46.825204 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:36:46.825204 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:36:46.825204 [info ] [MainThread]: 
[0m18:36:46.825204 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:36:46.825204 [info ] [MainThread]: 
[0m18:36:46.836412 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 28 at position 50
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m18:36:46.838421 [info ] [MainThread]: 
[0m18:36:46.838835 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:36:46.838835 [debug] [MainThread]: Command `dbt run` failed at 18:36:46.838835 after 6.42 seconds
[0m18:36:46.841133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BA470590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BD560F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5BD5EAC90>]}
[0m18:36:46.841505 [debug] [MainThread]: Flushing usage events
[0m18:36:47.736505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:37:19.062568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DE38FB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DAD8B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DD9A53A0>]}


============================== 18:37:19.062568 | ca9983c0-177c-43f1-9f21-cbf15e0359ee ==============================
[0m18:37:19.062568 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:37:19.062568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:37:19.548501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca9983c0-177c-43f1-9f21-cbf15e0359ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DE38DDF0>]}
[0m18:37:19.596558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca9983c0-177c-43f1-9f21-cbf15e0359ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DEE38560>]}
[0m18:37:19.612686 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:37:20.081889 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:37:20.240656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:20.240656 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:20.240656 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:37:20.278203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca9983c0-177c-43f1-9f21-cbf15e0359ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DD386600>]}
[0m18:37:20.337112 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:37:20.353227 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:37:20.368896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca9983c0-177c-43f1-9f21-cbf15e0359ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260E05643B0>]}
[0m18:37:20.384999 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:37:20.384999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca9983c0-177c-43f1-9f21-cbf15e0359ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260E01EFEC0>]}
[0m18:37:20.384999 [info ] [MainThread]: 
[0m18:37:20.384999 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:20.384999 [info ] [MainThread]: 
[0m18:37:20.384999 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:37:20.384999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:37:20.533140 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:37:20.533140 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:37:20.534141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:21.843728 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.322 seconds
[0m18:37:21.861426 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m18:37:21.861426 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:37:21.861426 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:37:21.861426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:22.829704 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.967 seconds
[0m18:37:22.829704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:37:22.829704 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:37:22.829704 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:37:23.025981 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.189 seconds
[0m18:37:23.037551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:37:23.037551 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:37:23.037551 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:37:23.220905 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b3-3201-7db6-000c-493e0002583a
[0m18:37:23.220905 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:37:23.220905 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:37:23.226552 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:37:23.226552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca9983c0-177c-43f1-9f21-cbf15e0359ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260E0A026F0>]}
[0m18:37:23.230562 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m18:37:23.230562 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_nrr_grr .................. [RUN]
[0m18:37:23.232567 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m18:37:23.232567 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m18:37:23.236813 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m18:37:23.236813 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m18:37:23.273268 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m18:37:23.277281 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m18:37:23.277281 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
         as
        (WITH revenues AS (
    SELECT 
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        payment_month
),
monthly_revenue AS (
    SELECT
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
)
SELECT
    n.customer_id,
    n.payment_month,
    n.recurring_revenue,
    n.previous_recurring_revenue,
    CASE 
        WHEN n.previous_recurring_revenue = 0 THEN 0
        ELSE (n.recurring_revenue / n.previous_recurring_revenue) * 100
    END AS nrr,
    m.grr
FROM
    nrr_calculation n
JOIN
    monthly_revenue m
ON
    n.customer_id = m.customer_id AND n.payment_month = m.payment_month
ORDER BY
    n.customer_id, n.payment_month
        );
[0m18:37:23.277281 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:37:24.319904 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00b3-3201-7e56-000c-493e00024992
[0m18:37:24.319904 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 26 at position 8
invalid identifier 'CUSTOMER_ID'
[0m18:37:24.319904 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 26 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m18:37:24.319904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9983c0-177c-43f1-9f21-cbf15e0359ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DD834950>]}
[0m18:37:24.319904 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_nrr_grr ......... [[31mERROR[0m in 1.09s]
[0m18:37:24.319904 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m18:37:24.335643 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 26 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql.
[0m18:37:24.335643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:24.335643 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:37:24.335643 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:37:24.646084 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m18:37:24.658997 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m18:37:24.979314 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m18:37:24.979314 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m18:37:25.310471 [info ] [MainThread]: 
[0m18:37:25.310471 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m18:37:25.310471 [debug] [MainThread]: Command end result
[0m18:37:25.335770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:37:25.339384 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:37:25.346818 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:37:25.346818 [info ] [MainThread]: 
[0m18:37:25.346818 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:37:25.346818 [info ] [MainThread]: 
[0m18:37:25.346818 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 26 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m18:37:25.346818 [info ] [MainThread]: 
[0m18:37:25.346818 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:37:25.346818 [debug] [MainThread]: Command `dbt run` failed at 18:37:25.346818 after 6.45 seconds
[0m18:37:25.346818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DE0FAED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DF0A7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DE3478F0>]}
[0m18:37:25.346818 [debug] [MainThread]: Flushing usage events
[0m18:37:26.267629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:19.202647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0CB0D280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0A81EED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0CB0FF50>]}


============================== 18:38:19.202647 | a7905609-915d-4ee7-a1d9-ec9c861e24c8 ==============================
[0m18:38:19.202647 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:38:19.208676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_new_and_churned_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:38:19.705287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7905609-915d-4ee7-a1d9-ec9c861e24c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0C64E8A0>]}
[0m18:38:19.767063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7905609-915d-4ee7-a1d9-ec9c861e24c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0D4BF620>]}
[0m18:38:19.768391 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:38:20.244596 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:38:20.409918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:20.409918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:20.425683 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:38:20.447172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7905609-915d-4ee7-a1d9-ec9c861e24c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0E889C70>]}
[0m18:38:20.514105 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:38:20.529817 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:38:20.561538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7905609-915d-4ee7-a1d9-ec9c861e24c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0EB4A780>]}
[0m18:38:20.564331 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:38:20.564331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7905609-915d-4ee7-a1d9-ec9c861e24c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0E8B6FF0>]}
[0m18:38:20.564331 [info ] [MainThread]: 
[0m18:38:20.564331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:20.564331 [info ] [MainThread]: 
[0m18:38:20.564331 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:38:20.564331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:38:20.679486 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:38:20.679486 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:38:20.679486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:22.156244 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.477 seconds
[0m18:38:22.158250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:38:22.172011 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:38:22.172011 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:38:22.172011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:23.057810 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b4-3201-7e56-000c-493e0002499a
[0m18:38:23.057810 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m18:38:23.058813 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m18:38:23.058813 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:38:23.059811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:38:23.062781 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:38:23.063809 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:38:23.768081 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.716 seconds
[0m18:38:23.781289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:38:23.784735 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:38:23.784735 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:38:23.968580 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.185 seconds
[0m18:38:23.968580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7905609-915d-4ee7-a1d9-ec9c861e24c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0D87EA80>]}
[0m18:38:23.983150 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:38:23.983150 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_new_and_churned_customers  [RUN]
[0m18:38:23.985048 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_new_and_churned_customers'
[0m18:38:23.985048 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:38:23.985048 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m18:38:23.985048 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:38:24.022468 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m18:38:24.022468 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_new_and_churned_customers"
[0m18:38:24.022468 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_new_and_churned_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_new_and_churned_customers"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_new_and_churned_customers
         as
        (WITH purchases AS (
    SELECT 
        customer_id,
        MIN(payment_month) AS first_purchase_month,
        MAX(payment_month) AS last_purchase_month
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        customer_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    LEFT JOIN 
        purchases p ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
)
SELECT
    *
FROM
    new_and_churned_customers
ORDER BY
    payment_month
        );
[0m18:38:24.022468 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:38:25.400921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.369 seconds
[0m18:38:25.420580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7905609-915d-4ee7-a1d9-ec9c861e24c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D09EF1700>]}
[0m18:38:25.420580 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_new_and_churned_customers  [[32mSUCCESS 1[0m in 1.44s]
[0m18:38:25.420580 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_new_and_churned_customers
[0m18:38:25.420580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:25.420580 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:38:25.420580 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:38:25.736922 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:38:25.736922 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:38:26.070123 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_new_and_churned_customers' was left open.
[0m18:38:26.070123 [debug] [MainThread]: On model.CRB_PROJECT.mart_new_and_churned_customers: Close
[0m18:38:26.394844 [info ] [MainThread]: 
[0m18:38:26.395843 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.83 seconds (5.83s).
[0m18:38:26.396845 [debug] [MainThread]: Command end result
[0m18:38:26.420789 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:38:26.423805 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:38:26.426787 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:38:26.426787 [info ] [MainThread]: 
[0m18:38:26.426787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:26.426787 [info ] [MainThread]: 
[0m18:38:26.426787 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:38:26.426787 [debug] [MainThread]: Command `dbt run` succeeded at 18:38:26.426787 after 7.40 seconds
[0m18:38:26.426787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0A226DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0C05BEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0C059D30>]}
[0m18:38:26.426787 [debug] [MainThread]: Flushing usage events
[0m18:38:27.698471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:58.666169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351C92C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023519198DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351C92DEB0>]}


============================== 18:40:58.666169 | 734b4453-a598-4fd1-8184-19a42a63610f ==============================
[0m18:40:58.666169 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:40:58.666169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m report', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:40:59.655098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '734b4453-a598-4fd1-8184-19a42a63610f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351D697890>]}
[0m18:40:59.705205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '734b4453-a598-4fd1-8184-19a42a63610f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351C904FE0>]}
[0m18:40:59.705205 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:41:00.322389 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:41:00.487878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:00.488860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:00.489326 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:41:00.523362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '734b4453-a598-4fd1-8184-19a42a63610f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351E797CB0>]}
[0m18:41:00.588991 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:41:00.610862 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:41:00.636209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '734b4453-a598-4fd1-8184-19a42a63610f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351EAF0440>]}
[0m18:41:00.636209 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:41:00.636209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '734b4453-a598-4fd1-8184-19a42a63610f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351C92FA70>]}
[0m18:41:00.636209 [info ] [MainThread]: 
[0m18:41:00.636209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:00.636209 [info ] [MainThread]: 
[0m18:41:00.648394 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:41:00.648394 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:41:03.787610 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:41:03.797835 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:41:03.797835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:05.267952 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.473 seconds
[0m18:41:05.267952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB, now create_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:41:05.267952 [debug] [ThreadPool]: Creating schema "database: "PROJECT_DB"
schema: "PROJECT_SCHEMA_report"
"
[0m18:41:05.278086 [debug] [ThreadPool]: Using snowflake connection "create_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:41:05.279042 [debug] [ThreadPool]: On create_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "create_PROJECT_DB_PROJECT_SCHEMA_report"} */
create schema if not exists PROJECT_DB.PROJECT_SCHEMA_report
[0m18:41:05.484136 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.212 seconds
[0m18:41:05.484136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m18:41:05.506253 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:41:05.506253 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:41:05.506253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:06.428477 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.934 seconds
[0m18:41:06.442371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:41:06.446411 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:41:06.446411 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:41:06.626831 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.178 seconds
[0m18:41:06.629362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:41:06.632360 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:41:06.633373 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:41:06.855714 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.221 seconds
[0m18:41:06.857721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '734b4453-a598-4fd1-8184-19a42a63610f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351E9A82F0>]}
[0m18:41:06.862929 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.report
[0m18:41:06.862929 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.report ...................... [RUN]
[0m18:41:06.862929 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.report'
[0m18:41:06.862929 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.report
[0m18:41:06.870685 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.report"
[0m18:41:06.870685 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.report
[0m18:41:06.911318 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.report"
[0m18:41:06.916691 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.report"
[0m18:41:06.916691 [debug] [Thread-1 (]: On model.CRB_PROJECT.report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.report
         as
        (WITH revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY
        payment_month
),
customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    LEFT JOIN 
        (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month
         FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
         GROUP BY customer_id) p
    ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
),
grr_nrr AS (
    SELECT
        payment_month,
        grr,
        nrr
    FROM
        PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
)
SELECT
    r.payment_month,
    r.total_revenue,
    pc.churned_customers_lm,
    nc.new_customers,
    nc.churned_customers,
    cs.cross_sell_opportunities,
    gn.grr,
    gn.nrr
FROM
    revenue r
LEFT JOIN
    product_churn_lm pc ON r.payment_month = pc.payment_month
LEFT JOIN
    new_and_churned_customers nc ON r.payment_month = nc.payment_month
LEFT JOIN
    (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities
     FROM cross_sell
     GROUP BY payment_month) cs ON r.payment_month = cs.payment_month
LEFT JOIN
    grr_nrr gn ON r.payment_month = gn.payment_month
ORDER BY
    r.payment_month;
[0m18:41:06.916691 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:08.089536 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00b7-3201-7e57-000c-493e000269d2
[0m18:41:08.089536 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 90 at position 19 unexpected ';'.
[0m18:41:08.105553 [debug] [Thread-1 (]: Database Error in model report (models\reporting\report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 19 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql
[0m18:41:08.105553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '734b4453-a598-4fd1-8184-19a42a63610f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351BDD4800>]}
[0m18:41:08.105553 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_report.report ............. [[31mERROR[0m in 1.24s]
[0m18:41:08.105553 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.report
[0m18:41:08.105553 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.report' to be skipped because of status 'error'.  Reason: Database Error in model report (models\reporting\report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 19 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql.
[0m18:41:08.105553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:08.105553 [debug] [MainThread]: Connection 'create_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m18:41:08.105553 [debug] [MainThread]: On create_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m18:41:08.435437 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m18:41:08.436437 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m18:41:08.767854 [debug] [MainThread]: Connection 'model.CRB_PROJECT.report' was left open.
[0m18:41:08.767854 [debug] [MainThread]: On model.CRB_PROJECT.report: Close
[0m18:41:09.082764 [info ] [MainThread]: 
[0m18:41:09.092960 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m18:41:09.092960 [debug] [MainThread]: Command end result
[0m18:41:09.118159 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:41:09.120921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:41:09.129017 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:41:09.129017 [info ] [MainThread]: 
[0m18:41:09.129017 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:41:09.129017 [info ] [MainThread]: 
[0m18:41:09.132957 [error] [MainThread]:   Database Error in model report (models\reporting\report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 19 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql
[0m18:41:09.133938 [info ] [MainThread]: 
[0m18:41:09.133938 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:41:09.135937 [debug] [MainThread]: Command `dbt run` failed at 18:41:09.135937 after 10.65 seconds
[0m18:41:09.135937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351915EF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351BACFC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351BACF230>]}
[0m18:41:09.136940 [debug] [MainThread]: Flushing usage events
[0m18:41:10.382359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:35.791236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021954B6AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021954B6B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021954B68590>]}


============================== 18:41:35.791236 | 4cbc7cb7-81d3-4a04-95da-71d9d562cabf ==============================
[0m18:41:35.791236 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:41:35.791236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m report', 'send_anonymous_usage_stats': 'True'}
[0m18:41:36.298455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cbc7cb7-81d3-4a04-95da-71d9d562cabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021955DBDCD0>]}
[0m18:41:36.358780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cbc7cb7-81d3-4a04-95da-71d9d562cabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021954B6A6F0>]}
[0m18:41:36.358780 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:41:36.851402 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:41:37.008960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:37.008960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:37.008960 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:41:37.048054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cbc7cb7-81d3-4a04-95da-71d9d562cabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021956E332C0>]}
[0m18:41:37.127713 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:41:37.131226 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:41:37.157569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cbc7cb7-81d3-4a04-95da-71d9d562cabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021956E7BDA0>]}
[0m18:41:37.157569 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:41:37.157569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cbc7cb7-81d3-4a04-95da-71d9d562cabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021956E30CB0>]}
[0m18:41:37.157569 [info ] [MainThread]: 
[0m18:41:37.157569 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:37.157569 [info ] [MainThread]: 
[0m18:41:37.157569 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:41:37.157569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:41:37.259496 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:41:37.259496 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:41:37.259496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:38.574810 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.310 seconds
[0m18:41:38.574810 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:41:38.596448 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:41:38.596448 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:41:38.596448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:39.485556 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.888 seconds
[0m18:41:39.485556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:41:39.485556 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:41:39.485556 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:41:39.690718 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.199 seconds
[0m18:41:39.692243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:41:39.697611 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:41:39.697611 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:41:39.891963 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.202 seconds
[0m18:41:39.891963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cbc7cb7-81d3-4a04-95da-71d9d562cabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021957632E40>]}
[0m18:41:39.907695 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.report
[0m18:41:39.911279 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.report ...................... [RUN]
[0m18:41:39.913289 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.report'
[0m18:41:39.913289 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.report
[0m18:41:39.924977 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.report"
[0m18:41:39.925808 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.report
[0m18:41:39.945524 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.report"
[0m18:41:39.961966 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.report"
[0m18:41:39.961966 [debug] [Thread-1 (]: On model.CRB_PROJECT.report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.report
         as
        (WITH revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY
        payment_month
),
customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    LEFT JOIN 
        (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month
         FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
         GROUP BY customer_id) p
    ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
),
grr_nrr AS (
    SELECT
        payment_month,
        grr,
        nrr
    FROM
        PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
)
SELECT
    r.payment_month,
    r.total_revenue,
    pc.churned_customers_lm,
    nc.new_customers,
    nc.churned_customers,
    cs.cross_sell_opportunities,
    gn.grr,
    gn.nrr
FROM
    revenue r
LEFT JOIN
    product_churn_lm pc ON r.payment_month = pc.payment_month
LEFT JOIN
    new_and_churned_customers nc ON r.payment_month = nc.payment_month
LEFT JOIN
    (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities
     FROM cross_sell
     GROUP BY payment_month) cs ON r.payment_month = cs.payment_month
LEFT JOIN
    grr_nrr gn ON r.payment_month = gn.payment_month
ORDER BY
    r.payment_month
        );
[0m18:41:39.961966 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:40.880145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00b7-3201-7db6-000c-493e0002588a
[0m18:41:40.880145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'PROJECT_DB.PROJECT_SCHEMA_MART.MART_NRR_GRR' does not exist or not authorized.
[0m18:41:40.880145 [debug] [Thread-1 (]: Database Error in model report (models\reporting\report.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_DB.PROJECT_SCHEMA_MART.MART_NRR_GRR' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql
[0m18:41:40.880145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cbc7cb7-81d3-4a04-95da-71d9d562cabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021954504860>]}
[0m18:41:40.880145 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_report.report ............. [[31mERROR[0m in 0.97s]
[0m18:41:40.880145 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.report
[0m18:41:40.880145 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.report' to be skipped because of status 'error'.  Reason: Database Error in model report (models\reporting\report.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_DB.PROJECT_SCHEMA_MART.MART_NRR_GRR' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql.
[0m18:41:40.880145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:40.880145 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:41:40.880145 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:41:41.204979 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:41:41.220878 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:41:41.540398 [debug] [MainThread]: Connection 'model.CRB_PROJECT.report' was left open.
[0m18:41:41.544075 [debug] [MainThread]: On model.CRB_PROJECT.report: Close
[0m18:41:41.874069 [info ] [MainThread]: 
[0m18:41:41.874069 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m18:41:41.874069 [debug] [MainThread]: Command end result
[0m18:41:41.900788 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:41:41.904351 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:41:41.911384 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:41:41.911384 [info ] [MainThread]: 
[0m18:41:41.911384 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:41:41.913480 [info ] [MainThread]: 
[0m18:41:41.914504 [error] [MainThread]:   Database Error in model report (models\reporting\report.sql)
  002003 (42S02): SQL compilation error:
  Object 'PROJECT_DB.PROJECT_SCHEMA_MART.MART_NRR_GRR' does not exist or not authorized.
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql
[0m18:41:41.915523 [info ] [MainThread]: 
[0m18:41:41.916521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:41:41.917486 [debug] [MainThread]: Command `dbt run` failed at 18:41:41.917486 after 6.29 seconds
[0m18:41:41.918505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021954B9FD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021954B9F440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021955D17500>]}
[0m18:41:41.918505 [debug] [MainThread]: Flushing usage events
[0m18:41:42.821047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:58.455479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297662AD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029763551BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029763769730>]}


============================== 18:43:58.459940 | 54ab8eb5-e3f9-4e3f-8226-01952380100f ==============================
[0m18:43:58.459940 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:43:58.460940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m18:43:58.956123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54ab8eb5-e3f9-4e3f-8226-01952380100f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029766FDF3E0>]}
[0m18:43:59.017132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54ab8eb5-e3f9-4e3f-8226-01952380100f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029766FDD250>]}
[0m18:43:59.019245 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:43:59.505349 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:43:59.675893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:43:59.675893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:43:59.681867 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:43:59.710296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54ab8eb5-e3f9-4e3f-8226-01952380100f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002976811CD40>]}
[0m18:43:59.786881 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:43:59.791152 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:43:59.823514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54ab8eb5-e3f9-4e3f-8226-01952380100f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002976811FB60>]}
[0m18:43:59.824516 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:43:59.824516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54ab8eb5-e3f9-4e3f-8226-01952380100f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297680D1F10>]}
[0m18:43:59.826516 [info ] [MainThread]: 
[0m18:43:59.826516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:59.827516 [info ] [MainThread]: 
[0m18:43:59.828513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:43:59.829515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:43:59.936212 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:43:59.936212 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:43:59.937411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:01.351676 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.414 seconds
[0m18:44:01.363000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:44:01.375133 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:44:01.375133 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:44:01.375133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:02.243673 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.880 seconds
[0m18:44:02.256986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:44:02.259648 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:44:02.259648 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:44:02.449678 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.199 seconds
[0m18:44:02.449678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:44:02.449678 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:44:02.449678 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:44:02.664176 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.200 seconds
[0m18:44:02.664176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54ab8eb5-e3f9-4e3f-8226-01952380100f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002976880A090>]}
[0m18:44:02.664176 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m18:44:02.664176 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_nrr_grr .................. [RUN]
[0m18:44:02.664176 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m18:44:02.664176 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m18:44:02.683145 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m18:44:02.685310 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m18:44:02.720301 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m18:44:02.722840 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m18:44:02.724851 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
         as
        (WITH revenues AS (
    SELECT 
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        payment_month
),
monthly_revenue AS (
    SELECT
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
)
SELECT
    n.customer_id,
    n.payment_month,
    n.recurring_revenue,
    n.previous_recurring_revenue,
    CASE 
        WHEN n.previous_recurring_revenue = 0 THEN 0
        ELSE (n.recurring_revenue / n.previous_recurring_revenue) * 100
    END AS nrr,
    m.grr
FROM
    nrr_calculation n
JOIN
    monthly_revenue m
ON
    n.customer_id = m.customer_id AND n.payment_month = m.payment_month
ORDER BY
    n.customer_id, n.payment_month
        );
[0m18:44:02.724851 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:44:03.722322 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00ba-3201-7d7b-000c-493e00022d3e
[0m18:44:03.722322 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 26 at position 8
invalid identifier 'CUSTOMER_ID'
[0m18:44:03.734265 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 26 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m18:44:03.738011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ab8eb5-e3f9-4e3f-8226-01952380100f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297657546E0>]}
[0m18:44:03.738488 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_nrr_grr ......... [[31mERROR[0m in 1.07s]
[0m18:44:03.738488 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m18:44:03.738488 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 26 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql.
[0m18:44:03.742017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:03.742017 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:44:03.742017 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:44:04.065910 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:44:04.065910 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:44:04.389938 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m18:44:04.389938 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m18:44:04.717601 [info ] [MainThread]: 
[0m18:44:04.719623 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m18:44:04.723532 [debug] [MainThread]: Command end result
[0m18:44:04.744608 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:44:04.753266 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:44:04.760746 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:44:04.761332 [info ] [MainThread]: 
[0m18:44:04.761332 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:44:04.761332 [info ] [MainThread]: 
[0m18:44:04.761332 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 26 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m18:44:04.761332 [info ] [MainThread]: 
[0m18:44:04.761332 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:44:04.761332 [debug] [MainThread]: Command `dbt run` failed at 18:44:04.761332 after 6.48 seconds
[0m18:44:04.761332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029765FBA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029766150DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297661516A0>]}
[0m18:44:04.761332 [debug] [MainThread]: Flushing usage events
[0m18:44:05.673303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:24.553220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D1AF35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D1AD1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D22A6210>]}


============================== 18:46:24.561396 | e76f8904-c045-455d-89de-3394feebd520 ==============================
[0m18:46:24.561396 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:46:24.563404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m18:46:25.265606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e76f8904-c045-455d-89de-3394feebd520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D191A060>]}
[0m18:46:25.322978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e76f8904-c045-455d-89de-3394feebd520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D2F18530>]}
[0m18:46:25.322978 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:46:25.841844 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:46:26.063498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:46:26.063498 [debug] [MainThread]: Partial parsing: updated file: CRB_PROJECT://models\mart\mart_nrr_grr.sql
[0m18:46:26.329979 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:46:26.346588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e76f8904-c045-455d-89de-3394feebd520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D47575F0>]}
[0m18:46:26.426029 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:46:26.430042 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:46:26.492204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e76f8904-c045-455d-89de-3394feebd520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D4729E20>]}
[0m18:46:26.493203 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:46:26.494206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e76f8904-c045-455d-89de-3394feebd520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D45C9EB0>]}
[0m18:46:26.496897 [info ] [MainThread]: 
[0m18:46:26.502929 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:46:26.502929 [info ] [MainThread]: 
[0m18:46:26.504940 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:46:26.504940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:46:26.628440 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:46:26.628440 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:46:26.628440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:27.998494 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.370 seconds
[0m18:46:28.009303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m18:46:28.014080 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:46:28.014080 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:46:28.021613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:28.900307 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.883 seconds
[0m18:46:28.905925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:46:28.911940 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:46:28.911940 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:46:29.105905 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.196 seconds
[0m18:46:29.105905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:46:29.161604 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:46:29.161604 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:46:29.354640 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.200 seconds
[0m18:46:29.354640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e76f8904-c045-455d-89de-3394feebd520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D47A0620>]}
[0m18:46:29.354640 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m18:46:29.370344 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_nrr_grr .................. [RUN]
[0m18:46:29.370344 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m18:46:29.370344 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m18:46:29.370344 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m18:46:29.370344 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m18:46:29.412396 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m18:46:29.415076 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m18:46:29.416334 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
         as
        (WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
)
SELECT
    n.customer_id,
    n.payment_month,
    n.recurring_revenue,
    n.previous_recurring_revenue,
    CASE 
        WHEN n.previous_recurring_revenue = 0 THEN 0
        ELSE (n.recurring_revenue / n.previous_recurring_revenue) * 100
    END AS nrr,
    m.grr
FROM
    nrr_calculation n
JOIN
    monthly_revenue m
ON
    n.customer_id = m.customer_id AND n.payment_month = m.payment_month
ORDER BY
    n.customer_id, n.payment_month;
[0m18:46:29.416334 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:46:30.359648 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00bc-3201-7d7b-000c-493e00022d42
[0m18:46:30.359648 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 52 at position 34 unexpected ';'.
[0m18:46:30.359648 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 34 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m18:46:30.359648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76f8904-c045-455d-89de-3394feebd520', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D1884BF0>]}
[0m18:46:30.359648 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_nrr_grr ......... [[31mERROR[0m in 0.99s]
[0m18:46:30.359648 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m18:46:30.359648 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 34 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql.
[0m18:46:30.359648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:30.359648 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:46:30.375537 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:46:30.689765 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m18:46:30.689765 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m18:46:31.011735 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m18:46:31.011735 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m18:46:31.331519 [info ] [MainThread]: 
[0m18:46:31.331519 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m18:46:31.331519 [debug] [MainThread]: Command end result
[0m18:46:31.358814 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:46:31.359814 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:46:31.367225 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:46:31.368255 [info ] [MainThread]: 
[0m18:46:31.368764 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:46:31.370778 [info ] [MainThread]: 
[0m18:46:31.370778 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 34 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m18:46:31.370778 [info ] [MainThread]: 
[0m18:46:31.370778 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:46:31.375748 [debug] [MainThread]: Command `dbt run` failed at 18:46:31.375748 after 7.00 seconds
[0m18:46:31.375748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D138F0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D138D250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157D138DEB0>]}
[0m18:46:31.375748 [debug] [MainThread]: Flushing usage events
[0m18:46:32.278251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:41.010811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C947AD1A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C94A4D3E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C94A4D2CC0>]}


============================== 18:46:41.022574 | e69c1367-3c0f-4afc-8a49-3a0d703c1428 ==============================
[0m18:46:41.022574 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:46:41.022574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:46:41.487523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e69c1367-3c0f-4afc-8a49-3a0d703c1428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C94B4D4B00>]}
[0m18:46:41.549276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e69c1367-3c0f-4afc-8a49-3a0d703c1428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C947F2B170>]}
[0m18:46:41.551277 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:46:42.054862 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:46:42.224940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:46:42.224940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:46:42.229482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:46:42.264448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e69c1367-3c0f-4afc-8a49-3a0d703c1428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C94C5B3B30>]}
[0m18:46:42.329541 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:46:42.343170 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:46:42.362946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e69c1367-3c0f-4afc-8a49-3a0d703c1428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C94C995CD0>]}
[0m18:46:42.369880 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:46:42.369880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e69c1367-3c0f-4afc-8a49-3a0d703c1428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C94C5F1970>]}
[0m18:46:42.369880 [info ] [MainThread]: 
[0m18:46:42.369880 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:46:42.369880 [info ] [MainThread]: 
[0m18:46:42.369880 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:46:42.369880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:46:42.479726 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:46:42.479726 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:46:42.479726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:43.754522 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.268 seconds
[0m18:46:43.760523 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:46:43.767914 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:46:43.767914 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:46:43.767914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:43.814482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A7CB8A5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A7F3E3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A7F3E35C0>]}


============================== 18:46:43.829982 | 8e8c2fff-bc78-419d-a06b-34dd00999a12 ==============================
[0m18:46:43.829982 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:46:43.830880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m18:46:43.956801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e8c2fff-bc78-419d-a06b-34dd00999a12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A7F5747D0>]}
[0m18:46:43.991543 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:46:43.993519 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:46:43.994521 [debug] [MainThread]: Command `cli deps` succeeded at 18:46:43.994521 after 0.34 seconds
[0m18:46:43.994521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A7F8D9E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A7F0A3FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A7F776000>]}
[0m18:46:43.995518 [debug] [MainThread]: Flushing usage events
[0m18:46:44.714818 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.951 seconds
[0m18:46:44.714818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:46:44.714818 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:46:44.714818 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:46:44.882357 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:44.931782 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.204 seconds
[0m18:46:44.934073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:46:44.937042 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:46:44.939046 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:46:45.134161 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.195 seconds
[0m18:46:45.136129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e69c1367-3c0f-4afc-8a49-3a0d703c1428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C94C997FE0>]}
[0m18:46:45.140126 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m18:46:45.141128 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_nrr_grr .................. [RUN]
[0m18:46:45.142128 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m18:46:45.142128 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m18:46:45.150128 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m18:46:45.151129 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m18:46:45.186460 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m18:46:45.189460 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m18:46:45.189460 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
         as
        (WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
)
SELECT
    n.customer_id,
    n.payment_month,
    n.recurring_revenue,
    n.previous_recurring_revenue,
    CASE 
        WHEN n.previous_recurring_revenue = 0 THEN 0
        ELSE (n.recurring_revenue / n.previous_recurring_revenue) * 100
    END AS nrr,
    m.grr
FROM
    nrr_calculation n
JOIN
    monthly_revenue m
ON
    n.customer_id = m.customer_id AND n.payment_month = m.payment_month
ORDER BY
    n.customer_id, n.payment_month
        );
[0m18:46:45.190462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:46:46.588267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.408 seconds
[0m18:46:46.619635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e69c1367-3c0f-4afc-8a49-3a0d703c1428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C949CD4710>]}
[0m18:46:46.619635 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_nrr_grr ............. [[32mSUCCESS 1[0m in 1.48s]
[0m18:46:46.620815 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m18:46:46.621866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:46.622905 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:46:46.622905 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:46:46.943768 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:46:46.944766 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:46:47.251090 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m18:46:47.260141 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m18:46:47.586410 [info ] [MainThread]: 
[0m18:46:47.587413 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m18:46:47.588411 [debug] [MainThread]: Command end result
[0m18:46:47.607920 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:46:47.607920 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:46:47.623492 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:46:47.624461 [info ] [MainThread]: 
[0m18:46:47.625459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:46:47.625459 [info ] [MainThread]: 
[0m18:46:47.626458 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:46:47.626458 [debug] [MainThread]: Command `dbt run` succeeded at 18:46:47.626458 after 6.78 seconds
[0m18:46:47.626458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C947AD1A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C949CB03E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C949CB2A20>]}
[0m18:46:47.626458 [debug] [MainThread]: Flushing usage events
[0m18:46:48.519412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:49:59.500572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583B668650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583B66A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583B66A1E0>]}


============================== 18:49:59.514175 | 140e035e-aace-401b-bfa3-cccdf50d7b34 ==============================
[0m18:49:59.514175 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:49:59.514175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_nrr_grr', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:49:59.885629 [error] [MainThread]: Encountered an error:

[0m18:49:59.928011 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 251, in wrapper
    project = load_project(
              ^^^^^^^^^^^^^
  File "C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\runtime.py", line 59, in load_project
    project = Project.from_project_root(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\project.py", line 752, in from_project_root
    return partial.render(renderer)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\project.py", line 321, in render
    return self.create_project(rendered)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\project.py", line 374, in create_project
    cfg = ProjectContract.from_dict(rendered.project_dict)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 3, in __mashumaro_from_dict__
  File "C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\core\meta\code\builder.py", line 588, in add_unpack_method
    self.compile()
  File "C:\Users\PaluriVarshini\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\core\meta\code\builder.py", line 332, in compile
    exec(code, self.globals, self.__dict__)
  File "<string>", line 0, in <module>
KeyboardInterrupt

[0m18:49:59.943946 [debug] [MainThread]: Command `dbt run` failed at 18:49:59.943946 after 0.60 seconds
[0m18:49:59.943946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583B6685F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583C01ADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583C019AC0>]}
[0m18:49:59.944937 [debug] [MainThread]: Flushing usage events
[0m18:50:01.194686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:21.280584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8C2B2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8F764320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8F767AD0>]}


============================== 18:50:21.299792 | 334a289e-51b1-4daf-805e-36ea4121af24 ==============================
[0m18:50:21.299792 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:50:21.299792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:50:21.712858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '334a289e-51b1-4daf-805e-36ea4121af24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D90CBFDD0>]}
[0m18:50:21.777034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '334a289e-51b1-4daf-805e-36ea4121af24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D90C97D10>]}
[0m18:50:21.777034 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:50:22.255735 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:50:22.415461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:22.415461 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:22.421470 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:50:22.451197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '334a289e-51b1-4daf-805e-36ea4121af24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D90CF1F10>]}
[0m18:50:22.523303 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:50:22.525309 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:50:22.547212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '334a289e-51b1-4daf-805e-36ea4121af24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D92127AD0>]}
[0m18:50:22.547212 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:50:22.547212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334a289e-51b1-4daf-805e-36ea4121af24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D90C949B0>]}
[0m18:50:22.547212 [info ] [MainThread]: 
[0m18:50:22.552623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:22.552623 [info ] [MainThread]: 
[0m18:50:22.552623 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:50:22.552623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:50:22.658866 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:50:22.658866 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:50:22.659851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:24.057009 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.402 seconds
[0m18:50:24.069644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m18:50:24.078721 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:50:24.079721 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:50:24.079721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:25.016084 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.950 seconds
[0m18:50:25.030654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:50:25.032161 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:50:25.034168 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:50:25.223538 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.199 seconds
[0m18:50:25.235905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:50:25.239233 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:50:25.239233 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:50:25.414055 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.184 seconds
[0m18:50:25.425534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334a289e-51b1-4daf-805e-36ea4121af24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D925A22A0>]}
[0m18:50:25.429899 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:50:25.429899 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m18:50:25.429899 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m18:50:25.429899 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:50:25.429899 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:50:25.429899 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:50:25.471059 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:50:25.484634 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:50:25.484634 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
product_churn_l3m AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_l3m
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '90 Days'
    GROUP BY
        product_id
),
product_churn_ltm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_ltm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '1 year'
    GROUP BY
        product_id
),
cross_sell_lm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
),
cross_sell_l3m AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '90 Days'
),
cross_sell_ltm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '1 year'
)
SELECT
    p.product_id,
    p.churned_customers_lm,
    p3m.churned_customers_l3m,
    p12m.churned_customers_ltm,
    COUNT(DISTINCT cs_lm.product_id_2) AS cross_sell_opportunities_lm,
    COUNT(DISTINCT cs_l3m.product_id_2) AS cross_sell_opportunities_l3m,
    COUNT(DISTINCT cs_ltm.product_id_2) AS cross_sell_opportunities_ltm
FROM
    product_churn_lm p
LEFT JOIN
    product_churn_l3m p3m
ON
    p.product_id = p3m.product_id
LEFT JOIN
    product_churn_ltm p12m
ON
    p.product_id = p12m.product_id
LEFT JOIN
    cross_sell_lm cs_lm
ON
    p.product_id = cs_lm.product_id_1
LEFT JOIN
    cross_sell_l3m cs_l3m
ON
    p.product_id = cs_l3m.product_id_1
LEFT JOIN
    cross_sell_ltm cs_ltm
ON
    p.product_id = cs_ltm.product_id_1
GROUP BY
    p.product_id, p.churned_customers_lm, p3m.churned_customers_l3m, p12m.churned_customers_ltm
ORDER BY
    p.product_id;
[0m18:50:25.485646 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:26.436856 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c0-3201-7db6-000c-493e0002593a
[0m18:50:26.436856 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 122 at position 16 unexpected ';'.
[0m18:50:26.436856 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 122 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m18:50:26.436856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a289e-51b1-4daf-805e-36ea4121af24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D90DE2630>]}
[0m18:50:26.436856 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.01s]
[0m18:50:26.451748 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:50:26.452576 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 122 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m18:50:26.454581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:26.454581 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:50:26.454581 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:50:26.774049 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m18:50:26.774049 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m18:50:27.086788 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m18:50:27.086788 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m18:50:27.419820 [info ] [MainThread]: 
[0m18:50:27.419820 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m18:50:27.419820 [debug] [MainThread]: Command end result
[0m18:50:27.457816 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:50:27.461040 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:50:27.465040 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:50:27.465040 [info ] [MainThread]: 
[0m18:50:27.465040 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:50:27.465040 [info ] [MainThread]: 
[0m18:50:27.470120 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 122 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m18:50:27.471397 [info ] [MainThread]: 
[0m18:50:27.473752 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:50:27.475171 [debug] [MainThread]: Command `dbt run` failed at 18:50:27.475171 after 6.34 seconds
[0m18:50:27.476239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D8C2B2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D925F7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D9204ADB0>]}
[0m18:50:27.476239 [debug] [MainThread]: Flushing usage events
[0m18:50:28.438048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:35.720194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021529165310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021529165190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021529164860>]}


============================== 18:50:35.721939 | 7313917c-822a-4922-830c-a802d9961ec0 ==============================
[0m18:50:35.721939 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:50:35.721939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:50:36.141265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7313917c-822a-4922-830c-a802d9961ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021529F4DDF0>]}
[0m18:50:36.203407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7313917c-822a-4922-830c-a802d9961ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152AFC2210>]}
[0m18:50:36.203407 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:50:36.679085 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:50:36.835427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:36.835427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:36.851110 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:50:36.881086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7313917c-822a-4922-830c-a802d9961ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152B00BB30>]}
[0m18:50:36.945649 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:50:36.945649 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:50:36.977387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7313917c-822a-4922-830c-a802d9961ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152B374BC0>]}
[0m18:50:36.977387 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:50:36.977387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7313917c-822a-4922-830c-a802d9961ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152AFC3260>]}
[0m18:50:36.982103 [info ] [MainThread]: 
[0m18:50:36.982103 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:36.982103 [info ] [MainThread]: 
[0m18:50:36.982103 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:50:36.982103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:50:37.089879 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:50:37.090883 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:50:37.090883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:38.203704 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.123 seconds
[0m18:50:38.219804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m18:50:38.219804 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:50:38.219804 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:50:38.219804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:39.537516 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.306 seconds
[0m18:50:39.539526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:50:39.543976 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:50:39.543976 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:50:39.879842 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.335 seconds
[0m18:50:39.880846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:50:39.882850 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:50:39.884856 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:50:40.071675 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.190 seconds
[0m18:50:40.071675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7313917c-822a-4922-830c-a802d9961ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002152B7D2EA0>]}
[0m18:50:40.071675 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:50:40.071675 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m18:50:40.087779 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m18:50:40.087779 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:50:40.098326 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:50:40.106708 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:50:40.140536 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:50:40.143533 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:50:40.144536 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
product_churn_l3m AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_l3m
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '90 Days'
    GROUP BY
        product_id
),
product_churn_ltm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_ltm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '1 year'
    GROUP BY
        product_id
),
cross_sell_lm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
),
cross_sell_l3m AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '90 Days'
),
cross_sell_ltm AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '1 year'
)
SELECT
    p.product_id,
    p.churned_customers_lm,
    p3m.churned_customers_l3m,
    p12m.churned_customers_ltm,
    COUNT(DISTINCT cs_lm.product_id_2) AS cross_sell_opportunities_lm,
    COUNT(DISTINCT cs_l3m.product_id_2) AS cross_sell_opportunities_l3m,
    COUNT(DISTINCT cs_ltm.product_id_2) AS cross_sell_opportunities_ltm
FROM
    product_churn_lm p
LEFT JOIN
    product_churn_l3m p3m
ON
    p.product_id = p3m.product_id
LEFT JOIN
    product_churn_ltm p12m
ON
    p.product_id = p12m.product_id
LEFT JOIN
    cross_sell_lm cs_lm
ON
    p.product_id = cs_lm.product_id_1
LEFT JOIN
    cross_sell_l3m cs_l3m
ON
    p.product_id = cs_l3m.product_id_1
LEFT JOIN
    cross_sell_ltm cs_ltm
ON
    p.product_id = cs_ltm.product_id_1
GROUP BY
    p.product_id, p.churned_customers_lm, p3m.churned_customers_l3m, p12m.churned_customers_ltm
ORDER BY
    p.product_id
        );
[0m18:50:40.144536 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:41.560984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.426 seconds
[0m18:50:41.577000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7313917c-822a-4922-830c-a802d9961ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215265918B0>]}
[0m18:50:41.592873 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 1.51s]
[0m18:50:41.592873 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:50:41.592873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:41.592873 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:50:41.592873 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:50:41.913437 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m18:50:41.913437 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m18:50:42.238120 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m18:50:42.238120 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m18:50:42.565169 [info ] [MainThread]: 
[0m18:50:42.565169 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.58 seconds (5.58s).
[0m18:50:42.565169 [debug] [MainThread]: Command end result
[0m18:50:42.587526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:50:42.601381 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:50:42.608072 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:50:42.609075 [info ] [MainThread]: 
[0m18:50:42.609075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:50:42.609075 [info ] [MainThread]: 
[0m18:50:42.611121 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:50:42.611121 [debug] [MainThread]: Command `dbt run` succeeded at 18:50:42.611121 after 7.06 seconds
[0m18:50:42.613128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021529165010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021529165190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021529165310>]}
[0m18:50:42.613128 [debug] [MainThread]: Flushing usage events
[0m18:50:43.502107 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:08.142869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE12F506E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE12F50710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE12F51190>]}


============================== 18:53:08.158590 | ea14518c-277d-4790-b60a-e9353f4b76e9 ==============================
[0m18:53:08.158590 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:53:08.158590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m report', 'send_anonymous_usage_stats': 'True'}
[0m18:53:08.571156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea14518c-277d-4790-b60a-e9353f4b76e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE1248A330>]}
[0m18:53:08.637156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea14518c-277d-4790-b60a-e9353f4b76e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE12429670>]}
[0m18:53:08.637156 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:53:09.132937 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:53:09.299724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:09.299724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:09.318965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:53:09.369593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea14518c-277d-4790-b60a-e9353f4b76e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE14D42600>]}
[0m18:53:09.446104 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:53:09.450966 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:53:09.476690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea14518c-277d-4790-b60a-e9353f4b76e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE150E0560>]}
[0m18:53:09.477687 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:53:09.477687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea14518c-277d-4790-b60a-e9353f4b76e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE12F52A50>]}
[0m18:53:09.479687 [info ] [MainThread]: 
[0m18:53:09.480314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:09.480314 [info ] [MainThread]: 
[0m18:53:09.481298 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:53:09.481298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:53:09.585680 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:53:09.585680 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:53:09.585680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:10.865569 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.279 seconds
[0m18:53:10.871357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m18:53:10.881215 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:53:10.881215 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:53:10.881215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:11.777101 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.900 seconds
[0m18:53:11.777101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:53:11.789121 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:53:11.791146 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:53:11.975069 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.184 seconds
[0m18:53:11.977103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:53:11.979099 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:53:11.979099 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:53:12.173125 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.200 seconds
[0m18:53:12.182412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea14518c-277d-4790-b60a-e9353f4b76e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE103835C0>]}
[0m18:53:12.187005 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.report
[0m18:53:12.188006 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.report ...................... [RUN]
[0m18:53:12.188701 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.report'
[0m18:53:12.189792 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.report
[0m18:53:12.198890 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.report"
[0m18:53:12.200891 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.report
[0m18:53:12.227209 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.report"
[0m18:53:12.237243 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.report"
[0m18:53:12.237243 [debug] [Thread-1 (]: On model.CRB_PROJECT.report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.report
         as
        (WITH revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY
        payment_month
),
customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    LEFT JOIN 
        (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month
         FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
         GROUP BY customer_id) p
    ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
),
grr_nrr AS (
    SELECT
        payment_month,
        grr,
        nrr
    FROM
        PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
)
SELECT
    r.payment_month,
    r.total_revenue,
    pc.churned_customers_lm,
    nc.new_customers,
    nc.churned_customers,
    cs.cross_sell_opportunities,
    gn.grr,
    gn.nrr
FROM
    revenue r
LEFT JOIN
    product_churn_lm pc ON r.payment_month = pc.payment_month
LEFT JOIN
    new_and_churned_customers nc ON r.payment_month = nc.payment_month
LEFT JOIN
    (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities
     FROM cross_sell
     GROUP BY payment_month) cs ON r.payment_month = cs.payment_month
LEFT JOIN
    grr_nrr gn ON r.payment_month = gn.payment_month
ORDER BY
    r.payment_month
        );
[0m18:53:12.238275 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:13.137010 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c3-3201-7e56-000c-493e00024b0e
[0m18:53:13.137547 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 84 at position 12
invalid identifier 'PAYMENT_MONTH'
[0m18:53:13.142177 [debug] [Thread-1 (]: Database Error in model report (models\reporting\report.sql)
  000904 (42000): SQL compilation error: error line 84 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql
[0m18:53:13.145135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea14518c-277d-4790-b60a-e9353f4b76e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE123F47A0>]}
[0m18:53:13.146144 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_report.report ............. [[31mERROR[0m in 0.95s]
[0m18:53:13.147266 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.report
[0m18:53:13.148273 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.report' to be skipped because of status 'error'.  Reason: Database Error in model report (models\reporting\report.sql)
  000904 (42000): SQL compilation error: error line 84 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql.
[0m18:53:13.150984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:13.150984 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:53:13.151668 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:53:13.474031 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:53:13.474031 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:53:13.800336 [debug] [MainThread]: Connection 'model.CRB_PROJECT.report' was left open.
[0m18:53:13.802292 [debug] [MainThread]: On model.CRB_PROJECT.report: Close
[0m18:53:14.137358 [info ] [MainThread]: 
[0m18:53:14.139089 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m18:53:14.139477 [debug] [MainThread]: Command end result
[0m18:53:14.154822 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:53:14.154822 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:53:14.170921 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:53:14.170921 [info ] [MainThread]: 
[0m18:53:14.170921 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:53:14.170921 [info ] [MainThread]: 
[0m18:53:14.170921 [error] [MainThread]:   Database Error in model report (models\reporting\report.sql)
  000904 (42000): SQL compilation error: error line 84 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql
[0m18:53:14.170921 [info ] [MainThread]: 
[0m18:53:14.170921 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:53:14.170921 [debug] [MainThread]: Command `dbt run` failed at 18:53:14.170921 after 6.19 seconds
[0m18:53:14.170921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE12F078F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE14D8ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002FE12375C70>]}
[0m18:53:14.170921 [debug] [MainThread]: Flushing usage events
[0m18:53:15.094420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:14.983765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D3E02750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D56A1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D76AADE0>]}


============================== 18:56:14.983765 | 9d4b3d2b-9b82-4ff0-9577-9657523bc77e ==============================
[0m18:56:14.983765 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:56:14.983765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:56:15.924038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d4b3d2b-9b82-4ff0-9577-9657523bc77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D79E7560>]}
[0m18:56:15.971672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d4b3d2b-9b82-4ff0-9577-9657523bc77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D8416E40>]}
[0m18:56:15.971672 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:56:16.554568 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:56:16.712725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:56:16.712725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:56:16.712725 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:56:16.752125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d4b3d2b-9b82-4ff0-9577-9657523bc77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D98C2120>]}
[0m18:56:16.816857 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:56:16.834305 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:56:16.869987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d4b3d2b-9b82-4ff0-9577-9657523bc77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D9C24110>]}
[0m18:56:16.869987 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:56:16.869987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4b3d2b-9b82-4ff0-9577-9657523bc77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D9BFBB30>]}
[0m18:56:16.869987 [info ] [MainThread]: 
[0m18:56:16.869987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:56:16.869987 [info ] [MainThread]: 
[0m18:56:16.869987 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:56:16.869987 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:56:19.850152 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:56:19.852783 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:56:19.852783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:21.276141 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.433 seconds
[0m18:56:21.301604 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:56:21.307771 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:56:21.307771 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:56:21.307771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:22.249219 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.940 seconds
[0m18:56:22.249219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:56:22.265065 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:56:22.265065 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:56:22.471695 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.205 seconds
[0m18:56:22.471695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:56:22.477794 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:56:22.477794 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:56:22.667964 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.186 seconds
[0m18:56:22.670993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d4b3d2b-9b82-4ff0-9577-9657523bc77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D4E73560>]}
[0m18:56:22.678072 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:56:22.678072 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m18:56:22.678072 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m18:56:22.686961 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:56:22.686961 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:56:22.686961 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:56:22.724420 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:56:22.724420 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:56:22.724420 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
),
SELECT
    p.product_id,
    p.churned_customers_lm,
    COUNT(DISTINCT cs_lm.product_id_2) AS cross_sell_opportunities_lm,
FROM
    product_churn p
LEFT JOIN
    cross_sell_lm cs_lm
ON
    p.product_id = cs_lm.product_id_1
GROUP BY
    p.product_id, p.churned_customers
ORDER BY
    p.product_id
        );
[0m18:56:22.724420 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:56:23.825795 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c6-3201-7db6-000c-493e00025a06
[0m18:56:23.825795 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 37 at position 0 unexpected 'SELECT'.
syntax error line 39 at position 5 unexpected '.'.
syntax error line 40 at position 10 unexpected 'DISTINCT'.
syntax error line 40 at position 42 unexpected 'cross_sell_opportunities_lm'.
syntax error line 41 at position 0 unexpected 'FROM'.
syntax error line 51 at position 8 unexpected ')'.
[0m18:56:23.839607 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 0 unexpected 'SELECT'.
  syntax error line 39 at position 5 unexpected '.'.
  syntax error line 40 at position 10 unexpected 'DISTINCT'.
  syntax error line 40 at position 42 unexpected 'cross_sell_opportunities_lm'.
  syntax error line 41 at position 0 unexpected 'FROM'.
  syntax error line 51 at position 8 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m18:56:23.839607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4b3d2b-9b82-4ff0-9577-9657523bc77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D6ED4770>]}
[0m18:56:23.839607 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.16s]
[0m18:56:23.839607 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:56:23.839607 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 0 unexpected 'SELECT'.
  syntax error line 39 at position 5 unexpected '.'.
  syntax error line 40 at position 10 unexpected 'DISTINCT'.
  syntax error line 40 at position 42 unexpected 'cross_sell_opportunities_lm'.
  syntax error line 41 at position 0 unexpected 'FROM'.
  syntax error line 51 at position 8 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m18:56:23.849564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:23.849564 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:56:23.849564 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:56:24.166289 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m18:56:24.166289 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m18:56:24.496950 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m18:56:24.496950 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m18:56:24.821778 [info ] [MainThread]: 
[0m18:56:24.821778 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.95 seconds (7.95s).
[0m18:56:24.821778 [debug] [MainThread]: Command end result
[0m18:56:24.842777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:56:24.842777 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:56:24.842777 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:56:24.842777 [info ] [MainThread]: 
[0m18:56:24.842777 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:56:24.858763 [info ] [MainThread]: 
[0m18:56:24.859668 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 0 unexpected 'SELECT'.
  syntax error line 39 at position 5 unexpected '.'.
  syntax error line 40 at position 10 unexpected 'DISTINCT'.
  syntax error line 40 at position 42 unexpected 'cross_sell_opportunities_lm'.
  syntax error line 41 at position 0 unexpected 'FROM'.
  syntax error line 51 at position 8 unexpected ')'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m18:56:24.859668 [info ] [MainThread]: 
[0m18:56:24.859668 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:56:24.859668 [debug] [MainThread]: Command `dbt run` failed at 18:56:24.859668 after 10.05 seconds
[0m18:56:24.859668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D73F86B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D75694F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3D7569430>]}
[0m18:56:24.859668 [debug] [MainThread]: Flushing usage events
[0m18:56:25.802496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:05.656133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C67369A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C6736AB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C64E15AF0>]}


============================== 18:57:05.666379 | 6598eb56-1f0d-456a-8757-d6ea13d8a0c4 ==============================
[0m18:57:05.666379 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:57:05.666379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m report', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:06.137735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6598eb56-1f0d-456a-8757-d6ea13d8a0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C68529520>]}
[0m18:57:06.201414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6598eb56-1f0d-456a-8757-d6ea13d8a0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C67B29F70>]}
[0m18:57:06.201414 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:57:06.671645 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:57:06.831278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:06.831278 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:06.831278 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:57:06.868810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6598eb56-1f0d-456a-8757-d6ea13d8a0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C6872AF00>]}
[0m18:57:06.935050 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:57:06.935050 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:57:06.968042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6598eb56-1f0d-456a-8757-d6ea13d8a0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C69922030>]}
[0m18:57:06.968042 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:57:06.968042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6598eb56-1f0d-456a-8757-d6ea13d8a0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C6872BAD0>]}
[0m18:57:06.968042 [info ] [MainThread]: 
[0m18:57:06.968042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:06.968042 [info ] [MainThread]: 
[0m18:57:06.968042 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:57:06.968042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:57:07.084167 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:57:07.085170 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:57:07.085170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:08.386903 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.303 seconds
[0m18:57:08.400751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:57:08.407135 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:57:08.407135 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:57:08.407135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:09.355829 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.950 seconds
[0m18:57:09.355829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:57:09.371920 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:57:09.371920 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:57:09.562969 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.192 seconds
[0m18:57:09.562969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:57:09.580132 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:57:09.580132 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:57:09.821021 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.243 seconds
[0m18:57:09.821021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6598eb56-1f0d-456a-8757-d6ea13d8a0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C69DCBCB0>]}
[0m18:57:09.821021 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.report
[0m18:57:09.821021 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.report ...................... [RUN]
[0m18:57:09.821021 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.report'
[0m18:57:09.821021 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.report
[0m18:57:09.841833 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.report"
[0m18:57:09.842800 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.report
[0m18:57:09.872643 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.report"
[0m18:57:09.872643 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.report"
[0m18:57:09.872643 [debug] [Thread-1 (]: On model.CRB_PROJECT.report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.report
         as
        (WITH revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY
        payment_month
),
customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        payment_month,
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        payment_month, product_id
),
cross_sell AS (
    SELECT
        ct1.payment_month,
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    LEFT JOIN 
        (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month
         FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
         GROUP BY customer_id) p
    ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
),
grr_nrr AS (
    SELECT
        payment_month,
        grr,
        nrr
    FROM
        PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
)
SELECT
    r.payment_month,
    r.total_revenue,
    pc.churned_customers_lm,
    nc.new_customers,
    nc.churned_customers,
    cs.cross_sell_opportunities,
    gn.grr,
    gn.nrr
FROM
    revenue r
LEFT JOIN
    (SELECT payment_month, SUM(churned_customers_lm) AS churned_customers_lm
     FROM product_churn_lm
     GROUP BY payment_month) pc ON r.payment_month = pc.payment_month
LEFT JOIN
    new_and_churned_customers nc ON r.payment_month = nc.payment_month
LEFT JOIN
    (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities
     FROM cross_sell
     GROUP BY payment_month) cs ON r.payment_month = cs.payment_month
LEFT JOIN
    grr_nrr gn ON r.payment_month = gn.payment_month
ORDER BY
    r.payment_month;
[0m18:57:09.872643 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:57:10.780969 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c7-3201-7e57-000c-493e00026b4e
[0m18:57:10.780969 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 94 at position 19 unexpected ';'.
[0m18:57:10.780969 [debug] [Thread-1 (]: Database Error in model report (models\reporting\report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 94 at position 19 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql
[0m18:57:10.796702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6598eb56-1f0d-456a-8757-d6ea13d8a0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C66D145C0>]}
[0m18:57:10.796702 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_report.report ............. [[31mERROR[0m in 0.96s]
[0m18:57:10.796702 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.report
[0m18:57:10.796702 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.report' to be skipped because of status 'error'.  Reason: Database Error in model report (models\reporting\report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 94 at position 19 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql.
[0m18:57:10.796702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:10.796702 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:57:10.796702 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:57:11.125648 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m18:57:11.125648 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m18:57:11.426453 [debug] [MainThread]: Connection 'model.CRB_PROJECT.report' was left open.
[0m18:57:11.442179 [debug] [MainThread]: On model.CRB_PROJECT.report: Close
[0m18:57:11.753561 [info ] [MainThread]: 
[0m18:57:11.753561 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.79 seconds (4.79s).
[0m18:57:11.753561 [debug] [MainThread]: Command end result
[0m18:57:11.775496 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:57:11.790903 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:57:11.795911 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:57:11.795911 [info ] [MainThread]: 
[0m18:57:11.795911 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:57:11.795911 [info ] [MainThread]: 
[0m18:57:11.795911 [error] [MainThread]:   Database Error in model report (models\reporting\report.sql)
  001003 (42000): SQL compilation error:
  syntax error line 94 at position 19 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql
[0m18:57:11.795911 [info ] [MainThread]: 
[0m18:57:11.795911 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:57:11.795911 [debug] [MainThread]: Command `dbt run` failed at 18:57:11.795911 after 6.30 seconds
[0m18:57:11.795911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C66C3AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C6739F500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C6739D2E0>]}
[0m18:57:11.795911 [debug] [MainThread]: Flushing usage events
[0m18:57:13.019843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:20.404237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027870C30560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002786E2617C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027870C32450>]}


============================== 18:57:20.404237 | aba71578-31fd-480e-9bbd-dc0a90c46255 ==============================
[0m18:57:20.404237 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:57:20.404237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m report', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:20.874576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aba71578-31fd-480e-9bbd-dc0a90c46255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002786E9D2360>]}
[0m18:57:20.938286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aba71578-31fd-480e-9bbd-dc0a90c46255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027870581460>]}
[0m18:57:20.938286 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:57:21.408456 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:57:21.567405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:21.567405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:21.567405 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:57:21.600744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aba71578-31fd-480e-9bbd-dc0a90c46255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027872A72C30>]}
[0m18:57:21.665468 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:57:21.673631 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:57:21.696841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aba71578-31fd-480e-9bbd-dc0a90c46255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027872CE2870>]}
[0m18:57:21.696841 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:57:21.696841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba71578-31fd-480e-9bbd-dc0a90c46255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278707D8950>]}
[0m18:57:21.696841 [info ] [MainThread]: 
[0m18:57:21.696841 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:21.696841 [info ] [MainThread]: 
[0m18:57:21.696841 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:57:21.696841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:57:21.814896 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:57:21.816166 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:57:21.816166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:23.144763 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.329 seconds
[0m18:57:23.165887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m18:57:23.182477 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:57:23.183476 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:57:23.183839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:24.123428 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.948 seconds
[0m18:57:24.123428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m18:57:24.139592 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:57:24.139592 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:57:24.362462 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.215 seconds
[0m18:57:24.362462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:57:24.362462 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:57:24.362462 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:57:24.570738 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.200 seconds
[0m18:57:24.576166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba71578-31fd-480e-9bbd-dc0a90c46255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027872A9EE10>]}
[0m18:57:24.583339 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.report
[0m18:57:24.584375 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.report ...................... [RUN]
[0m18:57:24.586177 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.report'
[0m18:57:24.587224 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.report
[0m18:57:24.601830 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.report"
[0m18:57:24.603442 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.report
[0m18:57:24.637222 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.report"
[0m18:57:24.640262 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.report"
[0m18:57:24.641261 [debug] [Thread-1 (]: On model.CRB_PROJECT.report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.report
         as
        (WITH revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY
        payment_month
),
customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        payment_month,
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        payment_month, product_id
),
cross_sell AS (
    SELECT
        ct1.payment_month,
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    LEFT JOIN 
        (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month
         FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
         GROUP BY customer_id) p
    ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
),
grr_nrr AS (
    SELECT
        payment_month,
        grr,
        nrr
    FROM
        PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
)
SELECT
    r.payment_month,
    r.total_revenue,
    pc.churned_customers_lm,
    nc.new_customers,
    nc.churned_customers,
    cs.cross_sell_opportunities,
    gn.grr,
    gn.nrr
FROM
    revenue r
LEFT JOIN
    (SELECT payment_month, SUM(churned_customers_lm) AS churned_customers_lm
     FROM product_churn_lm
     GROUP BY payment_month) pc ON r.payment_month = pc.payment_month
LEFT JOIN
    new_and_churned_customers nc ON r.payment_month = nc.payment_month
LEFT JOIN
    (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities
     FROM cross_sell
     GROUP BY payment_month) cs ON r.payment_month = cs.payment_month
LEFT JOIN
    grr_nrr gn ON r.payment_month = gn.payment_month
ORDER BY
    r.payment_month
        );
[0m18:57:24.641261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:57:26.434664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.807 seconds
[0m18:57:26.471260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aba71578-31fd-480e-9bbd-dc0a90c46255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002786DFD1790>]}
[0m18:57:26.471260 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_report.report ................. [[32mSUCCESS 1[0m in 1.88s]
[0m18:57:26.471260 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.report
[0m18:57:26.471260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:26.471260 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:57:26.471260 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:57:26.792354 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m18:57:26.792354 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m18:57:27.135270 [debug] [MainThread]: Connection 'model.CRB_PROJECT.report' was left open.
[0m18:57:27.135270 [debug] [MainThread]: On model.CRB_PROJECT.report: Close
[0m18:57:27.461603 [info ] [MainThread]: 
[0m18:57:27.462565 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.76 seconds (5.76s).
[0m18:57:27.463567 [debug] [MainThread]: Command end result
[0m18:57:27.490097 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:57:27.493100 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:57:27.500103 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:57:27.500103 [info ] [MainThread]: 
[0m18:57:27.501105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:27.501105 [info ] [MainThread]: 
[0m18:57:27.502103 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:57:27.502103 [debug] [MainThread]: Command `dbt run` succeeded at 18:57:27.502103 after 7.25 seconds
[0m18:57:27.502103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027870AFAED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278702CCC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278708D2F30>]}
[0m18:57:27.502103 [debug] [MainThread]: Flushing usage events
[0m18:57:28.432271 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:59:31.564073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587B1F5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587B1F4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587B1F4E60>]}


============================== 18:59:31.564073 | d9a8c0db-7978-442a-a7e8-25fe953a33d0 ==============================
[0m18:59:31.564073 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:59:31.564073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'send_anonymous_usage_stats': 'True'}
[0m18:59:32.050114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9a8c0db-7978-442a-a7e8-25fe953a33d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587A6C7B90>]}
[0m18:59:32.113376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9a8c0db-7978-442a-a7e8-25fe953a33d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587A671C10>]}
[0m18:59:32.113376 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:59:32.583558 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:59:32.726585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:59:32.726585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:59:32.742677 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m18:59:32.764260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9a8c0db-7978-442a-a7e8-25fe953a33d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587D02E9C0>]}
[0m18:59:32.830874 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:59:32.846535 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:59:32.879933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9a8c0db-7978-442a-a7e8-25fe953a33d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587D3803B0>]}
[0m18:59:32.879933 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m18:59:32.879933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9a8c0db-7978-442a-a7e8-25fe953a33d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587CF7EBD0>]}
[0m18:59:32.879933 [info ] [MainThread]: 
[0m18:59:32.879933 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:59:32.879933 [info ] [MainThread]: 
[0m18:59:32.879933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:59:32.879933 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m18:59:32.980466 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m18:59:32.980466 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m18:59:32.980466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:34.329472 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.346 seconds
[0m18:59:34.345572 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m18:59:34.356372 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m18:59:34.358377 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m18:59:34.358377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:35.320825 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.963 seconds
[0m18:59:35.320825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m18:59:35.320825 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m18:59:35.320825 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m18:59:35.508657 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.186 seconds
[0m18:59:35.508657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m18:59:35.517586 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m18:59:35.517586 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m18:59:35.690631 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.184 seconds
[0m18:59:35.690631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9a8c0db-7978-442a-a7e8-25fe953a33d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587D23B710>]}
[0m18:59:35.710339 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:59:35.710339 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m18:59:35.710339 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m18:59:35.712346 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:59:35.720371 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:59:35.722120 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:59:35.754088 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:59:35.757087 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m18:59:35.757087 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers_lm
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
--         AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
-- ),
-- SELECT
--     p.product_id,
--     p.churned_customers_lm,
--     COUNT(DISTINCT cs_lm.product_id_2) AS cross_sell_opportunities_lm,
-- FROM
--     product_churn p
-- LEFT JOIN
--     cross_sell_lm cs_lm
-- ON
--     p.product_id = cs_lm.product_id_1
-- GROUP BY
--     p.product_id, p.churned_customers
-- ORDER BY
--     p.product_id


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
)
SELECT
    p.product_id,
    p.churned_customers_lm,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm
FROM
    product_churn p
LEFT JOIN
    cross_sell cs
ON
    p.product_id = cs.product_id_1
GROUP BY
    p.product_id, p.churned_customers_lm
ORDER BY
    p.product_id;
[0m18:59:35.758088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:59:36.731145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c9-3201-7e57-000c-493e00026baa
[0m18:59:36.731145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 100 at position 16 unexpected ';'.
[0m18:59:36.735161 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 100 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m18:59:36.737167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9a8c0db-7978-442a-a7e8-25fe953a33d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587CFE3C50>]}
[0m18:59:36.737167 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.02s]
[0m18:59:36.737167 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m18:59:36.737167 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 100 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m18:59:36.741862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:36.741862 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m18:59:36.741862 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m18:59:37.056770 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m18:59:37.056770 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m18:59:37.404535 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m18:59:37.404535 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m18:59:37.734047 [info ] [MainThread]: 
[0m18:59:37.734047 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m18:59:37.746751 [debug] [MainThread]: Command end result
[0m18:59:37.787128 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m18:59:37.789136 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m18:59:37.789136 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m18:59:37.789136 [info ] [MainThread]: 
[0m18:59:37.789136 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:59:37.789136 [info ] [MainThread]: 
[0m18:59:37.789136 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 100 at position 16 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m18:59:37.789136 [info ] [MainThread]: 
[0m18:59:37.800066 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:59:37.801179 [debug] [MainThread]: Command `dbt run` failed at 18:59:37.800066 after 6.39 seconds
[0m18:59:37.801910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587B023770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587BBF2E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587BF6CBC0>]}
[0m18:59:37.801910 [debug] [MainThread]: Flushing usage events
[0m18:59:38.739649 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:36.815285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6A3BC2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6A3BCA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6A3BD130>]}


============================== 19:00:36.821172 | d70609a2-0d33-4574-97b8-2e72118e08b3 ==============================
[0m19:00:36.821172 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:00:36.821172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:37.305111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd70609a2-0d33-4574-97b8-2e72118e08b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6AE10C80>]}
[0m19:00:37.365042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd70609a2-0d33-4574-97b8-2e72118e08b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6AF80470>]}
[0m19:00:37.366467 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:00:37.848024 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:00:38.016522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:00:38.016522 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:00:38.016522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:00:38.055423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd70609a2-0d33-4574-97b8-2e72118e08b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6C183F80>]}
[0m19:00:38.133833 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:00:38.133833 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:00:38.162737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd70609a2-0d33-4574-97b8-2e72118e08b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6C560290>]}
[0m19:00:38.162737 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:00:38.162737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd70609a2-0d33-4574-97b8-2e72118e08b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6C183830>]}
[0m19:00:38.162737 [info ] [MainThread]: 
[0m19:00:38.162737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:38.162737 [info ] [MainThread]: 
[0m19:00:38.162737 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:00:38.162737 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:00:38.281892 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:00:38.281892 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:00:38.281892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:39.686305 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.401 seconds
[0m19:00:39.693820 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m19:00:39.700241 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:00:39.700241 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:00:39.700241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:40.649364 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.949 seconds
[0m19:00:40.649364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:00:40.649364 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:00:40.649364 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:00:40.849224 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.189 seconds
[0m19:00:40.849828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:00:40.854514 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:00:40.854514 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:00:41.049200 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.199 seconds
[0m19:00:41.049200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd70609a2-0d33-4574-97b8-2e72118e08b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6C8D7620>]}
[0m19:00:41.049200 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:00:41.049200 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:00:41.049200 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:00:41.064099 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:00:41.066704 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:00:41.066704 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:00:41.103469 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:00:41.107816 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:00:41.107816 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers_lm
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
--         AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
-- ),
-- SELECT
--     p.product_id,
--     p.churned_customers_lm,
--     COUNT(DISTINCT cs_lm.product_id_2) AS cross_sell_opportunities_lm,
-- FROM
--     product_churn p
-- LEFT JOIN
--     cross_sell_lm cs_lm
-- ON
--     p.product_id = cs_lm.product_id_1
-- GROUP BY
--     p.product_id, p.churned_customers
-- ORDER BY
--     p.product_id


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
        AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
)
SELECT
    p.product_id,
    p.churned_customers_lm,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm
FROM
    product_churn p
LEFT JOIN
    cross_sell cs
ON
    p.product_id = cs.product_id_1
GROUP BY
    p.product_id, p.churned_customers_lm
ORDER BY
    p.product_id
        );
[0m19:00:41.107816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:00:42.483130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.378 seconds
[0m19:00:42.498744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd70609a2-0d33-4574-97b8-2e72118e08b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B677617C0>]}
[0m19:00:42.498744 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 1.45s]
[0m19:00:42.498744 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:00:42.514393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:42.514393 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:00:42.514393 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:00:42.831925 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m19:00:42.831925 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m19:00:43.170814 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:00:43.170814 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:00:43.502666 [info ] [MainThread]: 
[0m19:00:43.502666 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m19:00:43.502666 [debug] [MainThread]: Command end result
[0m19:00:43.523019 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:00:43.523019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:00:43.538562 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:00:43.539455 [info ] [MainThread]: 
[0m19:00:43.539455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:43.540585 [info ] [MainThread]: 
[0m19:00:43.540585 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:00:43.541625 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:43.541625 after 6.89 seconds
[0m19:00:43.542624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B69EFF560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6923FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6A510920>]}
[0m19:00:43.542624 [debug] [MainThread]: Flushing usage events
[0m19:00:44.441373 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:00.923438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BCFCFC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BAAE1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BCFCCE30>]}


============================== 19:02:00.923438 | 36e76456-2526-48bd-943c-88160192d863 ==============================
[0m19:02:00.923438 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:02:00.923438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'send_anonymous_usage_stats': 'True'}
[0m19:02:01.409348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36e76456-2526-48bd-943c-88160192d863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BA3BEC60>]}
[0m19:02:01.472667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36e76456-2526-48bd-943c-88160192d863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BDCD43B0>]}
[0m19:02:01.472667 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:02:01.960890 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:02:02.118327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:02.118327 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:02.134473 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:02:02.163428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36e76456-2526-48bd-943c-88160192d863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BED895B0>]}
[0m19:02:02.234028 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:02:02.234028 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:02:02.261357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36e76456-2526-48bd-943c-88160192d863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BF190260>]}
[0m19:02:02.261357 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:02:02.261357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e76456-2526-48bd-943c-88160192d863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BEDF3830>]}
[0m19:02:02.261357 [info ] [MainThread]: 
[0m19:02:02.261357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:02:02.261357 [info ] [MainThread]: 
[0m19:02:02.261357 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:02:02.275531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:02:02.380783 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:02:02.380783 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:02:02.380783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:03.719305 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.352 seconds
[0m19:02:03.735012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m19:02:03.735012 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:02:03.735012 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:02:03.735012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:04.722523 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.975 seconds
[0m19:02:04.726640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:02:04.728646 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:02:04.728646 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:02:04.929449 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.199 seconds
[0m19:02:04.929449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:02:04.931453 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:02:04.933457 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:02:05.114647 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.182 seconds
[0m19:02:05.114647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e76456-2526-48bd-943c-88160192d863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BA453830>]}
[0m19:02:05.114647 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:02:05.114647 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:02:05.114647 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:02:05.130375 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:02:05.130375 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:02:05.130375 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:02:05.165021 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:02:05.165021 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:02:05.165021 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers_lm
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
--         AND ct1.payment_month >= CURRENT_DATE - INTERVAL '30 Days'
-- ),
-- SELECT
--     p.product_id,
--     p.churned_customers_lm,
--     COUNT(DISTINCT cs_lm.product_id_2) AS cross_sell_opportunities_lm,
-- FROM
--     product_churn p
-- LEFT JOIN
--     cross_sell_lm cs_lm
-- ON
--     p.product_id = cs_lm.product_id_1
-- GROUP BY
--     p.product_id, p.churned_customers
-- ORDER BY
--     p.product_id


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    p.product_id,
    p.churned_customers_lm,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm
FROM
    product_churn p
LEFT JOIN
    cross_sell cs
ON
    p.product_id = cs.product_id_1
GROUP BY
    p.product_id, p.churned_customers_lm
ORDER BY
    p.product_id
        );
[0m19:02:05.165021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:02:06.746193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.575 seconds
[0m19:02:06.766206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e76456-2526-48bd-943c-88160192d863', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BA3BDCA0>]}
[0m19:02:06.766206 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 1.65s]
[0m19:02:06.766206 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:02:06.778031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:06.778031 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:02:06.778031 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:02:07.106505 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m19:02:07.106505 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m19:02:07.428264 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:02:07.428264 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:02:07.756517 [info ] [MainThread]: 
[0m19:02:07.757059 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m19:02:07.759105 [debug] [MainThread]: Command end result
[0m19:02:07.773308 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:02:07.785612 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:02:07.792268 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:02:07.792268 [info ] [MainThread]: 
[0m19:02:07.793270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:02:07.793270 [info ] [MainThread]: 
[0m19:02:07.794307 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:02:07.794307 [debug] [MainThread]: Command `dbt run` succeeded at 19:02:07.794307 after 7.03 seconds
[0m19:02:07.794307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BCB35C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BAD7E4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226BAD7E720>]}
[0m19:02:07.794307 [debug] [MainThread]: Flushing usage events
[0m19:02:09.002972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:39.145005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D79502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D6939CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D76997F0>]}


============================== 19:05:39.154586 | 7be32700-02da-46b5-8c45-80483c3363e6 ==============================
[0m19:05:39.154586 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:05:39.154586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'send_anonymous_usage_stats': 'True'}
[0m19:05:39.633412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7be32700-02da-46b5-8c45-80483c3363e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D8674350>]}
[0m19:05:39.693285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7be32700-02da-46b5-8c45-80483c3363e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D771D370>]}
[0m19:05:39.693285 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:05:40.178354 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:05:40.336452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:40.336452 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:40.336452 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:05:40.363782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7be32700-02da-46b5-8c45-80483c3363e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D977C2F0>]}
[0m19:05:40.443348 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:05:40.447098 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:05:40.476645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7be32700-02da-46b5-8c45-80483c3363e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D998A060>]}
[0m19:05:40.476645 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:05:40.476645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7be32700-02da-46b5-8c45-80483c3363e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D9AD07A0>]}
[0m19:05:40.476645 [info ] [MainThread]: 
[0m19:05:40.476645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:40.476645 [info ] [MainThread]: 
[0m19:05:40.476645 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:40.476645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:05:40.585172 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:05:40.585172 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:05:40.586172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:42.026636 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.441 seconds
[0m19:05:42.032657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m19:05:42.042002 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:05:42.042002 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:05:42.042002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:43.013014 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.970 seconds
[0m19:05:43.015020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:05:43.016526 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:05:43.016526 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:05:43.210388 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.197 seconds
[0m19:05:43.216590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:05:43.222632 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:05:43.224644 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:05:43.416860 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.197 seconds
[0m19:05:43.416860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7be32700-02da-46b5-8c45-80483c3363e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D4D974D0>]}
[0m19:05:43.427829 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:05:43.427829 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:05:43.427829 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:05:43.427829 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:05:43.427829 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:05:43.427829 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:05:43.465965 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:05:43.465965 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:05:43.465965 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers_lm
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- )
-- SELECT
--     p.product_id,
--     p.churned_customers,
--     COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm
-- FROM
--     product_churn p
-- LEFT JOIN
--     cross_sell cs
-- ON
--     p.product_id = cs.product_id_1
-- GROUP BY
--     p.product_id, p.churned_customers
-- ORDER BY
--     p.product_id


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        customer_id,
        product_id,
        COUNT(DISTINCT customer_id) OVER (PARTITION BY product_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    cs.customer_id,
    cs.product_id_1,
    cs.product_id_2,
    pc.churned_customers_lm,
    COUNT(DISTINCT cs.product_id_2) OVER (PARTITION BY cs.customer_id) AS cross_sell_opportunities_lm
FROM
    cross_sell cs
LEFT JOIN
    product_churn pc
ON
    cs.product_id_1 = pc.product_id
GROUP BY
    cs.customer_id, cs.product_id_1, cs.product_id_2, pc.churned_customers_lm
ORDER BY
    cross_sell_opportunities_lm DESC, churned_customers_lm DESC;
[0m19:05:43.465965 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:05:44.406461 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00cf-3201-7e57-000c-493e00026bca
[0m19:05:44.406461 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 99 at position 63 unexpected ';'.
[0m19:05:44.409505 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 99 at position 63 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:05:44.412490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7be32700-02da-46b5-8c45-80483c3363e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D6E044D0>]}
[0m19:05:44.412490 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 0.98s]
[0m19:05:44.413463 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:05:44.414490 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 99 at position 63 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m19:05:44.416103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:44.416103 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:05:44.416103 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:05:44.738304 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m19:05:44.738304 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m19:05:45.063416 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:05:45.063416 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:05:45.395654 [info ] [MainThread]: 
[0m19:05:45.397842 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m19:05:45.397842 [debug] [MainThread]: Command end result
[0m19:05:45.424018 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:05:45.427255 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:05:45.433270 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:05:45.434810 [info ] [MainThread]: 
[0m19:05:45.436427 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:05:45.436427 [info ] [MainThread]: 
[0m19:05:45.437439 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 99 at position 63 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:05:45.438432 [info ] [MainThread]: 
[0m19:05:45.439429 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:05:45.439992 [debug] [MainThread]: Command `dbt run` failed at 19:05:45.439992 after 6.46 seconds
[0m19:05:45.439992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D6FB3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D748F2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5D748F620>]}
[0m19:05:45.439992 [debug] [MainThread]: Flushing usage events
[0m19:05:46.302123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:54.500604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9D915D340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9D915FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9D915C950>]}


============================== 19:05:54.510813 | e7235ec1-3609-4e1e-9bb1-1d4c805a16cc ==============================
[0m19:05:54.510813 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:05:54.510813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:05:54.993163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7235ec1-3609-4e1e-9bb1-1d4c805a16cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9D915FB90>]}
[0m19:05:55.053826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7235ec1-3609-4e1e-9bb1-1d4c805a16cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9D9E07110>]}
[0m19:05:55.055832 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:05:55.547954 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:05:55.707734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:55.707734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:55.713751 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:05:55.742788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7235ec1-3609-4e1e-9bb1-1d4c805a16cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DAF6EDE0>]}
[0m19:05:55.811196 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:05:55.815983 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:05:55.846389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7235ec1-3609-4e1e-9bb1-1d4c805a16cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DB2BFE30>]}
[0m19:05:55.847395 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:05:55.847395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7235ec1-3609-4e1e-9bb1-1d4c805a16cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DB0E4860>]}
[0m19:05:55.849401 [info ] [MainThread]: 
[0m19:05:55.849401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:55.849401 [info ] [MainThread]: 
[0m19:05:55.851407 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:55.851407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:05:55.947667 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:05:55.947667 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:05:55.947667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:57.371873 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.422 seconds
[0m19:05:57.371873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m19:05:57.387642 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:05:57.387642 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:05:57.387642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:58.278490 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.891 seconds
[0m19:05:58.287589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:05:58.289595 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:05:58.289595 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:05:58.495483 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.209 seconds
[0m19:05:58.501554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:05:58.503560 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:05:58.503560 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:05:58.702114 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.198 seconds
[0m19:05:58.702114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7235ec1-3609-4e1e-9bb1-1d4c805a16cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DAF2F0B0>]}
[0m19:05:58.702114 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:05:58.702114 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:05:58.702114 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:05:58.702114 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:05:58.720875 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:05:58.722514 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:05:58.754326 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:05:58.756325 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:05:58.757326 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers_lm
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- )
-- SELECT
--     p.product_id,
--     p.churned_customers,
--     COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm
-- FROM
--     product_churn p
-- LEFT JOIN
--     cross_sell cs
-- ON
--     p.product_id = cs.product_id_1
-- GROUP BY
--     p.product_id, p.churned_customers
-- ORDER BY
--     p.product_id


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        customer_id,
        product_id,
        COUNT(DISTINCT customer_id) OVER (PARTITION BY product_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    cs.customer_id,
    cs.product_id_1,
    cs.product_id_2,
    pc.churned_customers_lm,
    COUNT(DISTINCT cs.product_id_2) OVER (PARTITION BY cs.customer_id) AS cross_sell_opportunities_lm
FROM
    cross_sell cs
LEFT JOIN
    product_churn pc
ON
    cs.product_id_1 = pc.product_id
GROUP BY
    cs.customer_id, cs.product_id_1, cs.product_id_2, pc.churned_customers_lm
ORDER BY
    cross_sell_opportunities_lm DESC, churned_customers_lm DESC
        );
[0m19:05:58.758325 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:06:00.192678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.440 seconds
[0m19:06:00.240207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7235ec1-3609-4e1e-9bb1-1d4c805a16cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9D65018B0>]}
[0m19:06:00.240207 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 1.54s]
[0m19:06:00.240207 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:06:00.251391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:00.251391 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:06:00.251391 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:06:00.569670 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m19:06:00.569670 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m19:06:00.885627 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:06:00.889171 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:06:01.219084 [info ] [MainThread]: 
[0m19:06:01.219084 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m19:06:01.219084 [debug] [MainThread]: Command end result
[0m19:06:01.239893 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:06:01.239893 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:06:01.250211 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:06:01.253124 [info ] [MainThread]: 
[0m19:06:01.253124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:01.253124 [info ] [MainThread]: 
[0m19:06:01.253124 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:06:01.253124 [debug] [MainThread]: Command `dbt run` succeeded at 19:06:01.253124 after 6.91 seconds
[0m19:06:01.253124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9D85B1AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9D8B4C860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9D8946A80>]}
[0m19:06:01.253124 [debug] [MainThread]: Flushing usage events
[0m19:06:02.499215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:48.862844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288D52DA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288D52FAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288D52C980>]}


============================== 19:09:48.862844 | 64a9891c-b346-41f0-af30-35dc03e96900 ==============================
[0m19:09:48.862844 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:09:48.862844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:09:49.362212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64a9891c-b346-41f0-af30-35dc03e96900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288E2EF950>]}
[0m19:09:49.431886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64a9891c-b346-41f0-af30-35dc03e96900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288D780C80>]}
[0m19:09:49.431886 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:09:49.913716 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:09:50.073091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:50.073091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:50.073091 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:09:50.110807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64a9891c-b346-41f0-af30-35dc03e96900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288F3E1970>]}
[0m19:09:50.185489 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:09:50.185489 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:09:50.219657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64a9891c-b346-41f0-af30-35dc03e96900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288F784320>]}
[0m19:09:50.219657 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:09:50.219657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64a9891c-b346-41f0-af30-35dc03e96900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288F37B260>]}
[0m19:09:50.223833 [info ] [MainThread]: 
[0m19:09:50.223833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:50.223833 [info ] [MainThread]: 
[0m19:09:50.223833 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:09:50.223833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:09:50.337462 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:09:50.337462 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:09:50.337462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:51.638591 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.301 seconds
[0m19:09:51.664669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m19:09:51.685433 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:09:51.686433 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:09:51.686433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:52.647143 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.975 seconds
[0m19:09:52.664052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:09:52.664052 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:09:52.664052 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:09:52.867208 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.204 seconds
[0m19:09:52.878171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:09:52.881118 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:09:52.881118 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:09:53.108857 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.225 seconds
[0m19:09:53.116259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64a9891c-b346-41f0-af30-35dc03e96900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288F5A6F60>]}
[0m19:09:53.116259 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:09:53.116259 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:09:53.131361 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:09:53.131361 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:09:53.148782 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:09:53.150780 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:09:53.183392 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:09:53.183392 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:09:53.183392 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         customer_id,
--         product_id,
--         COUNT(DISTINCT customer_id) OVER (PARTITION BY product_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- )
-- SELECT
--     cs.customer_id,
--     cs.product_id_1,
--     cs.product_id_2,
--     pc.churned_customers_lm,
--     COUNT(DISTINCT cs.product_id_2) OVER (PARTITION BY cs.customer_id) AS cross_sell_opportunities_lm
-- FROM
--     cross_sell cs
-- LEFT JOIN
--     product_churn pc
-- ON
--     cs.product_id_1 = pc.product_id
-- GROUP BY
--     cs.customer_id, cs.product_id_1, cs.product_id_2, pc.churned_customers_lm
-- ORDER BY
--     cross_sell_opportunities_lm DESC, churned_customers_lm DESC


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    cs.customer_id,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm,
    pc.churned_customers_lm
FROM
    cross_sell cs
LEFT JOIN
    product_churn pc
ON
    cs.product_id_1 = pc.product_id
GROUP BY
    cs.customer_id, pc.churned_customers_lm
ORDER BY
    cross_sell_opportunities_lm DESC, pc.churned_customers_lm DESC;
[0m19:09:53.183392 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:09:54.131818 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00d3-3201-7e57-000c-493e00026bee
[0m19:09:54.131818 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 99 at position 66 unexpected ';'.
[0m19:09:54.131818 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 99 at position 66 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:09:54.131818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64a9891c-b346-41f0-af30-35dc03e96900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288C9D4830>]}
[0m19:09:54.131818 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.00s]
[0m19:09:54.142347 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:09:54.142347 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 99 at position 66 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m19:09:54.142347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:54.142347 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:09:54.142347 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:09:54.448682 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m19:09:54.448682 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m19:09:54.781183 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:09:54.781183 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:09:55.099583 [info ] [MainThread]: 
[0m19:09:55.099583 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m19:09:55.099583 [debug] [MainThread]: Command end result
[0m19:09:55.121617 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:09:55.121617 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:09:55.136364 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:09:55.137327 [info ] [MainThread]: 
[0m19:09:55.137327 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:09:55.138331 [info ] [MainThread]: 
[0m19:09:55.139234 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 99 at position 66 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:09:55.139799 [info ] [MainThread]: 
[0m19:09:55.141880 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:09:55.144079 [debug] [MainThread]: Command `dbt run` failed at 19:09:55.144079 after 6.44 seconds
[0m19:09:55.144883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288CDAB800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288B2CE660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001288B2CE540>]}
[0m19:09:55.144883 [debug] [MainThread]: Flushing usage events
[0m19:09:56.367631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:00.901029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551ACA93A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025518EB9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551B016180>]}


============================== 19:10:00.901029 | fd8ac1d2-3ad6-401c-b34f-f30cf0a2a8f7 ==============================
[0m19:10:00.901029 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:10:00.901029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:10:01.402014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd8ac1d2-3ad6-401c-b34f-f30cf0a2a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551B12A360>]}
[0m19:10:01.464063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd8ac1d2-3ad6-401c-b34f-f30cf0a2a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551C7C86E0>]}
[0m19:10:01.464063 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:10:01.944953 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:10:02.123047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:10:02.123047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:10:02.139625 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:10:02.161660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd8ac1d2-3ad6-401c-b34f-f30cf0a2a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551D9FFB90>]}
[0m19:10:02.255595 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:10:02.256099 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:10:02.287714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd8ac1d2-3ad6-401c-b34f-f30cf0a2a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551D9DC980>]}
[0m19:10:02.290097 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:10:02.290097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd8ac1d2-3ad6-401c-b34f-f30cf0a2a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551D9B3260>]}
[0m19:10:02.290097 [info ] [MainThread]: 
[0m19:10:02.290097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:10:02.290097 [info ] [MainThread]: 
[0m19:10:02.290097 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:10:02.290097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:10:02.401750 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:10:02.402750 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:10:02.402750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:03.439604 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.037 seconds
[0m19:10:03.444873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m19:10:03.455629 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:10:03.455629 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:10:03.455629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:10:04.374973 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.928 seconds
[0m19:10:04.374973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:10:04.374973 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:10:04.374973 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:10:04.580386 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.192 seconds
[0m19:10:04.582418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:10:04.584420 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:10:04.584420 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:10:04.766395 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.193 seconds
[0m19:10:04.766395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd8ac1d2-3ad6-401c-b34f-f30cf0a2a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551C8C2B10>]}
[0m19:10:04.782203 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:10:04.782203 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:10:04.782203 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:10:04.782203 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:10:04.782203 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:10:04.782203 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:10:04.826077 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:10:04.826077 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:10:04.826077 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         customer_id,
--         product_id,
--         COUNT(DISTINCT customer_id) OVER (PARTITION BY product_id) AS churned_customers
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- )
-- SELECT
--     cs.customer_id,
--     cs.product_id_1,
--     cs.product_id_2,
--     pc.churned_customers_lm,
--     COUNT(DISTINCT cs.product_id_2) OVER (PARTITION BY cs.customer_id) AS cross_sell_opportunities_lm
-- FROM
--     cross_sell cs
-- LEFT JOIN
--     product_churn pc
-- ON
--     cs.product_id_1 = pc.product_id
-- GROUP BY
--     cs.customer_id, cs.product_id_1, cs.product_id_2, pc.churned_customers_lm
-- ORDER BY
--     cross_sell_opportunities_lm DESC, churned_customers_lm DESC


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    cs.customer_id,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm,
    pc.churned_customers_lm
FROM
    cross_sell cs
LEFT JOIN
    product_churn pc
ON
    cs.product_id_1 = pc.product_id
GROUP BY
    cs.customer_id, pc.churned_customers_lm
ORDER BY
    cross_sell_opportunities_lm DESC, pc.churned_customers_lm DESC
        );
[0m19:10:04.826077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:10:06.175404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.358 seconds
[0m19:10:06.216931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8ac1d2-3ad6-401c-b34f-f30cf0a2a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025518FE19D0>]}
[0m19:10:06.216931 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 1.43s]
[0m19:10:06.217933 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:10:06.219933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:06.219933 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:10:06.219933 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:10:06.540150 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m19:10:06.540150 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m19:10:06.845961 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:10:06.857909 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:10:07.178664 [info ] [MainThread]: 
[0m19:10:07.179645 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m19:10:07.180645 [debug] [MainThread]: Command end result
[0m19:10:07.201301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:10:07.201301 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:10:07.214992 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:10:07.214992 [info ] [MainThread]: 
[0m19:10:07.215995 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:10:07.216994 [info ] [MainThread]: 
[0m19:10:07.216994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:10:07.217992 [debug] [MainThread]: Command `dbt run` succeeded at 19:10:07.217992 after 6.48 seconds
[0m19:10:07.218990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551ACA93A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551BE95370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002551B072A20>]}
[0m19:10:07.218990 [debug] [MainThread]: Flushing usage events
[0m19:10:08.129280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:12:13.940911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50D141DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50999C5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50D142930>]}


============================== 19:12:13.944921 | 083536a8-c9f2-4afc-8db0-0c01a33d8a0a ==============================
[0m19:12:13.944921 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:12:13.944921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m19:12:14.905034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '083536a8-c9f2-4afc-8db0-0c01a33d8a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50A4E26C0>]}
[0m19:12:14.968779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '083536a8-c9f2-4afc-8db0-0c01a33d8a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50C5666F0>]}
[0m19:12:14.970786 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:12:15.577952 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:12:15.735164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:12:15.735164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:12:15.735164 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:12:15.773964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '083536a8-c9f2-4afc-8db0-0c01a33d8a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50DF5C680>]}
[0m19:12:15.855525 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:12:15.873453 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:12:15.907158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '083536a8-c9f2-4afc-8db0-0c01a33d8a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50F277E60>]}
[0m19:12:15.909165 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:12:15.909165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '083536a8-c9f2-4afc-8db0-0c01a33d8a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50DF5EC60>]}
[0m19:12:15.911021 [info ] [MainThread]: 
[0m19:12:15.911021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:12:15.913029 [info ] [MainThread]: 
[0m19:12:15.913029 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:12:15.913029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:12:19.302074 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:12:19.302074 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:12:19.302074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:20.682109 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.384 seconds
[0m19:12:20.698079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m19:12:20.698079 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:12:20.698079 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:12:20.698079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:21.669020 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.960 seconds
[0m19:12:21.669020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:12:21.669020 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:12:21.669020 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:12:21.875933 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.205 seconds
[0m19:12:21.886927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:12:21.888934 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:12:21.888934 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:12:22.093335 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.203 seconds
[0m19:12:22.097344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '083536a8-c9f2-4afc-8db0-0c01a33d8a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50A577350>]}
[0m19:12:22.101351 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m19:12:22.101351 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_nrr_grr .................. [RUN]
[0m19:12:22.103355 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m19:12:22.103355 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m19:12:22.111112 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:12:22.113116 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m19:12:22.129719 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:12:22.148422 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m19:12:22.148422 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
         as
        (-- WITH revenues AS (
--     SELECT 
--         customer_id,
--         payment_month,
--         SUM(revenue) AS total_revenue,
--         SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
--         SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
--     GROUP BY 
--         customer_id, payment_month
-- ),
-- monthly_revenue AS (
--     SELECT
--         customer_id,
--         payment_month,
--         total_revenue,
--         recurring_revenue,
--         reoccuring_revenue,
--         recurring_revenue - reoccuring_revenue AS grr
--     FROM
--         revenues
-- ),
-- nrr_calculation AS (
--     SELECT
--         customer_id,
--         payment_month,
--         recurring_revenue,
--         LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
--     FROM
--         monthly_revenue
-- )
-- SELECT
--     n.customer_id,
--     n.payment_month,
--     n.recurring_revenue,
--     n.previous_recurring_revenue,
--     CASE 
--         WHEN n.previous_recurring_revenue = 0 THEN 0
--         ELSE (n.recurring_revenue / n.previous_recurring_revenue) * 100
--     END AS nrr,
--     m.grr
-- FROM
--     nrr_calculation n
-- JOIN
--     monthly_revenue m
-- ON
--     n.customer_id = m.customer_id AND n.payment_month = m.payment_month
-- ORDER BY
--     n.customer_id, n.payment_month




WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
),
grr_with_downsell AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        grr,
        CASE 
            WHEN previous_recurring_revenue > recurring_revenue THEN previous_recurring_revenue - recurring_revenue
            ELSE 0
        END AS downsell
    FROM
        nrr_calculation
    JOIN
        monthly_revenue USING (customer_id, payment_month)
)
SELECT
    customer_id,
    payment_month,
    total_revenue,
    recurring_revenue,
    reoccuring_revenue,
    grr,
    downsell,
    CASE 
        WHEN previous_recurring_revenue = 0 THEN 0
        ELSE (recurring_revenue / previous_recurring_revenue) * 100
    END AS nrr
FROM
    grr_with_downsell
ORDER BY
    customer_id, payment_month;
[0m19:12:22.148422 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:12:23.238352 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00d6-3201-7e56-000c-493e00024bea
[0m19:12:23.238352 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 121 at position 30 unexpected ';'.
[0m19:12:23.263953 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 121 at position 30 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m19:12:23.270415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '083536a8-c9f2-4afc-8db0-0c01a33d8a0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50F6DA120>]}
[0m19:12:23.270415 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_nrr_grr ......... [[31mERROR[0m in 1.16s]
[0m19:12:23.270415 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m19:12:23.273780 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 121 at position 30 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql.
[0m19:12:23.273780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:23.273780 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:12:23.273780 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:12:23.603369 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m19:12:23.609942 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m19:12:23.932419 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m19:12:23.932419 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m19:12:24.252857 [info ] [MainThread]: 
[0m19:12:24.252857 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.34 seconds (8.34s).
[0m19:12:24.252857 [debug] [MainThread]: Command end result
[0m19:12:24.280754 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:12:24.284762 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:12:24.294689 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:12:24.295689 [info ] [MainThread]: 
[0m19:12:24.296685 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:12:24.297409 [info ] [MainThread]: 
[0m19:12:24.299453 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 121 at position 30 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m19:12:24.300416 [info ] [MainThread]: 
[0m19:12:24.301416 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:12:24.302418 [debug] [MainThread]: Command `dbt run` failed at 19:12:24.302418 after 10.54 seconds
[0m19:12:24.303418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50C504FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50CE13320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50CE12DE0>]}
[0m19:12:24.303418 [debug] [MainThread]: Flushing usage events
[0m19:12:25.223085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:12:31.219005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743C94C830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743C94FAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743C94FFB0>]}


============================== 19:12:31.219005 | fc135bd6-5ba1-4908-815b-74748847286a ==============================
[0m19:12:31.219005 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:12:31.219005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_nrr_grr', 'send_anonymous_usage_stats': 'True'}
[0m19:12:31.737634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc135bd6-5ba1-4908-815b-74748847286a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743BE99DC0>]}
[0m19:12:31.800593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc135bd6-5ba1-4908-815b-74748847286a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743D604230>]}
[0m19:12:31.800593 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:12:32.287633 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:12:32.453108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:12:32.453108 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:12:32.468827 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:12:32.491209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc135bd6-5ba1-4908-815b-74748847286a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743D7529F0>]}
[0m19:12:32.556319 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:12:32.572170 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:12:32.603731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc135bd6-5ba1-4908-815b-74748847286a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743E991DC0>]}
[0m19:12:32.603731 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:12:32.603731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc135bd6-5ba1-4908-815b-74748847286a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743D79B320>]}
[0m19:12:32.603731 [info ] [MainThread]: 
[0m19:12:32.603731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:12:32.603731 [info ] [MainThread]: 
[0m19:12:32.603731 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:12:32.603731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:12:32.718175 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:12:32.718175 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:12:32.718175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:33.753538 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.044 seconds
[0m19:12:33.767256 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m19:12:33.774698 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:12:33.774698 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:12:33.774698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:34.709075 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.929 seconds
[0m19:12:34.709075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:12:34.709075 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:12:34.709075 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:12:34.891461 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.187 seconds
[0m19:12:34.891461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:12:34.891461 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:12:34.891461 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:12:35.097708 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.199 seconds
[0m19:12:35.106732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc135bd6-5ba1-4908-815b-74748847286a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017439D97560>]}
[0m19:12:35.106732 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m19:12:35.106732 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_nrr_grr .................. [RUN]
[0m19:12:35.113341 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m19:12:35.113341 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m19:12:35.113341 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:12:35.113341 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m19:12:35.153488 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:12:35.159332 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m19:12:35.160324 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
         as
        (-- WITH revenues AS (
--     SELECT 
--         customer_id,
--         payment_month,
--         SUM(revenue) AS total_revenue,
--         SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
--         SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
--     GROUP BY 
--         customer_id, payment_month
-- ),
-- monthly_revenue AS (
--     SELECT
--         customer_id,
--         payment_month,
--         total_revenue,
--         recurring_revenue,
--         reoccuring_revenue,
--         recurring_revenue - reoccuring_revenue AS grr
--     FROM
--         revenues
-- ),
-- nrr_calculation AS (
--     SELECT
--         customer_id,
--         payment_month,
--         recurring_revenue,
--         LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
--     FROM
--         monthly_revenue
-- )
-- SELECT
--     n.customer_id,
--     n.payment_month,
--     n.recurring_revenue,
--     n.previous_recurring_revenue,
--     CASE 
--         WHEN n.previous_recurring_revenue = 0 THEN 0
--         ELSE (n.recurring_revenue / n.previous_recurring_revenue) * 100
--     END AS nrr,
--     m.grr
-- FROM
--     nrr_calculation n
-- JOIN
--     monthly_revenue m
-- ON
--     n.customer_id = m.customer_id AND n.payment_month = m.payment_month
-- ORDER BY
--     n.customer_id, n.payment_month




WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
),
grr_with_downsell AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        grr,
        CASE 
            WHEN previous_recurring_revenue > recurring_revenue THEN previous_recurring_revenue - recurring_revenue
            ELSE 0
        END AS downsell
    FROM
        nrr_calculation
    JOIN
        monthly_revenue USING (customer_id, payment_month)
)
SELECT
    customer_id,
    payment_month,
    total_revenue,
    recurring_revenue,
    reoccuring_revenue,
    grr,
    downsell,
    CASE 
        WHEN previous_recurring_revenue = 0 THEN 0
        ELSE (recurring_revenue / previous_recurring_revenue) * 100
    END AS nrr
FROM
    grr_with_downsell
ORDER BY
    customer_id, payment_month
        );
[0m19:12:35.160324 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:12:36.292211 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00d6-3201-7e56-000c-493e00024bf2
[0m19:12:36.292211 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 115 at position 13
invalid identifier 'PREVIOUS_RECURRING_REVENUE'
[0m19:12:36.292211 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 115 at position 13
  invalid identifier 'PREVIOUS_RECURRING_REVENUE'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m19:12:36.292211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc135bd6-5ba1-4908-815b-74748847286a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743D79BD10>]}
[0m19:12:36.292211 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_nrr_grr ......... [[31mERROR[0m in 1.18s]
[0m19:12:36.308185 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m19:12:36.308185 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 115 at position 13
  invalid identifier 'PREVIOUS_RECURRING_REVENUE'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql.
[0m19:12:36.308185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:36.308185 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:12:36.308185 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:12:36.617973 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m19:12:36.617973 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m19:12:36.945729 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m19:12:36.945729 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m19:12:37.264313 [info ] [MainThread]: 
[0m19:12:37.264313 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m19:12:37.264313 [debug] [MainThread]: Command end result
[0m19:12:37.291819 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:12:37.294802 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:12:37.300782 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:12:37.300782 [info ] [MainThread]: 
[0m19:12:37.300782 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:12:37.300782 [info ] [MainThread]: 
[0m19:12:37.300782 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  000904 (42000): SQL compilation error: error line 115 at position 13
  invalid identifier 'PREVIOUS_RECURRING_REVENUE'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m19:12:37.300782 [info ] [MainThread]: 
[0m19:12:37.300782 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:12:37.300782 [debug] [MainThread]: Command `dbt run` failed at 19:12:37.300782 after 6.26 seconds
[0m19:12:37.300782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743C45EB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743A6FE840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743A6FE870>]}
[0m19:12:37.300782 [debug] [MainThread]: Flushing usage events
[0m19:12:38.207085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:35.784045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBC6D1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBC2EAFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBBCE78C0>]}


============================== 19:14:35.787052 | 327af8b8-0f0e-49df-ab27-069519e160e6 ==============================
[0m19:14:35.787052 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:14:35.787052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:14:36.305412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '327af8b8-0f0e-49df-ab27-069519e160e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBE457BC0>]}
[0m19:14:36.362728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '327af8b8-0f0e-49df-ab27-069519e160e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBC6D0470>]}
[0m19:14:36.368815 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:14:36.871129 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:14:37.028977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:37.028977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:37.028977 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:14:37.067630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '327af8b8-0f0e-49df-ab27-069519e160e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBE4546B0>]}
[0m19:14:37.130214 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:14:37.145367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:14:37.179824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '327af8b8-0f0e-49df-ab27-069519e160e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBE844710>]}
[0m19:14:37.179824 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:14:37.179824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '327af8b8-0f0e-49df-ab27-069519e160e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBE830C50>]}
[0m19:14:37.179824 [info ] [MainThread]: 
[0m19:14:37.179824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:37.179824 [info ] [MainThread]: 
[0m19:14:37.179824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:37.179824 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:14:37.297106 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:14:37.297106 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:14:37.297106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:38.629591 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.334 seconds
[0m19:14:38.637384 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m19:14:38.644779 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:14:38.644779 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:14:38.644779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:39.600928 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.952 seconds
[0m19:14:39.602970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:14:39.604980 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:14:39.604980 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:14:39.800814 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.201 seconds
[0m19:14:39.808876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:14:39.812935 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:14:39.812935 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:14:40.025400 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.220 seconds
[0m19:14:40.025400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '327af8b8-0f0e-49df-ab27-069519e160e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBE493290>]}
[0m19:14:40.041310 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m19:14:40.041310 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_nrr_grr .................. [RUN]
[0m19:14:40.041310 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m19:14:40.041310 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m19:14:40.041310 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:14:40.041310 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m19:14:40.091553 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:14:40.094554 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m19:14:40.095554 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
         as
        (-- WITH revenues AS (
--     SELECT 
--         customer_id,
--         payment_month,
--         SUM(revenue) AS total_revenue,
--         SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
--         SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
--     GROUP BY 
--         customer_id, payment_month
-- ),
-- monthly_revenue AS (
--     SELECT
--         customer_id,
--         payment_month,
--         total_revenue,
--         recurring_revenue,
--         reoccuring_revenue,
--         recurring_revenue - reoccuring_revenue AS grr
--     FROM
--         revenues
-- ),
-- nrr_calculation AS (
--     SELECT
--         customer_id,
--         payment_month,
--         recurring_revenue,
--         LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
--     FROM
--         monthly_revenue
-- ),
-- grr_with_downsell AS (
--     SELECT
--         customer_id,
--         payment_month,
--         total_revenue,
--         recurring_revenue,
--         reoccuring_revenue,
--         grr,
--         CASE 
--             WHEN previous_recurring_revenue > recurring_revenue THEN previous_recurring_revenue - recurring_revenue
--             ELSE 0
--         END AS downsell
--     FROM
--         nrr_calculation
--     JOIN
--         monthly_revenue USING (customer_id, payment_month)
-- )
-- SELECT
--     customer_id,
--     payment_month,
--     total_revenue,
--     recurring_revenue,
--     reoccuring_revenue,
--     grr,
--     downsell,
--     CASE 
--         WHEN previous_recurring_revenue = 0 THEN 0
--         ELSE (recurring_revenue / previous_recurring_revenue) * 100
--     END AS nrr
-- FROM
--     grr_with_downsell
-- ORDER BY
--     customer_id, payment_month



WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
),
grr_with_downsell AS (
    SELECT
        n.customer_id,
        n.payment_month,
        m.total_revenue,
        n.recurring_revenue,
        m.reoccuring_revenue,
        m.grr,
        n.previous_recurring_revenue,
        CASE 
            WHEN n.previous_recurring_revenue > n.recurring_revenue THEN n.previous_recurring_revenue - n.recurring_revenue
            ELSE 0
        END AS downsell
    FROM
        nrr_calculation n
    JOIN
        monthly_revenue m
    ON
        n.customer_id = m.customer_id AND n.payment_month = m.payment_month
)
SELECT
    customer_id,
    payment_month,
    total_revenue,
    recurring_revenue,
    reoccuring_revenue,
    grr,
    downsell,
    CASE 
        WHEN previous_recurring_revenue = 0 THEN 0
        ELSE (recurring_revenue / previous_recurring_revenue) * 100
    END AS nrr
FROM
    grr_with_downsell
ORDER BY
    customer_id, payment_month;
[0m19:14:40.095554 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:14:41.036400 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00d8-3201-7d7b-000c-493e00022f3a
[0m19:14:41.036400 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 138 at position 30 unexpected ';'.
[0m19:14:41.036400 [debug] [Thread-1 (]: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 138 at position 30 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m19:14:41.036400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '327af8b8-0f0e-49df-ab27-069519e160e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBBB745F0>]}
[0m19:14:41.043079 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_nrr_grr ......... [[31mERROR[0m in 1.00s]
[0m19:14:41.043079 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m19:14:41.045088 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 138 at position 30 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql.
[0m19:14:41.045088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:41.045088 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:14:41.045088 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:14:41.363001 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m19:14:41.363001 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m19:14:41.679363 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m19:14:41.679363 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m19:14:42.036890 [info ] [MainThread]: 
[0m19:14:42.036890 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.86 seconds (4.86s).
[0m19:14:42.036890 [debug] [MainThread]: Command end result
[0m19:14:42.063211 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:14:42.066212 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:14:42.073091 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:14:42.073091 [info ] [MainThread]: 
[0m19:14:42.073091 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:14:42.073091 [info ] [MainThread]: 
[0m19:14:42.073091 [error] [MainThread]:   Database Error in model mart_nrr_grr (models\mart\mart_nrr_grr.sql)
  001003 (42000): SQL compilation error:
  syntax error line 138 at position 30 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_nrr_grr.sql
[0m19:14:42.073091 [info ] [MainThread]: 
[0m19:14:42.073091 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:14:42.073091 [debug] [MainThread]: Command `dbt run` failed at 19:14:42.073091 after 6.47 seconds
[0m19:14:42.073091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBB6A8A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FBB86BF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FB9D01730>]}
[0m19:14:42.073091 [debug] [MainThread]: Flushing usage events
[0m19:14:42.953641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:49.267981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024313F0A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024313F08290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024313F085C0>]}


============================== 19:14:49.272017 | 0883553d-e3b4-4cd9-9081-81c4cf53374b ==============================
[0m19:14:49.272017 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:14:49.273013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:14:49.755973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0883553d-e3b4-4cd9-9081-81c4cf53374b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024314A431D0>]}
[0m19:14:49.808910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0883553d-e3b4-4cd9-9081-81c4cf53374b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243135F5100>]}
[0m19:14:49.808910 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:14:50.314819 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:14:50.468041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:50.468041 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:50.483956 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:14:50.511366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0883553d-e3b4-4cd9-9081-81c4cf53374b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024315E02E40>]}
[0m19:14:50.584569 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:14:50.586576 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:14:50.617073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0883553d-e3b4-4cd9-9081-81c4cf53374b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024316072030>]}
[0m19:14:50.619081 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:14:50.619081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0883553d-e3b4-4cd9-9081-81c4cf53374b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024315E2C9E0>]}
[0m19:14:50.621088 [info ] [MainThread]: 
[0m19:14:50.621088 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:50.621088 [info ] [MainThread]: 
[0m19:14:50.623092 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:50.623092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:14:50.737823 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:14:50.737823 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:14:50.738823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:51.820617 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.084 seconds
[0m19:14:51.827200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m19:14:51.836672 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:14:51.836672 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:14:51.836672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:52.995393 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.168 seconds
[0m19:14:53.010553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:14:53.010553 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:14:53.010553 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:14:53.222216 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.212 seconds
[0m19:14:53.228406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:14:53.231482 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:14:53.231482 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:14:53.428518 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.196 seconds
[0m19:14:53.428518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0883553d-e3b4-4cd9-9081-81c4cf53374b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024316219610>]}
[0m19:14:53.428518 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m19:14:53.428518 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_nrr_grr .................. [RUN]
[0m19:14:53.436835 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m19:14:53.436835 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m19:14:53.436835 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:14:53.436835 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m19:14:53.479267 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:14:53.482323 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m19:14:53.483323 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
         as
        (-- WITH revenues AS (
--     SELECT 
--         customer_id,
--         payment_month,
--         SUM(revenue) AS total_revenue,
--         SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
--         SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
--     GROUP BY 
--         customer_id, payment_month
-- ),
-- monthly_revenue AS (
--     SELECT
--         customer_id,
--         payment_month,
--         total_revenue,
--         recurring_revenue,
--         reoccuring_revenue,
--         recurring_revenue - reoccuring_revenue AS grr
--     FROM
--         revenues
-- ),
-- nrr_calculation AS (
--     SELECT
--         customer_id,
--         payment_month,
--         recurring_revenue,
--         LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
--     FROM
--         monthly_revenue
-- ),
-- grr_with_downsell AS (
--     SELECT
--         customer_id,
--         payment_month,
--         total_revenue,
--         recurring_revenue,
--         reoccuring_revenue,
--         grr,
--         CASE 
--             WHEN previous_recurring_revenue > recurring_revenue THEN previous_recurring_revenue - recurring_revenue
--             ELSE 0
--         END AS downsell
--     FROM
--         nrr_calculation
--     JOIN
--         monthly_revenue USING (customer_id, payment_month)
-- )
-- SELECT
--     customer_id,
--     payment_month,
--     total_revenue,
--     recurring_revenue,
--     reoccuring_revenue,
--     grr,
--     downsell,
--     CASE 
--         WHEN previous_recurring_revenue = 0 THEN 0
--         ELSE (recurring_revenue / previous_recurring_revenue) * 100
--     END AS nrr
-- FROM
--     grr_with_downsell
-- ORDER BY
--     customer_id, payment_month



WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS grr
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
),
grr_with_downsell AS (
    SELECT
        n.customer_id,
        n.payment_month,
        m.total_revenue,
        n.recurring_revenue,
        m.reoccuring_revenue,
        m.grr,
        n.previous_recurring_revenue,
        CASE 
            WHEN n.previous_recurring_revenue > n.recurring_revenue THEN n.previous_recurring_revenue - n.recurring_revenue
            ELSE 0
        END AS downsell
    FROM
        nrr_calculation n
    JOIN
        monthly_revenue m
    ON
        n.customer_id = m.customer_id AND n.payment_month = m.payment_month
)
SELECT
    customer_id,
    payment_month,
    total_revenue,
    recurring_revenue,
    reoccuring_revenue,
    grr,
    downsell,
    CASE 
        WHEN previous_recurring_revenue = 0 THEN 0
        ELSE (recurring_revenue / previous_recurring_revenue) * 100
    END AS nrr
FROM
    grr_with_downsell
ORDER BY
    customer_id, payment_month
        );
[0m19:14:53.483323 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:14:54.882240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.399 seconds
[0m19:14:54.898327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0883553d-e3b4-4cd9-9081-81c4cf53374b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243134F4BC0>]}
[0m19:14:54.898327 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_nrr_grr ............. [[32mSUCCESS 1[0m in 1.46s]
[0m19:14:54.898327 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m19:14:54.898327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:54.898327 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:14:54.898327 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:14:55.245268 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m19:14:55.245268 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m19:14:55.572374 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m19:14:55.572374 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m19:14:55.898923 [info ] [MainThread]: 
[0m19:14:55.899930 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.28 seconds (5.28s).
[0m19:14:55.900964 [debug] [MainThread]: Command end result
[0m19:14:55.921002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:14:55.925812 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:14:55.931758 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:14:55.932798 [info ] [MainThread]: 
[0m19:14:55.933766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:55.934766 [info ] [MainThread]: 
[0m19:14:55.934766 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:14:55.935767 [debug] [MainThread]: Command `dbt run` succeeded at 19:14:55.935767 after 6.83 seconds
[0m19:14:55.936800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002430DEC0A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024314059C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024313B4ABD0>]}
[0m19:14:55.936800 [debug] [MainThread]: Flushing usage events
[0m19:14:57.316323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:17:22.622658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604C72D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604C72CD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604C5F8740>]}


============================== 19:17:22.626342 | 9106d0bc-9274-4472-9b0c-ed35073f8d8c ==============================
[0m19:17:22.626342 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:17:22.626342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_nrr_grr', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:17:23.239176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9106d0bc-9274-4472-9b0c-ed35073f8d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604D3E4260>]}
[0m19:17:23.338033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9106d0bc-9274-4472-9b0c-ed35073f8d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604D417920>]}
[0m19:17:23.338033 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:17:23.926656 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:17:24.112575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:17:24.113075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:17:24.119516 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:17:24.151980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9106d0bc-9274-4472-9b0c-ed35073f8d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604D55C080>]}
[0m19:17:24.240873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:17:24.245809 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:17:24.275575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9106d0bc-9274-4472-9b0c-ed35073f8d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604E7C52E0>]}
[0m19:17:24.275575 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:17:24.275575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9106d0bc-9274-4472-9b0c-ed35073f8d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604C2D8950>]}
[0m19:17:24.279909 [info ] [MainThread]: 
[0m19:17:24.279909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:17:24.279909 [info ] [MainThread]: 
[0m19:17:24.279909 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:17:24.279909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:17:24.446302 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:17:24.447309 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:17:24.447309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:25.875832 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.428 seconds
[0m19:17:25.883005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m19:17:25.895065 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:17:25.895065 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:17:25.895065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:26.852922 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.957 seconds
[0m19:17:26.854922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:17:26.857751 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:17:26.858750 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:17:27.067606 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.209 seconds
[0m19:17:27.069607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:17:27.071574 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:17:27.074371 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:17:27.279466 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.206 seconds
[0m19:17:27.284489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9106d0bc-9274-4472-9b0c-ed35073f8d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604ED01970>]}
[0m19:17:27.289565 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m19:17:27.289565 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_nrr_grr .................. [RUN]
[0m19:17:27.289565 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m19:17:27.289565 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m19:17:27.301293 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:17:27.302295 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m19:17:27.335542 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:17:27.338575 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m19:17:27.338575 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
         as
        (-- WITH revenues AS (
--     SELECT 
--         customer_id,
--         payment_month,
--         SUM(revenue) AS total_revenue,
--         SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
--         SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
--     GROUP BY 
--         customer_id, payment_month
-- ),
-- monthly_revenue AS (
--     SELECT
--         customer_id,
--         payment_month,
--         total_revenue,
--         recurring_revenue,
--         reoccuring_revenue,
--         recurring_revenue - reoccuring_revenue AS grr
--     FROM
--         revenues
-- ),
-- nrr_calculation AS (
--     SELECT
--         customer_id,
--         payment_month,
--         recurring_revenue,
--         LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
--     FROM
--         monthly_revenue
-- ),
-- grr_with_downsell AS (
--     SELECT
--         customer_id,
--         payment_month,
--         total_revenue,
--         recurring_revenue,
--         reoccuring_revenue,
--         grr,
--         CASE 
--             WHEN previous_recurring_revenue > recurring_revenue THEN previous_recurring_revenue - recurring_revenue
--             ELSE 0
--         END AS downsell
--     FROM
--         nrr_calculation
--     JOIN
--         monthly_revenue USING (customer_id, payment_month)
-- )
-- SELECT
--     customer_id,
--     payment_month,
--     total_revenue,
--     recurring_revenue,
--     reoccuring_revenue,
--     grr,
--     downsell,
--     CASE 
--         WHEN previous_recurring_revenue = 0 THEN 0
--         ELSE (recurring_revenue / previous_recurring_revenue) * 100
--     END AS nrr
-- FROM
--     grr_with_downsell
-- ORDER BY
--     customer_id, payment_month



WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS diff
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
),
grr_with_downsell AS (
    SELECT
        n.customer_id,
        n.payment_month,
        m.total_revenue,
        n.recurring_revenue,
        m.reoccuring_revenue,
        m.diff,
        n.previous_recurring_revenue,
        CASE 
            WHEN n.previous_recurring_revenue > n.recurring_revenue THEN n.previous_recurring_revenue - n.recurring_revenue
            ELSE 0
        END AS downsell
    FROM
        nrr_calculation n
    JOIN
        monthly_revenue m
    ON
        n.customer_id = m.customer_id AND n.payment_month = m.payment_month
)
SELECT
    customer_id,
    payment_month,
    total_revenue,
    recurring_revenue,
    reoccuring_revenue,
    (diff-downsell) AS grr,
    downsell,
    CASE 
        WHEN previous_recurring_revenue = 0 THEN 0
        ELSE (recurring_revenue / previous_recurring_revenue) * 100
    END AS nrr
FROM
    grr_with_downsell
ORDER BY
    customer_id, payment_month
        );
[0m19:17:27.338575 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:17:28.814592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.478 seconds
[0m19:17:28.845067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9106d0bc-9274-4472-9b0c-ed35073f8d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604BBD4680>]}
[0m19:17:28.845067 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_nrr_grr ............. [[32mSUCCESS 1[0m in 1.55s]
[0m19:17:28.846066 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m19:17:28.847500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:28.847500 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:17:28.848615 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:17:29.175390 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m19:17:29.177401 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m19:17:29.500534 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m19:17:29.500534 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m19:17:29.822963 [info ] [MainThread]: 
[0m19:17:29.823559 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m19:17:29.824740 [debug] [MainThread]: Command end result
[0m19:17:29.847524 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:17:29.849611 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:17:29.856750 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:17:29.856750 [info ] [MainThread]: 
[0m19:17:29.857750 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:17:29.857750 [info ] [MainThread]: 
[0m19:17:29.858772 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:17:29.859785 [debug] [MainThread]: Command `dbt run` succeeded at 19:17:29.859785 after 7.42 seconds
[0m19:17:29.860781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604A4CE570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604A2BAF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604C043320>]}
[0m19:17:29.860781 [debug] [MainThread]: Flushing usage events
[0m19:17:30.802803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:11.746210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF74BE120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF74BC230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF74BC620>]}


============================== 19:18:11.755606 | d3c10dd0-d92b-4907-9ab5-6611c8ef766e ==============================
[0m19:18:11.755606 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:18:11.755606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:18:12.338231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3c10dd0-d92b-4907-9ab5-6611c8ef766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF82ACB30>]}
[0m19:18:12.411637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3c10dd0-d92b-4907-9ab5-6611c8ef766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF81B0860>]}
[0m19:18:12.411637 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:18:12.951966 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:18:13.185421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:13.185421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:13.193720 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:18:13.235106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3c10dd0-d92b-4907-9ab5-6611c8ef766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF943BA40>]}
[0m19:18:13.335146 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:18:13.339540 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:18:13.390115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3c10dd0-d92b-4907-9ab5-6611c8ef766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF943B3E0>]}
[0m19:18:13.390115 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:18:13.390115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3c10dd0-d92b-4907-9ab5-6611c8ef766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF941F6B0>]}
[0m19:18:13.398442 [info ] [MainThread]: 
[0m19:18:13.399440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:13.400442 [info ] [MainThread]: 
[0m19:18:13.400442 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:18:13.402902 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:18:13.578400 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:18:13.579496 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:18:13.579496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:14.898429 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.319 seconds
[0m19:18:14.899428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m19:18:14.916034 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:18:14.916034 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:18:14.916034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:15.870473 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.955 seconds
[0m19:18:15.870473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:18:15.870473 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:18:15.870473 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:18:16.077533 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.200 seconds
[0m19:18:16.079532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:18:16.086549 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:18:16.086549 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:18:16.276712 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.190 seconds
[0m19:18:16.343063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3c10dd0-d92b-4907-9ab5-6611c8ef766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF96922D0>]}
[0m19:18:16.354353 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:18:16.355351 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:18:16.358354 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:18:16.359348 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:18:16.419591 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:18:16.421592 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:18:16.458234 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:18:16.462234 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:18:16.462234 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers_lm
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- )
-- SELECT
--     cs.customer_id,
--     COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm,
--     pc.churned_customers_lm
-- FROM
--     cross_sell cs
-- LEFT JOIN
--     product_churn pc
-- ON
--     cs.product_id_1 = pc.product_id
-- GROUP BY
--     cs.customer_id, pc.churned_customers_lm
-- ORDER BY
--     cross_sell_opportunities_lm DESC, pc.churned_customers_lm DESC


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    cs.customer_id,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm,
    pc.churned_customers_lm
FROM
    cross_sell cs
LEFT JOIN
    product_churn pc
ON
    cs.product_id_1 = pc.product_id
GROUP BY
    cs.customer_id, pc.churned_customers_lm
ORDER BY
    cross_sell_opportunities_lm DESC, pc.churned_customers_lm DESC;
[0m19:18:16.463558 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:18:17.395840 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00dc-3201-7e57-000c-493e00026c3a
[0m19:18:17.395840 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 98 at position 66 unexpected ';'.
[0m19:18:17.403809 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 98 at position 66 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:18:17.405824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3c10dd0-d92b-4907-9ab5-6611c8ef766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF6A94860>]}
[0m19:18:17.407836 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.05s]
[0m19:18:17.436848 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:18:17.626335 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 98 at position 66 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m19:18:17.628349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:17.630364 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:18:17.630364 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:18:17.955461 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m19:18:17.956462 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m19:18:18.277658 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:18:18.277658 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:18:18.617872 [info ] [MainThread]: 
[0m19:18:18.617872 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m19:18:18.618947 [debug] [MainThread]: Command end result
[0m19:18:18.642407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:18:18.644917 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:18:18.651761 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:18:18.652913 [info ] [MainThread]: 
[0m19:18:18.652913 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:18:18.653914 [info ] [MainThread]: 
[0m19:18:18.654914 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 98 at position 66 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:18:18.655390 [info ] [MainThread]: 
[0m19:18:18.655390 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:18:18.657510 [debug] [MainThread]: Command `dbt run` failed at 19:18:18.656511 after 7.11 seconds
[0m19:18:18.657510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF3EBC590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF6B2B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FF744F020>]}
[0m19:18:18.658510 [debug] [MainThread]: Flushing usage events
[0m19:18:19.565541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:34.516992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF5E902750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF6036E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF6036E3C0>]}


============================== 19:18:34.530667 | 36856fd6-4bf0-4e48-be95-a63eec0301ca ==============================
[0m19:18:34.530667 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:18:34.530667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:18:35.079577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36856fd6-4bf0-4e48-be95-a63eec0301ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF61AA9C70>]}
[0m19:18:35.152055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36856fd6-4bf0-4e48-be95-a63eec0301ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF63287CE0>]}
[0m19:18:35.153709 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:18:35.702611 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:18:35.895004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:18:35.895004 [debug] [MainThread]: Partial parsing: updated file: CRB_PROJECT://models\mart\mart_cross_sell_and_product_churn.sql
[0m19:18:36.165638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:18:36.185143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36856fd6-4bf0-4e48-be95-a63eec0301ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF648C78C0>]}
[0m19:18:36.251852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:18:36.251852 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:18:36.285211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36856fd6-4bf0-4e48-be95-a63eec0301ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF64642EA0>]}
[0m19:18:36.285211 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:18:36.285211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36856fd6-4bf0-4e48-be95-a63eec0301ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF645F03B0>]}
[0m19:18:36.300659 [info ] [MainThread]: 
[0m19:18:36.300659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:36.300659 [info ] [MainThread]: 
[0m19:18:36.300659 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:18:36.300659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:18:36.452870 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:18:36.452870 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:18:36.452870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:37.728510 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.270 seconds
[0m19:18:37.728510 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m19:18:37.744225 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:18:37.744225 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:18:37.744225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:38.692790 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.946 seconds
[0m19:18:38.694796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:18:38.698808 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:18:38.698808 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:18:38.968957 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.269 seconds
[0m19:18:38.970965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:18:39.016231 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:18:39.016231 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:18:39.361941 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.343 seconds
[0m19:18:39.369269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36856fd6-4bf0-4e48-be95-a63eec0301ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF64CDD460>]}
[0m19:18:39.377665 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:18:39.377665 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:18:39.377665 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:18:39.377665 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:18:39.377665 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:18:39.377665 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:18:39.420872 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:18:39.423882 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:18:39.424880 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers_lm
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- )
-- SELECT
--     cs.customer_id,
--     COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm,
--     pc.churned_customers_lm
-- FROM
--     cross_sell cs
-- LEFT JOIN
--     product_churn pc
-- ON
--     cs.product_id_1 = pc.product_id
-- GROUP BY
--     cs.customer_id, pc.churned_customers_lm
-- ORDER BY
--     cross_sell_opportunities_lm DESC, pc.churned_customers_lm DESC


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    cs.customer_id,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm,
    pc.churned_customers_lm
FROM
    cross_sell cs
LEFT JOIN
    product_churn pc
ON
    cs.product_id_1 = pc.product_id
GROUP BY
    cs.customer_id, pc.churned_customers_lm
ORDER BY
    cross_sell_opportunities_lm DESC, pc.churned_customers_lm DESC
        );
[0m19:18:39.424880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:18:40.758166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.335 seconds
[0m19:18:40.778687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36856fd6-4bf0-4e48-be95-a63eec0301ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF64904B90>]}
[0m19:18:40.778687 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 1.40s]
[0m19:18:40.778687 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:18:40.778687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:40.789016 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:18:40.789016 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:18:41.093075 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m19:18:41.093075 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m19:18:41.416306 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:18:41.416306 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:18:41.732786 [info ] [MainThread]: 
[0m19:18:41.732786 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m19:18:41.732786 [debug] [MainThread]: Command end result
[0m19:18:41.764696 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:18:41.766705 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:18:41.775011 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:18:41.775011 [info ] [MainThread]: 
[0m19:18:41.775011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:41.775011 [info ] [MainThread]: 
[0m19:18:41.775011 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:18:41.775011 [debug] [MainThread]: Command `dbt run` succeeded at 19:18:41.775011 after 7.43 seconds
[0m19:18:41.775011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF5F9D7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF5E902750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF620FF500>]}
[0m19:18:41.775011 [debug] [MainThread]: Flushing usage events
[0m19:18:42.706069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:51.740176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC45D1BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC802ADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC802BEC0>]}


============================== 19:18:51.740176 | 20030ef6-e226-4f57-bd3b-f54c956f0497 ==============================
[0m19:18:51.740176 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:18:51.740176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_nrr_grr', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:18:52.265082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20030ef6-e226-4f57-bd3b-f54c956f0497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC8CC0DA0>]}
[0m19:18:52.345078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20030ef6-e226-4f57-bd3b-f54c956f0497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC911EC90>]}
[0m19:18:52.345078 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:18:52.868536 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:18:53.052032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:53.052032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:53.052032 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:18:53.092361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20030ef6-e226-4f57-bd3b-f54c956f0497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC8384950>]}
[0m19:18:53.173319 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:18:53.173319 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:18:53.215701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20030ef6-e226-4f57-bd3b-f54c956f0497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DCA402060>]}
[0m19:18:53.215701 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:18:53.215701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20030ef6-e226-4f57-bd3b-f54c956f0497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC7F58770>]}
[0m19:18:53.218284 [info ] [MainThread]: 
[0m19:18:53.218284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:53.218284 [info ] [MainThread]: 
[0m19:18:53.218284 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:18:53.218284 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:18:53.382433 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:18:53.383940 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:18:53.383940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:54.684124 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.301 seconds
[0m19:18:54.692058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m19:18:54.700203 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:18:54.703409 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:18:54.703409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:55.683503 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.982 seconds
[0m19:18:55.687096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:18:55.689764 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:18:55.691772 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:18:55.872738 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.183 seconds
[0m19:18:55.875779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:18:55.875779 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:18:55.875779 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:18:56.082230 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.204 seconds
[0m19:18:56.090307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20030ef6-e226-4f57-bd3b-f54c956f0497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DCA1D8CE0>]}
[0m19:18:56.090307 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_nrr_grr
[0m19:18:56.090307 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_nrr_grr .................. [RUN]
[0m19:18:56.098159 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_nrr_grr'
[0m19:18:56.098159 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_nrr_grr
[0m19:18:56.106930 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:18:56.106930 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_nrr_grr
[0m19:18:56.139130 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_nrr_grr"
[0m19:18:56.143430 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_nrr_grr"
[0m19:18:56.143430 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_nrr_grr"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
         as
        (-- WITH revenues AS (
--     SELECT 
--         customer_id,
--         payment_month,
--         SUM(revenue) AS total_revenue,
--         SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
--         SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
--     GROUP BY 
--         customer_id, payment_month
-- ),
-- monthly_revenue AS (
--     SELECT
--         customer_id,
--         payment_month,
--         total_revenue,
--         recurring_revenue,
--         reoccuring_revenue,
--         recurring_revenue - reoccuring_revenue AS grr
--     FROM
--         revenues
-- ),
-- nrr_calculation AS (
--     SELECT
--         customer_id,
--         payment_month,
--         recurring_revenue,
--         LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
--     FROM
--         monthly_revenue
-- ),
-- grr_with_downsell AS (
--     SELECT
--         customer_id,
--         payment_month,
--         total_revenue,
--         recurring_revenue,
--         reoccuring_revenue,
--         grr,
--         CASE 
--             WHEN previous_recurring_revenue > recurring_revenue THEN previous_recurring_revenue - recurring_revenue
--             ELSE 0
--         END AS downsell
--     FROM
--         nrr_calculation
--     JOIN
--         monthly_revenue USING (customer_id, payment_month)
-- )
-- SELECT
--     customer_id,
--     payment_month,
--     total_revenue,
--     recurring_revenue,
--     reoccuring_revenue,
--     grr,
--     downsell,
--     CASE 
--         WHEN previous_recurring_revenue = 0 THEN 0
--         ELSE (recurring_revenue / previous_recurring_revenue) * 100
--     END AS nrr
-- FROM
--     grr_with_downsell
-- ORDER BY
--     customer_id, payment_month



WITH revenues AS (
    SELECT 
        customer_id,
        payment_month,
        SUM(revenue) AS total_revenue,
        SUM(CASE WHEN revenue_type = 1 THEN revenue ELSE 0 END) AS recurring_revenue,
        SUM(CASE WHEN revenue_type = 0 THEN revenue ELSE 0 END) AS reoccuring_revenue
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY 
        customer_id, payment_month
),
monthly_revenue AS (
    SELECT
        customer_id,
        payment_month,
        total_revenue,
        recurring_revenue,
        reoccuring_revenue,
        recurring_revenue - reoccuring_revenue AS diff
    FROM
        revenues
),
nrr_calculation AS (
    SELECT
        customer_id,
        payment_month,
        recurring_revenue,
        LAG(recurring_revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS previous_recurring_revenue
    FROM
        monthly_revenue
),
grr_with_downsell AS (
    SELECT
        n.customer_id,
        n.payment_month,
        m.total_revenue,
        n.recurring_revenue,
        m.reoccuring_revenue,
        m.diff,
        n.previous_recurring_revenue,
        CASE 
            WHEN n.previous_recurring_revenue > n.recurring_revenue THEN n.previous_recurring_revenue - n.recurring_revenue
            ELSE 0
        END AS downsell
    FROM
        nrr_calculation n
    JOIN
        monthly_revenue m
    ON
        n.customer_id = m.customer_id AND n.payment_month = m.payment_month
)
SELECT
    customer_id,
    payment_month,
    total_revenue,
    recurring_revenue,
    reoccuring_revenue,
    (diff-downsell) AS grr,
    CASE 
        WHEN previous_recurring_revenue = 0 THEN 0
        ELSE (recurring_revenue / previous_recurring_revenue) * 100
    END AS nrr
FROM
    grr_with_downsell
ORDER BY
    customer_id, payment_month
        );
[0m19:18:56.143430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:18:57.544152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.411 seconds
[0m19:18:57.575871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20030ef6-e226-4f57-bd3b-f54c956f0497', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC78546B0>]}
[0m19:18:57.575871 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_nrr_grr ............. [[32mSUCCESS 1[0m in 1.48s]
[0m19:18:57.575871 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_nrr_grr
[0m19:18:57.575871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:57.575871 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:18:57.575871 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:18:57.910842 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m19:18:57.910842 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m19:18:58.225528 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_nrr_grr' was left open.
[0m19:18:58.225528 [debug] [MainThread]: On model.CRB_PROJECT.mart_nrr_grr: Close
[0m19:18:58.542296 [info ] [MainThread]: 
[0m19:18:58.542296 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m19:18:58.557495 [debug] [MainThread]: Command end result
[0m19:18:58.575764 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:18:58.582383 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:18:58.589558 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:18:58.590029 [info ] [MainThread]: 
[0m19:18:58.590983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:18:58.592056 [info ] [MainThread]: 
[0m19:18:58.592888 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:18:58.594280 [debug] [MainThread]: Command `dbt run` succeeded at 19:18:58.594280 after 7.03 seconds
[0m19:18:58.594280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC61523C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC6152300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DC61521B0>]}
[0m19:18:58.594280 [debug] [MainThread]: Flushing usage events
[0m19:18:59.460128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:57.133545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7216C170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7216C6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7216D220>]}


============================== 19:19:57.136064 | bf1ed7a9-a2a6-4be9-a227-bf03283ff519 ==============================
[0m19:19:57.136064 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:19:57.136064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:19:57.668826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf1ed7a9-a2a6-4be9-a227-bf03283ff519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB72EED160>]}
[0m19:19:57.733110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf1ed7a9-a2a6-4be9-a227-bf03283ff519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB72F24410>]}
[0m19:19:57.733110 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:19:58.301967 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:19:58.545332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:58.545332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:58.554202 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:19:58.585859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf1ed7a9-a2a6-4be9-a227-bf03283ff519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7402F8C0>]}
[0m19:19:58.675058 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:19:58.681091 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:19:58.729030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf1ed7a9-a2a6-4be9-a227-bf03283ff519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB74238350>]}
[0m19:19:58.729030 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:19:58.730033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf1ed7a9-a2a6-4be9-a227-bf03283ff519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB73FA7F20>]}
[0m19:19:58.732029 [info ] [MainThread]: 
[0m19:19:58.732029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:58.733028 [info ] [MainThread]: 
[0m19:19:58.734940 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:19:58.736733 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:19:58.912076 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:19:58.912076 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:19:58.912076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:00.179175 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.276 seconds
[0m19:20:00.196388 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m19:20:00.202400 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:20:00.202400 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:20:00.202400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:01.147068 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.954 seconds
[0m19:20:01.162772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:20:01.162772 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:20:01.162772 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:20:01.352792 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.192 seconds
[0m19:20:01.352792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:20:01.352792 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:20:01.352792 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:20:01.561363 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.199 seconds
[0m19:20:01.561363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf1ed7a9-a2a6-4be9-a227-bf03283ff519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6F5A35C0>]}
[0m19:20:01.571461 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:20:01.571461 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:20:01.572494 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:20:01.573493 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:20:01.580325 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:20:01.580325 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:20:01.609386 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:20:01.609386 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:20:01.609386 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers_lm
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- )
-- SELECT
--     cs.customer_id,
--     COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm,
--     pc.churned_customers_lm
-- FROM
--     cross_sell cs
-- LEFT JOIN
--     product_churn pc
-- ON
--     cs.product_id_1 = pc.product_id
-- GROUP BY
--     cs.customer_id, pc.churned_customers_lm
-- ORDER BY
--     cross_sell_opportunities_lm DESC, pc.churned_customers_lm DESC


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    cs.customer_id,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm,
    pc.churned_customers
FROM
    cross_sell cs
LEFT JOIN
    product_churn pc
ON
    cs.product_id_1 = pc.product_id
GROUP BY
    cs.customer_id, pc.churned_customers
ORDER BY
    cross_sell_opportunities_lm DESC, pc.churned_customers DESC
        );
[0m19:20:01.609386 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:20:02.545986 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00de-3201-7e57-000c-493e00026c6a
[0m19:20:02.546987 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 88 at position 4
invalid identifier 'PC.CHURNED_CUSTOMERS'
[0m19:20:02.549986 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  000904 (42000): SQL compilation error: error line 88 at position 4
  invalid identifier 'PC.CHURNED_CUSTOMERS'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:20:02.552985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf1ed7a9-a2a6-4be9-a227-bf03283ff519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7494B800>]}
[0m19:20:02.553583 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 0.98s]
[0m19:20:02.553583 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:20:02.553583 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  000904 (42000): SQL compilation error: error line 88 at position 4
  invalid identifier 'PC.CHURNED_CUSTOMERS'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m19:20:02.553583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:02.553583 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:20:02.553583 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:20:02.882045 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m19:20:02.882045 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m19:20:03.193819 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:20:03.193819 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:20:03.527023 [info ] [MainThread]: 
[0m19:20:03.527023 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.79 seconds (4.79s).
[0m19:20:03.527023 [debug] [MainThread]: Command end result
[0m19:20:03.553331 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:20:03.556657 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:20:03.563772 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:20:03.563772 [info ] [MainThread]: 
[0m19:20:03.564774 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:20:03.564774 [info ] [MainThread]: 
[0m19:20:03.565773 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  000904 (42000): SQL compilation error: error line 88 at position 4
  invalid identifier 'PC.CHURNED_CUSTOMERS'
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:20:03.566775 [info ] [MainThread]: 
[0m19:20:03.566775 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:20:03.567787 [debug] [MainThread]: Command `dbt run` failed at 19:20:03.567787 after 6.61 seconds
[0m19:20:03.568811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6FDBDF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6FF0E930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6FF0E810>]}
[0m19:20:03.568811 [debug] [MainThread]: Flushing usage events
[0m19:20:04.958020 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:21:25.806588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D187A1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D18442570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D187A3410>]}


============================== 19:21:25.822413 | a0c86232-3c10-444b-a566-f4440d40a2ba ==============================
[0m19:21:25.822413 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:21:25.822413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'send_anonymous_usage_stats': 'True'}
[0m19:21:26.329182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0c86232-3c10-444b-a566-f4440d40a2ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D187C1B80>]}
[0m19:21:26.387162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0c86232-3c10-444b-a566-f4440d40a2ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D1A51DAC0>]}
[0m19:21:26.387162 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:21:26.885641 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:21:27.052129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:21:27.052129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:21:27.055040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:21:27.089543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0c86232-3c10-444b-a566-f4440d40a2ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D1A583320>]}
[0m19:21:27.162177 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:21:27.164185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:21:27.199354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0c86232-3c10-444b-a566-f4440d40a2ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D1A7452B0>]}
[0m19:21:27.199354 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:21:27.201743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0c86232-3c10-444b-a566-f4440d40a2ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D1A5CF200>]}
[0m19:21:27.201743 [info ] [MainThread]: 
[0m19:21:27.204364 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:21:27.204364 [info ] [MainThread]: 
[0m19:21:27.204364 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:21:27.204364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:21:27.360769 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:21:27.360769 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:21:27.360769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:28.821091 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.456 seconds
[0m19:21:28.827551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m19:21:28.836789 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:21:28.838798 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:21:28.838798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:29.776883 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.938 seconds
[0m19:21:29.778629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:21:29.782640 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:21:29.782640 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:21:29.973448 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.200 seconds
[0m19:21:29.984436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:21:29.984436 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:21:29.984436 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:21:30.173548 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.188 seconds
[0m19:21:30.179552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0c86232-3c10-444b-a566-f4440d40a2ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D15BE7560>]}
[0m19:21:30.179552 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:21:30.179552 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:21:30.185569 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:21:30.185569 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:21:30.185569 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:21:30.185569 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:21:30.224700 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:21:30.224700 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:21:30.230507 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers_lm
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- )
-- SELECT
--     cs.customer_id,
--     COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm,
--     pc.churned_customers_lm
-- FROM
--     cross_sell cs
-- LEFT JOIN
--     product_churn pc
-- ON
--     cs.product_id_1 = pc.product_id
-- GROUP BY
--     cs.customer_id, pc.churned_customers_lm
-- ORDER BY
--     cross_sell_opportunities_lm DESC, pc.churned_customers_lm DESC


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    cs.customer_id,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities,
    pc.churned_customers
FROM
    cross_sell cs
LEFT JOIN
    product_churn pc
ON
    cs.product_id_1 = pc.product_id
GROUP BY
    cs.customer_id, pc.churned_customers
ORDER BY
    cross_sell_opportunities DESC, pc.churned_customers DESC
        );
[0m19:21:30.230507 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:21:31.692332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.470 seconds
[0m19:21:31.723328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c86232-3c10-444b-a566-f4440d40a2ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D15B51790>]}
[0m19:21:31.723328 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 1.54s]
[0m19:21:31.723328 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:21:31.723328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:31.723328 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:21:31.723328 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:21:32.358031 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m19:21:32.358031 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m19:21:32.682850 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:21:32.687383 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:21:33.000049 [info ] [MainThread]: 
[0m19:21:33.000049 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m19:21:33.000049 [debug] [MainThread]: Command end result
[0m19:21:33.033580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:21:33.035519 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:21:33.042976 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:21:33.043662 [info ] [MainThread]: 
[0m19:21:33.045435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:21:33.046314 [info ] [MainThread]: 
[0m19:21:33.047324 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:21:33.048322 [debug] [MainThread]: Command `dbt run` succeeded at 19:21:33.048322 after 7.40 seconds
[0m19:21:33.048322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D1950D910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D19157A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D18442570>]}
[0m19:21:33.049321 [debug] [MainThread]: Flushing usage events
[0m19:21:34.269827 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:15.283709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A388C1F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A388739F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A388C1FEC0>]}


============================== 19:22:15.283709 | ac3fb222-a4d3-4307-8541-7757a0a7de8b ==============================
[0m19:22:15.283709 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:22:15.283709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'send_anonymous_usage_stats': 'True'}
[0m19:22:15.801891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac3fb222-a4d3-4307-8541-7757a0a7de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3892C7B90>]}
[0m19:22:15.867898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac3fb222-a4d3-4307-8541-7757a0a7de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A389529EE0>]}
[0m19:22:15.867898 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:22:16.367478 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:22:16.526103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:22:16.526103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:22:16.526103 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:22:16.564381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac3fb222-a4d3-4307-8541-7757a0a7de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B11F080>]}
[0m19:22:16.641155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:22:16.645169 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:22:16.668934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac3fb222-a4d3-4307-8541-7757a0a7de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B470950>]}
[0m19:22:16.668934 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:22:16.668934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac3fb222-a4d3-4307-8541-7757a0a7de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38B32A960>]}
[0m19:22:16.668934 [info ] [MainThread]: 
[0m19:22:16.668934 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:22:16.668934 [info ] [MainThread]: 
[0m19:22:16.668934 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:22:16.685084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:22:16.834433 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:22:16.836301 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:22:16.836633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:18.143155 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.318 seconds
[0m19:22:18.158788 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m19:22:18.158788 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:22:18.158788 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:22:18.158788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:19.126516 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.958 seconds
[0m19:22:19.126516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:22:19.131479 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:22:19.131479 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:22:19.322160 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.192 seconds
[0m19:22:19.326728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:22:19.326728 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:22:19.326728 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:22:19.537862 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.211 seconds
[0m19:22:19.537862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac3fb222-a4d3-4307-8541-7757a0a7de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A389FE6930>]}
[0m19:22:19.537862 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:22:19.537862 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:22:19.537862 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:22:19.537862 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:22:19.553646 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:22:19.553646 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:22:19.590639 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:22:19.594278 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:22:19.594278 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (-- WITH customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn AS (
--     SELECT
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers_lm
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- )
-- SELECT
--     cs.customer_id,
--     COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities_lm,
--     pc.churned_customers_lm
-- FROM
--     cross_sell cs
-- LEFT JOIN
--     product_churn pc
-- ON
--     cs.product_id_1 = pc.product_id
-- GROUP BY
--     cs.customer_id, pc.churned_customers_lm
-- ORDER BY
--     cross_sell_opportunities_lm DESC, pc.churned_customers_lm DESC


WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    cs.customer_id,
    cs.product_id_1,
    cs.product_id_2,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities,
    pc.churned_customers
FROM
    cross_sell cs
LEFT JOIN
    product_churn pc
ON
    cs.product_id_1 = pc.product_id
GROUP BY
    cs.customer_id, pc.churned_customers
ORDER BY
    cross_sell_opportunities DESC, pc.churned_customers DESC
        );
[0m19:22:19.594278 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:22:20.533730 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00e0-3201-7e57-000c-493e00026c7e
[0m19:22:20.533730 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 87 at position 4
'CS.PRODUCT_ID_1' in select clause is neither an aggregate nor in the group by clause.
[0m19:22:20.533730 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001104 (42601): SQL compilation error: error line 87 at position 4
  'CS.PRODUCT_ID_1' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:22:20.533730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac3fb222-a4d3-4307-8541-7757a0a7de8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3887B46E0>]}
[0m19:22:20.533730 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.00s]
[0m19:22:20.547655 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:22:20.548656 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001104 (42601): SQL compilation error: error line 87 at position 4
  'CS.PRODUCT_ID_1' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m19:22:20.548656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:20.548656 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:22:20.548656 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:22:20.873954 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m19:22:20.875977 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m19:22:21.202559 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:22:21.202559 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:22:21.537974 [info ] [MainThread]: 
[0m19:22:21.537974 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m19:22:21.537974 [debug] [MainThread]: Command end result
[0m19:22:21.574516 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:22:21.578590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:22:21.583632 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:22:21.583632 [info ] [MainThread]: 
[0m19:22:21.583632 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:22:21.583632 [info ] [MainThread]: 
[0m19:22:21.583632 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001104 (42601): SQL compilation error: error line 87 at position 4
  'CS.PRODUCT_ID_1' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:22:21.583632 [info ] [MainThread]: 
[0m19:22:21.583632 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:22:21.583632 [debug] [MainThread]: Command `dbt run` failed at 19:22:21.583632 after 6.47 seconds
[0m19:22:21.583632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A38910F1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3870AE4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3870AE570>]}
[0m19:22:21.583632 [debug] [MainThread]: Flushing usage events
[0m19:22:22.483149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:24:08.068900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F921E52750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F925621A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9256215B0>]}


============================== 19:24:08.068900 | ecb0e96e-32cf-43d2-8545-fcfc0e924887 ==============================
[0m19:24:08.068900 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:24:08.068900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:24:08.554745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecb0e96e-32cf-43d2-8545-fcfc0e924887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F922EB2A80>]}
[0m19:24:08.602275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecb0e96e-32cf-43d2-8545-fcfc0e924887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F926844410>]}
[0m19:24:08.602275 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:24:09.083590 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:24:09.235261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:09.235261 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:09.235261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:24:09.277080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecb0e96e-32cf-43d2-8545-fcfc0e924887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9256B8680>]}
[0m19:24:09.333294 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:24:09.348944 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:24:09.381529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecb0e96e-32cf-43d2-8545-fcfc0e924887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92794DDC0>]}
[0m19:24:09.381857 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:24:09.382645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb0e96e-32cf-43d2-8545-fcfc0e924887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92792ECC0>]}
[0m19:24:09.385196 [info ] [MainThread]: 
[0m19:24:09.385196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:09.386197 [info ] [MainThread]: 
[0m19:24:09.387160 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:24:09.388159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:24:09.522593 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:24:09.522593 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:24:09.531843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:10.849193 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.317 seconds
[0m19:24:10.865221 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m19:24:10.872838 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:24:10.874844 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:24:10.874844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:11.854296 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.984 seconds
[0m19:24:11.854296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:24:11.854296 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:24:11.854296 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:24:12.052373 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.190 seconds
[0m19:24:12.052373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:24:12.067743 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:24:12.067743 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:24:12.274722 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.205 seconds
[0m19:24:12.274722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb0e96e-32cf-43d2-8545-fcfc0e924887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F922F43740>]}
[0m19:24:12.288278 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:24:12.288278 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:24:12.290395 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:24:12.290395 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:24:12.290395 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:24:12.290395 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:24:12.320979 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:24:12.320979 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:24:12.320979 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    cs.customer_id,
    cs.product_id_1,
    cs.product_id_2,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities,
    pc.churned_customers
FROM
    cross_sell cs
LEFT JOIN
    product_churn pc
ON
    cs.product_id_1 = pc.product_id
GROUP BY
    cs.customer_id, cs.product_id_1, cs.product_id_2, pc.churned_customers
ORDER BY
    cross_sell_opportunities DESC, pc.churned_customers DESC;
[0m19:24:12.320979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:24:13.294775 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00e2-3201-7d7b-000c-493e00022f96
[0m19:24:13.294775 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 51 at position 60 unexpected ';'.
[0m19:24:13.294775 [debug] [Thread-1 (]: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 60 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:24:13.294775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb0e96e-32cf-43d2-8545-fcfc0e924887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9280CA780>]}
[0m19:24:13.294775 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[31mERROR[0m in 1.00s]
[0m19:24:13.294775 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:24:13.294775 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' to be skipped because of status 'error'.  Reason: Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 60 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql.
[0m19:24:13.294775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:13.294775 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:24:13.294775 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:24:13.633115 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m19:24:13.635137 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m19:24:13.957707 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:24:13.957707 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:24:14.281685 [info ] [MainThread]: 
[0m19:24:14.281685 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m19:24:14.291806 [debug] [MainThread]: Command end result
[0m19:24:14.312196 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:24:14.312196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:24:14.324947 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:24:14.324947 [info ] [MainThread]: 
[0m19:24:14.326292 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:24:14.326292 [info ] [MainThread]: 
[0m19:24:14.326292 [error] [MainThread]:   Database Error in model mart_cross_sell_and_product_churn (models\mart\mart_cross_sell_and_product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 60 unexpected ';'.
  compiled code at target\run\CRB_PROJECT\models\mart\mart_cross_sell_and_product_churn.sql
[0m19:24:14.326292 [info ] [MainThread]: 
[0m19:24:14.326292 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:24:14.326292 [debug] [MainThread]: Command `dbt run` failed at 19:24:14.326292 after 6.42 seconds
[0m19:24:14.326292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9254C0CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92578BE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92564F2C0>]}
[0m19:24:14.326292 [debug] [MainThread]: Flushing usage events
[0m19:24:15.225111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:24:22.683645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AFB820C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AFB821550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AFB823B30>]}


============================== 19:24:22.683645 | 53a4d24d-966c-4128-bf05-ff8688e0f930 ==============================
[0m19:24:22.683645 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:24:22.683645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_cross_sell_and_product_churn', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:24:23.168907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53a4d24d-966c-4128-bf05-ff8688e0f930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AFC6007D0>]}
[0m19:24:23.216830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53a4d24d-966c-4128-bf05-ff8688e0f930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AFB4F3050>]}
[0m19:24:23.216830 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:24:23.693260 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:24:23.829653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:23.829653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:23.845601 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:24:23.867067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53a4d24d-966c-4128-bf05-ff8688e0f930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AFC5D0EC0>]}
[0m19:24:23.931196 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:24:23.947230 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:24:23.978625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53a4d24d-966c-4128-bf05-ff8688e0f930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AFC44F200>]}
[0m19:24:23.978625 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:24:23.978625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a4d24d-966c-4128-bf05-ff8688e0f930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AFC5D3830>]}
[0m19:24:23.978625 [info ] [MainThread]: 
[0m19:24:23.978625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:23.978625 [info ] [MainThread]: 
[0m19:24:23.978625 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:24:23.978625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:24:24.129758 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:24:24.129758 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:24:24.129758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:25.222571 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.091 seconds
[0m19:24:25.225955 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m19:24:25.225955 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:24:25.225955 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:24:25.225955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:26.579743 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.356 seconds
[0m19:24:26.595552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:24:26.595552 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:24:26.595552 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:24:26.795155 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.197 seconds
[0m19:24:26.795155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:24:26.795155 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:24:26.811195 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:24:27.005657 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.195 seconds
[0m19:24:27.009691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a4d24d-966c-4128-bf05-ff8688e0f930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AFDADA3F0>]}
[0m19:24:27.009691 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:24:27.009691 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [RUN]
[0m19:24:27.009691 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn'
[0m19:24:27.009691 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:24:27.021329 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:24:27.021329 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:24:27.052215 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:24:27.052215 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.mart_cross_sell_and_product_churn"
[0m19:24:27.052215 [debug] [Thread-1 (]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.mart_cross_sell_and_product_churn"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn
         as
        (WITH customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn AS (
    SELECT
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        product_id
),
cross_sell AS (
    SELECT
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
)
SELECT
    cs.customer_id,
    cs.product_id_1,
    cs.product_id_2,
    COUNT(DISTINCT cs.product_id_2) AS cross_sell_opportunities,
    pc.churned_customers
FROM
    cross_sell cs
LEFT JOIN
    product_churn pc
ON
    cs.product_id_1 = pc.product_id
GROUP BY
    cs.customer_id, cs.product_id_1, cs.product_id_2, pc.churned_customers
ORDER BY
    cross_sell_opportunities DESC, pc.churned_customers DESC
        );
[0m19:24:27.052215 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:24:28.730457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.680 seconds
[0m19:24:28.762148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a4d24d-966c-4128-bf05-ff8688e0f930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF8BD18E0>]}
[0m19:24:28.762148 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_mart.mart_cross_sell_and_product_churn  [[32mSUCCESS 1[0m in 1.75s]
[0m19:24:28.762148 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.mart_cross_sell_and_product_churn
[0m19:24:28.762148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:28.762148 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:24:28.762148 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:24:29.140772 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m19:24:29.140772 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m19:24:29.463168 [debug] [MainThread]: Connection 'model.CRB_PROJECT.mart_cross_sell_and_product_churn' was left open.
[0m19:24:29.463168 [debug] [MainThread]: On model.CRB_PROJECT.mart_cross_sell_and_product_churn: Close
[0m19:24:29.794734 [info ] [MainThread]: 
[0m19:24:29.794734 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m19:24:29.798977 [debug] [MainThread]: Command end result
[0m19:24:29.820385 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:24:29.820385 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:24:29.833620 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:24:29.834628 [info ] [MainThread]: 
[0m19:24:29.835627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:29.835627 [info ] [MainThread]: 
[0m19:24:29.837188 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:24:29.837188 [debug] [MainThread]: Command `dbt run` succeeded at 19:24:29.837188 after 7.30 seconds
[0m19:24:29.837188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF7F08350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AFC312F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AFC68A030>]}
[0m19:24:29.837188 [debug] [MainThread]: Flushing usage events
[0m19:24:30.705726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:01.013736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5AA60AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE57F40530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5AA63380>]}


============================== 19:26:01.019435 | e1097830-f7df-4df4-aa3c-61a8c1d4e34f ==============================
[0m19:26:01.019435 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:26:01.019435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m report', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:26:01.968631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1097830-f7df-4df4-aa3c-61a8c1d4e34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5A8BF0E0>]}
[0m19:26:02.026110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1097830-f7df-4df4-aa3c-61a8c1d4e34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5AA79F70>]}
[0m19:26:02.026110 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:26:02.648751 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:26:05.166980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:26:05.166980 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:26:05.172947 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:26:05.209569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1097830-f7df-4df4-aa3c-61a8c1d4e34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5CA180B0>]}
[0m19:26:05.279849 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:26:05.299519 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:26:05.341503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1097830-f7df-4df4-aa3c-61a8c1d4e34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5C8B8950>]}
[0m19:26:05.342502 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:26:05.343503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1097830-f7df-4df4-aa3c-61a8c1d4e34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5C833320>]}
[0m19:26:05.344503 [info ] [MainThread]: 
[0m19:26:05.345500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:05.345500 [info ] [MainThread]: 
[0m19:26:05.346503 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:26:05.347502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:26:08.778893 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:26:08.784081 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:26:08.784081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:10.286283 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.503 seconds
[0m19:26:10.291917 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m19:26:10.301834 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:26:10.301834 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:26:10.301834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:11.260008 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.955 seconds
[0m19:26:11.262012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:26:11.263756 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:26:11.263756 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:26:11.449064 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.194 seconds
[0m19:26:11.449064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:26:11.449064 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:26:11.464772 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:26:11.655370 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.191 seconds
[0m19:26:11.655370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1097830-f7df-4df4-aa3c-61a8c1d4e34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5B724E30>]}
[0m19:26:11.655370 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.report
[0m19:26:11.655370 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.report ...................... [RUN]
[0m19:26:11.655370 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.report'
[0m19:26:11.655370 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.report
[0m19:26:11.677858 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.report"
[0m19:26:11.677858 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.report
[0m19:26:11.713402 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.report"
[0m19:26:11.717434 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.report"
[0m19:26:11.717434 [debug] [Thread-1 (]: On model.CRB_PROJECT.report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.report
         as
        (WITH revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY
        payment_month
),
customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        payment_month,
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        payment_month, product_id
),
cross_sell AS (
    SELECT
        ct1.payment_month,
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    LEFT JOIN 
        (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month
         FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
         GROUP BY customer_id) p
    ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
),
grr_nrr AS (
    SELECT
        payment_month,
        grr,
        nrr
    FROM
        PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
)
SELECT
    r.payment_month,
    r.total_revenue,
    pc.churned_customers,
     nc.churned_customers,
    gn.grr,
    nc.new_customers,
    cs.cross_sell_opportunities,
    gn.nrr
FROM
    revenue r
LEFT JOIN
    (SELECT payment_month, SUM(churned_customers_lm) AS churned_customers_lm
     FROM product_churn_lm
     GROUP BY payment_month) pc ON r.payment_month = pc.payment_month
LEFT JOIN
    new_and_churned_customers nc ON r.payment_month = nc.payment_month
LEFT JOIN
    (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities
     FROM cross_sell
     GROUP BY payment_month) cs ON r.payment_month = cs.payment_month
LEFT JOIN
    grr_nrr gn ON r.payment_month = gn.payment_month
ORDER BY
    r.payment_month
        );
[0m19:26:11.718422 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:12.813628 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00e4-3201-7e57-000c-493e00026cb6
[0m19:26:12.813628 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 73 at position 4
invalid identifier 'PC.CHURNED_CUSTOMERS'
[0m19:26:12.826714 [debug] [Thread-1 (]: Database Error in model report (models\reporting\report.sql)
  000904 (42000): SQL compilation error: error line 73 at position 4
  invalid identifier 'PC.CHURNED_CUSTOMERS'
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql
[0m19:26:12.832118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1097830-f7df-4df4-aa3c-61a8c1d4e34f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE59F04860>]}
[0m19:26:12.832118 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model PROJECT_SCHEMA_report.report ............. [[31mERROR[0m in 1.17s]
[0m19:26:12.834313 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.report
[0m19:26:12.834313 [debug] [Thread-4 (]: Marking all children of 'model.CRB_PROJECT.report' to be skipped because of status 'error'.  Reason: Database Error in model report (models\reporting\report.sql)
  000904 (42000): SQL compilation error: error line 73 at position 4
  invalid identifier 'PC.CHURNED_CUSTOMERS'
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql.
[0m19:26:12.836319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:12.836319 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:26:12.836319 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:26:13.146120 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m19:26:13.146120 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m19:26:13.471410 [debug] [MainThread]: Connection 'model.CRB_PROJECT.report' was left open.
[0m19:26:13.471410 [debug] [MainThread]: On model.CRB_PROJECT.report: Close
[0m19:26:13.790599 [info ] [MainThread]: 
[0m19:26:13.790599 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m19:26:13.790599 [debug] [MainThread]: Command end result
[0m19:26:13.818791 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:26:13.821791 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:26:13.823757 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:26:13.823757 [info ] [MainThread]: 
[0m19:26:13.823757 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:26:13.823757 [info ] [MainThread]: 
[0m19:26:13.823757 [error] [MainThread]:   Database Error in model report (models\reporting\report.sql)
  000904 (42000): SQL compilation error: error line 73 at position 4
  invalid identifier 'PC.CHURNED_CUSTOMERS'
  compiled code at target\run\CRB_PROJECT\models\reporting\report.sql
[0m19:26:13.823757 [info ] [MainThread]: 
[0m19:26:13.823757 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:26:13.833477 [debug] [MainThread]: Command `dbt run` failed at 19:26:13.833477 after 13.01 seconds
[0m19:26:13.833477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5A568500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE59EB1BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE5B7B64E0>]}
[0m19:26:13.833477 [debug] [MainThread]: Flushing usage events
[0m19:26:15.080379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:26.134250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C0CD05C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C0CD0500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C0CD0890>]}


============================== 19:28:26.134250 | 13d2bf93-a278-4ec5-9b3b-cf74e22cc144 ==============================
[0m19:28:26.134250 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:28:26.134250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m report', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:28:26.607907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13d2bf93-a278-4ec5-9b3b-cf74e22cc144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C1733440>]}
[0m19:28:26.665292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13d2bf93-a278-4ec5-9b3b-cf74e22cc144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C1A23A10>]}
[0m19:28:26.667299 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:28:27.136686 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:28:27.301445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:28:27.301445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:28:27.306034 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:28:27.327293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13d2bf93-a278-4ec5-9b3b-cf74e22cc144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C0F4AC60>]}
[0m19:28:27.409190 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:28:27.409190 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:28:27.442979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13d2bf93-a278-4ec5-9b3b-cf74e22cc144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C2CCBC80>]}
[0m19:28:27.442979 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:28:27.442979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d2bf93-a278-4ec5-9b3b-cf74e22cc144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C2E7BE30>]}
[0m19:28:27.442979 [info ] [MainThread]: 
[0m19:28:27.442979 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:27.442979 [info ] [MainThread]: 
[0m19:28:27.442979 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:28:27.442979 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:28:27.550950 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:28:27.551948 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:28:27.551948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:28.881094 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.329 seconds
[0m19:28:28.887094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m19:28:28.897306 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:28:28.897306 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:28:28.898273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:29.788970 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.892 seconds
[0m19:28:29.788970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:28:29.788970 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:28:29.788970 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:28:30.013971 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.222 seconds
[0m19:28:30.013971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:28:30.022123 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:28:30.022123 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:28:30.213170 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.190 seconds
[0m19:28:30.214235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d2bf93-a278-4ec5-9b3b-cf74e22cc144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195BE117440>]}
[0m19:28:30.214235 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.report
[0m19:28:30.214235 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.report ...................... [RUN]
[0m19:28:30.214235 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.report'
[0m19:28:30.214235 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.report
[0m19:28:30.234754 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.report"
[0m19:28:30.235272 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.report
[0m19:28:30.268943 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.report"
[0m19:28:30.272944 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.report"
[0m19:28:30.273911 [debug] [Thread-1 (]: On model.CRB_PROJECT.report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.report
         as
        (-- WITH revenue AS (
--     SELECT
--         payment_month,
--         SUM(revenue) AS total_revenue
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
--     GROUP BY
--         payment_month
-- ),
-- customer_transactions AS (
--     SELECT
--         customer_id,
--         product_id,
--         payment_month
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
-- ),
-- product_churn_lm AS (
--     SELECT
--         payment_month,
--         product_id,
--         COUNT(DISTINCT customer_id) AS churned_customers_lm
--     FROM
--         customer_transactions
--     WHERE
--         payment_month < CURRENT_DATE - INTERVAL '30 Days'
--     GROUP BY
--         payment_month, product_id
-- ),
-- cross_sell AS (
--     SELECT
--         ct1.payment_month,
--         ct1.customer_id,
--         ct1.product_id AS product_id_1,
--         ct2.product_id AS product_id_2
--     FROM
--         customer_transactions ct1
--     JOIN
--         customer_transactions ct2
--     ON
--         ct1.customer_id = ct2.customer_id
--     WHERE
--         ct1.product_id <> ct2.product_id
-- ),
-- new_and_churned_customers AS (
--     SELECT
--         t.payment_month,
--         COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
--         COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
--     FROM 
--         PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
--     LEFT JOIN 
--         (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month
--          FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
--          GROUP BY customer_id) p
--     ON t.customer_id = p.customer_id
--     GROUP BY 
--         t.payment_month
-- ),
-- grr_nrr AS (
--     SELECT
--         payment_month,
--         grr,
--         nrr
--     FROM
--         PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
-- )
-- SELECT
--     r.payment_month,
--     r.total_revenue,
--     pc.churned_customers,
--      nc.churned_customers,
--     gn.grr,
--     nc.new_customers,
--     cs.cross_sell_opportunities,
--     gn.nrr
-- FROM
--     revenue r
-- LEFT JOIN
--     (SELECT payment_month, SUM(churned_customers_lm) AS churned_customers_lm
--      FROM product_churn_lm
--      GROUP BY payment_month) pc ON r.payment_month = pc.payment_month
-- LEFT JOIN
--     new_and_churned_customers nc ON r.payment_month = nc.payment_month
-- LEFT JOIN
--     (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities
--      FROM cross_sell
--      GROUP BY payment_month) cs ON r.payment_month = cs.payment_month
-- LEFT JOIN
--     grr_nrr gn ON r.payment_month = gn.payment_month
-- ORDER BY
--     r.payment_month







WITH revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY
        payment_month
),
customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        payment_month,
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        payment_month, product_id
),
cross_sell AS (
    SELECT
        ct1.payment_month,
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    LEFT JOIN 
        (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month
         FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
         GROUP BY customer_id) p
    ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
),
grr_nrr AS (
    SELECT
        payment_month,
        grr,
        nrr
    FROM
        PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
)
SELECT
    r.payment_month,
    r.total_revenue,
    pc.churned_customers_lm,
    nc.new_customers,
    nc.churned_customers,
    cs.cross_sell_opportunities,
    gn.grr,
    gn.nrr
FROM
    revenue r
LEFT JOIN
    (SELECT payment_month, SUM(churned_customers_lm) AS churned_customers_lm
     FROM product_churn_lm
     GROUP BY payment_month) pc ON r.payment_month = pc.payment_month
LEFT JOIN
    new_and_churned_customers nc ON r.payment_month = nc.payment_month
LEFT JOIN
    (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities
     FROM cross_sell
     GROUP BY payment_month) cs ON r.payment_month = cs.payment_month
LEFT JOIN
    grr_nrr gn ON r.payment_month = gn.payment_month
ORDER BY
    r.payment_month
        );
[0m19:28:30.273911 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:31.894034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.623 seconds
[0m19:28:31.916947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d2bf93-a278-4ec5-9b3b-cf74e22cc144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C0184B00>]}
[0m19:28:31.916947 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_report.report ................. [[32mSUCCESS 1[0m in 1.70s]
[0m19:28:31.916947 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.report
[0m19:28:31.924412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:31.924412 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:28:31.924412 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:28:32.237072 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m19:28:32.248175 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m19:28:32.564307 [debug] [MainThread]: Connection 'model.CRB_PROJECT.report' was left open.
[0m19:28:32.566331 [debug] [MainThread]: On model.CRB_PROJECT.report: Close
[0m19:28:32.899834 [info ] [MainThread]: 
[0m19:28:32.899834 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m19:28:32.899834 [debug] [MainThread]: Command end result
[0m19:28:32.926459 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:28:32.929340 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:28:32.936341 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:28:32.936341 [info ] [MainThread]: 
[0m19:28:32.946988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:32.971861 [info ] [MainThread]: 
[0m19:28:32.971861 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:28:32.973863 [debug] [MainThread]: Command `dbt run` succeeded at 19:28:32.972858 after 7.00 seconds
[0m19:28:32.973863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C06BD100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C2AA7FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195C100FA70>]}
[0m19:28:32.974860 [debug] [MainThread]: Flushing usage events
[0m19:28:34.230979 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:29:43.574653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144CE424A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144CE2AF020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144CE425460>]}


============================== 19:29:43.574653 | 5483b54c-cc2c-4c53-861b-a02063aa9103 ==============================
[0m19:29:43.574653 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:29:43.574653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m report', 'send_anonymous_usage_stats': 'True'}
[0m19:29:44.151881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5483b54c-cc2c-4c53-861b-a02063aa9103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144CF1DC350>]}
[0m19:29:44.213326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5483b54c-cc2c-4c53-861b-a02063aa9103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144CE0404A0>]}
[0m19:29:44.213326 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:29:44.736833 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:29:44.902271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:29:44.902271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:29:44.902271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:29:44.941589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5483b54c-cc2c-4c53-861b-a02063aa9103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144CF31FA10>]}
[0m19:29:45.021238 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:29:45.024745 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:29:45.053745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5483b54c-cc2c-4c53-861b-a02063aa9103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D0655160>]}
[0m19:29:45.053745 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:29:45.053745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5483b54c-cc2c-4c53-861b-a02063aa9103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144CF31E720>]}
[0m19:29:45.053745 [info ] [MainThread]: 
[0m19:29:45.053745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:29:45.066937 [info ] [MainThread]: 
[0m19:29:45.067694 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:29:45.067694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:29:45.166847 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:29:45.166847 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:29:45.166847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:46.623060 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.449 seconds
[0m19:29:46.670502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m19:29:46.681503 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:29:46.682505 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:29:46.682505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:47.618415 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.944 seconds
[0m19:29:47.618415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:29:47.618415 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:29:47.618415 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:29:47.841593 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.215 seconds
[0m19:29:47.848087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:29:47.850092 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:29:47.850092 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:29:48.048227 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.200 seconds
[0m19:29:48.054773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5483b54c-cc2c-4c53-861b-a02063aa9103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D04F85C0>]}
[0m19:29:48.058784 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.report
[0m19:29:48.058784 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.report ...................... [RUN]
[0m19:29:48.058784 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.report'
[0m19:29:48.058784 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.report
[0m19:29:48.071384 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.report"
[0m19:29:48.071384 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.report
[0m19:29:48.108813 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.report"
[0m19:29:48.112076 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.report"
[0m19:29:48.112076 [debug] [Thread-1 (]: On model.CRB_PROJECT.report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.report
         as
        (WITH revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY
        payment_month
),
customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        payment_month,
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        payment_month, product_id
),
cross_sell AS (
    SELECT
        ct1.payment_month,
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    LEFT JOIN 
        (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month
         FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
         GROUP BY customer_id) p
    ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
),
grr_nrr AS (
    SELECT
        payment_month,
        grr,
        nrr
    FROM
        PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
)
SELECT
    r.payment_month,
    r.total_revenue,
    pc.churned_customers_lm,
    nc.churned_customers,
    gn.grr,
    nc.new_customers,
    cs.cross_sell_opportunities,
    gn.nrr
FROM
    revenue r
LEFT JOIN
    (SELECT payment_month, SUM(churned_customers_lm) AS churned_customers_lm
     FROM product_churn_lm
     GROUP BY payment_month) pc ON r.payment_month = pc.payment_month
LEFT JOIN
    new_and_churned_customers nc ON r.payment_month = nc.payment_month
LEFT JOIN
    (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities
     FROM cross_sell
     GROUP BY payment_month) cs ON r.payment_month = cs.payment_month
LEFT JOIN
    grr_nrr gn ON r.payment_month = gn.payment_month
ORDER BY
    r.payment_month
        );
[0m19:29:48.114082 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:29:49.639100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.526 seconds
[0m19:29:49.663784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5483b54c-cc2c-4c53-861b-a02063aa9103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144CD8F46E0>]}
[0m19:29:49.665789 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_report.report ................. [[32mSUCCESS 1[0m in 1.60s]
[0m19:29:49.665789 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.report
[0m19:29:49.665789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:49.665789 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:29:49.665789 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:29:49.972863 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m19:29:49.972863 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m19:29:50.296458 [debug] [MainThread]: Connection 'model.CRB_PROJECT.report' was left open.
[0m19:29:50.296458 [debug] [MainThread]: On model.CRB_PROJECT.report: Close
[0m19:29:50.629674 [info ] [MainThread]: 
[0m19:29:50.630681 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.56 seconds (5.56s).
[0m19:29:50.631683 [debug] [MainThread]: Command end result
[0m19:29:50.655618 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:29:50.660513 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:29:50.666526 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:29:50.666526 [info ] [MainThread]: 
[0m19:29:50.666526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:29:50.666526 [info ] [MainThread]: 
[0m19:29:50.666526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:29:50.666526 [debug] [MainThread]: Command `dbt run` succeeded at 19:29:50.666526 after 7.25 seconds
[0m19:29:50.666526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D0464B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144CF1DD4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144D0654DD0>]}
[0m19:29:50.670619 [debug] [MainThread]: Flushing usage events
[0m19:29:51.568581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:20.435676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026359B8CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026359B8C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026359B8DA00>]}


============================== 19:30:20.435676 | 5f61e335-1930-4a7a-8472-e40206f6d6cf ==============================
[0m19:30:20.435676 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:30:20.435676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m crb_report', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:30:20.956619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f61e335-1930-4a7a-8472-e40206f6d6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635A7522A0>]}
[0m19:30:21.022490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f61e335-1930-4a7a-8472-e40206f6d6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635A8FD130>]}
[0m19:30:21.022490 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:30:21.525279 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:30:21.700612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:30:21.700612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:30:21.706609 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:30:21.741067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f61e335-1930-4a7a-8472-e40206f6d6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635B9BC080>]}
[0m19:30:21.822937 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:30:21.826935 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:30:21.863887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f61e335-1930-4a7a-8472-e40206f6d6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635BD34380>]}
[0m19:30:21.863887 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:30:21.864886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f61e335-1930-4a7a-8472-e40206f6d6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635BC002C0>]}
[0m19:30:21.866888 [info ] [MainThread]: 
[0m19:30:21.866888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:30:21.867885 [info ] [MainThread]: 
[0m19:30:21.868751 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:30:21.869841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:30:21.988709 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:30:21.988709 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:30:21.988709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:23.318202 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.329 seconds
[0m19:30:23.333641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m19:30:23.350156 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:30:23.350156 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:30:23.351153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:24.348777 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.997 seconds
[0m19:30:24.354473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:30:24.362489 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:30:24.363490 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:30:24.556254 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.192 seconds
[0m19:30:24.557421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:30:24.557421 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:30:24.557421 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:30:24.769967 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.211 seconds
[0m19:30:24.769967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f61e335-1930-4a7a-8472-e40206f6d6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635C159070>]}
[0m19:30:24.769967 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m19:30:24.769967 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.crb_report .................. [RUN]
[0m19:30:24.769967 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m19:30:24.769967 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m19:30:24.789748 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m19:30:24.792088 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m19:30:24.824322 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m19:30:24.827814 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m19:30:24.828817 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.crb_report
         as
        (WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue >= prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
customer_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_customers
),
product_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_products
),

crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        cr.revenue_rank AS customer_rank,
        pr.revenue_rank AS product_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA_stage.stg_locations l ON t.customer_id = l.customer_id
    LEFT JOIN customer_ranks cr ON t.customer_id = cr.customer_id
    LEFT JOIN product_ranks pr ON t.product_id = pr.product_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue,
        cr.revenue_rank,
        pr.revenue_rank
)

SELECT * FROM crb
        );
[0m19:30:24.828817 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:30:26.774641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.948 seconds
[0m19:30:26.797740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f61e335-1930-4a7a-8472-e40206f6d6cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635C31B9B0>]}
[0m19:30:26.797740 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_report.crb_report ............. [[32mSUCCESS 1[0m in 2.03s]
[0m19:30:26.799745 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m19:30:26.799745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:26.799745 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:30:26.799745 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:30:27.123799 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m19:30:27.123799 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m19:30:27.442462 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m19:30:27.442462 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m19:30:27.815819 [info ] [MainThread]: 
[0m19:30:27.816784 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m19:30:27.816784 [debug] [MainThread]: Command end result
[0m19:30:27.842712 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:30:27.845923 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:30:27.852851 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:30:27.853945 [info ] [MainThread]: 
[0m19:30:27.853945 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:27.854946 [info ] [MainThread]: 
[0m19:30:27.854946 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:30:27.855944 [debug] [MainThread]: Command `dbt run` succeeded at 19:30:27.855944 after 7.59 seconds
[0m19:30:27.856945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263590202C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263590228A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026358FF1A90>]}
[0m19:30:27.856945 [debug] [MainThread]: Flushing usage events
[0m19:30:28.811145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:31:32.568831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C826C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C826C5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C826F6E0>]}


============================== 19:31:32.568831 | f439ab84-3016-4300-9e92-9adfa3262493 ==============================
[0m19:31:32.568831 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:31:32.568831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m crb_report', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:31:33.070401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f439ab84-3016-4300-9e92-9adfa3262493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C9003A40>]}
[0m19:31:33.125447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f439ab84-3016-4300-9e92-9adfa3262493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C76C2C30>]}
[0m19:31:33.125447 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:31:33.620087 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:31:33.779214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:31:33.779214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:31:33.779214 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:31:33.810706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f439ab84-3016-4300-9e92-9adfa3262493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237CA0BD340>]}
[0m19:31:33.875677 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:31:33.891498 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:31:33.923159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f439ab84-3016-4300-9e92-9adfa3262493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237CA430950>]}
[0m19:31:33.923159 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:31:33.923159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f439ab84-3016-4300-9e92-9adfa3262493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237CA0D75F0>]}
[0m19:31:33.927228 [info ] [MainThread]: 
[0m19:31:33.927228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:31:33.927228 [info ] [MainThread]: 
[0m19:31:33.927228 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:31:33.927228 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:31:34.033173 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:31:34.033173 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:31:34.034176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:35.501739 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.482 seconds
[0m19:31:35.517413 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_report'
[0m19:31:35.533376 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:31:35.533376 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:31:35.533376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:36.710176 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.190 seconds
[0m19:31:36.725999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:31:36.729013 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:31:36.729013 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:31:36.928863 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.209 seconds
[0m19:31:36.928863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:31:36.943481 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:31:36.943481 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:31:37.128922 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.184 seconds
[0m19:31:37.128922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f439ab84-3016-4300-9e92-9adfa3262493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C56A7590>]}
[0m19:31:37.134034 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m19:31:37.134034 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.crb_report .................. [RUN]
[0m19:31:37.134034 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m19:31:37.134034 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m19:31:37.146845 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m19:31:37.148851 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m19:31:37.179403 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m19:31:37.183379 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m19:31:37.183379 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.crb_report
         as
        (WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue >= prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
customer_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_customers
),
product_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_products
),

crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        cr.revenue_rank AS customer_rank,
        pr.revenue_rank AS product_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA_stage.stg_locations l ON t.customer_id = l.customer_id
    LEFT JOIN customer_ranks cr ON t.customer_id = cr.customer_id
    LEFT JOIN product_ranks pr ON t.product_id = pr.product_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue,
        cr.revenue_rank,
        pr.revenue_rank
)

SELECT * FROM crb
        );
[0m19:31:37.183379 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:31:39.148078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.964 seconds
[0m19:31:39.173997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f439ab84-3016-4300-9e92-9adfa3262493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C5611790>]}
[0m19:31:39.173997 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_report.crb_report ............. [[32mSUCCESS 1[0m in 2.04s]
[0m19:31:39.175145 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m19:31:39.176152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:39.177183 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:31:39.177183 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:31:39.517084 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m19:31:39.517084 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m19:31:39.842203 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m19:31:39.842203 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m19:31:40.166429 [info ] [MainThread]: 
[0m19:31:40.167383 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.24 seconds (6.24s).
[0m19:31:40.168417 [debug] [MainThread]: Command end result
[0m19:31:40.192455 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:31:40.192455 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:31:40.201753 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:31:40.202718 [info ] [MainThread]: 
[0m19:31:40.203751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:31:40.203751 [info ] [MainThread]: 
[0m19:31:40.204718 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:31:40.205719 [debug] [MainThread]: Command `dbt run` succeeded at 19:31:40.205719 after 7.79 seconds
[0m19:31:40.205719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C826C500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C79A5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C828A3C0>]}
[0m19:31:40.206756 [debug] [MainThread]: Flushing usage events
[0m19:31:41.109716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:31:58.736698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DC73DCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0D99DD7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DB6E3170>]}


============================== 19:31:58.736698 | 2436d5c3-aa1c-4b3a-bf5a-05d147f002e2 ==============================
[0m19:31:58.736698 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:31:58.736698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m report', 'send_anonymous_usage_stats': 'True'}
[0m19:31:59.322927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2436d5c3-aa1c-4b3a-bf5a-05d147f002e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DC73C710>]}
[0m19:31:59.386863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2436d5c3-aa1c-4b3a-bf5a-05d147f002e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DBC19EE0>]}
[0m19:31:59.386863 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:31:59.887138 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:32:00.111444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:32:00.111444 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:32:00.127179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:32:00.163205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2436d5c3-aa1c-4b3a-bf5a-05d147f002e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DD273A10>]}
[0m19:32:00.239078 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:32:00.239078 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:32:00.286990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2436d5c3-aa1c-4b3a-bf5a-05d147f002e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DE558410>]}
[0m19:32:00.286990 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:32:00.286990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2436d5c3-aa1c-4b3a-bf5a-05d147f002e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DE53F5F0>]}
[0m19:32:00.286990 [info ] [MainThread]: 
[0m19:32:00.286990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:32:00.286990 [info ] [MainThread]: 
[0m19:32:00.286990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:32:00.286990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:32:00.397849 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:32:00.397849 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:32:00.397849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:01.714832 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.327 seconds
[0m19:32:01.730912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart'
[0m19:32:01.741896 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:32:01.743902 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:32:01.743902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:03.239568 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.496 seconds
[0m19:32:03.239568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:32:03.239568 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:32:03.239568 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:32:03.437667 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.194 seconds
[0m19:32:03.437667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_stage)
[0m19:32:03.443644 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:32:03.445652 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:32:03.649232 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.203 seconds
[0m19:32:03.652232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2436d5c3-aa1c-4b3a-bf5a-05d147f002e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DE929430>]}
[0m19:32:03.658879 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.report
[0m19:32:03.659912 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.report ...................... [RUN]
[0m19:32:03.660881 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.report'
[0m19:32:03.660881 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.report
[0m19:32:03.669878 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.report"
[0m19:32:03.672513 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.report
[0m19:32:03.709918 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.report"
[0m19:32:03.714905 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.report"
[0m19:32:03.715905 [debug] [Thread-1 (]: On model.CRB_PROJECT.report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.report
         as
        (WITH revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY
        payment_month
),
customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        payment_month,
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        payment_month, product_id
),
cross_sell AS (
    SELECT
        ct1.payment_month,
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    LEFT JOIN 
        (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month
         FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
         GROUP BY customer_id) p
    ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
),
grr_nrr AS (
    SELECT
        payment_month,
        grr,
        nrr
    FROM
        PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
)
SELECT
    r.payment_month,
    r.total_revenue,
    pc.churned_customers_lm AS product_churned_customers,
    nc.churned_customers AS churned_customers,
    gn.grr,
    nc.new_customers,
    cs.cross_sell_opportunities,
    gn.nrr
FROM
    revenue r
LEFT JOIN
    (SELECT payment_month, SUM(churned_customers_lm) AS churned_customers_lm
     FROM product_churn_lm
     GROUP BY payment_month) pc ON r.payment_month = pc.payment_month
LEFT JOIN
    new_and_churned_customers nc ON r.payment_month = nc.payment_month
LEFT JOIN
    (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities
     FROM cross_sell
     GROUP BY payment_month) cs ON r.payment_month = cs.payment_month
LEFT JOIN
    grr_nrr gn ON r.payment_month = gn.payment_month
ORDER BY
    r.payment_month
        );
[0m19:32:03.715905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:32:05.330569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.616 seconds
[0m19:32:05.351993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2436d5c3-aa1c-4b3a-bf5a-05d147f002e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DBBE4740>]}
[0m19:32:05.351993 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_report.report ................. [[32mSUCCESS 1[0m in 1.69s]
[0m19:32:05.351993 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.report
[0m19:32:05.351993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:32:05.351993 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:32:05.351993 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:32:05.668574 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage' was left open.
[0m19:32:05.668574 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: Close
[0m19:32:06.001260 [debug] [MainThread]: Connection 'model.CRB_PROJECT.report' was left open.
[0m19:32:06.001260 [debug] [MainThread]: On model.CRB_PROJECT.report: Close
[0m19:32:06.319692 [info ] [MainThread]: 
[0m19:32:06.319692 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.03 seconds (6.03s).
[0m19:32:06.319692 [debug] [MainThread]: Command end result
[0m19:32:06.351107 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:32:06.351107 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:32:06.351107 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:32:06.351107 [info ] [MainThread]: 
[0m19:32:06.351107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:32:06.351107 [info ] [MainThread]: 
[0m19:32:06.351107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:32:06.366806 [debug] [MainThread]: Command `dbt run` succeeded at 19:32:06.366806 after 7.80 seconds
[0m19:32:06.366806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DC714260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DBB936B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DC033320>]}
[0m19:32:06.366806 [debug] [MainThread]: Flushing usage events
[0m19:32:07.662902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:35:46.280407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4521DCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F42DE9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F41AF08C0>]}


============================== 19:35:46.288407 | 75efe9f5-59be-41d3-93fb-628a43df45e3 ==============================
[0m19:35:46.288407 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:35:46.288407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m report', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:46.818995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75efe9f5-59be-41d3-93fb-628a43df45e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F45C7DD00>]}
[0m19:35:46.877421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75efe9f5-59be-41d3-93fb-628a43df45e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F45D28920>]}
[0m19:35:46.877421 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:35:47.514636 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:35:47.676943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:35:47.676943 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:35:47.676943 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:35:47.714804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75efe9f5-59be-41d3-93fb-628a43df45e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F470B3170>]}
[0m19:35:47.784462 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:35:47.784462 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:35:47.824311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75efe9f5-59be-41d3-93fb-628a43df45e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F470B1AC0>]}
[0m19:35:47.826896 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:35:47.826896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75efe9f5-59be-41d3-93fb-628a43df45e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F451D7800>]}
[0m19:35:47.826896 [info ] [MainThread]: 
[0m19:35:47.826896 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:47.826896 [info ] [MainThread]: 
[0m19:35:47.826896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:35:47.831850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:35:47.942860 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:35:47.942860 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:35:47.942860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:49.394737 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.465 seconds
[0m19:35:49.417237 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m19:35:49.426281 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:35:49.426281 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:35:49.428287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:50.382762 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.968 seconds
[0m19:35:50.398529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:35:50.398529 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:35:50.398529 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:35:50.598021 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.207 seconds
[0m19:35:50.598021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:35:50.613196 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:35:50.613196 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:35:50.796835 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.182 seconds
[0m19:35:50.796835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75efe9f5-59be-41d3-93fb-628a43df45e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F45FBEBA0>]}
[0m19:35:50.796835 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.report
[0m19:35:50.796835 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.report ...................... [RUN]
[0m19:35:50.796835 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.report'
[0m19:35:50.796835 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.report
[0m19:35:50.814605 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.report"
[0m19:35:50.815561 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.report
[0m19:35:50.845138 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.report"
[0m19:35:50.848380 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.report"
[0m19:35:50.848380 [debug] [Thread-1 (]: On model.CRB_PROJECT.report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.report
         as
        (WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue >= prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
customer_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_customers
),
product_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_products
),

crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        cr.revenue_rank AS customer_rank,
        pr.revenue_rank AS product_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA_stage.stg_locations l ON t.customer_id = l.customer_id
    LEFT JOIN customer_ranks cr ON t.customer_id = cr.customer_id
    LEFT JOIN product_ranks pr ON t.product_id = pr.product_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue,
        cr.revenue_rank,
        pr.revenue_rank
)

SELECT * FROM crb
        );
[0m19:35:50.848380 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:35:52.482632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.632 seconds
[0m19:35:52.506995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75efe9f5-59be-41d3-93fb-628a43df45e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F446D4B30>]}
[0m19:35:52.507481 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_report.report ................. [[32mSUCCESS 1[0m in 1.71s]
[0m19:35:52.508553 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.report
[0m19:35:52.509553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:52.509553 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:35:52.509553 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:35:52.831561 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m19:35:52.831561 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m19:35:53.149123 [debug] [MainThread]: Connection 'model.CRB_PROJECT.report' was left open.
[0m19:35:53.151801 [debug] [MainThread]: On model.CRB_PROJECT.report: Close
[0m19:35:53.474122 [info ] [MainThread]: 
[0m19:35:53.474122 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m19:35:53.474122 [debug] [MainThread]: Command end result
[0m19:35:53.500686 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:35:53.500686 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:35:53.509228 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:35:53.509228 [info ] [MainThread]: 
[0m19:35:53.509228 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:35:53.509228 [info ] [MainThread]: 
[0m19:35:53.509228 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:35:53.509228 [debug] [MainThread]: Command `dbt run` succeeded at 19:35:53.509228 after 7.39 seconds
[0m19:35:53.509228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44F67530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44D5F8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44D5E870>]}
[0m19:35:53.509228 [debug] [MainThread]: Flushing usage events
[0m19:35:54.927196 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:07.065947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D2B05190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D2B053D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D2B05280>]}


============================== 19:36:07.065947 | f10bab47-59e4-43ab-8405-7a4966a883d0 ==============================
[0m19:36:07.065947 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:36:07.065947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m report', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:36:07.566309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f10bab47-59e4-43ab-8405-7a4966a883d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D2B33A10>]}
[0m19:36:07.632636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f10bab47-59e4-43ab-8405-7a4966a883d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D206B4A0>]}
[0m19:36:07.632636 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:36:08.143573 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:36:08.316055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:36:08.316849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:36:08.316849 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:36:08.355728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f10bab47-59e4-43ab-8405-7a4966a883d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D3A0E9C0>]}
[0m19:36:08.434659 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:36:08.438656 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:36:08.470536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f10bab47-59e4-43ab-8405-7a4966a883d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D4C03B30>]}
[0m19:36:08.470536 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:36:08.471391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10bab47-59e4-43ab-8405-7a4966a883d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D4B68EF0>]}
[0m19:36:08.472438 [info ] [MainThread]: 
[0m19:36:08.473409 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:08.473409 [info ] [MainThread]: 
[0m19:36:08.474397 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:36:08.475758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:36:08.565937 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:36:08.565937 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:36:08.565937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:10.102313 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.531 seconds
[0m19:36:10.115290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m19:36:10.120063 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:36:10.120063 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:36:10.120063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:11.186485 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.066 seconds
[0m19:36:11.186485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:36:11.186485 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:36:11.186485 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:36:11.377649 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.183 seconds
[0m19:36:11.377649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_report, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:36:11.377649 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:36:11.377649 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:36:11.600872 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.217 seconds
[0m19:36:11.600872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10bab47-59e4-43ab-8405-7a4966a883d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D51D2840>]}
[0m19:36:11.616758 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.report
[0m19:36:11.616758 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.report ...................... [RUN]
[0m19:36:11.616758 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.report'
[0m19:36:11.616758 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.report
[0m19:36:11.616758 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.report"
[0m19:36:11.616758 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.report
[0m19:36:11.652389 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.report"
[0m19:36:11.652389 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.report"
[0m19:36:11.652389 [debug] [Thread-1 (]: On model.CRB_PROJECT.report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.report
         as
        (WITH customer_data AS (
    SELECT
        customer_id,
        customer_name
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_customers
),
product_data AS (
    SELECT
        product_id,
        product_family,
        product_sub_family
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_products
),
transaction_data AS (
    SELECT
        customer_id,
        product_id,
        payment_month,
        revenue,
        SUM(revenue) OVER(PARTITION BY product_id) AS total_revenue,
        LAG(revenue) OVER (PARTITION BY customer_id ORDER BY payment_month) AS prev_revenue,
        CASE
            WHEN revenue >= prev_revenue THEN 'Expansion'
            WHEN revenue < prev_revenue THEN 'Contraction'
        END AS revenue_trend
    FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
customer_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_customers
),
product_ranks AS (
    SELECT * FROM PROJECT_DB.PROJECT_SCHEMA_mart.mart_rank_products
),

crb AS (
    SELECT
        t.customer_id,
        t.product_id,
        p.product_family,
        p.product_sub_family,
        t.revenue,
        t.prev_revenue,
        t.revenue_trend,
        l.region,
        l.country,
        cr.revenue_rank AS customer_rank,
        pr.revenue_rank AS product_rank
    FROM transaction_data t
    LEFT JOIN customer_data c ON t.customer_id = c.customer_id
    LEFT JOIN product_data p ON t.product_id = p.product_id
    LEFT JOIN PROJECT_DB.PROJECT_SCHEMA_stage.stg_locations l ON t.customer_id = l.customer_id
    LEFT JOIN customer_ranks cr ON t.customer_id = cr.customer_id
    LEFT JOIN product_ranks pr ON t.product_id = pr.product_id
    GROUP BY 
        t.customer_id, 
        t.product_id, 
        p.product_family, 
        p.product_sub_family, 
        t.revenue, 
        t.prev_revenue, 
        t.revenue_trend, 
        l.region, 
        l.country, 
        t.total_revenue,
        cr.revenue_rank,
        pr.revenue_rank
)

SELECT * FROM crb
        );
[0m19:36:11.652389 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:36:13.367468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.705 seconds
[0m19:36:13.383223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10bab47-59e4-43ab-8405-7a4966a883d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191CFED1850>]}
[0m19:36:13.383223 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_report.report ................. [[32mSUCCESS 1[0m in 1.77s]
[0m19:36:13.383223 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.report
[0m19:36:13.383223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:13.383223 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:36:13.383223 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:36:13.716307 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_mart' was left open.
[0m19:36:13.717304 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: Close
[0m19:36:14.038318 [debug] [MainThread]: Connection 'model.CRB_PROJECT.report' was left open.
[0m19:36:14.038318 [debug] [MainThread]: On model.CRB_PROJECT.report: Close
[0m19:36:14.354654 [info ] [MainThread]: 
[0m19:36:14.354654 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m19:36:14.354654 [debug] [MainThread]: Command end result
[0m19:36:14.392135 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:36:14.394114 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:36:14.396148 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:36:14.396148 [info ] [MainThread]: 
[0m19:36:14.396148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:36:14.396148 [info ] [MainThread]: 
[0m19:36:14.396148 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:36:14.396148 [debug] [MainThread]: Command `dbt run` succeeded at 19:36:14.396148 after 7.50 seconds
[0m19:36:14.404302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D4B6BC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D2B4AF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191D1FD55B0>]}
[0m19:36:14.404302 [debug] [MainThread]: Flushing usage events
[0m19:36:15.322286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:39.268079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0851C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B07E54B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B07E56630>]}


============================== 19:36:39.272091 | 677616ba-21a1-4285-8d54-2d327f04d547 ==============================
[0m19:36:39.272091 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:36:39.272091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\PaluriVarshini\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m crb_report', 'send_anonymous_usage_stats': 'True'}
[0m19:36:39.772660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '677616ba-21a1-4285-8d54-2d327f04d547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0805F170>]}
[0m19:36:39.830109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '677616ba-21a1-4285-8d54-2d327f04d547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B083C0320>]}
[0m19:36:39.830109 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:36:40.329738 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:36:40.495138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:36:40.496144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:36:40.497322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.CRB_PROJECT.example
[0m19:36:40.532391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '677616ba-21a1-4285-8d54-2d327f04d547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B092195E0>]}
[0m19:36:40.597049 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:36:40.607490 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:36:40.637203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '677616ba-21a1-4285-8d54-2d327f04d547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0A7440E0>]}
[0m19:36:40.637203 [info ] [MainThread]: Found 13 models, 4 sources, 474 macros
[0m19:36:40.637203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677616ba-21a1-4285-8d54-2d327f04d547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0A3A3320>]}
[0m19:36:40.637203 [info ] [MainThread]: 
[0m19:36:40.642080 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:40.642080 [info ] [MainThread]: 
[0m19:36:40.644282 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:36:40.644282 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB'
[0m19:36:40.747443 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB"
[0m19:36:40.747443 [debug] [ThreadPool]: On list_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB"} */
show terse schemas in database PROJECT_DB
    limit 10000
[0m19:36:40.748554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:42.027529 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.280 seconds
[0m19:36:42.031900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PROJECT_DB_PROJECT_SCHEMA_stage'
[0m19:36:42.031900 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_stage"
[0m19:36:42.031900 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_stage"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_stage limit 10000;
[0m19:36:42.031900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:42.993726 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.949 seconds
[0m19:36:42.997716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_stage, now list_PROJECT_DB_PROJECT_SCHEMA_mart)
[0m19:36:43.002675 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_mart"
[0m19:36:43.003675 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_mart"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_mart limit 10000;
[0m19:36:43.205057 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.201 seconds
[0m19:36:43.206056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_PROJECT_DB_PROJECT_SCHEMA_mart, now list_PROJECT_DB_PROJECT_SCHEMA_report)
[0m19:36:43.209056 [debug] [ThreadPool]: Using snowflake connection "list_PROJECT_DB_PROJECT_SCHEMA_report"
[0m19:36:43.210359 [debug] [ThreadPool]: On list_PROJECT_DB_PROJECT_SCHEMA_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "connection_name": "list_PROJECT_DB_PROJECT_SCHEMA_report"} */
show objects in PROJECT_DB.PROJECT_SCHEMA_report limit 10000;
[0m19:36:43.398555 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.199 seconds
[0m19:36:43.414471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677616ba-21a1-4285-8d54-2d327f04d547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B059573E0>]}
[0m19:36:43.432828 [debug] [Thread-1 (]: Began running node model.CRB_PROJECT.crb_report
[0m19:36:43.432828 [info ] [Thread-1 (]: 1 of 1 START sql table model PROJECT_SCHEMA_report.crb_report .................. [RUN]
[0m19:36:43.432828 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.CRB_PROJECT.crb_report'
[0m19:36:43.443215 [debug] [Thread-1 (]: Began compiling node model.CRB_PROJECT.crb_report
[0m19:36:43.484583 [debug] [Thread-1 (]: Writing injected SQL for node "model.CRB_PROJECT.crb_report"
[0m19:36:43.486611 [debug] [Thread-1 (]: Began executing node model.CRB_PROJECT.crb_report
[0m19:36:43.536495 [debug] [Thread-1 (]: Writing runtime sql for node "model.CRB_PROJECT.crb_report"
[0m19:36:43.540495 [debug] [Thread-1 (]: Using snowflake connection "model.CRB_PROJECT.crb_report"
[0m19:36:43.540495 [debug] [Thread-1 (]: On model.CRB_PROJECT.crb_report: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "CRB_PROJECT", "target_name": "dev", "node_id": "model.CRB_PROJECT.crb_report"} */
create or replace transient table PROJECT_DB.PROJECT_SCHEMA_report.crb_report
         as
        (WITH revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
    GROUP BY
        payment_month
),
customer_transactions AS (
    SELECT
        customer_id,
        product_id,
        payment_month
    FROM
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
),
product_churn_lm AS (
    SELECT
        payment_month,
        product_id,
        COUNT(DISTINCT customer_id) AS churned_customers_lm
    FROM
        customer_transactions
    WHERE
        payment_month < CURRENT_DATE - INTERVAL '30 Days'
    GROUP BY
        payment_month, product_id
),
cross_sell AS (
    SELECT
        ct1.payment_month,
        ct1.customer_id,
        ct1.product_id AS product_id_1,
        ct2.product_id AS product_id_2
    FROM
        customer_transactions ct1
    JOIN
        customer_transactions ct2
    ON
        ct1.customer_id = ct2.customer_id
    WHERE
        ct1.product_id <> ct2.product_id
),
new_and_churned_customers AS (
    SELECT
        t.payment_month,
        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,
        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers
    FROM 
        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t
    LEFT JOIN 
        (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month
         FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions
         GROUP BY customer_id) p
    ON t.customer_id = p.customer_id
    GROUP BY 
        t.payment_month
),
grr_nrr AS (
    SELECT
        payment_month,
        grr,
        nrr
    FROM
        PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr
)
SELECT
    r.payment_month,
    r.total_revenue,
    pc.churned_customers_lm AS product_churned_customers,
    nc.churned_customers AS churned_customers,
    gn.grr,
    nc.new_customers,
    cs.cross_sell_opportunities,
    gn.nrr
FROM
    revenue r
LEFT JOIN
    (SELECT payment_month, SUM(churned_customers_lm) AS churned_customers_lm
     FROM product_churn_lm
     GROUP BY payment_month) pc ON r.payment_month = pc.payment_month
LEFT JOIN
    new_and_churned_customers nc ON r.payment_month = nc.payment_month
LEFT JOIN
    (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities
     FROM cross_sell
     GROUP BY payment_month) cs ON r.payment_month = cs.payment_month
LEFT JOIN
    grr_nrr gn ON r.payment_month = gn.payment_month
ORDER BY
    r.payment_month
        );
[0m19:36:43.541496 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:36:45.185749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.644 seconds
[0m19:36:45.207438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677616ba-21a1-4285-8d54-2d327f04d547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0ACC91C0>]}
[0m19:36:45.208445 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PROJECT_SCHEMA_report.crb_report ............. [[32mSUCCESS 1[0m in 1.77s]
[0m19:36:45.208970 [debug] [Thread-1 (]: Finished running node model.CRB_PROJECT.crb_report
[0m19:36:45.209977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:45.211010 [debug] [MainThread]: Connection 'list_PROJECT_DB' was left open.
[0m19:36:45.211010 [debug] [MainThread]: On list_PROJECT_DB: Close
[0m19:36:45.528450 [debug] [MainThread]: Connection 'list_PROJECT_DB_PROJECT_SCHEMA_report' was left open.
[0m19:36:45.529453 [debug] [MainThread]: On list_PROJECT_DB_PROJECT_SCHEMA_report: Close
[0m19:36:45.845103 [debug] [MainThread]: Connection 'model.CRB_PROJECT.crb_report' was left open.
[0m19:36:45.845103 [debug] [MainThread]: On model.CRB_PROJECT.crb_report: Close
[0m19:36:46.170921 [info ] [MainThread]: 
[0m19:36:46.171920 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m19:36:46.172947 [debug] [MainThread]: Command end result
[0m19:36:46.195185 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\manifest.json
[0m19:36:46.199007 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\PaluriVarshini\CRB_PROJECT\target\semantic_manifest.json
[0m19:36:46.208152 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\PaluriVarshini\CRB_PROJECT\target\run_results.json
[0m19:36:46.208152 [info ] [MainThread]: 
[0m19:36:46.209119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:36:46.209119 [info ] [MainThread]: 
[0m19:36:46.210118 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:36:46.211154 [debug] [MainThread]: Command `dbt run` succeeded at 19:36:46.211154 after 7.11 seconds
[0m19:36:46.211154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B079C4FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B079C5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B0A33A7B0>]}
[0m19:36:46.211154 [debug] [MainThread]: Flushing usage events
[0m19:36:47.120621 [debug] [MainThread]: An error was encountered while trying to flush usage events
