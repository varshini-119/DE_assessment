{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-14T14:06:46.171920Z", "invocation_id": "677616ba-21a1-4285-8d54-2d327f04d547", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T14:06:43.445229Z", "completed_at": "2025-03-14T14:06:43.486611Z"}, {"name": "execute", "started_at": "2025-03-14T14:06:43.486611Z", "completed_at": "2025-03-14T14:06:45.205166Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7723371982574463, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00ee-3201-7e57-000c-493e00026e46"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.CRB_PROJECT.crb_report", "compiled": true, "compiled_code": "WITH revenue AS (\n    SELECT\n        payment_month,\n        SUM(revenue) AS total_revenue\n    FROM\n        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions\n    GROUP BY\n        payment_month\n),\ncustomer_transactions AS (\n    SELECT\n        customer_id,\n        product_id,\n        payment_month\n    FROM\n        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions\n),\nproduct_churn_lm AS (\n    SELECT\n        payment_month,\n        product_id,\n        COUNT(DISTINCT customer_id) AS churned_customers_lm\n    FROM\n        customer_transactions\n    WHERE\n        payment_month < CURRENT_DATE - INTERVAL '30 Days'\n    GROUP BY\n        payment_month, product_id\n),\ncross_sell AS (\n    SELECT\n        ct1.payment_month,\n        ct1.customer_id,\n        ct1.product_id AS product_id_1,\n        ct2.product_id AS product_id_2\n    FROM\n        customer_transactions ct1\n    JOIN\n        customer_transactions ct2\n    ON\n        ct1.customer_id = ct2.customer_id\n    WHERE\n        ct1.product_id <> ct2.product_id\n),\nnew_and_churned_customers AS (\n    SELECT\n        t.payment_month,\n        COUNT(DISTINCT CASE WHEN p.first_purchase_month = t.payment_month THEN t.customer_id END) AS new_customers,\n        COUNT(DISTINCT CASE WHEN p.last_purchase_month < t.payment_month THEN t.customer_id END) AS churned_customers\n    FROM \n        PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions t\n    LEFT JOIN \n        (SELECT customer_id, MIN(payment_month) AS first_purchase_month, MAX(payment_month) AS last_purchase_month\n         FROM PROJECT_DB.PROJECT_SCHEMA_stage.stg_transactions\n         GROUP BY customer_id) p\n    ON t.customer_id = p.customer_id\n    GROUP BY \n        t.payment_month\n),\ngrr_nrr AS (\n    SELECT\n        payment_month,\n        grr,\n        nrr\n    FROM\n        PROJECT_DB.PROJECT_SCHEMA_mart.mart_nrr_grr\n)\nSELECT\n    r.payment_month,\n    r.total_revenue,\n    pc.churned_customers_lm AS product_churned_customers,\n    nc.churned_customers AS churned_customers,\n    gn.grr,\n    nc.new_customers,\n    cs.cross_sell_opportunities,\n    gn.nrr\nFROM\n    revenue r\nLEFT JOIN\n    (SELECT payment_month, SUM(churned_customers_lm) AS churned_customers_lm\n     FROM product_churn_lm\n     GROUP BY payment_month) pc ON r.payment_month = pc.payment_month\nLEFT JOIN\n    new_and_churned_customers nc ON r.payment_month = nc.payment_month\nLEFT JOIN\n    (SELECT payment_month, COUNT(product_id_2) AS cross_sell_opportunities\n     FROM cross_sell\n     GROUP BY payment_month) cs ON r.payment_month = cs.payment_month\nLEFT JOIN\n    grr_nrr gn ON r.payment_month = gn.payment_month\nORDER BY\n    r.payment_month", "relation_name": "PROJECT_DB.PROJECT_SCHEMA_report.crb_report", "batch_results": null}], "elapsed_time": 5.526639461517334, "args": {"printer_width": 80, "skip_nodes_if_on_run_start_fails": false, "write_json": true, "require_batched_execution_for_custom_microbatch_strategy": false, "version_check": true, "introspect": true, "defer": false, "print": true, "which": "run", "select": ["crb_report"], "favor_state": false, "populate_cache": true, "macro_debugging": false, "use_colors": true, "require_explicit_package_overrides_for_builtin_materializations": true, "profiles_dir": "C:\\Users\\PaluriVarshini\\.dbt", "state_modified_compare_vars": false, "require_yaml_configuration_for_mf_time_spines": false, "partial_parse": true, "log_file_max_bytes": 10485760, "log_format_file": "debug", "vars": {}, "log_path": "C:\\Users\\PaluriVarshini\\CRB_PROJECT\\logs", "use_colors_file": true, "require_nested_cumulative_type_params": false, "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "log_level_file": "debug", "project_dir": "C:\\Users\\PaluriVarshini\\CRB_PROJECT", "log_level": "info", "strict_mode": false, "log_format": "default", "static_parser": true, "empty": false, "quiet": false, "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "show_resource_report": false, "source_freshness_run_project_hooks": false, "invocation_command": "dbt run -m crb_report", "require_resource_names_without_spaces": false, "state_modified_compare_more_unrendered_values": false, "exclude": [], "indirect_selection": "eager"}}